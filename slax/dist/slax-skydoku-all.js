/**
 * slax-skydoku - The skydoku slax application.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link skydoku.hudaokeji.com
 * @license 
 */
!function(factory,globals){var define=globals.define,require=globals.require,isAmd="function"==typeof define&&define.amd,isCmd=!isAmd&&"undefined"!=typeof exports;if(!isAmd&&!define){var map={};define=globals.define=function(e,t,i){"function"==typeof i?(map[e]={factory:i,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var i=t.split("/"),n=e.split("/");i.pop();for(var r=0;r<n.length;r++)"."!=n[r]&&(".."==n[r]?i.pop():i.push(n[r]));return i.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):map[e]={factory:null,resolved:!0,exports:i}},require=globals.require=function(e){if(!map.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=map[e];if(!module.resolved){var t=[];module.deps.forEach(function(e){t.push(require(e))}),module.exports=module.factory.apply(globals,t)||null,module.resolved=!0}return module.exports}}if(!define)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(define,require){define("skylark-langx-ns/_attach",[],function(){return function(e,t,i){"string"==typeof t&&(t=t.split("."));for(var n=t.length,r=e,s=0,o=t[s++];s<n;)r=r[o]=r[o]||{},o=t[s++];if(r[o]){if(i)throw new Error("This namespace already exists:"+t)}else r[o]=i||{};return r[o]}}),define("skylark-langx-ns/ns",["./_attach"],function(e){var t={attach:function(i,n){return e(t,i,n)}};return t}),define("skylark-langx-ns/main",["./ns"],function(e){return e}),define("skylark-langx-ns",["skylark-langx-ns/main"],function(e){return e}),define("skylark-langx-types/types",["skylark-langx-ns"],function(e){var t,i=Array.isArray,n={}.toString,r=(t={},"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(e){t["[object "+e+"]"]=e.toLowerCase()}),function(e){return null==e?String(e):t[n.call(e)]||"object"}),s=i||function(e){return object&&object.constructor===Array};function o(e){var t;for(t in e)if(null!==e[t])return!1;return!0}function a(e){return"function"==r(e)}function l(e){return e&&e.nodeType}function c(e){return"number"==typeof e}function h(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function u(e){return"string"==typeof e}function d(e){return e&&e==e.window}function f(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}var p=1/0,m=1.7976931348623157e308,g=NaN,v=/^\s+|\s+$/g,y=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,b=/^0o[0-7]+$/i,x=parseInt;function w(e){if(!e)return 0===e?e:0;if((e=_(e))===p||e===-p){var t=e<0?-1:1;return t*m}return e==e?e:0}function _(e){if("number"==typeof e)return e;if(f(e))return g;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(v,"");var i=k.test(e);return i||b.test(e)?x(e.slice(2),i?2:8):y.test(e)?g:+e}return e.attach("langx.types",{isArray:s,isArrayLike:function(e){return!u(e)&&!l(e)&&"number"==typeof e.length&&!a(e)},isBoolean:function(e){return!0===e||!1===e||"[object Boolean]"===n.call(e)},isDefined:function(e){return void 0!==e},isDocument:function(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE},isElement:function(e){return!(!e||1!==e.nodeType)},isEmpty:o,isEmptyObject:o,isFunction:a,isHtmlNode:l,isNaN:function(e){return isNaN(e)},isNull:function(e){return null===e},isNumber:c,isNumeric:c,isObject:h,isPlainObject:function(e){return h(e)&&!d(e)&&Object.getPrototypeOf(e)==Object.prototype},isString:u,isSameOrigin:function(e){if(e){var t=location.protocol+"//"+location.hostname;return location.port&&(t+=":"+location.port),e.startsWith(t)}},isSymbol:f,isUndefined:function(e){return void 0===e},isWindow:d,type:r,toFinite:w,toNumber:_,toInteger:function(e){var t=w(e),i=t%1;return t==t?i?t-i:t:0}})}),define("skylark-langx-types/main",["./types"],function(e){return e}),define("skylark-langx-types",["skylark-langx-types/main"],function(e){return e}),define("skylark-langx-objects/objects",["skylark-langx-ns","skylark-langx-types"],function(e,t){var i,n,r=Object.prototype.hasOwnProperty,s=(Array.prototype.slice,t.isBoolean,t.isFunction,t.isObject),o=t.isPlainObject,a=t.isArray;t.isArrayLike,t.isString,t.toInteger;function l(e){if(!s(e))return[];var t=[];for(var i in e)t.push(i);return t}function c(e,t){if(!a(t))return null!=e&&r.call(e,t);for(var i=t.length,n=0;n<i;n++){var s=t[n];if(null==e||!r.call(e,s))return!1;e=e[s]}return!!i}return e.attach("langx.objects",{allKeys:l,attach:e.attach,defaults:(i=l,n=!0,function(e){var t=arguments.length;if(n&&(e=Object(e)),t<2||null==e)return e;for(var r=1;r<t;r++)for(var s=arguments[r],o=i(s),a=o.length,l=0;l<a;l++){var c=o[l];n&&void 0!==e[c]||(e[c]=s[c])}return e}),has:c,isMatch:function(e,t){var i=i(t),n=i.length;if(null==e)return!n;for(var r=Object(e),s=0;s<n;s++){var o=i[s];if(t[o]!==r[o]||!(o in r))return!1}return!0},keys:function(e){if(s(e))return[];var t=[];for(var i in e)c(e,i)&&t.push(i);return t},removeItem:function(e,t){if(a(e)){var i=e.indexOf(t);-1!=i&&e.splice(i,1)}else if(o(e))for(var n in e)if(e[n]==t){delete e[n];break}return this},values:function(e){for(var t=l(e),i=t.length,n=Array(i),r=0;r<i;r++)n[r]=e[t[r]];return n}})}),define("skylark-langx-objects/clone",["skylark-langx-types","./objects"],function(e,t){var i=e.isPlainObject,n=e.isArray;return t.clone=function e(t,r){var s;if(void 0===t||null===t)s=t;else if(r&&t.clone)s=t.clone();else if(n(t)){s=[];for(var o=0;o<t.length;o++)s.push(e(t[o]))}else if(i(t))for(var a in s={},t)s[a]=e(t[a]);else s=t;return s}}),define("skylark-langx-objects/each",["./objects"],function(e){return e.each=function(e,t,i){var n,r,s,o;if(e)if(void 0===(n=e.length)){for(r in e)if(e.hasOwnProperty(r)&&(o=e[r],!1===(i?t.call(o,o,r):t.call(o,r,o))))break}else for(s=0;s<n&&(o=e[s],!1!==(i?t.call(o,o,s):t.call(o,s,o)));s++);return this}}),define("skylark-langx-objects/_mixin",["skylark-langx-types","./objects"],function(e,t){var i=e.isPlainObject;return function e(t,n,r,s){for(var o in n)s&&void 0!==t[o]||(r&&i(n[o])?(i(t[o])||(t[o]={}),e(t[o],n[o],r,s)):void 0!==n[o]&&(t[o]=n[o]));return t}}),define("skylark-langx-objects/_parse_mixin_args",["skylark-langx-types","./objects"],function(e,t){var i=Array.prototype.slice,n=e.isBoolean;return function(e){var t=i.call(arguments,0),r=t.shift(),s=!1;n(t[t.length-1])&&(s=t.pop());return{target:r,sources:t,deep:s}}}),define("skylark-langx-objects/mixin",["skylark-langx-types","./objects","./_mixin","./_parse_mixin_args"],function(e,t,i,n){return t.mixin=function(){var e=n.apply(this,arguments);return e.sources.forEach(function(t){i(e.target,t,e.deep,!1)}),e.target}}),define("skylark-langx-objects/extend",["./objects","./mixin"],function(e,t){var i=Array.prototype.slice;return e.extend=function(e){var n,r=i.call(arguments,1);"boolean"==typeof e&&(n=e,e=r.shift());0==r.length&&(r=[e],e=this);return r.forEach(function(i){t(e,i,n)}),e}}),define("skylark-langx-objects/includes",["./objects"],function(e){return e.includes=function(e,t,i,n){e=isArrayLike(e)?e:values(e),i=i&&!n?toInteger(i):0;var r=e.length;i<0&&(i=nativeMax(r+i,0));return isString(e)?i<=r&&e.indexOf(t,i)>-1:!!r&&baseIndexOf(e,t,i)>-1}}),define("skylark-langx-objects/is-equal",["skylark-langx-types","./objects"],function(e,t){var i,n,r=e.isFunction,s="undefined"!=typeof Symbol?Symbol.prototype:null;return i=function(e,t,i,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var s=typeof e;return("function"===s||"object"===s||"object"==typeof t)&&n(e,t,i,r)},n=function(e,t,n,o){var a=toString.call(e);if(a!==toString.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return s.valueOf.call(e)===s.valueOf.call(t)}var l="[object Array]"===a;if(!l){if("object"!=typeof e||"object"!=typeof t)return!1;var c=e.constructor,h=t.constructor;if(c!==h&&!(r(c)&&c instanceof c&&r(h)&&h instanceof h)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],o=o||[];for(var u=n.length;u--;)if(n[u]===e)return o[u]===t;if(n.push(e),o.push(t),l){if((u=e.length)!==t.length)return!1;for(;u--;)if(!i(e[u],t[u],n,o))return!1}else{var d,f=Object.keys(e);if(u=f.length,Object.keys(t).length!==u)return!1;for(;u--;)if(d=f[u],void 0===t[d]||!i(e[d],t[d],n,o))return!1}return n.pop(),o.pop(),!0},t.isEqual=function(e,t){return i(e,t)}}),define("skylark-langx-objects/omit",["./objects"],function(e){return e.omit=function(e,t,i){if(!e)return null;for(var n=mixin({},e),r=1;r<arguments.length;r++){var s=arguments[r];s in e&&delete n[s]}return n}}),define("skylark-langx-objects/pick",["./objects"],function(e){return e.pick=function(e,t,i){if(!e)return null;for(var n={},r=1;r<arguments.length;r++){var s=arguments[r];s in e&&(n[s]=e[s])}return n}}),define("skylark-langx-objects/result",["skylark-langx-types","./objects"],function(e,t){var i=e.isArray,n=e.isFunction;return t.result=function(e,t,r){i(t)||(t=t.split("."));var s=t.length;if(!s)return n(r)?r.call(e):r;for(var o=0;o<s;o++){var a=null==e?void 0:e[t[o]];void 0===a&&(a=r,o=s),e=n(a)?a.call(e):a}return e}}),define("skylark-langx-objects/safe-mixin",["./objects","./_mixin","./_parse_mixin_args"],function(e,t,i){return e.safeMixin=function(){var e=i.apply(this,arguments);return e.sources.forEach(function(i){t(e.target,i,e.deep,!0)}),e.target}}),define("skylark-langx-objects/scall",["./objects"],function(e){return e.scall=function(e,t,i,n){if(e&&e[t]){var r=slice.call(arguments,2);return e[t].apply(e,r)}}}),define("skylark-langx-objects/shadow",["./objects"],function(e){return e.shadow=function(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!1}),i}}),define("skylark-langx-objects/main",["./objects","./clone","./each","./extend","./includes","./is-equal","./mixin","./omit","./pick","./result","./safe-mixin","./scall","./shadow"],function(e){return e}),define("skylark-langx-objects",["skylark-langx-objects/main"],function(e){return e}),define("skylark-langx-hoster/hoster",["skylark-langx-ns"],function(e){var t={isBrowser:!0,isNode:null,global:this,browser:null,node:null};"object"==typeof process&&process.versions&&process.versions.node&&process.versions.v8&&(t.isNode=!0,t.isBrowser=!1),t.global=function(){return"undefined"!=typeof global&&"function"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}();var i=null;if(Object.defineProperty(t,"document",function(){if(!i){var e="undefined"==typeof window?require("html-element"):window;i=e.document}return i}),void 0===t.global.CustomEvent&&(t.global.CustomEvent=function(e,t){this.type=e,this.props=t}),t.isBrowser){var n=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}(navigator.userAgent),r=t.browser={};n.browser&&(r[n.browser]=!0,r.version=n.version),r.chrome?r.webkit=!0:r.webkit&&(r.safari=!0)}return t.detects={},e.attach("langx.hoster",t)}),define("skylark-langx-hoster/detects/mobile",["../hoster"],function(e){var t=/iPhone/i,i=/iPod/i,n=/iPad/i,r=/\biOS-universal(?:.+)Mac\b/i,s=/\bAndroid(?:.+)Mobile\b/i,o=/Android/i,a=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,l=/Silk/i,c=/Windows Phone/i,h=/\bWindows(?:.+)ARM\b/i,u=/BlackBerry/i,d=/BB10/i,f=/Opera Mini/i,p=/\b(CriOS|Chrome)(?:.+)Mobile/i,m=/Mobile(?:.+)Firefox\b/i,g=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};return e.detects.mobile=function(e){var v={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?v.userAgent=e:e&&e.userAgent&&(v={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):v={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var y=v.userAgent,k=y.split("[FBAN");void 0!==k[1]&&(y=k[0]);void 0!==(k=y.split("Twitter"))[1]&&(y=k[0]);var b=function(e){return function(t){return t.test(e)}}(y),x={apple:{phone:b(t)&&!b(c),ipod:b(i),tablet:!b(t)&&(b(n)||g(v))&&!b(c),universal:b(r),device:(b(t)||b(i)||b(n)||b(r)||g(v))&&!b(c)},amazon:{phone:b(a),tablet:!b(a)&&b(l),device:b(a)||b(l)},android:{phone:!b(c)&&b(a)||!b(c)&&b(s),tablet:!b(c)&&!b(a)&&!b(s)&&(b(l)||b(o)),device:!b(c)&&(b(a)||b(l)||b(s)||b(o))||b(/\bokhttp\b/i)},windows:{phone:b(c),tablet:b(h),device:b(c)||b(h)},other:{blackberry:b(u),blackberry10:b(d),opera:b(f),firefox:b(m),chrome:b(p),device:b(u)||b(d)||b(f)||b(m)||b(p)},any:!1,phone:!1,tablet:!1};return x.any=x.apple.device||x.android.device||x.windows.device||x.other.device,x.phone=x.apple.phone||x.android.phone||x.windows.phone,x.tablet=x.apple.tablet||x.android.tablet||x.windows.tablet,x}}),define("skylark-langx-hoster/isMobile",["./hoster","./detects/mobile"],function(e,t){return void 0==e.isMobile&&(e.isMobile=t()),e.isMobile}),define("skylark-langx-hoster/main",["./hoster","./isMobile"],function(e){return e}),define("skylark-langx-hoster",["skylark-langx-hoster/main"],function(e){return e}),define("skylark-langx-arrays/arrays",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects"],function(e,t,i){var n=Array.prototype.filter,r=Array.prototype.find,s=t.isArrayLike;function o(e,t,i,n){for(var r=e.length,s=i+(n?1:-1);n?s--:++s<r;)if(t(e[s],s,e))return s;return-1}function a(e){return e!=e}function l(e){if(s(e)){for(var t=[],i=0;i<e.length;i++){var n=e[i];if(s(n))for(var r=0;r<n.length;r++)t.push(n[r]);else t.push(n)}return t}return e}function c(e,t,i){return s(e)?(i||[]).concat(Array.prototype.slice.call(e,t||0)):[e]}return e.attach("langx.arrays",{baseFindIndex:o,baseIndexOf:function(e,t,i){if(t!=t)return o(e,a,i);var n=i-1,r=e.length;for(;++n<r;)if(e[n]===t)return n;return-1},compact:function(e){return n.call(e,function(e){return null!=e})},first:function(e,t){return t?e.slice(0,t):e[0]},filter:function(e,t){return n.call(e,t)},find:function(e,t){return r.call(e,t)},flatten:l,grep:function(e,t){var n=[];return i.each(e,function(e,i){t(i,e)&&n.push(i)}),n},inArray:function(e,t){if(!t)return-1;var i;if(t.indexOf)return t.indexOf(e);i=t.length;for(;i--;)if(t[i]===e)return i;return-1},indexOf:function(e,t){return e.indexOf(t)},makeArray:c,toArray:c,last:function(e){return e[e.length-1]},merge:function(e,t){var i=t.length,n=e.length,r=0;if("number"==typeof i)for(;r<i;r++)e[n++]=t[r];else for(;void 0!==t[r];)e[n++]=t[r++];return e.length=n,e},forEach:function(e,t){if(e.forEach)return e.forEach(t);for(var i=0;i<e.length;i++)t(e[i],i)},map:function(e,t){var i,n,r,o=[];if(s(e))for(n=0;n<e.length;n++)null!=(i=t.call(e[n],e[n],n))&&o.push(i);else for(r in e)null!=(i=t.call(e[r],e[r],r))&&o.push(i);return l(o)},reduce:function(e,t,i){return Array.prototype.reduce.call(e,t,i)},uniq:function(e){return n.call(e,function(t,i){return e.indexOf(t)==i})}})}),define("skylark-langx-arrays/main",["./arrays"],function(e){return e}),define("skylark-langx-arrays",["skylark-langx-arrays/main"],function(e){return e}),define("skylark-langx-funcs/funcs",["skylark-langx-ns"],function(e,t,i){return e.attach("langx.funcs",{noop:function(){},returnTrue:function(){return!0},returnFalse:function(){return!1}})}),define("skylark-langx-funcs/defer",["skylark-langx-types","./funcs"],function(e,t){return t.defer=function(t,i,n,r){var s={cancel:null},o=t;e.isNumber(i)||e.isFunction(i)||(r=n,n=i,i=0);n&&(o=function(){t.apply(r,n)});if(e.isFunction(i)){var a=!1;i(function(){a||o()}),s.cancel=function(){a=!0}}else{var l;0==i&&requestAnimationFrame?(l=requestAnimationFrame(o),s.cancel=function(){return cancelAnimationFrame(l)}):(l=setTimeout(o,i),s.cancel=function(){return clearTimeout(l)})}return s}}),define("skylark-langx-funcs/debounce",["./funcs","./defer"],function(e,t){return e.debounce=function(e,i,n){var r,s,o=function(){var o=this,l=arguments;return a(),r=setTimeout(function(){r=null,n?s=t(e,l,o):e.apply(o,l)},i),{cancel:a}},a=o.cancel=function(){r&&clearTimeout(r),s&&s.cancel(),r=void 0,s=void 0};return o}}),define("skylark-langx-funcs/delegate",["skylark-langx-objects","./funcs"],function(e,t){var i=e.mixin,n=function(){function e(){}return function(t,n){e.prototype=t;var r=new e;return e.prototype=null,n&&i(r,n),r}}();return t.delegate=n}),define("skylark-langx-funcs/loop",["./funcs"],function(e){function t(e){this.callback=e,this.running=!1,this.id=-1}return t.prototype.start=function(){if(!this.running){this.running=!0;var e=this;!function t(){e.callback();e.running&&(e.id=requestAnimationFrame(t))}()}},t.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},e.loop=function(e){return new t(e)}}),define("skylark-langx-funcs/negate",["./funcs"],function(e){return e.negate=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(...t){return!e.apply(this,t)}}}),define("skylark-langx-funcs/proxy",["skylark-langx-types","./funcs"],function(e,t){var i=Array.prototype.slice,n=e.isFunction,r=e.isString;return t.bind=t.proxy=function e(t,s){var o=2 in arguments&&i.call(arguments,2);if(n(t)){return function(){return t.apply(s,o?o.concat(i.call(arguments)):arguments)}}if(r(s))return o?(o.unshift(t[s],t),e.apply(null,o)):e(t[s],t);throw new TypeError("expected function")}}),define("skylark-langx-funcs/template",["skylark-langx-objects","./funcs","./proxy"],function(e,t,i){Array.prototype.slice;var n={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},r=/(.)^/,s={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},o=/\\|'|\r|\n|\t|\u2028|\u2029/g;function a(t,a,l){var c;l=e.defaults({},l,n);var h=RegExp([(l.escape||r).source,(l.interpolate||r).source,(l.evaluate||r).source].join("|")+"|$","g"),u=0,d="__p+='";t.replace(h,function(e,i,n,r,a){return d+=t.slice(u,a).replace(o,function(e){return"\\"+s[e]}),i&&(d+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(d+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(d+="';\n"+r+"\n__p+='"),u=a+e.length,e}),d+="';\n",l.variable||(d="with(obj||{}){\n"+d+"}\n"),d="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+d+"return __p;\n";try{c=new Function(l.variable||"obj","_",d)}catch(e){throw e.source=d,e}if(a)return c(a,this);var f=i(function(e){return c.call(this,e,this)},this),p=l.variable||"obj";return f.source="function("+p+"){\n"+d+"}",f}return a.templateSettings=t.templateSettings=n,t.template=a}),define("skylark-langx-funcs/throttle",["./funcs"],function(e){return e.throttle=function(e,t){let i=window.performance.now();return function(...n){const r=window.performance.now();r-i>=t&&(e(...n),i=r)}}}),define("skylark-langx-funcs/main",["./funcs","./debounce","./defer","./delegate","./loop","./negate","./proxy","./template","./throttle"],function(e){return e}),define("skylark-langx-funcs",["skylark-langx-funcs/main"],function(e){return e}),define("skylark-langx-async/Deferred",["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(e,t,i){"use strict";var n=Array.prototype.slice,r=t.proxy,s=e.makeArray,o=i.result,a=i.mixin;a(Promise.prototype,{always:function(e){return this.then(e,e),this},done:function(){for(var e=0;e<arguments.length;e++)this.then(arguments[e]);return this},fail:function(e){return this.catch(e),this}});var l=function(){var e=this;this.promise=c(new Promise(function(t,i){e._resolve=t,e._reject=i}))};function c(e){if(e.isResolved)return e;var t=!0,i=!1,n=!1,r=e.then(function(e){return n=!0,t=!1,e},function(e){throw i=!0,t=!1,e});r.isResolved=function(){return n},r.isPending=function(){return t},r.isRejected=function(){return i},r.state=function(){return n?"resolved":i?"rejected":"pending"};var s=[],o=[];return r.then=function(e,t,i){return i&&this.progress(i),c(Promise.prototype.then.call(this,e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)},t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)}))},r.progress=function(e){return s.forEach(function(t){e(t)}),o.push(e),this},r.pipe=r.then,r.notify=function(e){try{return s.push(e),o.forEach(function(t){return t(e)})}catch(e){this.reject(e)}return this},r}return l.prototype.resolve=function(e){var t=n.call(arguments);return this.resolveWith(null,t)},l.prototype.resolveWith=function(e,t){return(t=t?s(t):[]).__ctx__=e,this._resolve(t),this._resolved=!0,this},l.prototype.notify=function(e){var t=o(this,"promise");return t.notify(e),this},l.prototype.reject=function(e){var t=n.call(arguments);return this.rejectWith(null,t)},l.prototype.rejectWith=function(e,t){return(t=t?s(t):[]).__ctx__=e,this._reject(t),this._rejected=!0,this},l.prototype.isResolved=function(){var e=o(this,"promise");return e.isResolved()},l.prototype.isRejected=function(){var e=o(this,"promise");return e.isRejected()},l.prototype.state=function(){var e=o(this,"promise");return e.state()},l.prototype.then=function(e,t,i){var n=o(this,"promise");return n.then(e,t,i)},l.prototype.progress=function(e){var t=o(this,"promise");return t.progress(e)},l.prototype.catch=function(e){var t=o(this,"promise");return t.catch(e)},l.prototype.always=function(){var e=o(this,"promise");return e.always.apply(e,arguments),this},l.prototype.done=function(){var e=o(this,"promise");return e.done.apply(e,arguments),this},l.prototype.fail=function(e){var t=o(this,"promise");return t.fail(e),this},l.all=function(e){var t=new l;return Promise.all(e).then(t.resolve.bind(t),t.reject.bind(t)),o(t,"promise")},l.first=function(e){return c(Promise.race(e))},l.when=function(e,t,i,n){var s=e&&"function"==typeof e.then,o=s&&e instanceof Promise;if(!s)return arguments.length>1?t?t(e):e:(new l).resolve(e);if(!o){var a=new l(e.cancel);e.then(r(a.resolve,a),r(a.reject,a),a.notify),e=a.promise}return t||i||n?e.then(t,i,n):e},l.reject=function(e){var t=new l;return t.reject(e),t.promise},l.immediate=l.resolve=function(e){var t=new l;return t.resolve.apply(t,arguments),t.promise},l.promise=function(e){var t=new l;return e(t.resolve.bind(t),t.reject.bind(t),t.progress.bind(t)),t.promise},l}),define("skylark-langx-async/async",["skylark-langx-ns","skylark-langx-objects","./Deferred"],function(e,t,i){var n=t.each,r={Deferred:i,parallel:function(e,t,r){var s=[];return r=r||null,t=t||[],n(e,function(e,i){s.push(i.apply(r,t))}),i.all(s)},series:function(e,t,r){var s=[],o=new i,a=o.promise;return r=r||null,t=t||[],o.resolve(),n(e,function(e,i){a=a.then(function(){return i.apply(r,t)}),s.push(a)}),i.all(s)},waterful:function(e,t,r){var s=new i,o=s.promise;return r=r||null,t=t||[],s.resolveWith(r,t),n(e,function(e,t){o=o.then(t)}),o}};return e.attach("langx.async",r)}),define("skylark-langx-async/main",["./async"],function(e){return e}),define("skylark-langx-async",["skylark-langx-async/main"],function(e){return e}),define("skylark-langx-events/events",["skylark-langx-ns"],function(e){return e.attach("langx.events",{})}),define("skylark-langx-constructs/constructs",["skylark-langx-ns"],function(e){return e.attach("langx.constructs",{})}),define("skylark-langx-constructs/inherit",["./constructs"],function(e){return e.inherit=function(e,t){if("function"!=typeof t&&t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object.setPrototypeOf(e,t)}}),define("skylark-langx-constructs/klass",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","./constructs","./inherit"],function(e,t,i,n,r,s){var o=n.uniq,a=i.has,l=i.mixin,c=t.isArray,h=t.isDefined,u=function(){function e(){return this._construct?this._construct.apply(this,arguments):this.init?this.init.apply(this,arguments):void 0}return function i(n,r,u,d){c(r)&&(d=u,u=r,r=null),r=r||Object,h(u)&&!c(u)&&(d=u,u=!1);var f=r;u&&(u=function(e,t){var i=[];return t.forEach(function(e){if(a(e,"__mixins__"))throw new Error("nested mixins");for(var t=[];e;)t.unshift(e),e=e.superclass;i=i.concat(t)}),(i=(i=o(i)).filter(function(t){for(var i=e;i;){if(t===i)return!1;if(a(i,"__mixins__"))for(var n=i.__mixins__,r=0;r<n.length;r++)if(n[r]===t)return!1;i=i.superclass}return!0})).length>0&&i}(f,u)),u&&(f=function(e,t){for(var i=e,n=0;n<t.length;n++){var r=new Function;s(r,i),r.superclass=null,l(r.prototype,t[n].prototype),r.prototype.__mixin__=t[n],i=r}return i}(f,u));var p=n.klassName||"",m=new Function("return function "+p+"() {var inst = this, ctor = arguments.callee;if (!(inst instanceof ctor)) {inst = Object.create(ctor.prototype);}return ctor._constructor.apply(inst, arguments) || inst;}")();return s(m,f),m.superclass=r,m._constructor||(m._constructor=e),u&&(m.__mixins__=u),m.partial||(m.partial=function(e,i){return function(e,i,n){var r=e.prototype,s=e.superclass.prototype,o=n&&n.noOverrided;n&&n.overrides;for(var a in i)if("constructor"!==a){var l=i[a];"function"==typeof i[a]?r[a]=l._constructor||o||"function"!=typeof s[a]?l:function(e,t,i){return function(){var e=this.overrided;this.overrided=i;var n=t.apply(this,arguments);return this.overrided=e,n}}(0,l,s[a]):t.isPlainObject(l)&&null!==l&&l.get?Object.defineProperty(r,a,l):r[a]=l}return e}(this,e,i)}),m.inherit||(m.inherit=function(e,t,n){return i(e,this,t,n)}),m.partial(n,d),m}}();return r.klass=u}),define("skylark-langx-klass/klass",["skylark-langx-ns","skylark-langx-constructs/klass"],function(e,t){return e.attach("langx.klass",t)}),define("skylark-langx-klass/main",["./klass"],function(e){return e}),define("skylark-langx-klass",["skylark-langx-klass/main"],function(e){return e}),define("skylark-langx-events/Event",["skylark-langx-objects","skylark-langx-funcs","skylark-langx-klass","skylark-langx-hoster","./events"],function(e,t,i,n){var r={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function s(i,n){return!n&&i.isDefaultPrevented||(n||(n=i),e.each(r,function(e,r){var s=n[e];i[e]=function(){return this[r]=t.returnTrue,s&&s.apply(n,arguments)},i[r]=t.returnFalse})),i}class o extends CustomEvent{constructor(t,i){super(t,i),e.safeMixin(this,i),s(this)}}return o.compatible=s,n.Event=o}),define("skylark-langx-events/Listener",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event"],function(e,t,i,n,r,s){Array.prototype.slice;var o=i.compact,a=(e.isDefined,e.isUndefined),l=(e.isPlainObject,e.isFunction,e.isBoolean),c=e.isString,h=e.isEmptyObject,u=(t.mixin,t.safeMixin,n({listenTo:function(t,i,n,r,s){if(!t)return this;if(e.isPlainObject(i)){e.isBoolean(n)?(s=n,n=null):e.isBoolean(r)&&(s=r);var o=i;for(var h in o){var u=h.match(/^([\w:-]*)\s*(.*)$/),d=u[1],f=u[2]||n;f?this.listenTo(t,d,f,o[h],s):this.listenTo(t,d,o[h],s)}return this}l(r)?(s=r,r=n,n=null):l(n)?(s=n,r=n=null):a(r)&&(s=!1,r=n,n=null),r||(r="handleEvent"),c(r)&&(r=this[r]),s?n?t.one(i,n,r,this):t.one(i,r,this):n?t.on(i,n,r,this):t.on(i,r,this);for(var p,m=this._listeningTo||(this._listeningTo=[]),g=0;g<m.length;g++)if(m[g].obj==t){p=m[g];break}p||m.push(p={obj:t,events:{}});var v=p.events,y=v[i]=v[i]||[];return-1==y.indexOf(r)&&y.push(r),this},listenToOnce:function(e,t,i,n){return this.listenTo(e,t,i,n,1)},unlistenTo:function(e,t,i){var n=this._listeningTo;if(!n)return this;c(i)&&(i=this[i]);for(var r=0;r<n.length;r++){var s=n[r];if(!e||e==s.obj){var a=s.events;for(var l in a)if(!t||t==l){var u=a[l];if(u){for(var d=0;d<u.length;d++)i&&i!=u[r]||(s.obj.off(l,u[r],this),u[r]=null);u=a[l]=o(u),h(u)&&(a[l]=null)}}h(a)&&(n[r]=null)}}return n=this._listeningTo=o(n),h(n)&&(this._listeningTo=null),this}}));return r.Listener=u}),define("skylark-langx-events/Emitter",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./Event","./Listener"],function(e,t,i,n,r,s,o){var a=Array.prototype.slice,l=i.compact,c=e.isDefined,h=e.isPlainObject,u=e.isFunction,d=e.isString,f=(e.isEmptyObject,t.mixin);t.safeMixin;function p(e){var t=(""+e).split(".");return{name:t[0],ns:t.slice(1).join(" ")}}var m=new Map,g=o.inherit({_prepareArgs:function(e,t){return t=c(t)?[e].concat(t):[e]},on:function(e,t,i,n,r,s){var o=this,a=this._hub||(this._hub={});if(h(e))return r=n,each(e,function(e,n){o.on(e,t,i,n,r,s)}),this;if(d(t)||u(n)||(r=n,n=i,i=t,t=void 0),u(i)&&(r=n,n=i,i=null),!n)throw new Error("No callback function");if(!u(n))throw new Error("The callback  is not afunction");return d(e)&&(e=e.split(/\s/)),e.forEach(function(e){var o=p(e),l=o.name,c=o.ns;(a[l]||(a[l]=[])).push({fn:n,selector:t,data:i,ctx:r,ns:c,one:s})}),this},one:function(e,t,i,n,r){return this.on(e,t,i,n,r,1)},emit:function(e){if(!this._hub)return this;var t=this;d(e)&&(e=new s(e)),Object.defineProperty(e,"target",{value:this});var i=a.call(arguments,1);return i=this._prepareArgs(e,i),[e.type||e.name,"all"].forEach(function(n){var r=p(n),s=r.name,o=r.ns,a=t._hub[s];if(a){for(var c=a.length,u=!1,d=0;d<c;d++){if(e.isImmediatePropagationStopped&&e.isImmediatePropagationStopped())return this;var m=a[d];(!o||m.ns&&m.ns.startsWith(o))&&(m.data&&(e.data=f({},m.data,e.data)),2==i.length&&h(i[1])&&(e.data=e.data||{},f(e.data,i[1])),m.fn.apply(m.ctx,i),m.one&&(a[d]=null,u=!0))}u&&(t._hub[n]=l(a))}}),this},queueEmit:function(e){const t=e.type||e;let i=m.get(this);i||(i=new Map,m.set(this,i));const n=i.get(t);i.delete(t),window.clearTimeout(n);const r=window.setTimeout(()=>{0===i.size&&(i=null,m.delete(this)),this.trigger(e)},0);i.set(t,r)},listened:function(e){var t=(this._hub||(this._events={}))[e]||[];return t.length>0},off:function(e,t){if(e){var i=this._hub||(this._hub={});return d(e)&&(e=e.split(/\s/)),e.forEach(function(e){var n=p(e),r=n.name,s=n.ns,o=i[r];if(o){var a=[];if(t||s)for(var l=0,c=o.length;l<c;l++)t&&o[l].fn!==t&&o[l].fn._!==t?a.push(o[l]):!s||o[l].ns&&0==o[l].ns.indexOf(s)||a.push(o[l]);a.length?i[r]=a:delete i[r]}}),this}this._hub=null},trigger:function(){return this.emit.apply(this,arguments)},queueTrigger:function(e){return this.queueEmit.apply(this,arguments)}});return r.Emitter=g}),define("skylark-langx-events/createEvent",["./events","./Event"],function(e,t){return e.createEvent=function(e,i){return new t(e,i)}}),define("skylark-langx-events/main",["./events","./Event","./Listener","./Emitter","./createEvent"],function(e){return e}),define("skylark-langx-events",["skylark-langx-events/main"],function(e){return e}),define("skylark-langx-emitter/Emitter",["skylark-langx-events"],function(e){return e.Emitter}),define("skylark-langx-emitter/Evented",["./Emitter"],function(e){return e}),define("skylark-langx-urls/urls",["skylark-langx-ns"],function(e){return e.attach("langx.urls",{})}),define("skylark-langx-urls/parseUrl",["./urls"],function(e){"use strict";return e.parseUrl=function(e){const t=["protocol","hostname","port","pathname","search","hash","host"];let i=document.createElement("a");i.href=e;const n=""===i.host&&"file:"!==i.protocol;let r;n&&((r=document.createElement("div")).innerHTML=`<a href="${e}"></a>`,i=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),document.body.appendChild(r));const s={};for(let e=0;e<t.length;e++)s[t[e]]=i[t[e]];"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,""));"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,""));s.protocol||(s.protocol=window.location.protocol);n&&document.body.removeChild(r);return s}}),define("skylark-langx-urls/isCrossOrigin",["./urls","./parseUrl"],function(e,t){"use strict";return e.isCrossOrigin=function(e,i=window.location){const n=t(e);return(":"===n.protocol?i.protocol:n.protocol)+n.host!==i.protocol+i.host}}),define("skylark-net-http/http",["skylark-langx-ns/ns"],function(e){return e.attach("net.http",{})}),define("skylark-net-http/Xhr",["skylark-langx-ns/ns","skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-funcs","skylark-langx-async/Deferred","skylark-langx-emitter/Evented","skylark-langx-urls/isCrossOrigin","./http"],function(skylark,types,objects,arrays,funcs,Deferred,Evented,isCrossOrigin,http){var each=objects.each,mixin=objects.mixin,noop=funcs.noop,isArray=types.isArray,isFunction=types.isFunction,isPlainObject=types.isPlainObject,type=types.type,getAbsoluteUrl=function(e){return a||(a=document.createElement("a")),a.href=e,a.href},a,Xhr=function(){var jsonpID=0,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/,XhrDefaultOptions={async:!0,type:"GET",beforeSend:noop,success:noop,error:noop,complete:noop,context:null,global:!0,accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},crossDomain:!1,timeout:0,processData:!1,cache:!0,traditional:!1,xhrFields:{}};function mimeToDataType(e){if(e&&(e=e.split(";",2)[0]),e){if(e==htmlType)return"html";if(e==jsonType)return"json";if(scriptTypeRE.test(e))return"script";if(xmlTypeRE.test(e))return"xml"}return"text"}function appendQuery(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function serializeData(e){e.data=e.data||e.query,e.processData&&e.data&&"string"!=type(e.data)&&(e.data=param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||("string"!=type(e.data)&&(e.data=param(e.data,e.traditional)),e.url=appendQuery(e.url,e.data),e.data=void 0)}function serialize(e,t,i,n){var r,s=isArray(t),o=isPlainObject(t);each(t,function(t,a){r=type(a),n&&(t=i?n:n+"["+(o||"object"==r||"array"==r?t:"")+"]"),!n&&s?e.add(a.name,a.value):"array"==r||!i&&"object"==r?serialize(e,a,i,t):e.add(t,a)})}var param=function(e,t){var i=[];return i.add=function(e,t){isFunction(t)&&(t=t()),null==t&&(t=""),this.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},serialize(i,e,t),i.join("&").replace(/%20/g,"+")},Xhr=Evented.inherit({klassName:"Xhr",_request:function(args){var _=this._,self=this,options=mixin({},XhrDefaultOptions,_.options,args),xhr=_.xhr=new XMLHttpRequest;serializeData(options),options.beforeSend&&options.beforeSend.call(this,xhr,options);var dataType=options.dataType||options.handleAs,mime=options.mimeType||options.accepts[dataType],headers=options.headers,xhrFields=options.xhrFields,isFormData=options.data&&options.data instanceof FormData,basicAuthorizationToken=options.basicAuthorizationToken,type=options.type,url=options.url,async=options.async,user=options.user,password=options.password,deferred=new Deferred,contentType=options.contentType||!isFormData&&"application/x-www-form-urlencoded";if(xhrFields)for(name in xhrFields)xhr[name]=xhrFields[name];mime&&mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),mime&&xhr.overrideMimeType&&xhr.overrideMimeType(mime),"blob"!=dataType&&"arraybuffer"!=dataType||(xhr.responseType=dataType);var finish=function(){xhr.onloadend=noop,xhr.onabort=noop,xhr.onprogress=noop,xhr.ontimeout=noop,xhr=null},onloadend=function(){var result,error=!1;if(xhr.status>=200&&xhr.status<300||304==xhr.status||0==xhr.status&&getAbsoluteUrl(url).startsWith("file:")){dataType=dataType||mimeToDataType(options.mimeType||xhr.getResponseHeader("content-type"));try{"script"==dataType?eval(xhr.responseText):result="xml"==dataType?xhr.responseXML:"json"==dataType?blankRE.test(xhr.responseText)?null:JSON.parse(xhr.responseText):"blob"==dataType?xhr.response:"arraybuffer"==dataType?xhr.response:xhr.responseText}catch(e){error=e}error?deferred.reject(error,xhr.status,xhr):deferred.resolve(result,xhr.status,xhr)}else deferred.reject(new Error(xhr.statusText),xhr.status,xhr);finish()},onabort=function(){deferred&&deferred.reject(new Error("abort"),xhr.status,xhr),finish()},ontimeout=function(){deferred&&deferred.reject(new Error("timeout"),xhr.status,xhr),finish()},onprogress=function(e){deferred&&deferred.notify(e,xhr.status,xhr)};if(xhr.onloadend=onloadend,xhr.onabort=onabort,xhr.ontimeout=ontimeout,xhr.onprogress=onprogress,xhr.open(type,url,async,user,password),headers)for(var key in headers){var value=headers[key];"content-type"===key.toLowerCase()?contentType=value:xhr.setRequestHeader(key,value)}return contentType&&!1!==contentType&&xhr.setRequestHeader("Content-Type",contentType),headers&&"X-Requested-With"in headers||isCrossOrigin(url)||xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),basicAuthorizationToken&&xhr.setRequestHeader("Authorization",basicAuthorizationToken),xhr.send(options.data?options.data:null),deferred.promise},abort:function(){var e=this._,t=e.xhr;t&&t.abort()},request:function(e){return this._request(e)},get:function(e){return(e=e||{}).type="GET",this._request(e)},post:function(e){return(e=e||{}).type="POST",this._request(e)},patch:function(e){return(e=e||{}).type="PATCH",this._request(e)},put:function(e){return(e=e||{}).type="PUT",this._request(e)},del:function(e){return(e=e||{}).type="DELETE",this._request(e)},init:function(e){this._={options:e||{}}}});return["request","get","post","put","del","patch"].forEach(function(e){Xhr[e]=function(t,i){var n=new Xhr({url:t});return n[e](i)}}),Xhr.defaultOptions=XhrDefaultOptions,Xhr.param=param,Xhr}();return http.Xhr=Xhr}),define("skylark-langx/skylark",["skylark-langx-ns"],function(e){return e}),define("skylark-langx/arrays",["skylark-langx-arrays"],function(e){return e}),define("skylark-langx/klass",["skylark-langx-klass"],function(e){return e}),define("skylark-langx/ArrayStore",["./klass"],function(e){var t=function(e){if(!e)return e;var i=!!e.then;function n(n){e[n]=function(){var r=arguments,s=Deferred.when(e,function(e){return t(Array.prototype[n].apply(e,r))});if("forEach"!==n||i)return s}}return i&&(e=Object.delegate(e)),n("forEach"),n("filter"),n("map"),null==e.total&&(e.total=Deferred.when(e,function(e){return e.length})),e},i=e({klassName:"ArrayStore",queryEngine:function(e,t){switch(typeof e){default:throw new Error("Can not query with a "+typeof e);case"object":case"undefined":var i=e;e=function(e){for(var t in i){var n=i[t];if(n&&n.test){if(!n.test(e[t],e))return!1}else if(n!=e[t])return!1}return!0};break;case"string":if(!this[e])throw new Error("No filter function "+e+" was found in store");e=this[e];case"function":}function n(i){var n=function(e,t,i){var n,r=0,s=e&&e.length||0,o=[];s&&"string"==typeof e&&(e=e.split(""));"string"==typeof t&&(t=cache[t]||buildFn(t));if(i)for(;r<s;++r)n=e[r],t.call(i,n,r,e)&&o.push(n);else for(;r<s;++r)n=e[r],t(n,r,e)&&o.push(n);return o}(i,e),r=t&&t.sort;if(r&&n.sort("function"==typeof r?r:function(e,t){for(var i,n=0;i=r[n];n++){var s=e[i.attribute],o=t[i.attribute];if(s=null!=s?s.valueOf():s,o=null!=o?o.valueOf():o,s!=o)return!!i.descending==(null==s||s>o)?-1:1}return 0}),t&&(t.start||t.count)){var s=n.length;(n=n.slice(t.start||0,(t.start||0)+(t.count||1/0))).total=s}return n}return n.matches=e,n},idProperty:"id",get:function(e){return this.data[this.index[e]]},getIdentity:function(e){return e[this.idProperty]},put:function(e,t){var i=this.data,n=this.index,r=this.idProperty,s=e[r]=t&&"id"in t?t.id:r in e?e[r]:Math.random();if(s in n){if(t&&!1===t.overwrite)throw new Error("Object already exists");i[n[s]]=e}else n[s]=i.push(e)-1;return s},add:function(e,t){return(t=t||{}).overwrite=!1,this.put(e,t)},remove:function(e){var t=this.index,i=this.data;if(e in t)return i.splice(t[e],1),this.setData(i),!0},query:function(e,i){return t(this.queryEngine(e,i)(this.data))},setData:function(e){e.items?(this.idProperty=e.identifier||this.idProperty,e=this.data=e.items):this.data=e,this.index={};for(var t=0,i=e.length;t<i;t++)this.index[e[t][this.idProperty]]=t},init:function(e){for(var t in e)this[t]=e[t];this.setData(this.data||[])}});return i}),define("skylark-langx-aspect/aspect",["skylark-langx-ns"],function(e){var t,i=0;function n(e){return function(n,r,s,o){var a,l=n[r];l&&l.target==n||(n[r]=a=function(){for(var e=i,n=arguments,r=a.before;r;)n=r.advice.apply(this,n)||n,r=r.next;if(a.around)var s=a.around.advice(this,n);for(var o=a.after;o&&o.id<e;){if(o.receiveArguments){var l=o.advice.apply(this,n);s=l===t?s:l}else s=o.advice.call(this,s,n);o=o.next}return s},l&&(a.around={advice:function(e,t){return l.apply(e,t)}}),a.target=n);var c=function(e,t,n,r){var s,o=e[t],a="around"==t;if(a){var l=n(function(){return o.advice(this,arguments)});s={remove:function(){l&&(l=e=n=null)},advice:function(e,t){return l?l.apply(e,t):o.advice(e,t)}}}else s={remove:function(){if(s.advice){var i=s.previous,r=s.next;r||i?(i?i.next=r:e[t]=r,r&&(r.previous=i)):delete e[t],e=n=s.advice=null}},id:i++,advice:n,receiveArguments:r};if(o&&!a)if("after"==t){for(;o.next&&(o=o.next););o.next=s,s.previous=o}else"before"==t&&(e[t]=s,s.next=o,o.previous=s);else e[t]=s;return s}(a||l,e,s,o);return s=null,c}}return e.attach("langx.aspect",{after:n("after"),around:n("around"),before:n("before")})}),define("skylark-langx-aspect/main",["./aspect"],function(e){return e}),define("skylark-langx-aspect",["skylark-langx-aspect/main"],function(e){return e}),define("skylark-langx/aspect",["skylark-langx-aspect"],function(e){return e}),define("skylark-langx/async",["skylark-langx-async"],function(e){return e}),define("skylark-langx-binary/binary",["skylark-langx-ns"],function(e){"use strict";return e.attach("langx.binary",{fromBase64:function(e){for(var t,i,n,r,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=e.length/4*3,a=new ArrayBuffer(o),l=new Uint8Array(a),c=0,h=0;c<o;c+=3)t=s.indexOf(e.charAt(h++)),i=s.indexOf(e.charAt(h++)),n=s.indexOf(e.charAt(h++)),r=s.indexOf(e.charAt(h++)),l[c]=t<<2|i>>4,64!==n&&(l[c+1]=(15&i)<<4|n>>2),64!==r&&(l[c+2]=(3&n)<<6|r);return a},fromBinaryString:function(e){for(var t=e.length,i=new ArrayBuffer(t),n=new Uint8Array(i),r=0;r<t;r++)n[r]=e.charCodeAt(r);return i},fromBuffer:function(e){for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),n=0;n<e.length;n++)i[n]=e[n];return t}})}),define("skylark-langx-binary/main",["./binary"],function(e){return e}),define("skylark-langx-binary",["skylark-langx-binary/main"],function(e){return e}),define("skylark-langx/binary",["skylark-langx-binary"],function(e){return e}),define("skylark-langx-constructs/main",["./constructs","./inherit","./klass"],function(e){return e}),define("skylark-langx-constructs",["skylark-langx-constructs/main"],function(e){return e}),define("skylark-langx/constructs",["skylark-langx-constructs"],function(e){return e}),define("skylark-langx-datetimes/datetimes",["skylark-langx-ns"],function(e){return e.attach("langx.datetimes",{parseMilliSeconds:function(e){var t=e.split(" "),i=parseInt(t[0]);if(isNaN(i))return 0;switch(t[1].trim().replace(/\./g,"")){case"minutes":case"minute":case"min":case"mm":case"m":return 6e4*i;case"hours":case"hour":case"HH":case"hh":case"h":case"H":return 36e5*i;case"seconds":case"second":case"sec":case"ss":case"s":return 1e3*i;case"days":case"day":case"DD":case"dd":case"d":return 864e5*i;case"months":case"month":case"MM":case"M":return 24192e5*i;case"weeks":case"week":case"W":case"w":return 6048e5*i;case"years":case"year":case"yyyy":case"yy":case"y":return 31536e6*i;default:return 0}}})}),define("skylark-langx-datetimes/main",["./datetimes"],function(e){return e}),define("skylark-langx-datetimes",["skylark-langx-datetimes/main"],function(e){return e}),define("skylark-langx/datetimes",["skylark-langx-datetimes"],function(e){return e}),define("skylark-langx/Deferred",["skylark-langx-async"],function(e){return e.Deferred}),define("skylark-langx/Emitter",["skylark-langx-events"],function(e){return e.Emitter}),define("skylark-langx/Evented",["./Emitter"],function(e){return e}),define("skylark-langx/events",["skylark-langx-events"],function(e){return e}),define("skylark-langx/funcs",["skylark-langx-funcs"],function(e){return e}),define("skylark-langx-globals/globals",["skylark-langx-ns"],function(e){var t=function(){return"undefined"!=typeof global&&"function"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this}();return e.attach("langx.globals",t)}),define("skylark-langx-globals/console",["./globals"],function(e){return e.console=console}),define("skylark-langx-globals/document",["./globals"],function(e){var t;"undefined"!=typeof global?global:"undefined"!=typeof window&&window;return t="undefined"!=typeof document?document:require("min-document"),e.document=t}),define("skylark-langx-globals/window",["./globals"],function(e){var t="undefined"!=typeof window?window:{};return e.window=t}),define("skylark-langx-globals/main",["./globals","./console","./document","./window"],function(e){return e}),define("skylark-langx-globals",["skylark-langx-globals/main"],function(e){return e}),define("skylark-langx/globals",["skylark-langx-globals"],function(e){return e}),define("skylark-langx/hoster",["skylark-langx-hoster"],function(e){return e}),define("skylark-langx-maths/maths",["skylark-langx-ns","skylark-langx-types"],function(e,t){for(var i=[],n=0;n<256;n++)i[n]=(n<16?"0":"")+n.toString(16);var r={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*r.DEG2RAD},radToDeg:function(e){return e*r.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,i,n,r){var s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((t+n)/2),h=o((t+n)/2),u=s((t-n)/2),d=o((t-n)/2),f=s((n-t)/2),p=o((n-t)/2);"XYX"===r?e.set(a*h,l*u,l*d,a*c):"YZY"===r?e.set(l*d,a*h,l*u,a*c):"ZXZ"===r?e.set(l*u,l*d,a*h,a*c):"XZX"===r?e.set(a*h,l*p,l*f,a*c):"YXY"===r?e.set(l*f,a*h,l*p,a*c):"ZYZ"===r?e.set(l*p,l*f,a*h,a*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};return e.attach("langx.maths",r)}),define("skylark-langx-maths/main",["./maths"],function(e){return e}),define("skylark-langx-maths",["skylark-langx-maths/main"],function(e){return e}),define("skylark-langx/maths",["skylark-langx-maths"],function(e){return e}),define("skylark-langx-numerics/numerics",["skylark-langx-ns","skylark-langx-types"],function(e,t){return e.attach("langx.numerics",{toFinite:t.toFinite,toNumber:t.toNumber,toInteger:t.toInteger})}),define("skylark-langx-numerics/maths",["skylark-langx-ns","skylark-langx-types","./numerics"],function(e,t,i){for(var n=[],r=0;r<256;r++)n[r]=(r<16?"0":"")+r.toString(16);var s={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*s.DEG2RAD},radToDeg:function(e){return e*s.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,i,n,r){var s=Math.cos,o=Math.sin,a=s(i/2),l=o(i/2),c=s((t+n)/2),h=o((t+n)/2),u=s((t-n)/2),d=o((t-n)/2),f=s((n-t)/2),p=o((n-t)/2);"XYX"===r?e.set(a*h,l*u,l*d,a*c):"YZY"===r?e.set(l*d,a*h,l*u,a*c):"ZXZ"===r?e.set(l*u,l*d,a*h,a*c):"XZX"===r?e.set(a*h,l*p,l*f,a*c):"YXY"===r?e.set(l*f,a*h,l*p,a*c):"ZYZ"===r?e.set(l*p,l*f,a*h,a*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};return i.maths=s}),define("skylark-langx-numerics/Quaternion",["skylark-langx-klass","./numerics","./maths"],function(e,t,i){var n=e({klassName:"Quaternion",x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("mathsQuaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,n=e._y,r=e._z,s=e.order,o=Math.cos,a=Math.sin,l=o(i/2),c=o(n/2),h=o(r/2),u=a(i/2),d=a(n/2),f=a(r/2);return"XYZ"===s?(this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f):"YXZ"===s?(this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f):"ZXY"===s?(this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f):"ZYX"===s?(this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f):"YZX"===s?(this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f):"XZY"===s&&(this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],s=i[8],o=i[1],a=i[5],l=i[9],c=i[2],h=i[6],u=i[10],d=n+a+u;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(h-l)*t,this._y=(s-c)*t,this._z=(o-r)*t):n>a&&n>u?(t=2*Math.sqrt(1+n-a-u),this._w=(h-l)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(s+c)/t):a>u?(t=2*Math.sqrt(1+a-n-u),this._w=(s-c)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(l+h)/t):(t=2*Math.sqrt(1+u-n-a),this._w=(o-r)/t,this._x=(s+c)/t,this._y=(l+h)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var i=e.dot(t)+1;return i<1e-6?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(i.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var i=this.angleTo(e);if(0===i)return this;var n=Math.min(1,t/i);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("mathsQuaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=i*c+s*o+n*l-r*a,this._y=n*c+s*a+r*o-i*l,this._z=r*c+s*l+i*a-n*o,this._w=s*c-i*o-n*a-r*l,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,s=this._w,o=s*e._w+i*e._x+n*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;var a=1-o*o;if(a<=Number.EPSILON){var l=1-t;return this._w=l*s+t*this._w,this._x=l*i+t*this._x,this._y=l*n+t*this._y,this._z=l*r+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(a),h=Math.atan2(c,o),u=Math.sin((1-t)*h)/c,d=Math.sin(t*h)/c;return this._w=s*u+this._w*d,this._x=i*u+this._x*d,this._y=n*u+this._y*d,this._z=r*u+this._z*d,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},fromBufferAttribute:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){},_construct:function(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1}});return Object.assign(n,{slerp:function(e,t,i,n){return i.copy(e).slerp(t,n)},slerpFlat:function(e,t,i,n,r,s,o){var a=i[n+0],l=i[n+1],c=i[n+2],h=i[n+3],u=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(h!==p||a!==u||l!==d||c!==f){var m=1-o,g=a*u+l*d+c*f+h*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var k=Math.sqrt(y),b=Math.atan2(k,g*v);m=Math.sin(m*b)/k,o=Math.sin(o*b)/k}var x=o*v;if(a=a*m+u*x,l=l*m+d*x,c=c*m+f*x,h=h*m+p*x,m===1-o){var w=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=w,l*=w,c*=w,h*=w}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=h}}),Object.assign(n.prototype,{}),t.Quaternion=n}),define("skylark-langx-numerics/Vector3",["skylark-langx-klass","./numerics","./maths","./Quaternion"],function(e,t,i,n){var r=new n,s=e({klassName:"Vector3",set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("mathsVector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("mathsVector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("mathsVector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("mathsVector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(r.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(r.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,s=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*s,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*n-o*i,c=a*i+o*t-r*n,h=a*n+r*i-s*t,u=-r*t-s*i-o*n;return this.x=l*a+u*-r+c*-o-h*-s,this.y=c*a+u*-s+h*-r-l*-o,this.z=h*a+u*-o+l*-s-c*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){return void 0!==t?(console.warn("mathsVector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,s=t.x,o=t.y,a=t.z;return this.x=n*a-r*o,this.y=r*s-i*a,this.z=i*o-n*s,this},projectOnVector:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)},projectOnPlane:function(e){return o.copy(this).projectOnVector(e),this.sub(o)},reflect:function(e){return this.sub(o.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var i=this.dot(e)/t;return Math.acos(MathUtils.clamp(i,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,i){var n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("mathsVector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this},_construct:function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}}),o=new s;return t.Vector3=s}),define("skylark-langx-numerics/Matrix4",["skylark-langx-klass","./numerics","./Vector3"],function(e,t,i){var n=new i,r=new i(0,0,0),s=new i(1,1,1),o=new i,a=new i,l=new i,c=e({set:function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=n,g[1]=r,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=h,g[14]=u,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new c).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,i=e.elements,r=1/n.setFromMatrixColumn(e,0).length(),s=1/n.setFromMatrixColumn(e,1).length(),o=1/n.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("mathsMatrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,r=e.z,s=Math.cos(i),o=Math.sin(i),a=Math.cos(n),l=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if("XYZ"===e.order){var u=s*c,d=s*h,f=o*c,p=o*h;t[0]=a*c,t[4]=-a*h,t[8]=l,t[1]=d+f*l,t[5]=u-p*l,t[9]=-o*a,t[2]=p-u*l,t[6]=f+d*l,t[10]=s*a}else if("YXZ"===e.order){var m=a*c,g=a*h,v=l*c,y=l*h;t[0]=m+y*o,t[4]=v*o-g,t[8]=s*l,t[1]=s*h,t[5]=s*c,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=s*a}else if("ZXY"===e.order){var m=a*c,g=a*h,v=l*c,y=l*h;t[0]=m-y*o,t[4]=-s*h,t[8]=v+g*o,t[1]=g+v*o,t[5]=s*c,t[9]=y-m*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){var u=s*c,d=s*h,f=o*c,p=o*h;t[0]=a*c,t[4]=f*l-d,t[8]=u*l+p,t[1]=a*h,t[5]=p*l+u,t[9]=d*l-f,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){var k=s*a,b=s*l,x=o*a,w=o*l;t[0]=a*c,t[4]=w-k*h,t[8]=x*h+b,t[1]=h,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=b*h+x,t[10]=k-w*h}else if("XZY"===e.order){var k=s*a,b=s*l,x=o*a,w=o*l;t[0]=a*c,t[4]=-h,t[8]=l*c,t[1]=k*h+w,t[5]=s*c,t[9]=b*h-x,t[2]=x*h-b,t[6]=o*c,t[10]=w*h+k}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(r,e,s)},lookAt:function(e,t,i){var n=this.elements;return l.subVectors(e,t),0===l.lengthSq()&&(l.z=1),l.normalize(),o.crossVectors(i,l),0===o.lengthSq()&&(1===Math.abs(i.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),o.crossVectors(i,l)),o.normalize(),a.crossVectors(l,o),n[0]=o.x,n[4]=a.x,n[8]=l.x,n[1]=o.y,n[5]=a.y,n[9]=l.y,n[2]=o.z,n[6]=a.z,n[10]=l.z,this},multiply:function(e,t){return void 0!==t?(console.warn("mathsMatrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,s=i[0],o=i[4],a=i[8],l=i[12],c=i[1],h=i[5],u=i[9],d=i[13],f=i[2],p=i[6],m=i[10],g=i[14],v=i[3],y=i[7],k=i[11],b=i[15],x=n[0],w=n[4],_=n[8],C=n[12],S=n[1],A=n[5],M=n[9],T=n[13],L=n[2],$=n[6],E=n[10],O=n[14],R=n[3],D=n[7],I=n[11],P=n[15];return r[0]=s*x+o*S+a*L+l*R,r[4]=s*w+o*A+a*$+l*D,r[8]=s*_+o*M+a*E+l*I,r[12]=s*C+o*T+a*O+l*P,r[1]=c*x+h*S+u*L+d*R,r[5]=c*w+h*A+u*$+d*D,r[9]=c*_+h*M+u*E+d*I,r[13]=c*C+h*T+u*O+d*P,r[2]=f*x+p*S+m*L+g*R,r[6]=f*w+p*A+m*$+g*D,r[10]=f*_+p*M+m*E+g*I,r[14]=f*C+p*T+m*O+g*P,r[3]=v*x+y*S+k*L+b*R,r[7]=v*w+y*A+k*$+b*D,r[11]=v*_+y*M+k*E+b*I,r[15]=v*C+y*T+k*O+b*P,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],h=e[6],u=e[10],d=e[14],f=e[3],p=e[7],m=e[11],g=e[15];return f*(+r*a*h-n*l*h-r*o*u+i*l*u+n*o*d-i*a*d)+p*(+t*a*d-t*l*u+r*s*u-n*s*d+n*l*c-r*a*c)+m*(+t*l*h-t*o*d-r*s*h+i*s*d+r*o*c-i*l*c)+g*(-n*o*c-t*a*h+t*o*u+n*s*h-i*s*u+i*a*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,i){var n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this},getInverse:function(e,t){void 0!==t&&console.warn("mathsMatrix4: .getInverse() can no longer be configured to throw on degenerate.");var i=this.elements,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],h=n[6],u=n[7],d=n[8],f=n[9],p=n[10],m=n[11],g=n[12],v=n[13],y=n[14],k=n[15],b=f*y*u-v*p*u+v*h*m-c*y*m-f*h*k+c*p*k,x=g*p*u-d*y*u-g*h*m+l*y*m+d*h*k-l*p*k,w=d*v*u-g*f*u+g*c*m-l*v*m-d*c*k+l*f*k,_=g*f*h-d*v*h-g*c*p+l*v*p+d*c*y-l*f*y,C=r*b+s*x+o*w+a*_;if(0===C)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var S=1/C;return i[0]=b*S,i[1]=(v*p*a-f*y*a-v*o*m+s*y*m+f*o*k-s*p*k)*S,i[2]=(c*y*a-v*h*a+v*o*u-s*y*u-c*o*k+s*h*k)*S,i[3]=(f*h*a-c*p*a-f*o*u+s*p*u+c*o*m-s*h*m)*S,i[4]=x*S,i[5]=(d*y*a-g*p*a+g*o*m-r*y*m-d*o*k+r*p*k)*S,i[6]=(g*h*a-l*y*a-g*o*u+r*y*u+l*o*k-r*h*k)*S,i[7]=(l*p*a-d*h*a+d*o*u-r*p*u-l*o*m+r*h*m)*S,i[8]=w*S,i[9]=(g*f*a-d*v*a-g*s*m+r*v*m+d*s*k-r*f*k)*S,i[10]=(l*v*a-g*c*a+g*s*u-r*v*u-l*s*k+r*c*k)*S,i[11]=(d*c*a-l*f*a-d*s*u+r*f*u+l*s*m-r*c*m)*S,i[12]=_*S,i[13]=(d*v*o-g*f*o+g*s*p-r*v*p-d*s*y+r*f*y)*S,i[14]=(g*c*o-l*v*o-g*s*h+r*v*h+l*s*y-r*c*y)*S,i[15]=(l*f*o-d*c*o+d*s*h-r*f*h-l*s*p+r*c*p)*S,this},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,s=e.x,o=e.y,a=e.z,l=r*s,c=r*o;return this.set(l*s+i,l*o-n*a,l*a+n*o,0,l*o+n*a,c*o+i,c*a-n*s,0,l*a-n*o,c*a+n*s,r*a*a+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){var n=this.elements,r=t._x,s=t._y,o=t._z,a=t._w,l=r+r,c=s+s,h=o+o,u=r*l,d=r*c,f=r*h,p=s*c,m=s*h,g=o*h,v=a*l,y=a*c,k=a*h,b=i.x,x=i.y,w=i.z;return n[0]=(1-(p+g))*b,n[1]=(d+k)*b,n[2]=(f-y)*b,n[3]=0,n[4]=(d-k)*x,n[5]=(1-(u+g))*x,n[6]=(m+v)*x,n[7]=0,n[8]=(f+y)*w,n[9]=(m-v)*w,n[10]=(1-(u+p))*w,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(e,t,i){var r=this.elements,s=n.set(r[0],r[1],r[2]).length(),o=n.set(r[4],r[5],r[6]).length(),a=n.set(r[8],r[9],r[10]).length(),l=this.determinant();l<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],h.copy(this);var c=1/s,u=1/o,d=1/a;return h.elements[0]*=c,h.elements[1]*=c,h.elements[2]*=c,h.elements[4]*=u,h.elements[5]*=u,h.elements[6]*=u,h.elements[8]*=d,h.elements[9]*=d,h.elements[10]*=d,t.setFromRotationMatrix(h),i.x=s,i.y=o,i.z=a,this},makePerspective:function(e,t,i,n,r,s){void 0===s&&console.warn("mathsMatrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,a=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),h=(i+n)/(i-n),u=-(s+r)/(s-r),d=-2*s*r/(s-r);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,i,n,r,s){var o=this.elements,a=1/(t-e),l=1/(i-n),c=1/(s-r),h=(t+e)*a,u=(i+n)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<16;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e},_construct:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("mathsMatrix4: the constructor no longer reads arguments. use .set() instead.")}}),h=new c;return t.Matrix4=c}),define("skylark-langx-numerics/Euler",["skylark-langx-klass","./numerics","./maths","./Quaternion","./Vector3","./Matrix4"],function(e,t,i,n,r,s){var o=new s,a=new n,l=e({x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},isEuler:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=i.clamp,s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],h=s[5],u=s[9],d=s[2],f=s[6],p=s[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,h),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-d,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===t?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,h))):"YZX"===t?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p))):"XZY"===t?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-u,p),this._y=0)):console.warn("skylark-nunustudio/editor/gui/element/RendererCanvasEuler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,i){return o.makeRotationFromQuaternion(e),this.setFromRotationMatrix(o,t,i)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return a.setFromEuler(this),this.setFromQuaternion(a,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new r(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){},_construct:function(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||l.DefaultOrder}});return l.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],l.DefaultOrder="XYZ",t.Euler=l}),define("skylark-langx-numerics/Matrix3",["skylark-langx-klass","./numerics"],function(e,t){var i=e({klassName:"Matrix3",isMatrix3:!0,set:function(e,t,i,n,r,s,o,a,l){var c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=r,c[5]=a,c[6]=i,c[7]=s,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},extractBasis:function(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,s=i[0],o=i[3],a=i[6],l=i[1],c=i[4],h=i[7],u=i[2],d=i[5],f=i[8],p=n[0],m=n[3],g=n[6],v=n[1],y=n[4],k=n[7],b=n[2],x=n[5],w=n[8];return r[0]=s*p+o*v+a*b,r[3]=s*m+o*y+a*x,r[6]=s*g+o*k+a*w,r[1]=l*p+c*v+h*b,r[4]=l*m+c*y+h*x,r[7]=l*g+c*k+h*w,r[2]=u*p+d*v+f*b,r[5]=u*m+d*y+f*x,r[8]=u*g+d*k+f*w,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-i*r*c+i*o*a+n*r*l-n*s*a},getInverse:function(e,t){void 0!==t&&console.warn("mathsMatrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=e.elements,n=this.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],f=d*l-c*u,p=c*h-d*a,m=u*a-l*h,g=r*f+s*p+o*m;if(0===g)return this.set(0,0,0,0,0,0,0,0,0);var v=1/g;return n[0]=f*v,n[1]=(o*u-d*s)*v,n[2]=(c*s-o*l)*v,n[3]=p*v,n[4]=(d*r-o*h)*v,n[5]=(o*a-c*r)*v,n[6]=m*v,n[7]=(s*h-u*r)*v,n[8]=(l*r-s*a)*v,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,i,n,r,s,o){var a=Math.cos(r),l=Math.sin(r);this.set(i*a,i*l,-i*(a*s+l*o)+s+e,-n*l,n*a,-n*(-l*s+a*o)+o+t,0,0,1)},scale:function(e,t){var i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.elements,r=n[0],s=n[3],o=n[6],a=n[1],l=n[4],c=n[7];return n[0]=t*r+i*a,n[3]=t*s+i*l,n[6]=t*o+i*c,n[1]=-i*r+t*a,n[4]=-i*s+t*l,n[7]=-i*o+t*c,this},translate:function(e,t){var i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<9;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e},_construct:function(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}});return t.Matrix3=i}),define("skylark-langx-numerics/Transform",["skylark-langx-klass","./numerics"],function(e,t){var i=e({klassName:"Transform",value:{get:function(){return this._.value}}});return t.Transform=i}),define("skylark-langx-numerics/MatrixTransform",["./numerics","./Transform"],function(e,t){var i=t.inherit({klassName:"MatrixTransform",value:{get:function(){return this.matrix.clone()}},matrix:{get:function(){return this._.matrix}},clone:function(){},transform:function(e){},transformBounds:function(e){},_construct:function(e){var t=this._={};t.matrix=e}});return e.MatrixTransform=i}),define("skylark-langx-numerics/Plane",["skylark-langx-klass","./numerics","./Matrix3","./Vector3"],function(e,t,i,n){var r=new n,s=new n,o=new i,a=e({klassName:"Plane",set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,i){var n=r.subVectors(i,t).cross(s.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("mathsPlane: .projectPoint() target is now required"),t=new n),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("mathsPlane: .intersectLine() target is now required"),t=new n);var i=e.delta(r),s=this.normal.dot(i);if(0===s)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/s;return o<0||o>1?void 0:t.copy(i).multiplyScalar(o).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("mathsPlane: .coplanarPoint() target is now required"),e=new n),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var i=t||o.getNormalMatrix(e),n=this.coplanarPoint(r).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(s),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant},_construct:function(e,t){this.normal=void 0!==e?e:new n(1,0,0),this.constant=void 0!==t?t:0}});return t.Plane=a}),define("skylark-langx-numerics/RotateTransform",["./numerics","./Transform","./MatrixTransform"],function(e,t,i){var n=e.RotateTransform=t.inherit({klassName:"RotateTransform",value:{get:function(){return i.rotateAt(this.angle,this.centerX,this.centerY)}},angle:{get:function(){return this._.angle}},centerX:{get:function(){return this._.centerX}},centerY:{get:function(){return this._.centerY}},clone:function(){},transform:function(e){},transformBounds:function(e){},init:function(e,t,i){var n=this._={};n.angle=e||0,n.centerX=t||0,n.centerY=i||0}});return n}),define("skylark-langx-numerics/ScaleTransform",["./numerics","./Transform","./MatrixTransform"],function(e,t,i){var n=t.inherit({klassName:"ScaleTransform",value:{get:function(){return i.scaleAt(this.scaleX,this.scaleY,this.centerX,this.centerY)}},scaleX:{get:function(){return this._.scaleX}},scaleY:{get:function(){return this._.scaleY}},centerX:{get:function(){return this._.centerX}},centerY:{get:function(){return this._.centerY}},clone:function(){},transform:function(e){},transformBounds:function(e){},_construct:function(e,t,i,n){var r=this._={};r.scaleX=e||1,r.scaleY=t||1,r.centerX=i||0,r.centerY=n||0}});return e.ScaleTransform=n}),define("skylark-langx-numerics/SkewTransform",["./numerics","./Transform","./MatrixTransform"],function(e,t,i){var n=t.inherit({klassName:"SkewTransform",value:{get:function(){return i.scaleAt(this.skewX,this.skewY)}},skewX:{get:function(){return this._.skewX}},skewY:{get:function(){return this._.skewY}},clone:function(){},transform:function(e){},transformBounds:function(e){},_construct:function(e,t){var i=this._={};i.skewX=e||0,i.skewY=t||0}});return e.SkewTransform=n}),define("skylark-langx-numerics/Vector2",["skylark-langx-klass","./numerics"],function(e,t){var i=e({klassName:"Vector2",set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*i-s*n+e.x,this.y=r*n+s*i+e.y,this},_construct:function(e,t){this.x=e||0,this.y=t||0}});return t.Vector2=i}),define("skylark-langx-numerics/TransformMatrix",["skylark-langx-klass","./numerics","./Vector2"],function(e,t,i){var n=Math.PI/180,r={},s=function(e){return r[e]||(r[e]=Math.PI*e/180)},o=e({klassName:"TransformMatrix",_multiplyPoint:function(e){var t=this._,n=e.x*t.m11+e.y*t.m21+t.dx,r=e.x*t.m12+e.y*t.m22+t.dy;return new i(n,r)},m11:{get:function(){return this._.m11}},m12:{get:function(){return this._.m12}},m21:{get:function(){return this._.m21}},m22:{get:function(){return this._.m22}},dx:{get:function(){return this._.dx}},dy:{get:function(){return this._.dy}},alpha:{get:function(){return this._.alpha}},shadow:{get:function(){return this._.shadow}},compositeOperation:{get:function(){return this._.compositeOperation}},multiplyPoint:function(e){return this._multiplyPoint(e)},multiplyRectangle:function(e){if(this.isIdentity())return e.clone();var t=this.multiplyPoint(e.leftTop),i=this.multiplyPoint(e.leftBottom),n=this.multiplyPoint(e.right),r=this.multiplyPoint(e.rightBottom),s=Math.min(t.x,i.x,n.x,r.x),o=Math.min(t.y,i.y,n.y,r.y),a=Math.max(t.x,i.x,n.x,r.x),l=Math.max(t.y,i.y,n.y,r.y);return new Rect(s,o,a-s,l-o)},prepend:function(e,t,i,n,r,s){var o=this.dx;if(1!=e||0!=t||0!=i||1!=n){var a=this.m11,l=this.m21;this.m11=a*e+this.m12*i,this.m12=a*t+this.m12*n,this.m21=l*e+this.m22*i,this.m22=l*t+this.m22*n}return this.dx=o*e+this.dy*i+r,this.dy=o*t+this.dy*n+s,this},append:function(e,t,i,n,r,s){var o=this.m11,a=this.m12,l=this.m21,c=this.m22;return this.m11=e*o+t*l,this.m12=e*a+t*c,this.m21=i*o+n*l,this.m22=i*a+n*c,this.dx=r*o+s*l+this.dx,this.dy=r*a+s*c+this.dy,this},prependMatrix:function(e){return this.prepend(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),this.prependProperties(e.alpha,e.shadow,e.compositeOperation),this},appendMatrix:function(e){return this.append(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),this.appendProperties(e.alpha,e.shadow,e.compositeOperation),this},prependTransform:function(e,t,i,r,s,o,a,l,c){if(s%360)var h=s*n,u=Math.cos(h),d=Math.sin(h);else u=1,d=0;return(l||c)&&(this.dx-=l,this.dy-=c),o||a?(o*=n,a*=n,this.prepend(u*i,d*i,-d*r,u*r,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,t)):this.prepend(u*i,d*i,-d*r,u*r,e,t),this},appendTransform:function(e,t,i,r,s,o,a,l,c){if(s%360)var h=s*n,u=Math.cos(h),d=Math.sin(h);else u=1,d=0;return o||a?(o*=n,a*=n,this.append(Math.cos(a),Math.sin(a),-Math.sin(o),Math.cos(o),e,t),this.append(u*i,d*i,-d*r,u*r,0,0)):this.append(u*i,d*i,-d*r,u*r,e,t),(l||c)&&(this.dx-=l*this.m11+c*this.m21,this.dy-=l*this.m12+c*this.m22),this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.m11,r=this.m21,s=this.dx;return this.m11=n*t-this.m12*i,this.m12=n*i+this.m12*t,this.m21=r*t-this.m22*i,this.m22=r*i+this.m22*t,this.dx=s*t-this.dy*i,this.dy=s*i+this.dy*t,this},skew:function(e,t){return e*=n,t*=n,this.append(Math.cos(t),Math.sin(t),-Math.sin(e),Math.cos(e),0,0),this},scale:function(e,t){return this.m11*=e,this.m22*=t,this.dx*=e,this.dy*=t,this},translate:function(e,t){return this.dx+=e,this.dy+=t,this},identity:function(){return this.alpha=this.m11=this.m22=1,this.m12=this.m21=this.dx=this.dy=0,this.shadow=this.compositeOperation=null,this},invert:function(){var e=this.m11,t=this.m12,i=this.m21,n=this.m22,r=this.dx,s=e*n-t*i;return this.m11=n/s,this.m12=-t/s,this.m21=-i/s,this.m22=e/s,this.dx=(i*this.dy-n*r)/s,this.dy=-(e*this.dy-t*r)/s,this},isIdentity:function(){return 0==this.dx&&0==this.dy&&1==this.m11&&0==this.m12&&0==this.m21&&1==this.m22},decompose:function(e){null==e&&(e={}),e.x=this.dx,e.y=this.dy,e.scaleX=Math.sqrt(this.m11*this.m11+this.m12*this.m12),e.scaleY=Math.sqrt(this.m21*this.m21+this.m22*this.m22);var t=Math.atan2(-this.m21,this.m22),i=Math.atan2(this.m12,this.m11);return t==i?(e.rotation=i/n,this.m11<0&&this.m22>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=t/n,e.skewY=i/n),e},reinitialize:function(e,t,i,n,r,s,o,a,l){return this._initialize(e,t,i,n,r,s),this.alpha=o||1,this.shadow=a,this.compositeOperation=l,this},appendProperties:function(e,t,i){return this.alpha*=e,this.shadow=t||this.shadow,this.compositeOperation=i||this.compositeOperation,this},prependProperties:function(e,t,i){return this.alpha*=e,this.shadow=this.shadow||t,this.compositeOperation=this.compositeOperation||i,this},multiply:function(e){var t=this.m11,i=this.m12,n=this.m21,r=this.m22,s=this.dx,o=this.dy,a=e;return this.m11=t*a.m11+n*a.m12,this.m12=i*a.m11+r*a.m12,this.m21=t*a.m21+n*a.m22,this.m22=i*a.m21+r*a.m22,this.dx=t*a.dx+n*a.dy+s,this.dy=i*a.dx+r*a.dy+o,this},clone:function(){var e=this._,t=new o(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy);return t.shadow=this.shadow,t.alpha=this.alpha,t.compositeOperation=this.compositeOperation,t},toString:function(){var e=this._;return"[TransformMatrix (m11="+e.m11+" m12="+e.m12+" m21="+e.m21+" m22="+e.m22+" dx="+e.dx+" dy="+e.dy+")]"},_construct:function(e,t,i,n,r,s){var o=this._={};o.m11=e||1,o.m12=t||0,o.m21=i||0,o.m22=n||1,o.dx=r||0,o.dy=s||0}});return Object.assign(o,{translate:function(e,t){return new o(1,0,0,1,e,t)},scale:function(e,t){return new o(e,0,0,t||e,0,0)},rotate:function(e){var t=Math.cos(e),i=Math.sin(e);return new o(t,i,-i,t,0,0)},rotateg:function(e){return this.rotate(s(e))},skewX:function(e){var t=Math.tan(e);return new o(1,0,t,1)},skewXg:function(e){return this.skewX(s(e))},skewY:function(e){var t=Math.tan(e);return new o(1,t,0,1)},skewYg:function(e){return this.skewY(s(e))},reflect:function(e,t){1==arguments.length&&(t=e.y,e=e.x);var i=e*e,n=t*t,r=i+n,s=2*i/r-1,a=2*e*t/r,l=a,c=2*n/r-1;return new o(s,l,a,c)},project:function(e,t){var i=e*e,n=t*t,r=i+n,s=i/r,a=e*t/r;return yx=a,yy=n/r,new o(s,yx,a,yy)},_sandwich:function(e,t,i){return this.translate(t,i).multiply(e).multiply(this.translate(-t,-i))},scaleAt:function(e,t,i,n){switch(arguments.length){case 4:return this._sandwich(this.scale(e,t),i,n);case 3:return"number"==typeof i?this._sandwich(this.scale(e),t,i):this._sandwich(this.scale(e,t),i.x,i.y)}return this._sandwich(this.scale(e),t.x,t.y)},rotateAt:function(e,t,i){return arguments.length>2?this._sandwich(this.rotate(e),t,i):this._sandwich(this.rotate(e),t.x,t.y)},rotategAt:function(e,t,i){return arguments.length>2?this._sandwich(this.rotateg(e),t,i):this._sandwich(this.rotateg(e),t.x,t.y)},skewXAt:function(e,t,i){return arguments.length>2?this._sandwich(this.skewX(e),t,i):this._sandwich(this.skewX(e),t.x,t.y)},skewXgAt:function(e,t,i){return arguments.length>2?this._sandwich(this.skewXg(e),t,i):this._sandwich(this.skewXg(e),t.x,t.y)},skewYAt:function(e,t,i){return arguments.length>2?this._sandwich(this.skewY(e),t,i):this._sandwich(this.skewY(e),t.x,t.y)},skewYgAt:function(e,t,i){return arguments.length>2?this._sandwich(this.skewYg(e),t,i):this._sandwich(this.skewYg(e),t.x,t.y)}}),t.TransformMatrix=o}),define("skylark-langx-numerics/TranslateTransform",["./numerics","./Transform","./MatrixTransform"],function(e,t,i,n,r){var s=t.inherit({klassName:"TranslateTransform",value:{get:function(){return i.scaleAt(this.x,this.y)}},x:{get:function(){return this._.x}},y:{get:function(){return this._.y}},clone:function(){},transform:function(e){},transformBounds:function(e){},init:function(e,t){var i=this._;i.x=e||0,i.y=t||0}});return e.TranslateTransform=s}),define("skylark-langx-numerics/Vector4",["skylark-langx-klass","./numerics"],function(e,t){var i=e({klassName:"Vector4",set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*t+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*t+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*t+s[7]*i+s[11]*n+s[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,s=e.elements,o=s[0],a=s[4],l=s[8],c=s[1],h=s[5],u=s[9],d=s[2],f=s[6],p=s[10];if(Math.abs(a-c)<.01&&Math.abs(l-d)<.01&&Math.abs(u-f)<.01){if(Math.abs(a+c)<.1&&Math.abs(l+d)<.1&&Math.abs(u+f)<.1&&Math.abs(o+h+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,g=(h+1)/2,v=(p+1)/2,y=(a+c)/4,k=(l+d)/4,b=(u+f)/4;return m>g&&m>v?m<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(m),n=y/i,r=k/i):g>v?g<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(g),i=y/n,r=b/n):v<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(v),i=k/r,n=b/r),this.set(i,n,r,t),this}var x=Math.sqrt((f-u)*(f-u)+(l-d)*(l-d)+(c-a)*(c-a));return Math.abs(x)<.001&&(x=1),this.x=(f-u)/x,this.y=(l-d)/x,this.z=(c-a)/x,this.w=Math.acos((o+h+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this},_construct:function(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1}});return t.Vector4=i}),define("skylark-langx-numerics/main",["./numerics","./Euler","./maths","./Matrix3","./Matrix4","./MatrixTransform","./Plane","./Quaternion","./RotateTransform","./ScaleTransform","./SkewTransform","./Transform","./TransformMatrix","./TranslateTransform","./Vector2","./Vector3","./Vector4"],function(e){return e}),define("skylark-langx-numerics",["skylark-langx-numerics/main"],function(e){return e}),define("skylark-langx/numerics",["skylark-langx-numerics"],function(e){return e}),define("skylark-langx/objects",["skylark-langx-objects"],function(e){return e}),define("skylark-langx-strings/strings",["skylark-langx-ns"],function(e){var t=Object.freeze({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"});function i(e){return t[e]}var n=/[&<>"'`=]/g;var r=0;function s(e,t){var i,n,r,s,o,a,l,c=arguments.callee;return c.cache[e]||(c.cache[e]=(i=e,n=/^[\w\-]+$/.test(e)?c.get(e):(i="template(string)",e),r=1,s=("try { "+(c.variable?"var "+c.variable+" = this.stash;":"with (this.stash) { ")+"this.ret += '"+n.replace(/<%/g,"").replace(/%>/g,"").replace(/'(?![^\x11\x13]+?\x13)/g,"\\x27").replace(/^\s*|\s*$/g,"").replace(/\n|\r\n/g,function(){return"';\nthis.line = "+ ++r+"; this.ret += '\\n"}).replace(/\x11=raw(.+?)\x13/g,"' + ($1) + '").replace(/\x11=(.+?)\x13/g,"' + this.escapeHTML($1) + '").replace(/\x11(.+?)\x13/g,"'; $1; this.ret += '")+"'; "+(c.variable?"":"}")+"return this.ret;} catch (e) { throw 'TemplateError: ' + e + ' (on "+i+"' + ' line ' + this.line + ')'; } //@ sourceURL="+i+"\n").replace(/this\.ret \+= '';/g,""),o=new Function(s),a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#x22;","'":"&#x27;"},l=function(e){return(""+e).replace(/[&<>\'\"]/g,function(e){return a[e]})},function(e){return o.call(c.context={escapeHTML:l,line:1,ret:"",stash:e})})),t?c.cache[e](t):c.cache[e]}return s.cache={},s.get=function(e){return document.getElementById(e).innerHTML},e.attach("langx.strings",{camelCase:function(e){return e.replace(/-([\da-z])/g,function(e){return e.toUpperCase().replace("-","")})},dasherize:function(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()},deserializeValue:function(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?JSON.parse(e):e):e}catch(t){return e}},escapeHTML:function(e){if(null==e)return"";if(!e)return String(e);return e.toString().replace(n,i)},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})},ltrim:function(e){return e.replace(/^\s+/,"")},lowerFirst:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},rtrim:function(e){return e.replace(/\s+$/,"")},serializeValue:function(e){return JSON.stringify(e)},substitute:function(e,t,i,n){function r(e,t){if(e.match(/\./)){var i,n=function(e,t){var r=e.pop();return r?t[r]?n(e,i=t[r]):null:i};return n(e.split(".").reverse(),t)}return t[e]}return n=n||window,i=i?proxy(n,i):function(e){return e},e.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(e,s,o){var a=r(s,t);return o&&(a=r(o,n).call(n,a,s)),i(a,s).toString()})},slugify:function(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var t="ÁÄÂÀÃÅČÇĆĎÉĚËÈÊẼĔȆÍÌÎÏŇÑÓÖÒÔÕØŘŔŠŤÚŮÜÙÛÝŸŽáäâàãåčçćďéěëèêẽĕȇíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",i=0,n=t.length;i<n;i++)e=e.replace(new RegExp(t.charAt(i),"g"),"AAAAAACCCDEEEEEEEEIIIINNOOOOOORRSTUUUUUYYZaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbBDdBAa------".charAt(i));return e=e.replace(/\s+/g,"-").replace(/-+/g,"-")},trim:function(e){return null==e?"":String.prototype.trim.call(e)},uniqueId:function(e){var t=++r+"";return e?e+t:t},upperFirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}})}),define("skylark-langx-strings/base64",["./strings"],function(e){return e.base64={decode:function(e,t){t=null!=t&&t;var i,n,r,s,o,a,l,c="",h=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(;h<e.length;)s=this._keyStr.indexOf(e.charAt(h++)),o=this._keyStr.indexOf(e.charAt(h++)),a=this._keyStr.indexOf(e.charAt(h++)),l=this._keyStr.indexOf(e.charAt(h++)),i=s<<2|o>>4,n=(15&o)<<4|a>>2,r=(3&a)<<6|l,c+=String.fromCharCode(i),64!=a&&(c+=String.fromCharCode(n)),64!=l&&(c+=String.fromCharCode(r));t||(c=function(e){var t="",i=0,n=c1=c2=0;for(;i<e.length;)(n=e.charCodeAt(i))<128?(t+=String.fromCharCode(n),i++):n>191&&n<224?(c2=e.charCodeAt(i+1),t+=String.fromCharCode((31&n)<<6|63&c2),i+=2):(c2=e.charCodeAt(i+1),c3=e.charCodeAt(i+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),i+=3);return t}(c));return c},encode:function(e,t){var i,n,r,s,o,a,l,c="",h=0;(t=null!=t&&t)||(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}(e));for(;h<e.length;)i=e.charCodeAt(h++),n=e.charCodeAt(h++),r=e.charCodeAt(h++),s=i>>2,o=(3&i)<<4|n>>4,a=(15&n)<<2|r>>6,l=63&r,isNaN(n)?a=l=64:isNaN(r)&&(l=64),c=c+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(l);return c}}}),define("skylark-langx-strings/main",["./strings","./base64"],function(e){return e}),define("skylark-langx-strings",["skylark-langx-strings/main"],function(e){return e}),define("skylark-langx/strings",["skylark-langx-strings"],function(e){return e}),define("skylark-langx/Stateful",["./Evented","./strings","./objects"],function(e,t,i){var n=i.isEqual,r=i.mixin,s=i.result,o=i.isEmptyObject,a=i.clone,l=t.uniqueId,c=e.inherit({_construct:function(e,t){var i=e||{};t||(t={}),this.cid=l(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{});var n=s(this,"defaults");i=r({},n,i),this.set(i,t),this.changed={}},changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",toJSON:function(e){return a(this.attributes)},get:function(e){return this.attributes[e]},has:function(e){return null!=this.get(e)},set:function(e,t,i){if(null==e)return this;var r;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;var s=i.unset,o=i.silent,l=[],c=this._changing;this._changing=!0,c||(this._previousAttributes=a(this.attributes),this.changed={});var h=this.attributes,u=this.changed,d=this._previousAttributes;for(var f in r)t=r[f],n(h[f],t)||l.push(f),n(d[f],t)?delete u[f]:u[f]=t,s?delete h[f]:h[f]=t;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!o){l.length&&(this._pending=i);for(var p=0;p<l.length;p++)this.trigger("change:"+l[p],this,h[l[p]],i)}if(c)return this;if(!o)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,r({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,r({},e,{unset:!0}))},hasChanged:function(e){return null==e?!o(this.changed):void 0!==this.changed[e]},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&a(this.changed);var t=this._changing?this._previousAttributes:this.attributes,i={};for(var r in e){var s=e[r];n(t[r],s)||(i[r]=s)}return!o(i)&&i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return a(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},r({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=r({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,r(t,{validationError:i})),!1)}});return c}),define("skylark-langx-topic/topic",["skylark-langx-ns","skylark-langx-events"],function(e,t){var i=new t.Emitter;return e.attach("langx.topic",{publish:function(e,t,n){var r=[].slice.call(arguments,1);return i.trigger({type:e,data:r})},subscribe:function(e,t,n){var r=function(e){t.apply(n,e.data)};return i.on(e,r),{remove:function(){i.off(e,r)}}}})}),define("skylark-langx-topic/main",["./topic"],function(e){return e}),define("skylark-langx-topic",["skylark-langx-topic/main"],function(e){return e}),define("skylark-langx/topic",["skylark-langx-topic"],function(e){return e}),define("skylark-langx/types",["skylark-langx-types"],function(e){return e}),define("skylark-langx/langx",["./skylark","./arrays","./ArrayStore","./aspect","./async","./binary","./constructs","./datetimes","./Deferred","./Emitter","./Evented","./events","./funcs","./globals","./hoster","./klass","./maths","./numerics","./objects","./Stateful","./strings","./topic","./types"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v,y,k,b,x,w){"use strict";Array.prototype.concat,Array.prototype.indexOf,Array.prototype.slice,Array.prototype.filter;var _=y.mixin,C=(y.safeMixin,w.isFunction);var S=1;function A(){return A}return _(A,{createEvent:c.createEvent,funcArg:function(e,t,i,n){return C(t)?t.call(e,i,n):t},getQueryParams:function(e){var t=(e=e||window.location.href).split("?"),i={};t.length>1&&t[1].split("&").forEach(function(e){var t=e.split("=");i[t[0]]=t[1]});return i},toPixel:function(e){return parseFloat(e)||0},uid:function(e){return e._uid||(e._uid=S++)},URL:"undefined"!=typeof window?window.URL||window.webkitURL:null}),_(A,t,n,a,d,v,y,b,w,{ArrayStore:i,async:r,Deferred:l,Emitter:c,Evented:h,hoster:p,klass:m,Stateful:k,topic:x}),e.langx=A}),define("skylark-domx-browser/browser",["skylark-langx/skylark","skylark-langx/langx"],function(e,t){"use strict";var i=t.hoster.browser;return t.mixin(i,{isIE:!!/msie/i.exec(window.navigator.userAgent),location:function(){return window.location},support:{}}),e.attach("domx.browser",i)}),define("skylark-domx-browser/support/css3",["skylark-langx/langx","../browser"],function(e,t){"use strict";var i,n,r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},s=null,o="",a="",l={},c={},h=/^(Webkit|webkit|O|Moz|moz|ms)(.*)$/,u=window.document,d=u.createElement("div"),f=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.matchesSelector,p=d.style;for(var m in p){var g=m.match(n||h);if(g){n||(i=g[1],n=new RegExp("^("+i+")(.*)$"),i,o="-"+i.toLowerCase()+"-",a=i.toLowerCase()),l[e.lowerFirst(g[2])]=m;var v=e.dasherize(g[2]);c[v]=o+v,r[m]&&(s=r[m])}}s||void 0!==p.transition&&(s=r.transition);var y={normalizeStyleProperty:function(e){return l[e]||e},normalizeCssProperty:function(e){return c[e]||e},normalizeCssEvent:function(e){return a?a+e:e.toLowerCase()},matchesSelector:f};return e.mixin(t,y),t.css3PropPrefix=y.propPrefix=o,s&&(t.support.transition=y.transition={end:s}),t.support.cssPointerEvents=y.pointerEvents=(d.style.cssText="pointer-events:auto","auto"===d.style.pointerEvents),d=null,t.support.css3=y}),define("skylark-domx-browser/support/fullscreen",["../browser"],function(e){const t={prefixed:!0},i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],n=i[0];let r;for(let e=0;e<i.length;e++)if(i[e][1]in document){r=i[e];break}if(r){for(let e=0;e<r.length;e++)t[n[e]]=r[e];t.prefixed=r[0]!==n[0],e.requestFullscreen=function(){return document.body[t.requestFullscreen].apply(this,arguments)},e.exitFullscreen=function(){return document[t.exitFullscreen].apply(this,arguments)},e.support.fullscreen=t}else e.support.fullscreen=null;return e.support.fullscreen}),define("skylark-domx-browser/support/touch",["../browser"],function(e){return e.support.tocuh=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)}),define("skylark-domx-browser/main",["./browser","./support/css3","./support/fullscreen","./support/touch"],function(e){return e}),define("skylark-domx-browser",["skylark-domx-browser/main"],function(e){return e}),define("skylark-langx-scripter/scripter",["skylark-langx/skylark","skylark-langx/langx"],function(e,t,i){var n=document.getElementsByTagName("head")[0],r={},s={},o=0;function a(){return a}var l={type:!0,src:!0,nonce:!0,noModule:!0};return t.mixin(a,{loadJavaScript:function(e,t,i){var a=r[e];if(a||(a=r[e]={state:0,loadedCallbacks:[],errorCallbacks:[]}),a.loadedCallbacks.push(t),a.errorCallbacks.push(i),1===a.state)a.node.onload();else if(-1===a.state)a.node.onerror();else{var l=a.node=document.createElement("script"),c=a.id=o++;l.type="text/javascript",l.async=!1,l.defer=!1,startTime=(new Date).getTime(),n.appendChild(l),l.onload=function(){a.state=1;for(var e=a.loadedCallbacks,t=e.length;t--;)e[t]();a.loadedCallbacks=[],a.errorCallbacks=[]},l.onerror=function(){a.state=-1;for(var e=a.errorCallbacks,t=e.length;t--;)e[t]();a.loadedCallbacks=[],a.errorCallbacks=[]},l.src=e,s[c]=l}return a.id},deleteJavaScript:function(e){var t=s[e];if(t){var i=t.src;t.parentNode&&t.parentNode.remove(t),delete s[e],delete r[i]}},evaluate:function(e,t,i){var n,r,s=(i=i||document).createElement("script");if(s.text=e,t)for(n in l)(r=t[n]||t.getAttribute&&t.getAttribute(n))&&s.setAttribute(n,r);return i.head.appendChild(s).parentNode.removeChild(s),this}}),e.attach("langx.scripter",a)}),define("skylark-langx-scripter/main",["./scripter"],function(e){return e}),define("skylark-langx-scripter",["skylark-langx-scripter/main"],function(e){return e}),define("skylark-domx-noder/noder",["skylark-langx-ns","skylark-langx-types","skylark-langx-arrays","skylark-langx-strings","skylark-langx-scripter","skylark-domx-browser"],function(e,t,i,n,r,s){var o=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),a=/^\s*<(\w+|!)[^>]*>/,l=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,c=document.createElement("div"),h=document.createElement("table"),u=document.createElement("tbody"),d=document.createElement("tr"),f={tr:u,tbody:h,thead:h,tfoot:h,td:d,th:d,"*":c},p=/^(?:body|html)$/i,m=/^$|^module$|\/(?:java|ecma)script/i,g=Array.prototype.map,v=Array.prototype.slice;function y(e,n){var r=function(e){"function"==typeof e&&(e=e());return g.call(t.isArrayLike(e)?e:[e],e=>("function"==typeof e&&(e=e()),T(e)||M(e)?e:"string"==typeof e&&/\S/.test(e)?document.createTextNode(e):void 0)).filter(e=>e)}(e);return n&&(r=g.call(r,function(e){return e.cloneNode(!0)})),i.flatten(r)}function k(e,t){var i=e.nodeName&&e.nodeName.toLowerCase();return void 0!==t?i===t.toLowerCase():i}function b(e,n){if(t.isFunction(e))return e.apply(n,[]);if(t.isArrayLike(e)){for(var r,s=0;s<e.length;s++)t.isFunction(e[s])&&(e[s]=e[s].apply(n,[]),t.isArrayLike(e[s])&&(r=!0));r&&(e=i.flatten(e))}return e}function x(e,t,i){t=b(t,e);for(var n=e,r=y(t,i),s=0;s<r.length;s++)n.appendChild(r[s]);return this}function w(e,i,n,r){var s;if(s=/svg/i.test(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e),t.isHtmlNode(i)?(r=i,i=null,n=null):t.isHtmlNode(n)&&(r=n,n=null),i)for(var o in i)s[o]=i[o];if(n)for(var o in n)s.setAttribute(o,n[o]);return r&&x(r,s),s}function _(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}return this}function C(e){return!1===e?s.exitFullscreen.apply(document):e?e[s.support.fullscreen.requestFullscreen]():document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement}var S=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;function A(e,t,i){if(i)return e.parentNode===t;if(document.documentElement.contains)return t.contains(e);for(;e;){if(t===e)return!0;e=e.parentNode}return!1}function M(e){return e&&3===e.nodeType}function T(e){return e&&1===e.nodeType}function L(e){return e?9==e.nodeType?e:e.ownerDocument:document}function E(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||E(e.parentNode)))}function O(){return O}return Object.assign(O,{active:function(e){var t;e=e||document;try{t=e.activeElement}catch(i){t=e.body}t||(t=e.body);t.nodeName||(t=e.body);return t},after:function(e,t,i){t=b(t,e);var n=(s=e).parentNode;if(n)for(var r=y(t,i),s=s.nextSibling,o=0;o<r.length;o++)s?n.insertBefore(r[o],s):n.appendChild(r[o]);return this},append:x,before:function(e,t,i){t=b(t,e);var n=e,r=n.parentNode;if(r)for(var s=y(t,i),o=0;o<s.length;o++)r.insertBefore(s[o],n);return this},blur:function(e){e.blur()},body:function(){return document.body},clone:function(e,t){var i,n=this;if(!o||1!==e.nodeType||t)return e.cloneNode(t);if(!t)return i=document.createElement(e.nodeName),each(n.getAttribs(e),function(t){n.setAttrib(i,t.nodeName,n.getAttrib(e,t.nodeName))}),i},contains:function(e,t){return A(t,e)},contents:function(e){if(k(e,"iframe"))return e.contentDocument;return e.childNodes},createElement:w,createFragment:function(e){if(e=n.trim(e),l.test(e))return[w(RegExp.$1)];var t=a.test(e)&&RegExp.$1;t in f||(t="*");var i=f[t];return i.innerHTML=function(e){for(var t=e.split("/>"),i="",n=0;n<t.length-1;n++){var r=t[n].split("<");i+=t[n]+"></"+r[r.length-1].split(" ")[0]+">"}return i+t[t.length-1]}(""+e),dom=v.call(i.childNodes),dom.forEach(function(e){i.removeChild(e)}),dom},createTextNode:function(e){return document.createTextNode(e)},doc:function(){return document},empty:_,generateId:function(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,n=0;for(;i--;)n+=t.charCodeAt(i);return n.toString(36)},fullscreen:C,focusable:function(e,t){var i,n,r,s,o,a=e.nodeName.toLowerCase();if("area"===a)return i=e.parentNode,n=i.name,!(!e.href||!n||"map"!==i.nodeName.toLowerCase())&&((r=$("img[usemap='#"+n+"']")).length>0&&r.is(":visible"));/^(input|select|textarea|button|object)$/.test(a)?(s=!e.disabled)&&(o=$(e).closest("fieldset")[0])&&(s=!o.disabled):s="a"===a&&e.href||t;return s&&$(e).is(":visible")&&visible($(e))},fromPoint:function(e,t){return document.elementFromPoint(e,t)},html:function(e,i){var n=function(e,i){if(void 0===i)return e.innerHTML;if(_(e),i=i||"",t.isString(i)&&(i=i.replace(S,"<$1></$2>")),t.isString(i)||t.isNumber(i))e.innerHTML=i;else if(t.isArrayLike(i))for(var n=0;n<i.length;n++)e.appendChild(i[n]);else e.appendChild(i);return this}(e,i);if(void 0!==i){for(var s=e.querySelectorAll("script"),o=0;o<s.length;o++){var a=s[o];m.test(a.type||"")&&r.evaluate(a.textContent,a)}return this}return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)},isChildOf:A,isDocument:function(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE},isEditable:E,isElement:T,isFullscreen:function(e){return C()===e},isInDocument:function(e){return e===document.body||document.body.contains(e)},isInFrame:function(){try{return window.parent!==window.self}catch(e){return!0}},isInput:function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||E(e)},isTextNode:M,isWindow:t.isWindow,nodeName:k,offsetParent:function(e){var t=e.offsetParent||document.body;for(;t&&!p.test(t.nodeName)&&"static"==document.defaultView.getComputedStyle(t).position;)t=t.offsetParent;return t},ownerDoc:L,ownerWindow:function(e){var t=L(e);return t.defaultView||t.parentWindow},prepend:function(e,t,i){for(var n=e,r=n.firstChild,s=y(t,i),o=0;o<s.length;o++)r?n.insertBefore(s[o],r):n.appendChild(s[o]);return this},reflow:function(e){e||(e=document);return e.offsetHeight,this},remove:function(e){if(e&&e.parentNode)try{e.parentNode.removeChild(e)}catch(e){console.warn("The node is already removed",e)}return this},removeChild:function(e,i){t.isArrayLike(i)||(i=[i]);for(var n=0;n<i.length;n++)e.removeChild(i[n]);return this},replace:function(e,t){return t.parentNode.replaceChild(e,t),this},selectable:function(e,t){if(void 0===e||void 0===e.style)return;e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off"},traverse:function e(t,i){i(t);for(var n=0,r=t.childNodes.length;n<r;n++)e(t.childNodes[n],i);return this},reverse:function(e){for(var t=e.firstChild,i=e.children.length-1;i>0;i--)if(i>0){var n=e.children[i];e.insertBefore(n,t)}},wrapper:function(e,i){t.isString(i)&&(i=this.createFragment(i).firstChild);e.parentNode.insertBefore(i,e),i.appendChild(e)},wrapperInner:function(e,t){var i=v.call(e.childNodes);e.appendChild(t);for(var n=0;n<i.length;n++)t.appendChild(i[n]);return this},unwrap:function(e){var t=e.parentNode;if(t){if(this.isDoc(t.parentNode))return;t.parentNode.insertBefore(e,t)}}}),e.attach("domx.noder",O)}),define("skylark-domx-styler/styler",["skylark-langx/skylark","skylark-langx/langx"],function(e,t){Array.prototype.every;var i=Array.prototype.forEach,n=t.camelCase,r=t.dasherize;function s(e,t){return"number"!=typeof t||o[r(e)]?t:t+"px"}var o={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},a={};function l(e){return e in a?a[e]:a[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function c(e,t){var i=e.className||"",n=i&&void 0!==i.baseVal;if(void 0===t)return n?i.baseVal:i;n?i.baseVal=t:e.className=t}var h={};function u(e,i){if(!i)return this;var n=c(e);return(t.isString(i)?i.split(/\s+/g):i).forEach(function(e){var t=l(e);n.match(t)||(n+=(n?" ":"")+e)}),c(e,n),this}function d(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=window),t.getComputedStyle(e)}function f(e,t){var i=l(t);return e.className&&e.className.match(i)}function p(e,i){if(i){var n=c(e);(t.isString(i)?i.split(/\s+/g):i).forEach(function(e){var t=l(e);n.match(t)&&(n=n.replace(t," "))}),c(e,n.trim())}else c(e,"");return this}var m=function(){return m};return t.mixin(m,{autocssfix:!1,cssHooks:{},addClass:u,className:c,css:function(e,o,a){if(void 0==a){var l=d(e);if(void 0==o)return l;if(t.isString(o))return e.style[n(o)]||l.getPropertyValue(r(o));if(t.isArrayLike(o)){var c={};return i.call(o,function(t){c[t]=e.style[n(t)]||l.getPropertyValue(r(t))}),c}}var h="";if("string"==typeof o)a||0===a?h=r(o)+":"+s(o,a):e.style.removeProperty(r(o));else for(key in o)void 0!==o[key]&&(o[key]||0===o[key]?h+=r(key)+":"+s(key,o[key])+";":e.style.removeProperty(r(key)));return e.style.cssText+=";"+h,this},disabled:function(e,t){if(arguments.length<2)return!!this.dom.disabled;return e.disabled=t,this},hasClass:f,hide:function(e){return m.css(e,"display","none"),this},isInvisible:function(e){return"none"==m.css(e,"display")||0==m.css(e,"opacity")||"hidden"==m.css(e,"visibility")},removeClass:p,show:function(e){m.css(e,"display",""),"none"==m.css(e,"display")&&m.css(e,"display",function(e){var t,i;h[e]||(t=document.createElement(e),document.body.appendChild(t),i=d(t).getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),h[e]=i);return h[e]}(e.nodeName));return this},toggleClass:function(e,t,i){return t.split(/\s+/g).forEach(function(t){void 0===i&&(i=!f(e,t)),i?u(e,t):p(e,t)}),this}}),e.attach("domx.styler",m)}),define("skylark-domx-styler/main",["./styler"],function(e,t,i){return e}),define("skylark-domx-styler",["skylark-domx-styler/main"],function(e){return e}),define("skylark-domx-noder/overlay",["skylark-domx-styler","./noder"],function(e,t){return t.overlay=function(i,n){var r=t.createElement("div",n);return e.css(r,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2147483647,opacity:.7}),i.appendChild(r),r}}),define("skylark-domx-noder/throb",["skylark-langx/langx","skylark-domx-styler","./noder"],function(e,t,i){return i.throb=function(e,n){(n=n||{}).text,n.style;var r,s=n.time,o=n.callback,a=i.createElement("div",{className:n.className||"throbber"}),l=function(){r&&(clearTimeout(r),r=null),a&&(i.remove(a),a=null)};n.style&&t.css(a,n.style);var c=n.content||'<span class="throb"></span>';i.html(a,c),e.appendChild(a),s&&(r=setTimeout(function(){l(),o&&o()},s));return{throbber:a,remove:l,update:function(e){e&&e.text&&a&&(textNode.nodeValue=e.text)}}}}),define("skylark-domx-noder/main",["./noder","./overlay","./throb"],function(e){return e}),define("skylark-domx-noder",["skylark-domx-noder/main"],function(e){return e}),define("skylark-domx-finder/finder",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-styler"],function(e,t,n,r,s){var o={},a=Array.prototype.filter,l=Array.prototype.slice,c=n.matchesSelector;(function(){var e,t,i,n,r,s={},o={},a=/\\/g,l=function(i,r){if(null==i)return null;if(!0===i.Slick)return i;i=(""+i).replace(/^\s+|\s+$/g,"");var a=(n=!!r)?o:s;if(a[i])return a[i];for(e={Slick:!0,expressions:[],raw:i,reverse:function(){return l(this.raw,!0)}},t=-1;i!=(i=i.replace(d,f)););return e.length=e.expressions.length,a[e.raw]=n?h(e):e},c=function(e){return"!"===e?" ":" "===e?"!":/^!/.test(e)?e.replace(/^!/,""):"!"+e},h=function(e){for(var t=e.expressions,i=0;i<t.length;i++){for(var n=t[i],r={parts:[],tag:"*",combinator:c(n[0].combinator)},s=0;s<n.length;s++){var o=n[s];o.reverseCombinator||(o.reverseCombinator=" "),o.combinator=o.reverseCombinator,delete o.reverseCombinator}n.reverse().push(r)}return e},u=(r=/(?=[\-\[\]{}()*+?.\\\^$|,#\s])/g,function(e){return e.replace(r,"\\")}),d=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+u(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])"));function f(r,s,o,l,h,d,f,p,m,g,v,y,k,b,x,w){if((s||-1===t)&&(e.expressions[++t]=[],i=-1,s))return"";if(o||l||-1===i){o=o||" ";var _=e.expressions[t];n&&_[i]&&(_[i].reverseCombinator=c(o)),_[++i]={combinator:o,tag:"*"}}var C=e.expressions[t][i];if(h)C.tag=h.replace(a,"");else if(d)C.id=d.replace(a,"");else if(f)f=f.replace(a,""),C.classList||(C.classList=[]),C.classes||(C.classes=[]),C.classList.push(f),C.classes.push({value:f,regexp:new RegExp("(^|\\s)"+u(f)+"(\\s|$)")});else if(k)w=(w=w||x)?w.replace(a,""):null,C.pseudos||(C.pseudos=[]),C.pseudos.push({key:k.replace(a,""),value:w,type:1==y.length?"class":"element"});else if(p){var S,A;switch(p=p.replace(a,""),v=(v||"").replace(a,""),m){case"^=":A=new RegExp("^"+u(v));break;case"$=":A=new RegExp(u(v)+"$");break;case"~=":A=new RegExp("(^|\\s)"+u(v)+"(\\s|$)");break;case"|=":A=new RegExp("^"+u(v)+"(-|$)");break;case"=":S=function(e){return v==e};break;case"*=":S=function(e){return e&&e.indexOf(v)>-1};break;case"!=":S=function(e){return v!=e};break;default:S=function(e){return!!e}}""==v&&/^[*$^]=$/.test(m)&&(S=function(){return!1}),S||(S=function(e){return e&&A.test(e)}),C.attributes||(C.attributes=[]),C.attributes.push({key:p,operator:m,value:v,test:S})}return""}var p=this.Slick||{};p.parse=function(e){return l(e)},p.escapeRegExp=u,this.Slick||(this.Slick=p)}).apply(o);var h=/^(?:input|select|textarea|button)$/i,u=/^h\d$/i,l=Array.prototype.slice;o.parseSelector=o.Slick.parse;var d=o.pseudos={button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},checked:function(e){return!!e.checked},contains:function(e,t,i,n){if($(this).text().indexOf(n)>-1)return this},disabled:function(e){return!!e.disabled},enabled:function(e){return!e.disabled},eq:function(e,t,i,n){return t==n},even:function(e,t,i,n){return t%2==0},focus:function(e){return document.activeElement===e&&(e.href||e.type||e.tabindex)},focusable:function(e){return r.focusable(e,null!=e.tabindex)},first:function(e,t){return 0===t},gt:function(e,t,i,n){return t>n},has:function(e,t,i,n){return b(e,n)},header:function(e){return u.test(e.nodeName)},hidden:function(e){return!o.pseudos.visible(e)},input:function(e){return h.test(e.nodeName)},last:function(e,t,i){return t===i.length-1},lt:function(e,t,i,n){return t<n},not:function(e,t,i,n){return!_(e,n)},odd:function(e,t,i,n){return t%2==1},parent:function(e){return!!e.parentElement},selected:function(e){return!!e.selected},tabbable:function(e){var t=e.tabindex,i=null!=t;return(!i||t>=0)&&r.focusable(element,i)},text:function(e){return"text"===e.type},visible:function(e){return e.offsetWidth&&e.offsetWidth},empty:function(e){return!e.hasChildNodes()}};function f(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function p(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}for(i in["first","eq","last"].forEach(function(e){d[e].isArrayFilter=!0}),d.nth=d.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d[i]=f(i);for(i in{submit:!0,reset:!0})d[i]=p(i);function m(e,i,n){for(var r=[],s=n&&t.isString(n);(e=e.parentElement)&&9!==e.nodeType;){if(n)if(s){if(_(e,n))break}else if(t.isArrayLike(n)){if(t.inArray(e,n)>-1)break}else if(e==n)break;i&&!_(e,i)||r.push(e)}return r}function g(e,t){for(var i=e.childNodes,n=[],r=0;r<i.length;r++){var e=i[r];1==e.nodeType&&n.push(e)}return t&&(n=o.filter(n,t)),n}function v(e,t,i,n){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentElement===i&&_(e,t):_(e,t))||n&&e===i)return e;if(e===i)break}while(e=A(e))}return null}function y(e,t){try{return l.call(e.querySelectorAll(t))}catch(e){}return o.query(e,t)}function k(e,t){try{return e.querySelector(t)}catch(e){}var i=o.query(e,t);return i.length>0?i[0]:null}function b(e,t){return t||(t=e,e=document.body),_(e,t)?e:k(e,t)}function x(e,t,i){for(var n=e.childNodes,r=n[0];r;){if(1==r.nodeType){if(!t||_(r,t))return r;if(i)break}r=r.nextSibling}return null}function w(e,t,i){for(var n=e.childNodes,r=n[n.length-1];r;){if(1==r.nodeType){if(!t||_(r,t))return r;if(i)break}r=r.previousSibling}return null}function _(e,i){if(!i||!e||1!==e.nodeType)return!1;if(t.isString(i)){try{return c.call(e,i.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(e){}return o.match(e,i)}return t.isArrayLike(i)?t.inArray(e,i)>-1:t.isPlainObject(i)?o.check(e,i):e===i}function C(e,t,i){for(var n=e.nextSibling;n;){if(1==n.nodeType){if(!t||_(n,t))return n;if(i)break}n=n.nextSibling}return null}function S(e,t){for(var i=e.nextSibling,n=[];i;)1==i.nodeType&&(t&&!_(i,t)||n.push(i)),i=i.nextSibling;return n}function A(e,t){var i=e.host&&e!==document&&e.host.nodeType?e.host:e.parentElement;return!i||t&&!_(i,t)?null:i}function M(e,t,i){for(var n=e.previousSibling;n;){if(1==n.nodeType){if(!t||_(n,t))return n;if(i)break}n=n.previousSibling}return null}function T(e,t){for(var i=e.previousSibling,n=[];i;)1==i.nodeType&&(t&&!_(i,t)||n.push(i)),i=i.previousSibling;return n}function L(e,t){for(var i=e.parentElement.firstChild,n=[];i;)1==i.nodeType&&i!==e&&(t&&!_(i,t)||n.push(i)),i=i.nextSibling;return n}o.divide=function(e){var t,i,n,r,s,o="",a=[];if((i=e.id)&&(o+="#"+i),n=e.classes)for(var l=n.length;l--;)o+="."+n[l].value;if(r=e.attributes)for(var l=0;l<r.length;l++)r[l].operator?o+="["+r[l].key+r[l].operator+JSON.stringify(r[l].value)+"]":o+="["+r[l].key+"]";if(s=e.pseudos)for(l=s.length;l--;)part=s[l],this.pseudos[part.key]?a.push(part):void 0!==part.value&&(o+=":"+part.key+"("+JSON.stringify(part));return(t=e.tag)&&"*"!==t&&(o=t.toUpperCase()+o),o||(o="*"),{nativeSelector:o,customPseudos:a}},o.check=function(e,t,i,n,r){var s,o,a,l,h,u,d,f,p;if(!r){if(s=t.tag){var m=e.nodeName.toUpperCase();if("*"==s){if(m<"@")return!1}else if(m!=(s||"").toUpperCase())return!1}if((o=t.id)&&e.getAttribute("id")!=o)return!1;if(a=t.classes)for(u=a.length;u--;)if(!(f=e.getAttribute("class"))||!a[u].regexp.test(f))return!1;if(l=t.attributes)for(u=l.length;u--;)if((d=l[u]).operator?!d.test(e.getAttribute(d.key)):!e.hasAttribute(d.key))return!1}if(h=t.pseudos)for(u=h.length;u--;)if(d=h[u],p=this.pseudos[d.key]){if((r&&p.isArrayFilter||!r&&!p.isArrayFilter)&&!p(e,i,n,d.value))return!1}else if(!r&&!c.call(e,d.key))return!1;return!0},o.match=function(e,i){var n;if(!(n=t.isString(i)?o.Slick.parse(i):i))return!0;var r,s,a=n.expressions,l=0;for(r=0;s=a[r];r++)if(1==s.length){var c=s[0];if(this.check(e,c))return!0;l++}if(l==n.length)return!1;var h,u=this.query(document,n);for(r=0;h=u[r++];)if(h===e)return!0;return!1},o.filterSingle=function(e,t){var i=a.call(e,function(i,n){return o.check(i,t,n,e,!1)});return i=a.call(i,function(e,n){return o.check(e,t,n,i,!0)})},o.filter=function(e,i){if(!t.isString(i))return o.filterSingle(e,i);var n,r,s=o.Slick.parse(i).expressions,a=[];for(n=0;r=s[n];n++){if(1!=r.length)throw new Error("not supported selector:"+i);var l=r[0],c=o.filterSingle(e,l);a=t.uniq(a.concat(c))}return a},o.combine=function(e,t){var i,n=t.combinator,r=t,s=[];switch(n){case">":s=g(e,r);break;case"+":(i=C(e,r,!0))&&s.push(i);break;case"^":(i=x(e,r,!0))&&s.push(i);break;case"~":s=S(e,r);break;case"++":var c=M(e,r,!0),h=C(e,r,!0);c&&s.push(c),h&&s.push(h);break;case"~~":s=L(e,r);break;case"!":s=m(e,r);break;case"!>":(i=A(e,r))&&s.push(i);break;case"!+":s=M(e,r,!0);break;case"!^":(i=w(e,r,!0))&&s.push(i);break;case"!~":s=T(e,r);break;default:var u=this.divide(t);if(s=l.call(e.querySelectorAll(u.nativeSelector)),u.customPseudos)for(var d=u.customPseudos.length-1;d>=0;d--)s=a.call(s,function(e,t){return o.check(e,{pseudos:[u.customPseudos[d]]},t,s,!1)}),s=a.call(s,function(e,t){return o.check(e,{pseudos:[u.customPseudos[d]]},t,s,!0)})}return s},o.query=function(e,i,n){for(var r,s,a=this.Slick.parse(i),l=[],c=a.expressions,h=0;r=c[h];h++){for(var u,d=[e],f=0;s=r[f];f++)(u=t.map(d,function(e,t){return o.combine(e,s)}))&&(d=u);u&&(l=l.concat(u))}return l};var E=function(){return E};return t.mixin(E,{ancestor:function(e,i,n){var r=n&&t.isString(n);for(;e=e.parentElement;){if(_(e,i))return e;if(n)if(r){if(_(e,n))break}else if(e==n)break}return null},ancestors:m,byId:function(e,t){return(t=t||r.doc()).getElementById(e)},childAt:function(e,i,n){var r=0,o=e.children;n=t.mixin({ignoreHidden:!0,excluding:null,closesting:null},n);for(var a=0;a<o.length;a++){var l=o[a];if((!n.ignoreHidden||"none"!==s.css(l))&&((!n.excluding||!n.excluding.includes(l))&&(!n.closesting||v(l,n.closesting,e,!1)))){if(r===i)return l;r++}}return null},children:g,closest:v,descendant:k,descendants:y,find:b,findAll:function(e,t){t||(t=e,e=document.body);return y(e,t)},firstChild:x,index:function(e,i){var n=0;if(!e||!e.parentNode)return-1;for(;e&&(e=e.previousElementSibling);)t.isString(i)?_(e,i)&&n++:t.isFunction(i)&&i(e)&&n++,n++;return n},lastChild:w,matches:_,nextSibling:C,nextSiblings:S,parent:A,previousSibling:M,previousSiblings:T,pseudos:o.pseudos,siblings:L}),e.attach("domx.finder",E)}),define("skylark-domx-finder/main",["./finder"],function(e){return e}),define("skylark-domx-finder",["skylark-domx-finder/main"],function(e){return e}),define("skylark-domx-data/data",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-finder","skylark-domx-noder"],function(e,t,i,n){var r=Array.prototype.map,s=(Array.prototype.filter,t.camelCase),o=t.deserializeValue,a=/([A-Z])/g,l={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};var c={option:{get:function(e){var t=e.getAttribute("value");return null!=t?t:(m(e).match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")}},select:{get:function(e){var t,i,r,s=e.options,o=e.selectedIndex,a="select-one"===e.type,l=a?null:[],c=a?o+1:s.length;for(r=o<0?c:a?o:0;r<c;r++)if((i=s[r]).selected&&!i.disabled&&(!i.parentNode.disabled||!n.nodeName(i.parentNode,"optgroup"))){if(t=g(i),a)return t;l.push(t)}return l},set:function(e,i){for(var n,r,s=e.options,o=t.makeArray(i),a=s.length;a--;)((r=s[a]).selected=t.inArray(c.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}};function h(e,t,i){if(void 0===i){if("object"==typeof t){for(var n in t)h(e,n,t[n]);return this}return e.getAttribute?e.getAttribute(t):e[t]}return e.setAttribute?e.setAttribute(t,i):e[t]=i,this}function u(e,i){var n=e._$_store;return!n&&i&&(n=e._$_store=function(e){var i={};return t.each(e.attributes||[],function(e,t){0==t.name.indexOf("data-")&&(i[s(t.name.replace("data-",""))]=o(t.value))}),i}(e)),n}function d(e,t,i){var n=u(e,!0);n[s(t)]=i}function f(e,i,n){if(void 0===n){if("object"==typeof i){for(var r in i)d(e,r,i[r]);return this}return function(e,i){if(void 0===i)return u(e,!0);var n=u(e);if(n){if(i in n)return n[i];var r=s(i);if(r in n)return n[r]}var o="data-"+i.replace(a,"-$1").toLowerCase(),l=h(e,o);return t.isString(l)||(l=void 0),l}(e,i)}return d(e,i,n),this}function p(e){e._$_store&&delete e._$_store}function m(e,t){return void 0===t?void 0!==e.textContent?e.textContent:e.innerText:(t=null==t?"":""+t,void 0!==e.textContent?e.textContent=t:e.innerText=t,this)}function g(e,i){var n=c[e.type]||c[e.nodeName.toLowerCase()];if(void 0===i)return n&&"get"in n&&void 0!==(ret=n.get(e,"value"))?ret:(ret=e.value,"string"==typeof ret?ret.replace(/\r/g,""):null==ret?"":ret);null==i?i="":"number"==typeof i?i+="":t.isArray(i)&&(i=t.map(i,function(e){return null==e?"":e+""})),n&&"set"in n&&void 0!==n.set(e,i,"value")||(e.value=i)}function v(){return v}return t.each(["radio","checkbox"],function(){c[this]={set:function(e,i){if(t.isArray(i))return e.checked=t.inArray(g(e),i)>-1}}}),i.pseudos.data=function(e,t,i,n){return!!f(e,n||i[3])},t.mixin(v,{aria:function(e,t,i){return this.attr(e,"aria-"+t,i)},attr:h,cleanData:p,data:f,pluck:function(e,t){return r.call(e,function(e){return e[t]})},prop:function e(t,i,n){if(void 0===n&&"object"==typeof i){for(var r in i)e(t,r,i[r]);return this}i=l[i]||i;return void 0===n?t[i]:(t[i]=n,this)},removeAttr:function(e,t){return t.split(" ").forEach(function(t){!function(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i)}(e,t)}),this},removeData:function(e,i){if(i){t.isString(i)&&(i=i.split(/\s+/));var n=u(e,!0);i.forEach(function(e){delete n[e]})}else p(e);return this},removeProp:function(e,t){return t.split(" ").forEach(function(t){delete e[t]}),this},text:m,val:g,valHooks:c}),e.attach("domx.data",v)}),define("skylark-domx-query/query",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder"],function(e,t,i,n){var r,s=Array.prototype.some,o=Array.prototype.push,a=(Array.prototype.every,Array.prototype.concat,Array.prototype.slice),l=(Array.prototype.map,Array.prototype.filter),c=Array.prototype.forEach,h=Array.prototype.indexOf,u=Array.prototype.sort,d=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,f=t.funcArg,p=t.isArrayLike,m=t.isString,g=t.uniq,v=t.isFunction,y=t.type,k=(t.isArray,t.isWindow,t.isDocument,t.isObject);t.isPlainObject,t.compact,t.flatten,t.camelCase,t.dasherize,n.children;function b(e,n,r){return function(r){var s,o=t.map(arguments,function(e){return"function"==(s=y(e))||"object"==s||"array"==s||null==e?e:i.createFragment(e)});return o.length<1?this:(this.each(function(t){e.apply(n,[this,o,t>0])}),this)}}function x(e,i){return function(){var n=a.call(arguments),r=t.map(this,function(t,r){return e.apply(i,[t].concat(n))});return T(g(r))}}function w(e,t,i){return function(n){a.call(arguments);var r=this.map(function(r,s){return s.querySelector?e.apply(t,i?[s]:[s,n]):[]});return i&&n?r.filter(n):r}}function _(e,t,i){return function(n,r){a.call(arguments);var s=this.map(function(s,o){return e.apply(t,i?[o,n]:[o,r,n])});return i&&r?s.filter(r):s}}function C(e,t){return function(){var i=a.call(arguments);return this.each(function(n,r){e.apply(t,[this].concat(i))}),this}}function S(e,i,n){return function(r){return t.isDefined(r)?(c.call(this,function(t,s){var o;o=n?f(t,r,s,n(t)):r,e.apply(i,[t,o])}),this):this[0]?e.apply(i,[this[0]]):void 0}}var A,M=t.klass({klassName:"SkNodeList",init:function(e,r){var s,a,l,c;if(e&&(this.context=r=r||i.doc(),m(e)?(this.selector=e,(s="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:d.exec(e))?s[1]?(a=i.createFragment(e),t.isPlainObject(r)&&(c=r)):(l=n.byId(s[2],i.ownerDoc(r)))&&(a=[l]):(t.isString(r)&&(r=n.find(r)),a=n.descendants(r,e))):a=!i.isWindow(e)&&p(e)?e:[e]),a&&(o.apply(this,a),c))for(var h in c)t.isFunction(this[h])?this[h](c[h]):this.attr(h,c[h]);return this}}),T=function(){r=function(e){return e instanceof M},init=function(e,t){return new M(e,t)};var e=function(t,i){return v(t)?(e.ready(function(){t(e)}),d):r(t)?t:i&&r(i)&&m(t)?i.find(t):init(t,i)},d=e(document);e.fn=M.prototype,t.mixin(e.fn,{length:0,map:function(i){return e(g(t.map(this,function(e,t){return i.call(e,t,e)})))},slice:function(){return e(a.apply(this,arguments))},forEach:function(){return c.apply(this,arguments)},get:function(e){return void 0===e?a.call(this):this[e>=0?e:e+this.length]},indexOf:function(){return h.apply(this,arguments)},sort:function(){return u.apply(this,arguments)},toArray:function(){return a.call(this)},size:function(){return this.length},remove:function(e){return e?this.find(e).remove():(this.each(function(e,t){i.remove(t)}),this)},each:function(e){return t.each(this,e),this},filter:function(t){return v(t)?this.not(this.not(t)):e(l.call(this,function(e){return n.matches(e,t)}))},add:function(t,i){return e(g(this.toArray().concat(e(t,i).toArray())))},is:function(e){if(this.length>0){if(t.isString(e))return s.call(this,function(t){return n.matches(t,e)});if(t.isArrayLike(e))return s.call(this,function(i){return t.inArray(i,e)>-1});if(t.isHtmlNode(e))return s.call(this,function(t){return t==e})}return!1},not:function(t){var i=[];if(v(t)&&void 0!==t.call)this.each(function(e,n){t.call(this,e,n)||i.push(this)});else{var n="string"==typeof t?this.filter(t):p(t)&&v(t.item)?a.call(t):e(t);this.forEach(function(e){n.indexOf(e)<0&&i.push(e)})}return e(i)},has:function(t){return this.filter(function(){return k(t)?i.contains(this,t):e(this).find(t).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},find:w(n.descendants,n),closest:w(n.closest,n),parents:w(n.ancestors,n),parentsUntil:_(n.ancestors,n),parent:w(n.parent,n),children:w(n.children,n),contents:x(i.contents,i),empty:C(i.empty,i),html:S(i.html,i),pluck:function(e){return t.map(this,function(t){return t[e]})},pushStack:function(t){var i=e(t);return i.prevObject=this,i},replaceWith:function(e){return this.before(e).remove()},wrap:function(t){var i="function"==typeof t;return this.each(function(n){e(this).wrapAll(i?t.call(this,n):t)})},wrapAll:function(t){var i;return this[0]&&("function"==typeof t&&(t=t.call(this[0])),i=e(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&i.insertBefore(this[0]),i.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(t){return"function"==typeof t?this.each(function(i){e(this).wrapInner(t.call(this,i))}):this.each(function(){var i=e(this),n=i.contents();n.length?n.wrapAll(t):i.append(t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){e(this).replaceWith(this.childNodes)}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},toggle:function(t){return this.each(function(){var i=e(this);(void 0===t?"none"==i.css("display"):t)?i.show():i.hide()})},prev:function(t){return e(this.pluck("previousElementSibling")).filter(t||"*")},prevAll:w(n.previousSiblings,n),next:function(t){return e(this.pluck("nextElementSibling")).filter(t||"*")},nextAll:w(n.nextSiblings,n),siblings:w(n.siblings,n),index:function(t){return t?this.indexOf(e(t)[0]):this.parent().children().indexOf(this[0])}}),e.fn.detach=e.fn.remove,e.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};i.traverse;return e.fn.after=b(i.after,i),e.fn.prepend=b(i.prepend,i),e.fn.before=b(i.before,i),e.fn.append=b(i.append,i),t.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,i){e.fn[t]=function(t){for(var n,r=[],s=e(t),a=s.length-1,l=0;l<=a;l++)n=l===a?this:this.clone(!0),e(s[l])[i](n),o.apply(r,n.get());return this.pushStack(r)}}),e}();return(A=T).fn.scrollParent=function(e){var t=this.css("position"),i="absolute"===t,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,r=this.parents().filter(function(){var e=A(this);return(!i||"static"!==e.css("position"))&&n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==t&&r.length?r:A(this[0].ownerDocument||document)},function(e){e.fn.end=function(){return this.prevObject||e()},e.fn.andSelf=function(){return this.add(this.prevObject||e())},e.fn.addBack=function(e){return this.prevObject?e?this.add(this.prevObject.filter(e)):this.add(this.prevObject):this},"filter,add,not,eq,first,last,find,closest,parents,parent,children,siblings,prev,prevAll,next,nextAll".split(",").forEach(function(t){var i=e.fn[t];e.fn[t]=function(){var e=i.apply(this,arguments);return e.prevObject=this,e}})}(T),function(e){var s;e.fn.query=e.fn.find,e.fn.place=function(e,s){return t.isString(e)?e=n.descendant(e):r(e)&&(e=e[0]),this.each(function(t,n){switch(s){case"before":i.before(e,n);break;case"after":i.after(e,n);break;case"replace":i.replace(e,n);break;case"only":i.empty(e),i.append(e,n);break;case"first":i.prepend(e,n);break;default:i.append(e,n)}})},e.fn.addContent=function(e,i){return e.template&&(e=t.substitute(e.template,e)),this.append(e)},e.fn.disableSelection=(s="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(s+".ui-disableSelection",function(e){e.preventDefault()})}),e.fn.enableSelection=function(){return this.off(".ui-disableSelection")},e.fn.reflow=function(){return i.reflow(this[0])},e.fn.isBlockNode=function(){return i.isBlockNode(this[0])}}(T),T.fn.plugin=function(e,t){var i=a.call(arguments,1),n=this,r=this;return this.each(function(){r=plugins.instantiate.apply(n,[this,e].concat(i))}),r},T.wraps={wrapper_node_operation:b,wrapper_map:x,wrapper_value:S,wrapper_selector:w,wrapper_some_chk:function(e,t){return function(){var i=a.call(arguments);return s.call(this,function(n){return e.apply(t,[n].concat(i))})}},wrapper_selector_until:_,wrapper_every_act_firstArgFunc:function(e,t,i){return function(n){var r=a.call(arguments);return c.call(this,function(s,o){var a=f(s,n,o,i(s));e.apply(t,[s,a].concat(r.slice(1)))}),this}},wrapper_every_act:C,wrapper_name_value:function(e,i,n){return function(r,s){return t.isPlainObject(r)||t.isDefined(s)?(c.call(this,function(t,o){var a;a=n?f(t,s,o,n(t,r)):s,e.apply(i,[t,r,a])}),this):this[0]?e.apply(i,[this[0],r]):void 0}}},e.attach("domx.query",T)}),define("skylark-domx-query/main",["./query","skylark-domx-styler"],function(e,t){return e.fn.style=e.wraps.wrapper_name_value(t.css,t),e.fn.css=e.wraps.wrapper_name_value(t.css,t),e.fn.hasClass=e.wraps.wrapper_some_chk(t.hasClass,t),e.fn.addClass=e.wraps.wrapper_every_act_firstArgFunc(t.addClass,t,t.className),e.fn.removeClass=e.wraps.wrapper_every_act_firstArgFunc(t.removeClass,t,t.className),e.fn.toggleClass=e.wraps.wrapper_every_act_firstArgFunc(t.toggleClass,t,t.className),e.fn.replaceClass=function(e,t){return this.removeClass(t),this.addClass(e),this},e.fn.replaceClass=function(e,t){return this.removeClass(t),this.addClass(e),this},e}),define("skylark-domx-query",["skylark-domx-query/main"],function(e){return e}),define("skylark-domx-velm/velm",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-finder","skylark-domx-query"],function(e,t,i,n,r){var s=Array.prototype.map,o=Array.prototype.slice,a=t.klass({klassName:"VisualElement",_construct:function(e){t.isString(e)&&(e="<"===(e=t.trim(e)).charAt(0)?i.createFragment(e)[0]:document.getElementById(e)),this._elm=e}});a.prototype.$=a.prototype.query=function(e){return r(e,this._elm)},a.prototype.elm=function(){return this._elm};var l=new a(document.body),c=function(e){return e?new a(e):l};return t.mixin(c,{batch:function(e,t,i){return e.forEach(function(e){var n=e instanceof a?e:c(e);n[t].apply(n,i)}),this},root:new a(document.body),VisualElement:a,partial:function(e,t){var i={};i[e]=t,a.partial(i)},delegate:function(e,i,n){var r={};e.forEach(function(e){var l=e;n&&n[e]&&(l=n[e]),r[e]=function(e,i){return function(){var n=this._elm,r=e.apply(i,[n].concat(o.call(arguments)));if(r){if(r===i)return this;r instanceof HTMLElement?r=new a(r):t.isArrayLike(r)&&(r=s.call(r,function(e){return e instanceof HTMLElement?new a(e):e}))}return r}}(i[l],i)}),a.partial(r)}}),c.delegate(["ancestor","ancestors","children","descendant","find","findAll","firstChild","lastChild","matches","nextSibling","nextSiblings","parent","previousSibling","previousSiblings","siblings"],n),c.find=function(e){return"body"===e?this.root:this.root.descendant(e)},c.delegate(["after","append","before","clone","contains","contents","empty","html","isChildOf","isDocument","isInDocument","isWindow","ownerDoc","prepend","remove","removeChild","replace","reverse","throb","traverse","wrapper","wrapperInner","unwrap"],i),e.attach("domx.velm",c)}),define("skylark-domx-velm/main",["./velm","skylark-domx-styler"],function(e,t){e.delegate(["addClass","className","css","hasClass","hide","isInvisible","removeClass","show","toggleClass"],t);return["position","left","top","right","bottom","width","height","border","borderLeft","borderTop","borderRight","borderBottom","borderColor","display","overflow","margin","marginLeft","marginTop","marginRight","marginBottom","padding","paddingLeft","paddingTop","paddingRight","paddingBottom","color","background","backgroundColor","opacity","fontSize","fontWeight","textAlign","textDecoration","textTransform","cursor","zIndex"].forEach(function(t){var i=t;e.VisualElement.prototype[i]=function(e){return this.css(t,e),this}}),e}),define("skylark-domx-velm",["skylark-domx-velm/main"],function(e){return e}),define("skylark-domx-data/main",["./data","skylark-domx-velm","skylark-domx-query"],function(e,t,i){return t.delegate(["attr","data","prop","removeAttr","removeData","text","val"],e),i.fn.text=i.wraps.wrapper_value(e.text,e,e.text),i.fn.attr=i.wraps.wrapper_name_value(e.attr,e,e.attr),i.fn.removeAttr=i.wraps.wrapper_every_act(e.removeAttr,e),i.fn.prop=i.wraps.wrapper_name_value(e.prop,e,e.prop),i.fn.removeProp=i.wraps.wrapper_every_act(e.removeProp,e),i.fn.data=i.wraps.wrapper_name_value(e.data,e),i.fn.removeData=i.wraps.wrapper_every_act(e.removeData),i.fn.val=i.wraps.wrapper_value(e.val,e,e.val),e}),define("skylark-domx-data",["skylark-domx-data/main"],function(e){return e}),define("skylark-domx-eventer/eventer",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-finder","skylark-domx-noder","skylark-domx-data"],function(e,t,i,n,r,s){t.mixin;var o=t.each,a=(Array.prototype.slice,t.uid),l=/^([A-Z]|returnValue$|layer[XY]$)/,c={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},h=/complete|loaded|interactive/;function u(e,i){return!i&&e.isDefaultPrevented||(i||(i=e),t.each(c,function(n,r){var s=i[n];e[n]=function(){return this[r]=t.returnTrue,s&&s.apply(i,arguments)},e[r]=t.returnFalse})),e}function d(e){if(e){var t=(""+e).split(".");return{type:t[0],ns:t.slice(1).sort().join(" ")}}return{type:null,ns:null}}function f(e){return e&&(t.isFunction(e)||t.isFunction(e.handleEvent))}var p=[window.CustomEvent,window.CompositionEvent,window.DragEvent,window.Event,window.FocusEvent,window.KeyboardEvent,window.MessageEvent,window.MouseEvent,window.MouseScrollEvent,window.MouseWheelEvent,window.MutationEvent,window.ProgressEvent,window.TextEvent,window.TouchEvent,window.UIEvent,window.WheelEvent,window.ClipboardEvent],m={compositionstart:1,compositionend:1,compositionupdate:1,beforecopy:16,beforecut:16,beforepaste:16,copy:16,cut:16,paste:16,drag:2,dragend:2,dragenter:2,dragexit:2,dragleave:2,dragover:2,dragstart:2,drop:2,abort:3,change:3,error:3,selectionchange:3,submit:3,reset:3,fullscreenchange:3,fullscreenerror:3,focus:4,blur:4,focusin:4,focusout:4,keydown:5,keypress:5,keyup:5,message:6,click:7,contextmenu:7,dblclick:7,mousedown:7,mouseup:7,mousemove:7,mouseover:7,mouseout:7,mouseenter:7,mouseleave:7,progress:11,textInput:12,tap:13,touchstart:13,touchmove:13,touchend:13,load:14,resize:14,select:14,scroll:14,unload:14,wheel:15},g=function(){return function(e,i){t.isString(e)?i=i||{}:e=(i=e||{}).type||"";var n=d(e);e=n.type,i=t.mixin({bubbles:!0,cancelable:!0},i),n.ns&&(i.namespace=n.ns);var r=function(e){var t=m[e];t||(t=0);return p[t]}(e),s=new r(e,i);return t.safeMixin(s,i),u(s)}}();function v(e,i){var n,r={originalEvent:e};for(n in e)"keyIdentifier"===n||l.test(n)||void 0===e[n]||(r[n]=e[n]);return i&&t.mixin(r,i),u(r,e)}var y={},k="onfocusin"in window,b={focus:"focusin",blur:"focusout"},x={mouseenter:"mouseover",mouseleave:"mouseout"},w=function(e){return x[e]||k&&b[e]||e},_={},C=t.klass({init:function(e,t){this._target=e,this._event=t,this._bindings=[]},add:function(e,i){var s=this._bindings,o={fn:e,options:t.mixin({},i)};s.push(o);var a=this;if(!a._listener){a._listener=function(e){var i=this,s=v(e),o=e._args,l=a._bindings,c=s.namespace;o=t.isDefined(o)?[s].concat(o):[s],s.type=a._event,t.each(l,function(e,l){var h=i;if(s.isImmediatePropagationStopped&&s.isImmediatePropagationStopped())return!1;var u=l.fn,d=l.options||{},f=d.selector,p=d.one,m=d.data;if(!c||c==d.ns||-1!==d.ns.indexOf(c)){if(f){if(!(h=n.closest(s.target,f))||h===i)return;t.mixin(s,{currentTarget:h,liveFired:i})}var g=a._event;if(g in x){var v=s.relatedTarget;if(v&&(v===h||r.contains(h,v)))return}t.isDefined(m)&&(s.data=m),p&&a.remove(u,d),!1===(u.handleEvent?u.handleEvent.apply(u,o):d.ctx?u.apply(d.ctx,o):u.apply(h,o))&&(s.preventDefault(),s.stopPropagation())}})};var l=a._event;a._target.addEventListener?a._target.addEventListener(w(l),a._listener,!1):console.warn("invalid eventer object",a._target)}},remove:function(e,i){var n,r;(i=t.mixin({},i)).ns&&(r=i.ns,n=new RegExp("(?:^| )"+r.replace(" "," .* ?")+"(?: |$)")),this._bindings=this._bindings.filter(function(t){var r=(!e||e===t.fn)&&(!n||n.test(t.options.ns))&&(!i.selector||i.selector==t.options.selector);return!r}),0==this._bindings.length&&(this._target.removeEventListener&&this._target.removeEventListener(w(this._event),this._listener,!1),this._listener=null)}}),S=t.klass({init:function(e){this._target=e,this._handler={}},register:function(e,i,n){var r=d(e),e=r.type,s=y[e],o=s&&(s.bindType||s.bindEventName),a=this._handler;void 0===a[e]&&(a[e]=new C(this._target,o||e)),a[e].add(i,t.mixin({ns:r.ns},n))},unregister:function(e,i,n){var r=this._handler,s=d(e);if(e=s.type){var o=r[e];o&&o.remove(i,t.mixin({ns:s.ns},n))}else for(e in r){var o=r[e];o.remove(i,t.mixin({ns:s.ns},n))}}}),A=function(e){var t=a(e),i=_[t];return i||(i=_[t]=new S(e)),i};var M=[],T=t.loop(function(){for(var e=0;e<M.length;e++)$(M[e],"focused");M=[]});function L(e,i,n,r,s,o,a){if(t.isPlainObject(i))return t.each(i,function(t,i){L(e,t,n,r,i,a)}),this;t.isString(n)||f(s)||(a=o,o=s,s=r,r=n,n=void 0),f(r)&&(a=o,o=s,s=r,r=void 0),t.isBoolean(o)&&(a=o,o=void 0),!1===s&&(s=t.returnFalse),"string"==typeof i&&(i=i.indexOf(",")>-1?i.split(","):i.split(/\s/));var l=A(e);return i.forEach(function(e){if("ready"==e)return E(s);l.register(e,s,{data:r,selector:n,ctx:o,one:!!a})}),this}function $(e,t,i){var n;(n=t instanceof Event?t:g(t,i))._args=i;var r=e.dispatchEvent||e.trigger;return r?r.call(e,n):console.warn("The evented parameter is not a eventable object"),this}function E(e){return h.test(document.readyState)&&document.body?t.defer(e):document.addEventListener("DOMContentLoaded",e,!1),this}T.start();var O=[],R=t.loop(function(){for(var e=0;e<O.length;e++)$(O[e],"resized");O=[]});R.start();var D={backspace:8,comma:188,delete:46,down:40,end:35,enter:13,escape:27,home:36,left:37,page_down:34,page_up:33,period:190,right:39,space:32,tab:9,up:38};function I(){return I}return i.support.transition&&(y.transitionEnd={bindType:i.support.transition.end,delegateType:i.support.transition.end}),t.mixin(I,{NativeEvents:m,clear:function(e){return A(e).unregister(),this},create:g,focused:function(e){M.includes(e)||M.push(e)},keys:D,isNativeEvent:function(e){if(t.isString(e))return!!m[e];if(t.isArray(e)){for(var i=0;i<e.length;i++)if(m[e])return!1;return e.length>0}},off:function e(i,n,r,s){if(t.isPlainObject(n))return t.each(n,function(t,n){e(i,t,r,n)}),this;t.isString(r)||f(s)||!1===s||(s=r,r=void 0);!1===s&&(s=t.returnFalse);"string"==typeof n&&(n=n.indexOf(",")>-1?n.split(","):n.split(/\s/));var o=A(i);n&&n.forEach(function(e){o.unregister(e,s,{selector:r})});return this},on:L,one:function(...e){return L(...e,!0),this},proxy:v,ready:E,resized:function(e){O.includes(e)||O.push(e)},shortcuts:function(e){var t=s.data(e,"shortcuts");if(!t){t={},s.data(e,"shortcuts",t);var i=function(e,t){var i=t.metaKey||t.ctrlKey;if(e.ctrl==i&&e.alt==t.altKey&&e.shift==t.shiftKey&&(t.keyCode==e.keyCode||t.charCode&&t.charCode==e.charCode))return t.preventDefault(),"keydown"==t.type&&e.fn(t),!0};L(e,"keyup keypress keydown",function(e){if(!/INPUT|TEXTAREA/.test(e.target.nodeName))for(var n in t)i(t[n],e)})}return{add:function(e,i){(e.indexOf(",")>-1?e.toLowerCase().split(","):e.toLowerCase().split(" ")).forEach(function(e){var n={fn:i,alt:!1,ctrl:!1,shift:!1};e.split("+").forEach(function(e){switch(e){case"alt":case"ctrl":case"shift":n[e]=!0;break;default:n.charCode=e.charCodeAt(0),n.keyCode=D[e]||e.toUpperCase().charCodeAt(0)}});var r=(n.ctrl?"ctrl":"")+","+(n.alt?"alt":"")+","+(n.shift?"shift":"")+","+n.keyCode;t[r]=n})}}},special:y,stop:function(e){window.document.all&&(e.keyCode=0);e.preventDefault&&(e.preventDefault(),e.stopPropagation());return this},trigger:$}),o(m,function(e){I[e]=function(t,i,n,r){return arguments.length>1?this.on(t,e,i,n,r):("focus"==e?t.focus&&t.focus():"blur"==e?t.blur&&t.blur():"click"==e?t.click&&t.click():this.trigger(t,e),this)}}),e.attach("domx.eventer",I)}),define("skylark-domx-eventer/main",["skylark-langx/langx","./eventer","skylark-domx-velm","skylark-domx-query"],function(e,t,i,n){var r=["off","on","one","trigger"];return e.each(t.NativeEvents,function(e){r.push(e)}),i.delegate(r,t),e.each(r,function(e,i){n.fn[i]=n.wraps.wrapper_every_act(t[i],t)}),n.ready=t.ready,t}),define("skylark-domx-eventer",["skylark-domx-eventer/main"],function(e){return e}),define("skylark-slax-runtime/slax",["skylark-langx-ns","skylark-langx-objects","skylark-langx-hoster","skylark-langx-async","skylark-net-http/Xhr","skylark-domx-eventer"],function(skylark,objects,hoster,async,Xhr,eventer){var _config={},_rootUrl="",_baseUrl="",slax={prepare:function(config){var p,slaxRoot,slaxApp;if(config||(config=hoster.global.slaxConfig),!config)for(var scripts=document.getElementsByTagName("script"),i=0,script,slaxDir,src,match;i<scripts.length;)if(script=scripts[i++],(src=script.getAttribute("src"))&&(match=src.match(/(((.*)\/)|^)skylark-slax-runtime([0-9A-Za-z\-]*)\.js(\W|$)/i))){slaxDir=match[3]||"",(src=script.getAttribute("data-slax-config"))?config=eval("({ "+src+" })"):(slaxRoot=script.getAttribute("data-slax-root"),void 0==slaxRoot&&(slaxRoot=slaxDir),slaxApp=script.getAttribute("data-slax-app"));break}if(config)objects.mixin(_config,config),p=async.Deferred.resolve();else{var d=new async.Deferred,p=d.promise;Xhr.get(slaxRoot+"/slax-config.json").then(function(e){if(slaxApp){for(var t,i=0;i<e.apps.length;i++)e.apps[i].name==slaxApp&&(t=slaxRoot+e.apps[i].dir);Xhr.get(t+"/spa.json").then(function(e){objects.mixin(_config,e),d.resolve()})}else objects.mixin(_config,e),d.resolve()})}return p},start:function(){var e=_config;require.config(e.runtime);var t=function(t,i){var n=t(i=i||e);hoster.global.go=function(e,t){n.go(e,t)},n.prepare().then(function(){n.run()})};e.spaModule?require([e.spaModule],function(e){e._start?e._start().then(function(i){t(e,i)}):t(e)}):t(skylark.spa)}};return define("slax",[],function(){return slax}),skylark.attach("slax",slax)}),define("skylark-io-caches/caches",["skylark-langx-ns"],function(e){"use strict";let t=e.attach("io.caches");return t.storages=t.storages||{},t}),define("skylark-io-caches/clipboard",["./caches"],function(e){}),define("skylark-io-caches/cookie",["skylark-langx-types","skylark-langx-objects/mixin","skylark-langx-datetimes","./caches"],function(e,t,i,n){"use strict";function r(){return r}return t(r,{get:function(e){return sKey&&this.has(e)?unescape(document.cookie.replace(new RegExp("(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*"),"$1")):null},has:function(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},list:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=0;t<e.length;t++)e[t]=unescape(e[t]);return e},remove:function(e,t){e&&this.has(e)&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; path="+t:""))},set:function(t,n,r,s,o,a){if(t&&!/^(?:expires|max\-age|path|domain|secure)$/i.test(t)){var l=e.type(r);if("number"===l){var c=Date.now();c.setTime(c.getTime()+24*expire*60*60*1e3),r=c}else"string"===l&&(r=new Date(Date.now()+i.parseMilliSeconds(r)));document.cookie=escape(t)+"="+escape(n)+(r?"; domain="+r.toGMTString():"")+(o?"; domain="+o:"")+(s?"; path="+s:"")+(a?"; secure":"")}}}),n.cookie=r}),define("skylark-io-caches/local-file-system",["skylark-langx-objects/mixin","skylark-langx-events/Emitter","skylark-langx-async/Deferred","./caches"],function(e,t,i,n){"use strict";var r=window.requestFileSystem||window.webkitRequestFileSystem;window.resolveLocalFileSystemURL||window.webkitResolveLocalFileSystemURL,window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;function s(e){var t="";switch(e.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}return t}var o=t.inherit({_fs:null,_isPersisted:!0,_cwd:null,init:function(e){this._fs=e,this._cwd=e.root},readfileAsArrayBuffer:function(e,t,i){this._cwd.getFile(e,{},function(e){e.file(function(e){var i=new FileReader;i.onloadend=function(){t(null,this.result)},i.readAsArrayBuffer(e)},i)},i)},readfileAsDataURL:function(e,t,i){this._cwd.getFile(e,{},function(e){e.file(function(e){var i=new FileReader;i.onloadend=function(){t(null,this.result)},i.readAsDataURL(e)},i)},i)},readfileAsText:function(e,t,i){this._cwd.getFile(e,{},function(e){e.file(function(e){var i=new FileReader;i.onloadend=function(){t(null,this.result)},i.readAsText(e)},i)},i)},writefile:function(e,t,i,n){var r=this,s=e.split("/");s=s.slice(0,s.length-1),this.mkdir(s.join("/"),function(){r._cwd.getFile(e,{create:!0},function(e){e.createWriter(function(e){var r=!1;e.onwriteend=function(){if(!r)return r=!0,void this.truncate(this.position);i&&i()},e.onerror=n;var s=t;!s instanceof Blob&&(s=new Blob([t],{type:"text/plain"})),e.write(s)},n)},n)})},rmfile:function(e,t,i){this._cwd.getFile(e,{},function(e){e.remove(function(){t()},i)},i)},readdir:function(e,t,i){this._cwd.getDirectory(e,{},function(e){var n=e.createReader(),r=[];!function e(){n.readEntries(function(i){i.length?(r=r.concat(Array.prototype.slice.call(i).map(function(e){return e.name+(e.isDirectory?"/":"")})),e()):t(null,r)},i)}()},i)},mkdir:function(e,t,i){var n=e.split("/"),r=function(s,o){"."!=o[0]&&""!=o[0]||(o=o.slice(1)),0!=o.length?s.getDirectory(o[0],{create:!0,exclusive:!1},function(s){if(s.isDirectory)o.length&&1!=n.length?r(s,o.slice(1)):t&&t(s);else{var a=new Error(e+" is not a directory");if(!i)throw a;i(a)}},function(e){if(!i)throw e;i(e)}):t(s)};r(this._cwd,n)},rmdir:function(e,t,i){this._cwd.getDirectory(e,{},function(e){e.removeRecursively(function(){t()},i)},i)},copy:function(e,t,i){this._cwd.getFile(e,{},function(e){cwd.getDirectory(t,{},function(t){e.copyTo(t,function(){i()},i)},i)},i)},move:function(e,t,i){this._cwd.getFile(e,{},function(e){cwd.getDirectory(t,{},function(t){e.moveTo(t,function(){i()},i)},i)},i)},chdir:function(e,t){this._cwd.getDirectory(e,{},function(e){cwd=e,fs.onchdir&&fs.onchdir(cwd.fullPath),t()},t)},importFromHost:function(e){for(var t,n=new i,r=0;t=e[r];++r)!function(e){cwd.getFile(t.name,{create:!0,exclusive:!0},function(t){t.createWriter(function(t){t.write(e)},s)},s)}(t);return n.promise},exportToHost:function(){}});return e(o,{isSupported:function(){return!!r},request:function(e,t){e=e||10485760;var n=t?PERSISTENT:TEMPORARY,s=new i;return r(n,e,function(e){var i=new o(e,!!t);s.resolve(i)},function(e){s.reject(e)}),s.promise}}),n.requestLocalFileSystem=o.request,n.LocalFileSystem=o}),define("skylark-io-caches/storages/local",["skylark-langx-objects/mixin","skylark-langx-strings","../caches"],function(e,t,i){"use strict";var n=null;try{n=window.localStorage}catch(e){}function r(){return r}return e(r,{isSupported:function(){return!!n},set:function(e,i){return void 0===i?this.remove(e):(n.setItem(e,t.serializeValue(i)),i)},get:function(e,i){var r=t.deserializeValue(n.getItem(e));return void 0===r?i:r},remove:function(e){n.removeItem(e)},clear:function(){n.clear()},list:function(){for(var e={},t=0;t<n.length;t++)e[key]=n.key(t);return values}}),i.storages.local=r}),define("skylark-io-caches/storages/session",["skylark-langx-objects/mixin","skylark-langx-strings","../caches"],function(e,t,i){"use strict";var n=null;try{n=window.sessiionStorage}catch(e){}return e(function e(){return e},{isSupported:function(){return!!n},set:function(e,i){return void 0===i?this.remove(e):(n.setItem(e,t.serializeValue(i)),i)},get:function(e,i){var r=t.deserializeValue(n.getItem(e));return void 0===r?i:r},remove:function(e){n.removeItem(e)},clear:function(){n.clear()},list:function(){for(var e={},t=0;t<n.length;t++)e[key]=n.key(t);return values}}),i.storages.session=sessionStorage}),define("skylark-io-caches/main",["./caches","./clipboard","./cookie","./local-file-system","./storages/local","./storages/session"],function(e){"use strict";return e}),define("skylark-io-caches",["skylark-io-caches/main"],function(e){return e}),define("skylark-slax-runtime/caches",["./slax","skylark-io-caches"],function(e,t){return e.caches=t}),define("skylark-langx/main",["./langx"],function(e){return e}),define("skylark-langx",["skylark-langx/main"],function(e){return e}),define("skylark-domx-animates/animates",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser"],function(e,t,i){function n(){return n}return t.mixin(n,{off:!1,speeds:{normal:400,fast:200,slow:600},animationName:i.normalizeCssProperty("animation-name"),animationDuration:i.normalizeCssProperty("animation-duration"),animationDelay:i.normalizeCssProperty("animation-delay"),animationTiming:i.normalizeCssProperty("animation-timing-function"),animationEnd:i.normalizeCssEvent("AnimationEnd"),animateBaseClass:"animated"}),e.attach("domx.animates",n)}),define("skylark-domx-geom/geom",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder","skylark-domx-styler"],function(e,t,i,n){"use strict";var r,s=/^(?:body|html)$/i,o=t.toPixel,a=i.offsetParent;function l(e){if(i.isWindow(e))return{left:0,top:0,right:0,bottom:0};var t=getComputedStyle(e);return{left:o(t.borderLeftWidth,e),top:o(t.borderTopWidth,e),right:o(t.borderRightWidth,e),bottom:o(t.borderBottomWidth,e)}}function c(e,t){if(void 0===t)return s.test(e.nodeName)?{top:0,left:0}:e.getBoundingClientRect();var i=a(e),n=c(i),r=f(e),o=l(i);return g(e,{top:t.top-n.top-r.top-o.top,left:t.left-n.left-r.left-o.left}),this}function h(e,t){return void 0!==t?(c(e,t),b(e,t),this):e==window||e==document.documentElement||e==document.body?{top:0,left:0,bottom:window.innerHeight,right:window.innerWidth,height:window.innerHeight,width:window.innerWidth}:e.getBoundingClientRect?e.getBoundingClientRect():void 0}function u(e,t){if(void 0==t)return{width:e.clientWidth,height:e.clientHeight};var i="border-box"===n.css(e,"box-sizing"),r={width:t.width,height:t.height};if(i){var s=l(e);void 0!==r.width&&(r.width=r.width+s.left+s.right),void 0!==r.height&&(r.height=r.height+s.top+s.bottom)}else{var o=p(e);void 0!==r.width&&(r.width=r.width-o.left-o.right),void 0!==r.height&&(r.height=r.height-o.top-o.bottom)}return n.css(e,r),this}function d(e){var t=e.documentElement,i=e.body,n=Math.max,r=n(t.scrollWidth,i.scrollWidth),s=n(t.clientWidth,i.clientWidth),o=n(t.offsetWidth,i.offsetWidth),a=n(t.scrollHeight,i.scrollHeight),l=n(t.clientHeight,i.clientHeight),c=n(t.offsetHeight,i.offsetHeight);return{width:r<o?s:r,height:a<c?l:a}}function f(e){if(i.isWindow(e))return{left:0,top:0,right:0,bottom:0};var t=getComputedStyle(e);return{left:o(t.marginLeft),top:o(t.marginTop),right:o(t.marginRight),bottom:o(t.marginBottom)}}function p(e){if(i.isWindow(e))return{left:0,top:0,right:0,bottom:0};var t=getComputedStyle(e);return{left:o(t.paddingLeft),top:o(t.paddingTop),right:o(t.paddingRight),bottom:o(t.paddingBottom)}}function m(e,t){if(void 0===t){var i=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return{left:i.left+n.pageXOffset,top:i.top+n.pageYOffset}}var r=a(e),s=m(r),o=f(e),c=l(r);return g(e,{top:t.top-s.top-o.top-c.top,left:t.left-s.left-o.left-c.left}),this}function g(e,i){if(void 0==i){var r=a(e),s=c(e),o=c(r),h=f(e),u=l(r);return{top:s.top-o.top-u.top-h.top,left:s.left-o.left-u.left-h.left}}var r=a(e),d={top:i.top,left:i.left};return t.isDefined(d.top)&&(d.top=d.top+(k(r)||0)),t.isDefined(d.left)&&(d.left=d.left+(y(r)||0)),"static"==n.css(e,"position")&&(d.position="relative"),n.css(e,d),this}function v(e,t){if(void 0===t){var i=a(e),n=h(e),r=c(i),s=(f(e),l(i));return{top:n.top-r.top-s.top,left:n.left-r.left-s.left,width:n.width,height:n.height}}return g(e,t),b(e,t),this}function y(e,t){9===e.nodeType?e=e.defaultView:e==document.body&&(e=document.scrollingElement||document.documentElement);var i="scrollLeft"in e;return void 0===t?i?e.scrollLeft:e.pageXOffset:(i?e.scrollLeft=t:e.scrollTo(t,e.scrollY),this)}function k(e,t){9===e.nodeType?e=e.defaultView:e==document.body&&(e=document.scrollingElement||document.documentElement);var i="scrollTop"in e;return void 0===t?i?e.scrollTop:e.pageYOffset:(i?e.scrollTop=t:e.scrollTo(e.scrollX,t),this)}function b(e,i){if(void 0==i)return t.isWindow(e)?{width:e.innerWidth,height:e.innerHeight}:t.isDocument(e)?d(document):{width:e.offsetWidth,height:e.offsetHeight};var r="border-box"===n.css(e,"box-sizing"),s={width:i.width,height:i.height};if(!r){var o=p(e),a=l(e);void 0!==s.width&&""!==s.width&&null!==s.width&&(s.width=s.width-o.left-o.right-a.left-a.right),void 0!==s.height&&""!==s.height&&null!==s.height&&(s.height=s.height-o.top-o.bottom-a.top-a.bottom)}return n.css(e,s),this}function x(e){return h(e=e||window)}function w(){return w}return t.mixin(w,{borderExtents:l,boundingPosition:c,boundingRect:h,clientHeight:function(e,t){return void 0==t?u(e).height:u(e,{height:t})},clientSize:u,clientWidth:function(e,t){return void 0==t?u(e).width:(u(e,{width:t}),this)},contentRect:function(e){var t=u(e),i=p(e);return{left:i.left,top:i.top,width:t.width-i.left-i.right,height:t.height-i.top-i.bottom}},getDocumentSize:d,hasScrollbar:function(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)},height:function(e,t){return void 0==t?b(e).height:(b(e,{height:t}),this)},inview:function(e,t){var i=function(e,t){var i={};return t=+t||0,i.width=(i.right=e.right+t)-(i.left=e.left-t),i.height=(i.bottom=e.bottom+t)-(i.top=e.top-t),i}(h(e),t),n=x();return!!i&&i.bottom>=0&&i.right>=0&&i.top<=n.height&&i.left<=n.width},marginExtents:f,marginRect:function(e){var t=v(e),i=f(e);return{left:t.left,top:t.top,width:t.width+i.left+i.right,height:t.height+i.top+i.bottom}},marginSize:function(e){var t=b(e),i=f(e);return{width:t.width+i.left+i.right,height:t.height+i.top+i.bottom}},offsetParent:a,paddingExtents:p,pagePosition:m,pageRect:function(e,t){if(void 0===t){var i=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return{left:i.left+n.pageXOffset,top:i.top+n.pageYOffset,width:Math.round(i.width),height:Math.round(i.height)}}return m(e,t),b(e,t),this},relativePosition:g,relativeRect:v,scrollbarWidth:function(){if(void 0!==r)return r;var e,t,s=i.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],o=s.childNodes[0];i.append(document.body,s),e=o.offsetWidth,n.css(s,"overflow","scroll"),t=o.offsetWidth,e===t&&(t=s[0].clientWidth);return i.remove(s),r=e-t},scrollIntoView:function(e,t){var i,n,r,s,o,a,l=e.parentNode,c=function(e,t){var i,n,r=e;i=n=0;for(;r&&r!=t&&r.nodeType;)i+=r.offsetLeft||0,n+=r.offsetTop||0,r=r.offsetParent;return{x:i,y:n}}(e,l);i=c.x,n=c.y,r=e.offsetWidth,s=e.offsetHeight,o=l.clientWidth,a=l.clientHeight,"end"==t?(i-=o-r,n-=a-s):"center"==t&&(i-=o/2-r/2,n-=a/2-s/2);return l.scrollLeft=i,l.scrollTop=n,this},scrollLeft:y,scrollTop:k,scrollBy:function(e,t,i){e.scrollLeft+=t,e.scrollTop+=i},size:b,testAxis:function(e){var t=e.offsetTop,i=e.offsetLeft,n=e.offsetWidth,r=e.offsetHeight;for(;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,i+=e.offsetLeft;var s={x:0,y:0};t<window.pageYOffset?s.y=t-window.pageYOffset:t+r>window.pageYOffset+window.innerHeight&&(s.y=t+r-(window.pageYOffset+window.innerHeight));i<window.pageXOffset?s.x=i-window.pageXOffset:i+n>window.pageXOffset+window.innerWidth&&(s.x=i+n-(window.pageXOffset+window.innerWidth));return s},viewportSize:x,width:function(e,t){return void 0==t?b(e).width:(b(e,{width:t}),this)}}),e.attach("domx.geom",w)}),define("skylark-domx-geom/posit",["skylark-langx/langx","skylark-domx-noder","skylark-domx-styler","./geom"],function(e,t,i,n){"use strict";var r=Math.max,s=Math.abs,o=/left|center|right/,a=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,h=/%$/;function u(e,t,i){return[parseFloat(e[0])*(h.test(e[0])?t/100:1),parseFloat(e[1])*(h.test(e[1])?i/100:1)]}function d(e,t){return parseInt(i.css(e,t),10)||0}var f={fit:{left:function(e,t){var i,n=t.within,s=n.isWindow?n.scrollLeft:n.offset.left,o=n.width,a=e.left-t.collisionPosition.marginLeft,l=s-a,c=a+t.collisionWidth-o-s;t.collisionWidth>o?l>0&&c<=0?(i=e.left+l+t.collisionWidth-o-s,e.left+=l-i):e.left=c>0&&l<=0?s:l>c?s+o-t.collisionWidth:s:l>0?e.left+=l:c>0?e.left-=c:e.left=r(e.left-a,e.left)},top:function(e,t){var i,n=t.within,s=n.isWindow?n.scrollTop:n.offset.top,o=t.within.height,a=e.top-t.collisionPosition.marginTop,l=s-a,c=a+t.collisionHeight-o-s;t.collisionHeight>o?l>0&&c<=0?(i=e.top+l+t.collisionHeight-o-s,e.top+=l-i):e.top=c>0&&l<=0?s:l>c?s+o-t.collisionHeight:s:l>0?e.top+=l:c>0?e.top-=c:e.top=r(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,r=t.within,o=r.offset.left+r.scrollLeft,a=r.width,l=r.isWindow?r.scrollLeft:r.offset.left,c=e.left-t.collisionPosition.marginLeft,h=c-l,u=c+t.collisionWidth-a-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,f="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,p=-2*t.offset[0];h<0?((i=e.left+d+f+p+t.collisionWidth-a-o)<0||i<s(h))&&(e.left+=d+f+p):u>0&&((n=e.left-t.collisionPosition.marginLeft+d+f+p-l)>0||s(n)<u)&&(e.left+=d+f+p)},top:function(e,t){var i,n,r=t.within,o=r.offset.top+r.scrollTop,a=r.height,l=r.isWindow?r.scrollTop:r.offset.top,c=e.top-t.collisionPosition.marginTop,h=c-l,u=c+t.collisionHeight-a-l,d="top"===t.my[1],f=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,p="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];h<0?((n=e.top+f+p+m+t.collisionHeight-a-o)<0||n<s(h))&&(e.top+=f+p+m):u>0&&((i=e.top-t.collisionPosition.marginTop+f+p+m-l)>0||s(i)<u)&&(e.top+=f+p+m)}},flipfit:{left:function(){f.flip.left.apply(this,arguments),f.fit.left.apply(this,arguments)},top:function(){f.flip.top.apply(this,arguments),f.fit.top.apply(this,arguments)}}};return n.posit=function(h,p){var m,g,v,y,k,b,x=(p=e.extend({},p)).of,w=(A=p.within,M=A||window,T=t.isWindow(M),L=!!M&&9===M.nodeType,$=!T&&!L,E=n.marginSize(M),{element:M,isWindow:T,isDocument:L,offset:$?n.pagePosition(A):{left:0,top:0},scrollLeft:n.scrollLeft(M),scrollTop:n.scrollTop(M),width:E.width,height:E.height}),_=function(e){var t=e.isWindow||e.isDocument?"":i.css(e.element,"overflow-x"),r=e.isWindow||e.isDocument?"":i.css(e.element,"overflow-y"),s="scroll"===t||"auto"===t&&e.width<n.scrollWidth(e.element);return{width:"scroll"===r||"auto"===r&&e.height<n.scrollHeight(e.element)?n.scrollbarWidth():0,height:s?n.scrollbarWidth():0}}(w),C=(p.collision||"flip").split(" "),S={};var A,M,T,L,$,E;O=x,b=9===O.nodeType?{size:size(O),offset:{top:0,left:0}}:t.isWindow(O)?{size:n.size(O),offset:{top:n.scrollTop(O),left:n.scrollLeft(O)}}:O.preventDefault?{size:{width:0,height:0},offset:{top:O.pageY,left:O.pageX}}:{size:n.size(O),offset:n.pagePosition(O)},x.preventDefault&&(p.at="left top");var O;g=b.size.width,v=b.size.height,y=b.offset,k=e.extend({},y),e.each(["my","at"],function(){var e,t,i=(p[this]||"").split(" ");1===i.length&&(i=o.test(i[0])?i.concat(["center"]):a.test(i[0])?["center"].concat(i):["center","center"]),i[0]=o.test(i[0])?i[0]:"center",i[1]=a.test(i[1])?i[1]:"center",e=l.exec(i[0]),t=l.exec(i[1]),S[this]=[e?e[0]:0,t?t[0]:0],p[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===C.length&&(C[1]=C[0]);"right"===p.at[0]?k.left+=g:"center"===p.at[0]&&(k.left+=g/2);"bottom"===p.at[1]?k.top+=v:"center"===p.at[1]&&(k.top+=v/2);return m=u(S.at,g,v),k.left+=m[0],k.top+=m[1],function(t){var i,o,a=n.marginSize(t),l=a.width,c=a.height,h=d(t,"marginLeft"),b=d(t,"marginTop"),A=l+h+d(t,"marginRight")+_.width,M=c+b+d(t,"marginBottom")+_.height,T=e.extend({},k),L=u(S.my,a.width,a.height);"right"===p.my[0]?T.left-=l:"center"===p.my[0]&&(T.left-=l/2),"bottom"===p.my[1]?T.top-=c:"center"===p.my[1]&&(T.top-=c/2),T.left+=L[0],T.top+=L[1],i={marginLeft:h,marginTop:b},e.each(["left","top"],function(e,n){f[C[e]]&&f[C[e]][n](T,{targetWidth:g,targetHeight:v,elemWidth:l,elemHeight:c,collisionPosition:i,collisionWidth:A,collisionHeight:M,offset:[m[0]+L[0],m[1]+L[1]],my:p.my,at:p.at,within:w,elem:t})}),p.using&&(o=function(e){var i=y.left-T.left,n=i+g-l,o=y.top-T.top,a=o+v-c,h={target:{element:x,left:y.left,top:y.top,width:g,height:v},element:{element:t,left:T.left,top:T.top,width:l,height:c},horizontal:n<0?"left":i>0?"right":"center",vertical:a<0?"top":o>0?"bottom":"middle"};g<l&&s(i+n)<g&&(h.horizontal="center"),v<c&&s(o+a)<v&&(h.vertical="middle"),r(s(i),s(n))>r(s(o),s(a))?h.important="horizontal":h.important="vertical",p.using.call(this,e,h)}),n.pagePosition(t,e.extend(T,{using:o}))}(h)}}),define("skylark-domx-geom/scrollToTop",["skylark-langx/langx","skylark-domx-styler","./geom"],function(e,t,i){return i.scrollToTop=function(t,i,n,r){var s=parseInt(t.scrollTop),o=0,a=1e3*n/5,l=parseInt(i),c=setInterval(function(){++o<=a&&(t.scrollTop=(l-s)/a*o+s),o>=a+1&&(clearInterval(c),r&&e.debounce(r,1e3)())},5);return this}}),define("skylark-domx-geom/main",["skylark-langx/langx","./geom","skylark-domx-velm","skylark-domx-query","./posit","./scrollToTop"],function(e,t,i,n){return i.delegate(["borderExtents","boundingPosition","boundingRect","clientHeight","clientSize","clientWidth","contentRect","height","marginExtents","marginRect","marginSize","offsetParent","paddingExtents","pagePosition","pageRect","relativePosition","relativeRect","scrollIntoView","scrollLeft","scrollTop","pageSize","width"],t,{pageSize:"size"}),n.fn.offset=n.wraps.wrapper_value(t.pagePosition,t,t.pagePosition),n.fn.scrollTop=n.wraps.wrapper_value(t.scrollTop,t),n.fn.scrollLeft=n.wraps.wrapper_value(t.scrollLeft,t),n.fn.position=function(i){if(!this.length)return this;if(i)return i.of&&i.of.length&&((i=e.clone(i)).of=i.of[0]),this.each(function(){t.posit(this,i)});var n=this[0];return t.relativePosition(n)},n.fn.offsetParent=n.wraps.wrapper_map(t.offsetParent,t),n.fn.pageSize=n.wraps.wrapper_value(t.size,t),n.fn.width=n.wraps.wrapper_value(t.width,t,t.width),n.fn.height=n.wraps.wrapper_value(t.height,t,t.height),n.fn.clientSize=n.wraps.wrapper_value(t.clientSize,t.clientSize),["width","height"].forEach(function(e){var i=e.replace(/./,function(e){return e[0].toUpperCase()});n.fn["outer"+i]=function(i,n){if(arguments.length?"boolean"!=typeof i&&(n=i,i=!1):(i=!1,n=void 0),void 0===n){var r=this[0];if(!r)return;var s=t.size(r);if(i){var o=t.marginExtents(r);s.width=s.width+o.left+o.right,s.height=s.height+o.top+o.bottom}return"width"===e?s.width:s.height}return this.each(function(r,s){var o={},a=t.marginExtents(s);"width"===e?(o.width=n,i&&(o.width=o.width-a.left-a.right)):(o.height=n,i&&(o.height=o.height-a.top-a.bottom)),t.size(s,o)})}}),n.fn.innerWidth=n.wraps.wrapper_value(t.clientWidth,t,t.clientWidth),n.fn.innerHeight=n.wraps.wrapper_value(t.clientHeight,t,t.clientHeight),t}),define("skylark-domx-geom",["skylark-domx-geom/main"],function(e){return e}),define("skylark-domx-animates/animation",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-geom","skylark-domx-styler","skylark-domx-eventer","./animates"],function(e,t,i,n,r,s,o){var a=o.animationName,l=o.animationDuration,c=o.animationTiming,h=o.animationDelay,u=o.animationEnd,d={};return d[a]=d[l]=d[h]=d[c]="",o.animation=function(t,i,n,h,d,f){var p={};e.isPlainObject(n)&&(h=n.easing,d=n.complete,f=n.delay,n=n.duration);e.isString(n)&&(n=o.speeds[n]);void 0===n&&(n=o.speeds.normal);n/=1e3,e.isFunction(h)?(d=h,eace="swing"):h=h||"swing";f?f/=1e3:f=0;p[a]=i,p[l]=n+"s",p[c]=h,n>0&&s.on(t,u,d);return t.clientLeft,r.css(t,p),this}}),define("skylark-domx-animates/animate",["skylark-langx/langx","skylark-domx-styler","skylark-domx-eventer","./animates"],function(e,t,i,n){return n.animate=function(e,r){n.animateBaseClass&&(r=n.animateBaseClass+" "+r);return t.addClass(e,r),i.one(e,n.animationEnd,function(){t.removeClass(e,r)}),this}}),define("skylark-domx-animates/main",["./animates","./animation","./animate"],function(e){return e}),define("skylark-domx-animates",["skylark-domx-animates/main"],function(e){return e}),define("skylark-domx/animates",["skylark-domx-animates"],function(e){return e}),define("skylark-domx/browser",["skylark-domx-browser"],function(e){"use strict";return e}),define("skylark-domx-css/css",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-noder"],function(e,t,i){"use strict";var n,r=document.getElementsByTagName("head")[0],s=0,o={},a={},l=f(),c=a[l],h="cssRules"in c?"cssRules":"rules",u=c.deleteRule||c.removeRule;if(c.insertRule){var d=c.insertRule;n=function(e,t,i){d.call(this,e+"{"+t+"}",i)}}else n=c.addRule;function f(e,n){var o,l={type:"text/css"},c=s++;return(n=n||{}).media&&(l.media=n.media),o=e?i.create("link",t.mixin(l,{rel:"stylesheet",async:!1})):i.createElement("style",l),i.append(r,o),a[c]={id:c,node:o},c}function p(e,i){var n=a[e];return t.isNumber(i)?u.call(n,i):t.each(n[h],function(e,t){if(i===t)return u.call(n,e),!1}),this}function m(e,n){var r,s=a[e];return r=t.isString(n)?n:v(n),i.append(s.node,i.createTextNode(r)),this}function g(e){return e.startsWith("@")}function v(e){var i=function(e,t,i){return e&&(g(e)?i+=1:t=e+" "+t),{name:t,depth:i}},n=function(e,r,s){var o="",a=g(e);if(g(e))t.isString(r)?o=y.SPACE.repeat(s)+e.trim()+' "'+r.trim()+' ";\n':(o+=y.SPACE.repeat(s)+e.trim()+" {\n",o+=n("",r,s+1),o+=y.SPACE.repeat(s)+" }\n");else if(t.isString(r))o=y.SPACE.repeat(s)+e.trim(),o=a?o+' "'+r.trim()+' ";\n':o+": "+r.trim()+";\n";else if(t.isArray(r))for(var l=0;l<r.length;l++)o+=n(e,r[l],s);else{if(e){for(var l in o+=y.SPACE.repeat(s)+e.trim()+" {\n",r){var c=r[l];t.isString(c)&&(o+=n(l,c,s+1))}o+=y.SPACE.repeat(s)+"}\n"}for(var l in r){var c=r[l];if(!t.isString(c)){var h=i(e,l,s);o+=n(h.name,c,h.depth)}}}return o};return n("",e,0)}function y(){return y}return t.mixin(y,{SPACE:"\t",addRules:function(e){return this.addRules(l,e)},addSheetRules:m,createStyleSheet:function(e,t){t||(t={});var i=f(!1,t);e&&m(i,e);return i},deleteSheetRule:p,deleteRule:function(e){return p(l,e),this},insertRule:function(e,t,i){return this.insertSheetRule(l,e,t,i)},insertSheetRule:function(e,t,i,r){if(!t||!i)return-1;var s=a[e];return r=r||s[h].length,n.call(s,t,i,r)},loadStyleSheet:function(e,i,n,r){t.isFunction(i)&&(r=n,n=i,i={});var s=o[e];if(!s){var l=f(!0,i);s=o[e]=a[l],t.mixin(s,{state:0,url:e,deferred:new t.Deferred});var c=s.node;startTime=(new Date).getTime(),c.onload=function(){s.state=1,s.deferred.resolve(s.id)},c.onerror=function(e){s.state=-1,s.deferred.reject(e)},c.href=s.url}(n||r)&&s.deferred.promise.then(n,r);return s.id},removeStyleSheet:function(e){if(e===l)throw new Error("The default stylesheet can not be deleted");var t=a[e];return delete a[e],i.remove(t.node),this},toString:v}),e.attach("domx.css",y)}),define("skylark-domx-css/main",["./css"],function(e){return e}),define("skylark-domx-css",["skylark-domx-css/main"],function(e){return e}),define("skylark-domx/css",["skylark-domx-css"],function(e){"use strict";return e}),define("skylark-domx/data",["skylark-domx-data"],function(e){return e}),define("skylark-domx/eventer",["skylark-domx-eventer"],function(e){return e}),define("skylark-domx/finder",["skylark-domx-finder"],function(e){return e}),define("skylark-domx-fx/fx",["skylark-langx/skylark","skylark-langx/langx"],function(e,t){function i(){return i}return t.mixin(i,{off:!1,speeds:{normal:400,fast:200,slow:600}}),e.attach("domx.fx",i)}),define("skylark-domx-transits/transits",["skylark-langx/skylark","skylark-langx/langx"],function(e,t){function i(){return i}return t.mixin(i,{off:!1,speeds:{normal:400,fast:200,slow:600}}),e.attach("domx.transits",i)}),define("skylark-domx-transits/transit",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-geom","skylark-domx-styler","skylark-domx-eventer","./transits"],function(e,t,i,n,r,s,o){var a,l,c,h,u=t.normalizeCssEvent("TransitionEnd"),d=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,f=t.css3PropPrefix+"transform",p={};return p[a=t.normalizeCssProperty("transition-property")]=p[l=t.normalizeCssProperty("transition-duration")]=p[h=t.normalizeCssProperty("transition-delay")]=p[c=t.normalizeCssProperty("transition-timing-function")]="",o.transit=function(t,i,m,g,v,y){var k,b,x,w={},_=[],C="",S=this,A=!1,M=!1;e.isPlainObject(m)&&(g=m.easing,v=m.complete,y=m.delay,m=m.duration);e.isString(m)&&(m=o.speeds[m]);void 0===m&&(m=o.speeds.normal);m/=1e3,o.off&&(m=0);e.isFunction(g)?(v=g,eace="swing"):g=g||"swing";y?y/=1e3:y=0;for(k in i){var T=i[k];if(d.test(k))C+=k+"("+T+") ";else{if("scrollTop"===k&&(M=!0),"clip"==k&&e.isPlainObject(T)){if(w[k]="rect("+T.top+"px,"+T.right+"px,"+T.bottom+"px,"+T.left+"px)","auto"==r.css(t,"clip")){var L=n.size(t);r.css(t,"clip","rect(0px,"+L.width+"px,"+L.height+"px,0px)"),!0}}else w[k]=T;_.push(e.dasherize(k))}}b=u,C&&(w[f]=C,_.push(f));m>0&&(w[a]=_.join(", "),w[l]=m+"s",w[h]=y+"s",w[c]=g);x=function(e){if(A=!0,e){if(e.target!==e.currentTarget)return;s.off(e.target,b,x)}else s.off(t,b,x);r.css(t,p),v&&v.call(this)},m>0&&(s.on(t,b,x),e.debounce(function(){A||x.call(S)},1e3*(m+y)+25)());t.clientLeft,r.css(t,w),m<=0&&e.debounce(function(){A||x.call(S)},0)();M&&n.scrollToTop(t,i.scrollTop,m,v);return this}}),define("skylark-domx-fx/animate",["skylark-langx/langx","skylark-domx-transits/transit","skylark-domx-animates/animation","./fx"],function(e,t,i,n){return n.animate=function(n,r,s,o,a,l){return e.isString(r)?i(n,r,s,o,a,l):t(n,r,s,o,a,l)}}),define("skylark-domx-transits/bounce",["skylark-langx/langx","skylark-domx-geom","skylark-domx-styler","./transits","./transit"],function(e,t,i,n,r){return n.bounce=function(n,s,o){var a,l,c,h,u=s.mode,d="hide"===u,f="show"===u,p=s.direction||"up",m=s.distance,g=s.times||5,v=2*g+(f||d?1:0),y=s.duration/v,k=s.easing,b="up"===p||"down"===p?"top":"left",x="up"===p||"left"===p,w=0,_=e.Deferred,C=[];if(c=i.css(n,b),!m){var S=t.size(n);m=("top"===b?S.height:S.width)/3}h=t.relativePosition(n)[b],f&&((l={opacity:1})[b]=c,i.css(n,"opacity",0),i.css(n,b,h+(x?2*-m:2*m)),C.push(A(n,l,y,k)));d&&(m/=Math.pow(2,g-1));function A(e,t,i,n){return function(){var s=new _;return r(e,t,i,n,function(){s.resolve()}),s.promise}}for((l={})[b]=c;w<g;w++)(a={})[b]=h+(x?-m:m),C.push(A(n,a,y,k)),C.push(A(n,l,y,k)),m=d?2*m:m/2;d&&((a={opacity:0})[b]=h+(x?-1*m:m),C.push(A(n,a,y,k)));return C.push(o),C.reduce(function(e,t,i,n){return e.then(t)},_.resolve()),this}}),define("skylark-domx-transits/emulateTransitionEnd",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","./transits"],function(e,t,i,n){return n.emulateTransitionEnd=function(e,n){var r=!1;i.one(e,"transitionEnd",function(){r=!0});return setTimeout(function(){r||i.trigger(e,t.support.transition.end)},n),this}}),define("skylark-domx-transits/show",["skylark-langx/langx","skylark-domx-styler","./transits","./transit"],function(e,t,i,n){return i.show=function(i,r,s){t.show(i),r&&(!s&&e.isFunction(r)&&(s=r,r="normal"),t.css(i,"opacity",0),n(i,{opacity:1,scale:"1,1"},r,s));return this}}),define("skylark-domx-transits/hide",["skylark-langx/langx","skylark-domx-styler","./transits","./transit"],function(e,t,i,n){return i.hide=function(i,r,s){r?(!s&&e.isFunction(r)&&(s=r,r="normal"),n(i,{opacity:0,scale:"0,0"},r,function(){t.hide(i),s&&s.call(i)})):t.hide(i);return this}}),define("skylark-domx-transits/explode",["skylark-langx/langx","skylark-domx-styler","skylark-domx-geom","skylark-domx-noder","skylark-domx-query","./transits","./transit","./show","./hide"],function(e,t,i,n,r,s,o,a,l){return s.explode=function(e,n,s){t.show(e),t.css(e,"visibility","hidden");var o,a,l,c,h,u=n.pieces?Math.round(Math.sqrt(n.pieces)):3,d=u,f="show"===n.mode,p=i.pagePosition(e),m=i.marginSize(e),g=Math.ceil(m.width/d),v=Math.ceil(m.height/u),y=[];function k(){y.push(this),y.length===u*d&&(t.css(e,{visibility:"visible"}),r(y).remove(),s())}for(var b=0;b<u;b++)for(l=p.top+b*v,h=b-(u-1)/2,o=0;o<d;o++)a=p.left+o*g,c=o-(d-1)/2,r(e).clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*g,top:-b*v}).parent().addClass(n.explodeClass||"ui-effects-explode").css({position:"absolute",overflow:"hidden",width:g,height:v,left:a+(f?c*g:0),top:l+(f?h*v:0),opacity:f?0:1}).transit({left:a+(f?0:c*g),top:l+(f?0:h*v),opacity:f?1:0},n.duration||500,n.easing,k);return this}}),define("skylark-domx-transits/fade",["skylark-langx/langx","skylark-domx-styler","./transits","./transit"],function(e,t,i,n){return i.fade=function(t,i,r,s){e.isFunction(r)&&(s=r,r={});return n(t,{opacity:i},(r=r||{}).duration,r.easing,s),this}}),define("skylark-domx-transits/fadeIn",["skylark-langx/langx","skylark-domx-styler","./transits","./fade"],function(e,t,i,n){return i.fadeIn=function(e,i,r){var s=t.css(e,"opacity");s>0?t.css(e,"opacity",0):s=1;return t.show(e),n(e,s,i,r),this}}),define("skylark-domx-transits/fadeOut",["skylark-langx/langx","skylark-domx-styler","./transits","./fade"],function(e,t,i,n){return i.fadeOut=function(e,t,i){return n(e,0,t,i),this}}),define("skylark-domx-transits/fadeToggle",["skylark-langx/langx","skylark-domx-styler","./transits","./fadeIn","./fadeOut"],function(e,t,i,n,r){return i.fadeToggle=function(e,i,s,o){t.isInvisible(e)?n(e,i,s,o):r(e,i,s,o);return this}}),define("skylark-domx-transits/pulsate",["skylark-langx/langx","skylark-domx-geom","skylark-domx-styler","./transits","./transit"],function(e,t,i,n,r){return n.pulsate=function(t,n,s){var o=n.mode,a="show"===o||!o,l=a||"hide"===o,c=2*(n.times||5)+(l?1:0),h=n.duration/c,u=0,d=1;(a||i.isInvisible(t))&&(i.css(t,"opacity",0),i.show(t),u=1);var f=e.Deferred,p=[];function m(e,t,i,n){return function(){var s=new f;return r(e,t,i,n,function(){s.resolve()}),s.promise}}for(;d<c;d++)p.push(m(t,{opacity:u},h,n.easing)),u=1-u;return p.push(m(t,{opacity:u},h,n.easing)),p.push(s),p.reduce(function(e,t,i,n){return e.then(t)},f.resolve()),this}}),define("skylark-domx-transits/shake",["skylark-langx/langx","skylark-domx-geom","skylark-domx-styler","./transits","./transit"],function(e,t,i,n,r){return n.shake=function(i,n,s){var o=1,a=n.direction||"left",l=n.distance||20,c=n.times||3,h=2*c+1,u=Math.round(n.duration/h),d="up"===a||"down"===a?"top":"left",f="up"===a||"left"===a,p={},m={},g={},v={},y=e.Deferred;function k(e,t,i,n){return function(){var s=new y;return r(e,t,i,n,function(){s.resolve()}),s.promise}}for(start=t.relativePosition(i)[d],funcs=[],p[d]=start,m[d]=start+(f?-1:1)*l,g[d]=m[d]+(f?1:-1)*l*2,v[d]=g[d]+(f?-1:1)*l*2,funcs.push(k(i,m,u,n.easing));o<c;o++)funcs.push(k(i,g,u,n.easing)),funcs.push(k(i,v,u,n.easing));return funcs.push(k(i,p,u/2,n.easing)),funcs.push(s),funcs.reduce(function(e,t,i,n){return e.then(t)},y.resolve()),this}}),define("skylark-domx-transits/slide",["skylark-langx/langx","skylark-domx-styler","./transits","./transit"],function(e,t,i,n){return i.slide=function(r,s,o){e.isFunction(s)&&(o=s,s={});var a=(s=s||{}).direction||"down",l="up"===a||"left"===a,c="up"===a||"down"===a,h=s.duration||i.speeds.normal,u=t.css(r,"position");if(l){if(t.isInvisible(r))return this}else t.show(r),t.css(r,{position:"absolute",visibility:"hidden"});if(c){var d=t.css(r,"margin-top"),f=t.css(r,"margin-bottom"),p=t.css(r,"padding-top"),m=t.css(r,"padding-bottom"),g=t.css(r,"height");l?(t.css(r,{visibility:"visible",overflow:"hidden",height:g,marginTop:d,marginBottom:f,paddingTop:p,paddingBottom:m}),n(r,{height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},{duration:h,queue:!1,complete:function(){t.hide(r),t.css(r,{visibility:"visible",overflow:"hidden",height:g,marginTop:d,marginBottom:f,paddingTop:p,paddingBottom:m}),o&&o.apply(r)}})):(t.css(r,{position:u,visibility:"visible",overflow:"hidden",height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0}),n(r,{height:g,marginTop:d,marginBottom:f,paddingTop:p,paddingBottom:m},{duration:h,complete:function(){o&&o.apply(r)}}))}else{var v=t.css(r,"margin-left"),y=t.css(r,"margin-right"),k=t.css(r,"padding-left"),b=t.css(r,"padding-right"),x=t.css(r,"width");l?(t.css(r,{visibility:"visible",overflow:"hidden",width:x,marginLeft:v,marginRight:y,paddingLeft:k,paddingRight:b}),n(r,{width:0,marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0},{duration:h,queue:!1,complete:function(){t.hide(r),t.css(r,{visibility:"visible",overflow:"hidden",width:x,marginLeft:v,marginRight:y,paddingLeft:k,paddingRight:b}),o&&o.apply(r)}})):(t.css(r,{position:u,visibility:"visible",overflow:"hidden",width:0,marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0}),n(r,{width:x,marginLeft:v,marginRight:y,paddingLeft:k,paddingRight:b},{duration:h,complete:function(){o&&o.apply(r)}}))}return this}}),define("skylark-domx-transits/slideDown",["./transits","./slide"],function(e,t){return e.slideDown=function(e,i,n){return t(e,{direction:"down",duration:i},n)}}),define("skylark-domx-transits/slideUp",["./transits","./slide"],function(e,t){return e.slideUp=function(e,i,n){return t(e,{direction:"up",duration:i},n)}}),define("skylark-domx-transits/slideToggle",["skylark-langx/langx","skylark-domx-geom","./transits","./slideDown","./slideUp"],function(e,t,i,n,r){return i.slideToggle=function(e,i,s){0==t.height(e)?n(e,i,s):r(e,i,s);return this}}),define("skylark-domx-transits/throb",["skylark-langx/langx","skylark-domx-styler","skylark-domx-noder","./transits","./transit"],function(e,t,i,n,r){return n.throb=function(e,n){(n=n||{}).text,n.style;var r,s=n.time,o=n.callback,a=i.createElement("div",{class:n.className||"throbber"}),l=function(){r&&(clearTimeout(r),r=null),a&&(i.remove(a),a=null)};n.style&&t.css(a,n.style);var c=n.content||'<span class="throb"></span>';i.html(a,c),e.appendChild(a),s&&(r=setTimeout(function(){l(),o&&o()},s));return{throbber:a,remove:l,update:function(e){e&&e.text&&a&&(textNode.nodeValue=e.text)}}}}),define("skylark-domx-transits/toggle",["skylark-langx/langx","skylark-domx-styler","./transits","./show","./hide"],function(e,t,i,n,r){return i.toggle=function(e,i,s){t.isInvisible(e)?n(e,i,s):r(e,i,s);return this}}),define("skylark-domx-transits/main",["./transits","skylark-domx-velm","skylark-domx-query","./transit","./bounce","./emulateTransitionEnd","./explode","./fadeIn","./fadeOut","./fade","./fadeToggle","./hide","./pulsate","./shake","./show","./slide","./slideDown","./slideToggle","./slideUp","./throb","./toggle"],function(e,t,i){return t.delegate(["transit","emulateTransitionEnd","fadeIn","fadeOut","fade","fadeToggle","hide","scrollToTop","slideDown","slideToggle","slideUp","show","toggle"],e),i.fn.hide=i.wraps.wrapper_every_act(e.hide,e),i.fn.transit=i.wraps.wrapper_every_act(e.transit,e),i.fn.emulateTransitionEnd=i.wraps.wrapper_every_act(e.emulateTransitionEnd,e),i.fn.show=i.wraps.wrapper_every_act(e.show,e),i.fn.hide=i.wraps.wrapper_every_act(e.hide,e),i.fn.toogle=i.wraps.wrapper_every_act(e.toogle,e),i.fn.fadeTo=i.wraps.wrapper_every_act(e.fadeTo,e),i.fn.fadeIn=i.wraps.wrapper_every_act(e.fadeIn,e),i.fn.fadeOut=i.wraps.wrapper_every_act(e.fadeOut,e),i.fn.fadeToggle=i.wraps.wrapper_every_act(e.fadeToggle,e),i.fn.slideDown=i.wraps.wrapper_every_act(e.slideDown,e),i.fn.slideToggle=i.wraps.wrapper_every_act(e.slideToggle,e),i.fn.slideUp=i.wraps.wrapper_every_act(e.slideUp,e),e}),define("skylark-domx-transits",["skylark-domx-transits/main"],function(e){return e}),define("skylark-domx-fx/bounce",["skylark-domx-transits","./fx"],function(e,t){return t.bounce=e.bounce}),define("skylark-domx-fx/emulateTransitionEnd",["skylark-domx-transits","./fx"],function(e,t){return t.emulateTransitionEnd=e.emulateTransitionEnd}),define("skylark-domx-fx/explode",["skylark-domx-transits","./fx"],function(e,t){return t.explode=e.explode}),define("skylark-domx-fx/fadeIn",["skylark-domx-transits","./fx"],function(e,t){return t.fadeIn=e.fadeIn}),define("skylark-domx-fx/fadeOut",["skylark-domx-transits","./fx"],function(e,t){return t.fadeOut=e.fadeOut}),define("skylark-domx-fx/fade",["skylark-domx-transits","./fx"],function(e,t){return t.fade=e.fade}),define("skylark-domx-fx/fadeToggle",["skylark-domx-transits","./fx"],function(e,t){return t.fadeToggle=e.fadeToggle}),define("skylark-domx-fx/hide",["skylark-domx-transits","./fx"],function(e,t){return t.hide=e.hide}),define("skylark-domx-fx/pulsate",["skylark-domx-transits","./fx"],function(e,t){return t.pulsate=e.pulsate}),define("skylark-domx-fx/shake",["skylark-domx-transits","./fx"],function(e,t){return t.shake=e.shake}),define("skylark-domx-fx/show",["skylark-domx-transits","./fx"],function(e,t){return t.show=e.show}),define("skylark-domx-fx/slide",["skylark-domx-transits","./fx"],function(e,t){return t.slide=function(e,i,n){langx.isFunction(i)&&(n=i,i={});var r=(i=i||{}).direction||"down",s="up"===r||"left"===r,o="up"===r||"down"===r,a=i.duration||t.speeds.normal,l=styler.css(e,"position");if(s){if(styler.isInvisible(e))return this}else styler.show(e),styler.css(e,{position:"absolute",visibility:"hidden"});if(o){var c=styler.css(e,"margin-top"),h=styler.css(e,"margin-bottom"),u=styler.css(e,"padding-top"),d=styler.css(e,"padding-bottom"),f=styler.css(e,"height");s?(styler.css(e,{visibility:"visible",overflow:"hidden",height:f,marginTop:c,marginBottom:h,paddingTop:u,paddingBottom:d}),animate(e,{height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0},{duration:a,queue:!1,complete:function(){styler.hide(e),styler.css(e,{visibility:"visible",overflow:"hidden",height:f,marginTop:c,marginBottom:h,paddingTop:u,paddingBottom:d}),n&&n.apply(e)}})):(styler.css(e,{position:l,visibility:"visible",overflow:"hidden",height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0}),animate(e,{height:f,marginTop:c,marginBottom:h,paddingTop:u,paddingBottom:d},{duration:a,complete:function(){n&&n.apply(e)}}))}else{var p=styler.css(e,"margin-left"),m=styler.css(e,"margin-right"),g=styler.css(e,"padding-left"),v=styler.css(e,"padding-right"),y=styler.css(e,"width");s?(styler.css(e,{visibility:"visible",overflow:"hidden",width:y,marginLeft:p,marginRight:m,paddingLeft:g,paddingRight:v}),animate(e,{width:0,marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0},{duration:a,queue:!1,complete:function(){styler.hide(e),styler.css(e,{visibility:"visible",overflow:"hidden",width:y,marginLeft:p,marginRight:m,paddingLeft:g,paddingRight:v}),n&&n.apply(e)}})):(styler.css(e,{position:l,visibility:"visible",overflow:"hidden",width:0,marginLeft:0,marginRight:0,paddingLeft:0,paddingRight:0}),animate(e,{width:y,marginLeft:p,marginRight:m,paddingLeft:g,paddingRight:v},{duration:a,complete:function(){n&&n.apply(e)}}))}return this}}),define("skylark-domx-fx/slideDown",["skylark-domx-transits","./fx"],function(e,t){return t.slideDown=function(e,t,i){return slide(e,{direction:"down",duration:t},i)}}),define("skylark-domx-fx/slideToggle",["skylark-domx-transits","./fx"],function(e,t){return t.slideToggle=function(e,t,i){0==geom.height(e)?slideDown(e,t,i):slideUp(e,t,i);return this}}),define("skylark-domx-fx/slideUp",["skylark-domx-transits","./fx"],function(e,t){return t.slideUp=function(e,t,i){return slide(e,{direction:"up",duration:t},i)}}),define("skylark-domx-fx/throb",["skylark-domx-transits","./fx"],function(e,t){return t.throb=function(e,t){(t=t||{}).text,t.style;var i,n=t.time,r=t.callback,s=noder.createElement("div",{class:t.className||"throbber"}),o=function(){i&&(clearTimeout(i),i=null),s&&(noder.remove(s),s=null)};t.style&&styler.css(s,t.style);var a=t.content||'<span class="throb"></span>';noder.html(s,a),e.appendChild(s),n&&(i=setTimeout(function(){o(),r&&r()},n));return{throbber:s,remove:o,update:function(e){e&&e.text&&s&&(textNode.nodeValue=e.text)}}}}),define("skylark-domx-fx/toggle",["skylark-domx-transits","./fx"],function(e,t){return t.toggle=function(e,t,i){styler.isInvisible(e)?show(e,t,i):hide(e,t,i);return this}}),define("skylark-domx-fx/main",["./fx","./animate","./bounce","./emulateTransitionEnd","./explode","./fadeIn","./fadeOut","./fade","./fadeToggle","./hide","./pulsate","./shake","./show","./slide","./slideDown","./slideToggle","./slideUp","./throb","./toggle"],function(e){return e}),define("skylark-domx-fx",["skylark-domx-fx/main"],function(e){return e}),define("skylark-domx/fx",["skylark-domx-fx"],function(e){return e}),define("skylark-domx/geom",["skylark-domx-geom"],function(e){return e}),define("skylark-domx-iframes/iframes",["skylark-langx-ns"],function(e){return e.attach("domx.iframes")}),define("skylark-domx-iframes/create",["skylark-domx-noder","./iframes"],function(e,t){"use strict";return t.create=function(t,i){let n={},r={};(t=t||{}).id&&(n.id=t.id);t.url&&(n.src=t.url);t.style&&(n.style=t.style);t.onload&&(n.onload=t.onload);t.onerror&&(n.onload=t.onerror);t.className&&(n.className=t.className);t.sandbox&&(r.sandbox=t.sandbox);t.frameBorder&&(r.frameBorder=t.frameBorder);t.name&&(r.name=t.name);let s=e.create("iframe",n,r,i);t.contentWindowName&&(s.contentWindow.name=t.contentWindowName);return s}}),define("skylark-domx-iframes/hook-sizing",["skylark-domx-eventer","./iframes"],function(e,t){"use strict";return t.hookSizing=function(t){e.on(window,"message",function(e){e||(e=window.event);t.style.height=1*e.data.height+2+"px"})}}),define("skylark-domx-iframes/load-real",["skylark-domx-noder","skylark-domx-data","./iframes","./hook-sizing"],function(e,t,i,n){return i.loadReal=function(i,n){n=n||{};var r=e.clone(i),s=n.url;s||(s=t.attr(r,n.urlAttrName||"data-url"));s=s.split("&")[0],t.prop(r,"src",s),t.prop(r,"_src",s),e.replace(r,ifame)}}),define("skylark-domx-iframes/lazy-load",["skylark-domx-eventer","skylark-domx-data","skylark-domx-geom","./iframes","./load-real"],function(e,t,i,n,r){var s;function o(){s||(s=[],e.on(window,"scroll",function(){!function(){var e=0,t=[];for(e=0;e<s.length;e++)i.inview(s[e],400)&&t.unshift({iframe:s[e],i:e});for(e=t.length-1;e>=0;e--)s.splice(t[e].i,1),r(t[e].iframe)}()}))}return n.lazyLoad=function(e,i){o(),(i=i||{}).url&&t.attr(e,i.urlAttrName||"data-url",i.url);i.holdingUrl&&t.prop(e,"src",i.holdingUrl);s.push(e)}}),define("skylark-langx-urls/getQuery",["./urls"],function(e){"use strict";return e.getQuery=function(e){for(var t={},i=e.split("&"),n=i.length,r=[],s=0;s<n;s++){r=i[s].split("=",2);try{r[0]=decodeURIComponent(r[0]),r[1]=decodeURIComponent(r[1])}catch(e){}void 0===t[r[0]]?t[r[0]]=r[1]:t[r[0]]+=","+r[1]}return t}}),define("skylark-domx-iframes/replace",["skylark-langx-urls/getQuery","skylark-domx-noder","skylark-domx-geom","skylark-domx-styler","./iframes","./create","./load-real","./lazy-load"],function(e,t,i,n,r,s,o,a){"use strict";return r.replace=function(r,l){l=l||{};s({className:r.className,id:r.id,style:{border:"1px solid #aaa"}});var c=l.url||r.href,h=l.size||e(r.search),u=l.holdingUrl;n.css(iframe,"width",h.width||"100%"),n.css(iframe,"minHeight",h.height||"300px"),h.height&&n.css(iframe,"maxHeight",h.height);i.inview(r,100)?o(iframe,{url:c}):a(iframe,{url:c,holdingUrl:u});t.replace(iframe,r)}}),define("skylark-domx-iframes/main",["./iframes","./create","./lazy-load","./load-real","./replace"],function(){}),define("skylark-domx-iframes",["skylark-domx-iframes/main"],function(e){return e}),define("skylark-domx/iframes",["skylark-domx-iframes"],function(e){return e}),define("skylark-domx-lists/lists",["skylark-langx-ns","skylark-domx-query","skylark-domx-data","skylark-domx-geom","skylark-domx-finder","skylark-domx-noder","skylark-domx-styler"],function(e){return e.attach("domx.lists")}),define("skylark-domx-lists/multitier",["skylark-langx","skylark-domx-query","./lists"],function(e,t,i){"use strict";return i.multitier=function(i,n){var r=(n=e.mixin({classes:{active:"active",collapse:"collapse",in:"in"},selectors:{item:"li",sublist:"ul",hasSublist:":has(ul)",handler:" > a"},mode:"",levels:2,togglable:!1,multiExpand:!1},n,!0)).selectors.item,s=t(r,i),o=n.classes.active,a="."+o,l=(n.mode,n.selectors.sublist),c=n.togglable,h=n.multiExpand,u=n.selectors.handler,d=n.classes.collapse,f=n.classes.in,p=n.show||function(e){e.addClass(f)},m=n.hide||function(e){e.addClass(d).removeClass(f)};n.toggle;s.find(u).on("click.multitier",function(e){e.preventDefault();let i,s=t(this).closest(r);h||(i=s.siblings().removeClass(o).children(l))&&m(i);let a=s.hasClass(o);a&&!c||(i=s.children(n.selectors.sublist),a?(s.removeClass(o),m(i)):(s.addClass(o),p(i)))}),m(s.has(l).children(l)),p(s.filter(a).has(l).children(l))}}),define("skylark-domx-lists/main",["./lists","./multitier"],function(e){return e}),define("skylark-domx-lists",["skylark-domx-lists/main"],function(e){return e}),define("skylark-domx/lists",["skylark-domx-lists"],function(e){return e}),define("skylark-domx/noder",["skylark-domx-noder"],function(e){return e}),define("skylark-domx/styler",["skylark-domx-styler"],function(e){return e}),define("skylark-domx/query",["skylark-domx-query","./data","./eventer","./fx","./geom","./styler"],function(e){return e}),define("skylark-domx-transforms/transforms",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-data","skylark-domx-styler"],function(e,t,i,n,r){var s=i.normalizeCssProperty("transform");function o(e,t){return e>0&&e>-t?t:e<0&&e<t?-t:0}function a(e,t){var i,n,o,a,l,c=(i=t.radian,n=t.y,o=t.x,a=Math.cos(i),l=Math.sin(i),{M11:a*n,M12:-l*o,M21:l*n,M22:a*o});r.css(e,s,"matrix("+c.M11.toFixed(16)+","+c.M21.toFixed(16)+","+c.M12.toFixed(16)+","+c.M22.toFixed(16)+", 0, 0)")}function l(e,t){if(!t)return(t=n.data(e,"transform")||{}).radian=t.radian||0,t.x=t.x||1,t.y=t.y||1,t.zoom=t.zoom||1,t;n.data(e,"transform",t)}var c={vertical:function(e){e.radian=Math.PI-e.radian,e.y*=-1},horizontal:function(e){e.radian=Math.PI-e.radian,e.x*=-1},rotate:function(e,t){e.radian=t*Math.PI/180},left:function(e){e.radian-=Math.PI/2},right:function(e){e.radian+=Math.PI/2},scale:function(e,t){var i=o(e.y,t),n=o(e.x,t);i&&n&&(e.y+=i,e.x+=n)},zoomin:function(e){c.scale(e,.1)},zoomout:function(e){c.scale(e,-.1)}};function h(){return h}return["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout"].forEach(function(e){var i;h[e]=(i=c[e],function(){var e=t.makeArray(arguments),n=e.shift(),r=l(n);e.unshift(r),i.apply(this,e),a(n,r),l(n,r)})}),t.mixin(h,{reset:function(e){var t={x:1,y:1,radian:0};a(e,t),l(e,t)},matrix:function(e){var t="";do{var i=r.css(e,"transform");i&&"none"!==i&&(t=i+" "+t)}while(e=e.parentElement);if(window.DOMMatrix)return new DOMMatrix(t);if(window.WebKitCSSMatrix)return new WebKitCSSMatrix(t);if(window.CSSMatrix)return new CSSMatrix(t)}}),e.attach("domx.transforms",h)}),define("skylark-domx-transforms/main",["./transforms"],function(e){return e}),define("skylark-domx-transforms",["skylark-domx-transforms/main"],function(e){return e}),define("skylark-domx/transforms",["skylark-domx-transforms"],function(e){return e}),define("skylark-domx/transits",["skylark-domx-transits"],function(e){return e}),define("skylark-domx/velm",["skylark-domx-velm","./data","./eventer","./fx","./geom","./styler"],function(e){return e}),define("skylark-domx/main",["./animates","./browser","./css","./data","./eventer","./finder","./fx","./geom","./iframes","./lists","./noder","./query","./styler","./transforms","./transits","./velm"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m){return{animates:e,browser:t,css:i,data:n,eventer:r,finder:s,geom:a,lists:c,noder:h,iframes:l,query:u,styler:d,transforms:f,transits:p,velm:m}}),define("skylark-domx",["skylark-domx/main"],function(e){return e}),define("skylark-domx-files/files",["skylark-langx/skylark"],function(e){var t=function(){return t};return e.attach("domx.files",t)}),define("skylark-io-diskfs/diskfs",["skylark-langx/skylark"],function(e){var t=function(){return t};return e.attach("storages.diskfs",t)}),define("skylark-io-diskfs/webentry",["skylark-langx/arrays","skylark-langx/Deferred","./diskfs"],function(e,t,i){var n=Array.prototype.concat,r=function(){function i(e,i){var n=new t,s=function(e){n.reject(e)};if(i=i||"",e.isFile)e.file(function(e){e.relativePath=i,n.resolve(e)},s);else if(e.isDirectory){var o=e.createReader();o.readEntries(function(t){r(t,i+e.name+"/").then(function(e){n.resolve(e)}).catch(s)},s)}else n.resolve([]);return n.promise}function r(r,s){return t.all(e.map(r,function(e){return i(e,s)})).then(function(){return n.apply([],arguments)})}return{one:i,all:r}}();return i.webentry=r}),define("skylark-domx-files/dropzone",["skylark-langx/arrays","skylark-langx/Deferred","skylark-domx-styler","skylark-domx-eventer","skylark-domx-velm","skylark-domx-query","skylark-io-diskfs/webentry","./files"],function(e,t,i,n,r,s,o,a){function l(t,r){var s=(r=r||{}).hoverClass||"hover",a=r.dropped,l=0;return n.on(t,"dragenter",function(e){e.dataTransfer&&e.dataTransfer.types.indexOf("Files")>-1&&(n.stop(e),l++,i.addClass(t,s))}),n.on(t,"dragover",function(e){e.dataTransfer&&e.dataTransfer.types.indexOf("Files")>-1&&n.stop(e)}),n.on(t,"dragleave",function(e){e.dataTransfer&&e.dataTransfer.types.indexOf("Files")>-1&&0==--l&&i.removeClass(t,s)}),n.on(t,"drop",function(r){if(r.dataTransfer&&r.dataTransfer.types.indexOf("Files")>-1&&(i.removeClass(t,s),n.stop(r),a)){var l=r.dataTransfer.items;l&&l.length&&(l[0].webkitGetAsEntry||l[0].getAsEntry)?o.all(e.map(l,function(e){return e.webkitGetAsEntry?e.webkitGetAsEntry():e.getAsEntry()})).then(a):a(r.dataTransfer.files)}}),this}return a.dropzone=l,r.delegate(["dropzone"],a),s.fn.dropzone=s.wraps.wrapper_every_act(a.dropzone,a),l}),define("skylark-domx-files/pastezone",["skylark-langx/objects","skylark-domx-eventer","skylark-domx-velm","skylark-domx-query","./files"],function(e,t,i,n,r){function s(i,n){(n=n||{}).hoverClass;var r=n.pasted;return t.on(i,"paste",function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,n=[];i&&i.length&&e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&n.push(i)}),r&&n.length&&r(n)}),this}return r.pastezone=s,i.delegate(["pastezone"],r),n.fn.pastezone=n.wraps.wrapper_every_act(r.pastezone,r),s}),define("skylark-io-diskfs/select",["./diskfs"],function(e){var t,i=1/0;return e.select=function(e){var n=(e=e||{}).directory||!1,r=e.multiple||!1,s=e.accept||"",o=e.title||"",a=e.picked;if(!t){var l=t=document.createElement("input");l.type="file",l.style.position="fixed",l.style.left=0,l.style.top=0,l.style.opacity=.001,document.body.appendChild(l)}function c(e){for(var t=e.length;t--;)e[t].size>i&&e.splice(t,1);a(e)}t.onchange=function(e){var i=e.target.webkitEntries||e.target.entries;i&&i.length?webentry.all(i).then(function(e){c(e)}):c(Array.prototype.slice.call(e.target.files)),t.value="",t.onchange=null},t.multiple=r,t.accept=s,t.title=o,t.webkitdirectory=n,t.click()}}),define("skylark-domx-files/picker",["skylark-langx/objects","skylark-domx-eventer","skylark-domx-velm","skylark-domx-query","skylark-io-diskfs/select","./files"],function(e,t,i,n,r,s){function o(e,i){return t.on(e,"click",function(e){e.preventDefault(),r(i)}),this}return s.picker=o,i.delegate(["picker"],s),n.fn.picker=n.wraps.wrapper_every_act(s.picker,s),o}),define("skylark-domx-files/main",["./files","./dropzone","./pastezone","./picker"],function(e){return e}),define("skylark-domx-files",["skylark-domx-files/main"],function(e){return e}),define("skylark-domx-images/images",["skylark-langx/skylark"],function(e){return e.attach("domx.images",function e(){return e})}),define("skylark-domx-images/isCompleted",["./images"],function(e){return e.isCompleted=function(e){return e.complete&&void 0!==e.naturalWidth}}),define("skylark-domx-images/isLoaded",["./images"],function(e){return e.isLoaded=function(e){return e.complete&&0!==e.naturalWidth}}),define("skylark-domx-images/watch",["skylark-langx/langx","skylark-domx-eventer","./images","./isCompleted","./isLoaded"],function(e,t,i,n,r){return i.watch=function(i){e.isArray(i)||(i=[i]);var s=i.length,o=0,a=0,l=0,c=new e.Deferred;function h(){c.resolve({total:s,successed:a,failered:l,imgs:i})}function u(e,t){o++,t?a++:l++,c.progress({img:e,isLoaded:t,progressed:o,total:s,imgs:i}),o==s&&h()}return e.defer(function(){i.length?i.forEach(function(e){n(e)?u(e,r(e)):t.on(e,{load:function(){u(e,!0)},error:function(){u(e,!1)}})}):h()}),c.promise.totalCount=s,c.promise}}),define("skylark-domx-images/loaded",["skylark-domx-finder","./images","./watch"],function(e,t,i){return t.loaded=function(t,n){var r=[];function s(e){var t=/url\((['"])?(.*?)\1\)/gi.exec(styler.css(e,"background-image")),i=t&&t[2];if(i){var n=new Image;n.src=i,r.push(n)}}if(n=n||{},"IMG"==t.nodeName)r.push(t);else{for(var o=e.findAll(t,"img"),a=0;a<o.length;a++)r.push(o[a]);if(!0===n.background)s(t);else if("string"==typeof n.background){var l=e.findAll(t,n.background);for(a=0;a<l.length;a++)s(l[a])}}return i(r)}}),define("skylark-domx-images/preload",["skylark-langx/langx","./images","./watch"],function(e,t,i){return t.preload=function(t,n){e.isString(t)&&(t=[t]);var r=[];return t.forEach(function(e){var t=new Image;t.src=e,r.push(t)}),i(r)}}),define("skylark-domx-images/transform",["skylark-domx-transforms","./images"],function(e,t){function i(e,t){}return["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout","reset"].forEach(function(t){i[t]=e[t]}),t.transform=i}),define("skylark-domx-images/viewer",["skylark-langx/langx","skylark-domx-noder","skylark-domx-geom","skylark-domx-styler","skylark-domx-transforms","./images"],function(e,t,i,n,r,s){return s.viewer=function(s,o){var a,l={},c=i.clientSize(s),h=o.loaded;o.failered;function u(){n.css(a,{top:(c.height-a.offsetHeight)/2+"px",left:(c.width-a.offsetWidth)/2+"px"}),r.reset(a),n.css(a,{visibility:"visible"}),h&&h()}function d(){}function f(e){a.style.visibility="hidden",a.src=e}!function(){"relative"!=(l=n.css(s,["position","overflow"])).position&&"absolute"!=l.position&&n.css(s,"position","relative");n.css(s,"overflow","hidden"),a=new Image,n.css(a,{position:"absolute",border:0,padding:0,margin:0,width:"auto",height:"auto",visibility:"hidden"}),a.onload=u,a.onerror=d,t.append(s,a),o.url&&f(o.url)}();var p={load:f,dispose:function(){t.remove(a),n.css(s,l),a=a.onload=a.onerror=null}};return["vertical","horizontal","rotate","left","right","scale","zoom","zoomin","zoomout","reset"].forEach(function(t){p[t]=function(){var i=e.makeArray(arguments);i.unshift(a),r[t].apply(null,i)}}),p}}),define("skylark-domx-images/main",["skylark-domx-query","skylark-domx-velm","./images","./isCompleted","./isLoaded","./loaded","./preload","./transform","./viewer","./watch"],function(e,t,i,n,r,s,o,a,l,c){return t.delegate(["imageIsCompleted","imageIsLoaded","imageLoaded","imageViewer"],i,{imageIsCompleted:"isCompleted",imageIsLoaded:"isLoaded",imageLoaded:"loaded",imageViewer:"viewer"}),i}),define("skylark-domx-images",["skylark-domx-images/main"],function(e){return e}),define("skylark-domx-plugins-base/plugins",["skylark-langx-ns"],function(e){"use strict";return e.attach("domx.plugins",{pluginKlasses:{},shortcuts:{}})}),define("skylark-domx-plugins-colors/colors",["skylark-domx-plugins-base/plugins"],function(e){"use strict";return e.colores={}}),define("skylark-domx-plugins-base/plugin",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects","skylark-langx-funcs","skylark-langx-events/Emitter","skylark-domx-noder","skylark-domx-data","skylark-domx-eventer","skylark-domx-finder","skylark-domx-geom","skylark-domx-styler","skylark-domx-fx","skylark-domx-query","skylark-domx-velm","./plugins"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p){"use strict";Array.prototype.slice,Array.prototype.concat;function m(e){return e.hasOwnProperty("superclass")?e.superclass:Object.getPrototypeOf(e)}var g=r.inherit({klassName:"Plugin",_construct:function(e,t){this._elm=e,this._initOptions(t)},_initOptions:function(e){var t=this.constructor,n=t.cache=t.hasOwnProperty("cache")?t.cache:{},r=n.defaults;if(!r){var s=[];do{if(s.unshift(t),t===g)break;t=m(t)}while(t);r=n.defaults={};for(var o=0;o<s.length;o++)(t=s[o]).prototype.hasOwnProperty("options")&&i.mixin(r,t.prototype.options,!0),t.hasOwnProperty("options")&&i.mixin(r,t.options,!0)}return Object.defineProperty(this,"options",{value:i.mixin({},r,e,!0)}),this.options},destroy:function(){this._destroy(),this.unlistenTo(),o.removeData(this._elm,this.pluginName)},_destroy:n.noop,_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},elmx:function(e){return e?f(e):(this._velm||(this._velm=f(this._elm)),this._velm)},$:function(e){return e?d(e,this._elm):(this._$elm||(this._$elm=d(this._elm)),this._$elm)},option:function(e,t){var n,r,s,o=e;if(0===arguments.length)return i.mixin({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(r=o[e]=i.mixin({},this.options[e]),s=0;s<n.length-1;s++)r[n[s]]=r[n[s]]||{},r=r[n[s]];if(e=n.pop(),1===arguments.length)return void 0===r[e]?null:r[e];r[e]=t}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=t}return this._setOptions(o),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,this},getUID:function(e){e=e||"plugin";do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},elm:function(){return this._elm}});return p.Plugin=g}),define("skylark-domx-plugins-base/instantiate",["skylark-domx-data","./plugins","./plugin"],function(e,t,i){"use strict";var n=t.pluginKlasses;function r(t,i,r){var s=i.split(":"),o=s[1];i=s[0],o||(o=i);var a=e.data(t,o);if("instance"===r)return a;if("destroy"===r){if(!a)throw new Error("The plugin instance is not existed");a.destroy(),a=void 0}else if(a)r&&a.reset(r);else{if(void 0!==r&&"object"!=typeof r)throw new Error("The options must be a plain object");var l=n[i];a=new l(t,r),e.data(t,o,a)}return a}return i.instantiate=function(e,t){return r(e,this.prototype.pluginName,t)},t.instantiate=r}),define("skylark-domx-plugins-base/shortcutter",["skylark-langx-types","./plugins","./instantiate"],function(e,t,i){"use strict";var n=Array.prototype.slice;return t.shortcutter=function(t,r){return function(s,o){var a=i(s,t,"instance");if("instance"===o)return a||null;if(!a&&(a=i(s,t,"object"==typeof o&&o||{}),"string"!=typeof o))return this;if(o){var l=n.call(arguments,1);if(r)return r.apply(a,l);if("string"==typeof o){var c=o;if(!a)throw new Error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+c+"'");if(!e.isFunction(a[c])||"_"===c.charAt(0))throw new Error("no such method '"+c+"' for "+t+" plugin instance");l=n.call(l,1);var h=a[c].apply(a,l);return h==a&&(h=void 0),h}}}}}),define("skylark-domx-plugins-base/register",["skylark-langx-types","skylark-domx-query","skylark-domx-velm","./plugins","./shortcutter"],function(e,t,i,n,r){"use strict";var s=Array.prototype.slice,o=n.pluginKlasses,a=n.shortcuts;return n.register=function(n,l,c,h){var u=n.prototype.pluginName;if(o[u]=n,l){c&&e.isFunction(c)&&(h=c,c=null),c&&(u=u+":"+c);var d=a[l]=r(u,h);t.fn[l]=function(e){var t=this;if(this.length||"instance"!==e){var i=s.call(arguments);this.each(function(){var e=s.call(i);e.unshift(this);var n=d.apply(void 0,e);void 0!==n&&(t=n)})}else t=void 0;return t},i.partial(l,function(e){var t=d(this._elm,e);return void 0===t&&(t=this),t})}}}),define("skylark-domx-plugins-base/main",["skylark-domx-query","skylark-domx-velm","./plugins","./instantiate","./plugin","./register","./shortcutter"],function(e,t,i,n,r,s,o){"use strict";var a=Array.prototype.slice;return e.fn.plugin=function(e,t){var i,r=a.call(arguments,1),s=this;return this.each(function(){i=n.apply(s,[this,e].concat(r))}),i},t.partial("plugin",function(e,t){var i=a.call(arguments,1);return n.apply(this,[this._elm,e].concat(i))}),i}),define("skylark-domx-plugins-base",["skylark-domx-plugins-base/main"],function(e){return e}),define("skylark-domx-plugins-popups/popups",["skylark-langx-ns","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base/plugins"],function(e,t,i,n){var r=[];return n.popups={around:function(e){var i=t.size(popup),n=i.width,r=i.height,s=t.height(e),o=e.ownerDocument,a=o.documentElement,l=a.clientWidth+t.scrollLeft(o),c=a.clientHeight+t.scrollTop(o),h=t.pagePosition(e),u=h.left,d=h.top;return d+=s,u-=Math.min(u,u+n>l&&l>n?Math.abs(u+n-l):0),{top:d-=Math.min(d,d+r>c&&c>r?Math.abs(r+s-0):0),bottom:h.bottom,left:u,right:h.right,width:h.width,height:h.height}},open:function(e,t){t.around;let n=i(e);n.show().removeAttr("aria-hidden").position(t.position),r.push({popup:n[0]})},close:function(e){var t=0;if(e){e=i(e)[0];for(var n=r.length-1;n>=0;n--)if(r[n].popup==e){t=r.length-n;break}}else t=r.length;for(var n=0;n<t;n++){var s=r.pop(),o=i(s.popup);o.hide().attr("aria-hidden","true")}}}}),define("skylark-domx-plugins-popups/calc-offset",["skylark-domx-geom","./popups"],function(e,t){return t.calcOffset=function(t,i){var n=e.size(t),r=n.width,s=n.height,o=e.height(i),a=t.ownerDocument,l=a.documentElement,c=l.clientWidth+e.scrollLeft(a),h=l.clientHeight+e.scrollTop(a),u=e.pagePosition(i),d=u.left,f=u.top;return f+=o,d-=Math.min(d,d+r>c&&c>r?Math.abs(d+r-c):0),{top:f-=Math.min(f,f+s>h&&h>s?Math.abs(s+o-0):0),bottom:u.bottom,left:d,right:u.right,width:u.width,height:u.height}}}),define("skylark-domx-plugins-popups/dropdown",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups"],function(e,t,i,n,r,s,o,a){"use strict";var l=".dropdown-backdrop",c='[data-toggle="dropdown"]',h=o.Plugin.inherit({klassName:"Dropdown",pluginName:"lark.popups.dropdown",options:{selectors:{toggler:'[data-toggle="dropdown"],.dropdown-menu'}},_construct:function(e,t){this.overrided(e,t);var i=this.$element=s(this._elm);i.on("click.dropdown",this.toggle),i.on("keydown.dropdown",this.options.selectors.toggler,this.keydown)},toggle:function(e){var t=s(this);if(!t.is(".disabled, :disabled")){var n=u(t),r=n.hasClass("open");if(d(),!r){"ontouchstart"in document.documentElement&&!n.closest(".navbar-nav").length&&s(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(s(this)).on("click",d);var o={relatedTarget:this};if(n.trigger(e=i.create("show.dropdown",o)),e.isDefaultPrevented())return;t.trigger("focus").attr("aria-expanded","true"),n.toggleClass("open").trigger(i.create("shown.dropdown",o))}return!1}},keydown:function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var t=s(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var i=u(t),n=i.hasClass("open");if(!n&&27!=e.which||n&&27==e.which)return 27==e.which&&i.find(c).trigger("focus"),t.trigger("click");var r=i.find(".dropdown-menu li:not(.disabled):visible a");if(r.length){var o=r.index(e.target);38==e.which&&o>0&&o--,40==e.which&&o<r.length-1&&o++,~o||(o=0),r.eq(o).trigger("focus")}}}}});function u(e){var t=e.attr("data-target");t||(t=(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""));var i=t&&s(t);return i&&i.length?i:e.parent()}function d(e){e&&3===e.which||(s(l).remove(),s(c).each(function(){var t=s(this),r=u(t),o={relatedTarget:this};r.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&n.contains(r[0],e.target)||(r.trigger(e=i.create("hide.dropdown",o)),e.isDefaultPrevented()||(t.attr("aria-expanded","false"),r.removeClass("open").trigger(i.create("hidden.dropdown",o)))))}))}return s(document).on("click.dropdown.data-api",d).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}),o.register(h),a.Dropdown=h}),define("skylark-domx-plugins-popups/comboBox",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups","./dropdown"],function(e,t,i,n,r,s,o,a,l){var c=o.Plugin.inherit({klassName:"ComboBox",pluginName:"lark.popups.combobox",options:{autoResizeMenu:!0,filterOnKeypress:!1,showOptionsOnKeypress:!1,filter:function(e,t,i){var n=0;i.$dropMenu.find(".empty-indicator").remove(),e.each(function(e){var i=s(this),r=s(this).text().trim();i.removeClass(),r===t?(i.addClass("text-success"),n++):r.substr(0,t.length)===t?(i.addClass("text-info"),n++):i.addClass("hidden")}),0===n&&i.$dropMenu.append('<li class="empty-indicator text-muted"><em>No Matches</em></li>')}},_construct:function(t,i){this.overrided(t,i),this.$element=this.$(),this.$dropMenu=this.$element.find(".dropdown-menu"),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.$button.plugin("lark.popups.dropdown"),this.$inputGroupBtn=this.$element.find(".input-group-btn"),this.$element.on("click.lark","a",e.proxy(this.itemclicked,this)),this.$element.on("change.lark","input",e.proxy(this.inputchanged,this)),this.$element.on("shown.bs.dropdown",e.proxy(this.menuShown,this)),this.$input.on("keyup.lark",e.proxy(this.keypress,this)),this.setDefaultSelection();var n=this.$dropMenu.children("li");0===n.length&&this.$button.addClass("disabled"),this.options.filterOnKeypress&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this)},_destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){s(this).attr("value",s(this).val())}),this.$element[0].outerHTML},doSelect:function(e){void 0!==e[0]?(this.$element.find("li.selected:first").removeClass("selected"),this.$selectedItem=e,this.$selectedItem.addClass("selected"),this.$input.val(this.$selectedItem.text().trim())):(this.$selectedItem=null,this.$element.find("li.selected:first").removeClass("selected"))},clearSelection:function(){this.$selectedItem=null,this.$input.val(""),this.$dropMenu.find("li").removeClass("selected")},menuShown:function(){this.options.autoResizeMenu&&this.resizeMenu()},resizeMenu:function(){var e=this.$element.outerWidth();this.$dropMenu.outerWidth(e)},selectedItem:function(){var t=this.$selectedItem,i={};if(t){var n=this.$selectedItem.text().trim();i=e.mixin({text:n},this.$selectedItem.data())}else i={text:this.$input.val().trim(),notFound:!0};return i},selectByText:function(e){var t=s([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||s(this).text()||"").trim().toLowerCase()===(e||"").trim().toLowerCase())return t=s(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e="li[data-selected=true]:first",t=this.$element.find(e);t.length>0&&(this.selectBySelector(e),t.removeData("selected"),t.removeAttr("data-selected"))},enable:function(){this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(e){this.$selectedItem=s(e.target).parent(),this.$input.val(this.$selectedItem.text().trim()).trigger("change",{synthetic:!0});var t=this.selectedItem();this.$element.trigger("changed.lark",t),e.preventDefault(),this.$element.find(".dropdown-toggle").focus()},keypress:function(e){var t=38===e.which||40===e.which||37===e.which||39===e.which;if(this.options.showOptionsOnKeypress&&!this.$inputGroupBtn.hasClass("open")&&(this.$button.plugin("lark.popups.dropdown").toggle(),this.$input.focus()),13===e.which){e.preventDefault();var i=this.$dropMenu.find("li.selected").text().trim();i.length>0?this.selectByText(i):this.selectByText(this.$input.val()),this.$inputGroupBtn.removeClass("open")}else if(27===e.which)e.preventDefault(),this.clearSelection(),this.$inputGroupBtn.removeClass("open");else if(this.options.showOptionsOnKeypress&&(40===e.which||38===e.which)){e.preventDefault();var n=this.$dropMenu.find("li.selected");n.length>0&&(n=40===e.which?n.next(":not(.hidden)"):n.prev(":not(.hidden)")),0===n.length&&(n=40===e.which?this.$dropMenu.find("li:not(.hidden):first"):this.$dropMenu.find("li:not(.hidden):last")),this.doSelect(n)}this.options.filterOnKeypress&&!t&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this),this.previousKeyPress=e.which},inputchanged:function(e,t){var i=s(e.target).val();if(t&&t.synthetic)this.selectByText(i);else{this.selectByText(i);var n=this.selectedItem();0===n.text.length&&(n={text:i}),this.$element.trigger("changed.lark",n)}}});return c.prototype.getValue=c.prototype.selectedItem,o.register(c),a.ComboBox=c}),define("skylark-domx-plugins-popups/select-list",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups","./dropdown"],function(e,t,i,n,r,s,o,a,l){var c=o.Plugin.inherit({klassName:"SelectList",pluginName:"lark.popups.selectlist",options:{emptyLabelHTML:'<li data-value=""><a href="#">No items</a></li>'},_construct:function(t,i){this.overrided(t,i),this.$element=this.$(),this.$button=this.$element.find(".btn.dropdown-toggle"),this.$hiddenField=this.$element.find(".hidden-field"),this.$label=this.$element.find(".selected-label"),this.$dropdownMenu=this.$element.find(".dropdown-menu"),this.$button.plugin("lark.popups.dropdown"),this.$element.on("click.selectlist",".dropdown-menu a",e.proxy(this.itemClicked,this)),this.setDefaultSelection(),"auto"!==this.options.resize&&"auto"!==this.$element.attr("data-resize")||this.resize();var n=this.$dropdownMenu.children("li");0===n.length&&(this.disable(),this.doSelect(s(this.options.emptyLabelHTML))),this.$element.on("shown.dropdown",function(){var e=s(this);s(document).on("keypress.selectlist",function(t){var i=String.fromCharCode(t.which);e.find("li").each(function(e,t){if(s(t).text().charAt(0).toLowerCase()===i)return s(t).children("a").focus(),!1})})}),this.$element.on("hide.dropdown",function(){s(document).off("keypress.selectlist")})},_destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},doSelect:function(e){var t;this.$selectedItem=t=e,this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.html(s(this.$selectedItem.children()[0]).html()),this.$element.find("li").each(function(){t.is(s(this))?s(this).attr("data-selected",!0):s(this).removeData("selected").removeAttr("data-selected")})},itemClicked:function(e){this.$element.trigger("clicked.selectlist",this.$selectedItem),e.preventDefault(),s(e.currentTarget).parent("li").is(".disabled, :disabled")||(s(e.target).parent().is(this.$selectedItem)||this.itemChanged(e),this.$element.find(".dropdown-toggle").focus())},itemChanged:function(e){this.doSelect(s(e.target).closest("li"));var t=this.selectedItem();this.$element.trigger("changed.selectlist",t)},resize:function(){var e=0,t=0,i=s("<div/>").addClass("selectlist-sizer");Boolean(s(document).find("html").hasClass("fuelux"))?s(document.body).append(i):s(".fuelux:first").append(i),i.append(this.$element.clone()),this.$element.find("a").each(function(){i.find(".selected-label").text(s(this).text()),t=i.find(".selectlist").outerWidth(),(t+=i.find(".sr-only").outerWidth())>e&&(e=t)}),e<=1||(this.$button.css("width",e),this.$dropdownMenu.css("width",e),i.remove())},selectedItem:function(){var t=this.$selectedItem.text();return e.mixin({text:t},this.$selectedItem.data())},selectByText:function(e){var t=s([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||s(this).text()||"").toLowerCase()===(e||"").toLowerCase())return t=s(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e=this.$element.find("li[data-selected=true]").eq(0);0===e.length&&(e=this.$element.find("li").has("a").eq(0)),this.doSelect(e)},enable:function(){this.$element.removeClass("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$button.addClass("disabled")}});return c.prototype.getValue=c.prototype.selectedItem,o.register(c),a.SelectList=c}),define("skylark-domx-plugins-popups/main",["./popups","./calc-offset","./dropdown","./comboBox","./select-list"],function(e){return e}),define("skylark-domx-plugins-popups",["skylark-domx-plugins-popups/main"],function(e){return e}),define("skylark-graphics-colors/colors",["skylark-langx-ns"],function(e){return e.attach("graphics.colors",{})}),define("skylark-graphics-colors/_names",[],function(){return{aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"}}),define("skylark-graphics-colors/_hexNames",["./_names"],function(e){return function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}(e)}),define("skylark-graphics-colors/_conversion",["skylark-langx-strings","./_names"],function(e,t){var i=Math,n=i.round,r=i.min,s=i.max;i.random;function o(e){return 1==e.length?"0"+e:""+e}function a(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=r(t,s(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}var l,c,h,u=(c="[\\s|\\(]+("+(l="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+l+")[,|\\s]+("+l+")\\s*\\)?",h="[\\s|\\(]+("+l+")[,|\\s]+("+l+")[,|\\s]+("+l+")[,|\\s]+("+l+")\\s*\\)?",{rgb:new RegExp("rgb"+c),rgba:new RegExp("rgba"+h),hsl:new RegExp("hsl"+c),hsla:new RegExp("hsla"+h),hsv:new RegExp("hsv"+c),hsva:new RegExp("hsva"+h),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex3s:/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6s:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8s:/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function d(e){return parseInt(e,16)}return{bound01:a,rgbToRgb:function(e,t,i){return{r:255*a(e,255),g:255*a(t,255),b:255*a(i,255)}},rgbToHsl:function(e,t,i){e=a(e,255),t=a(t,255),i=a(i,255);var n,o,l=s(e,t,i),c=r(e,t,i),h=(l+c)/2;if(l==c)n=o=0;else{var u=l-c;switch(o=h>.5?u/(2-l-c):u/(l+c),l){case e:n=(t-i)/u+(t<i?6:0);break;case t:n=(i-e)/u+2;break;case i:n=(e-t)/u+4}n/=6}return{h:n,s:o,l:h}},hslToRgb:function(e,t,i){var n,r,s;function o(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}if(e=a(e,360),t=a(t,100),i=a(i,100),0===t)n=r=s=i;else{var l=i<.5?i*(1+t):i+t-i*t,c=2*i-l;n=o(c,l,e+1/3),r=o(c,l,e),s=o(c,l,e-1/3)}return{r:255*n,g:255*r,b:255*s}},rgbToHsv:function(e,t,i){e=a(e,255),t=a(t,255),i=a(i,255);var n,o,l=s(e,t,i),c=r(e,t,i),h=l,u=l-c;if(o=0===l?0:u/l,l==c)n=0;else{switch(l){case e:n=(t-i)/u+(t<i?6:0);break;case t:n=(i-e)/u+2;break;case i:n=(e-t)/u+4}n/=6}return{h:n,s:o,v:h}},hsvToRgb:function(e,t,n){e=6*a(e,360),t=a(t,100),n=a(n,100);var r=i.floor(e),s=e-r,o=n*(1-t),l=n*(1-s*t),c=n*(1-(1-s)*t),h=r%6;return{r:255*[n,l,o,o,c,n][h],g:255*[c,n,n,l,o,o][h],b:255*[o,o,c,n,n,l][h]}},rgbToHex:function(e,t,i,r){var s=[o(n(e).toString(16)),o(n(t).toString(16)),o(n(i).toString(16))];if(r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1))return s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0);return s.join("")},rgbaToHex:function(e,t,i,r){return[o((s=r,Math.round(255*parseFloat(s)).toString(16))),o(n(e).toString(16)),o(n(t).toString(16)),o(n(i).toString(16))].join("");var s},hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},strToRgb:function(i){i=e.trim(i).toLowerCase();var n,r=!1;if(t[i])i=t[i],r=!0;else if("transparent"==i)return{r:0,g:0,b:0,a:0,format:"name"};if(n=u.rgb.exec(i))return{r:n[1],g:n[2],b:n[3]};if(n=u.rgba.exec(i))return{r:n[1],g:n[2],b:n[3],a:n[4]};if(n=u.hsl.exec(i))return{h:n[1],s:n[2],l:n[3]};if(n=u.hsla.exec(i))return{h:n[1],s:n[2],l:n[3],a:n[4]};if(n=u.hsv.exec(i))return{h:n[1],s:n[2],v:n[3]};if(n=u.hsva.exec(i))return{h:n[1],s:n[2],v:n[3],a:n[4]};if((n=u.hex8.exec(i))||(n=u.hex8s.exec(i)))return{a:(s=n[1],d(s)/255),r:d(n[2]),g:d(n[3]),b:d(n[4]),format:r?"name":"hex8"};var s;if((n=u.hex6.exec(i))||(n=u.hex6s.exec(i)))return{r:d(n[1]),g:d(n[2]),b:d(n[3]),format:r?"name":"hex"};if((n=u.hex3.exec(i))||(n=u.hex3s.exec(i)))return{r:d(n[1]+""+n[1]),g:d(n[2]+""+n[2]),b:d(n[3]+""+n[3]),format:r?"name":"hex"};return!1}}}),define("skylark-graphics-colors/Color",["skylark-langx-types","skylark-langx-klass","./colors","./_names","./_hexNames","./_conversion"],function(e,t,i,n,r,s){var o=Math,a=o.round,l=o.min,c=o.max,h=o.random;function u(e){return l(1,c(0,e))}var d=t({init:function(t,i){i=i||{},e.isString(t)&&(t=s.hexToRgb(t)),this._r=t.r,this._g=t.g,this._b=t.b,this._a=e.isDefined(t.a)?t.a:1,this._roundA=a(1e3*this._a)/1e3,this._format=i.format||t.format,this._gradientType=i.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b))},isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},setAlpha:function(e){return this._a=function(e){e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1);return e}(e),this._roundA=a(1e3*this._a)/1e3,this},toHsv:function(){var e=s.rgbToHsv(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=s.rgbToHsv(this._r,this._g,this._b),t=a(360*e.h),i=a(100*e.s),n=a(100*e.v);return 1==this._a?"hsv("+t+", "+i+"%, "+n+"%)":"hsva("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=s.rgbToHsl(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=s.rgbToHsl(this._r,this._g,this._b),t=a(360*e.h),i=a(100*e.s),n=a(100*e.l);return 1==this._a?"hsl("+t+", "+i+"%, "+n+"%)":"hsla("+t+", "+i+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return s.rgbToHex(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return s.rgbaToHex(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(100*s.bound01(this._r,255))+"%",g:a(100*s.bound01(this._g,255))+"%",b:a(100*s.bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+a(100*s.bound01(this._r,255))+"%, "+a(100*s.bound01(this._g,255))+"%, "+a(100*s.bound01(this._b,255))+"%)":"rgba("+a(100*s.bound01(this._r,255))+"%, "+a(100*s.bound01(this._g,255))+"%, "+a(100*s.bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(r[s.rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+s.rgbaToHex(this._r,this._g,this._b,this._a),i=t,n=this._gradientType?"GradientType = 1, ":"";if(e){var r=d(e);i=r.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+i+")"},toNumber:function(){return this._r<<16^this._g<<8^this._b<<0},toString:function(e){var t=!!e;e=e||this._format;var i=!1,n=this._a<1&&this._a>=0,r=!t&&n&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e);return r?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(i=this.toRgbString()),"prgb"===e&&(i=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(i=this.toHexString()),"hex3"===e&&(i=this.toHexString(!0)),"hex8"===e&&(i=this.toHex8String()),"name"===e&&(i=this.toName()),"hsl"===e&&(i=this.toHslString()),"hsv"===e&&(i=this.toHsvString()),i||this.toHexString())},lighten:function(e){e=0===e?0:e||10;var t=this.toHsl();return t.l+=e/100,t.l=u(t.l),d.fromHsl(t)},brighten:function(e){e=0===e?0:e||10;var t=this.toRgb();return t.r=c(0,l(255,t.r-a(-e/100*255))),t.g=c(0,l(255,t.g-a(-e/100*255))),t.b=c(0,l(255,t.b-a(-e/100*255))),new d(t)},darken:function(e){e=0===e?0:e||10;var t=this.toHsl();return t.l-=e/100,t.l=u(t.l),d.fromHsl(t)},desaturate:function(e){e=0===e?0:e||10;var t=this.toHsl();return t.s-=e/100,t.s=u(t.s),d.fromHsl(t)},saturate:function(e){e=0===e?0:e||10;var t=this.toHsl();return t.s+=e/100,t.s=u(t.s),d.fromHsl(t)},greyscale:function(){return this.desaturate(100)},spin:function(e){var t=this.toHsl(),i=(a(t.h)+e)%360;return t.h=i<0?360+i:i,d.fromHsl(t)},analogous:function(e,t){e=e||6,t=t||30;var i=this.toHsl(),n=360/t,r=[this];for(i.h=(i.h-(n*e>>1)+720)%360;--e;)i.h=(i.h+n)%360,r.push(d.fromHsl(i));return r},complement:function(){var e=this.toHsl();return e.h=(e.h+180)%360,d.fromHsl(e)},monochromatic:function(e){e=e||6;for(var t=this.toHsv(),i=t.h,n=t.s,r=t.v,s=[],o=1/e;e--;)s.push(d.fromHsv({h:i,s:n,v:r})),r=(r+o)%1;return s},splitcomplement:function(){var e=this.toHsl(),t=e.h;return[this,d.fromHsl({h:(t+72)%360,s:e.s,l:e.l}),d.fromHsl({h:(t+216)%360,s:e.s,l:e.l})]},triad:function(){var e=this.toHsl(),t=e.h;return[this,d.fromHsl({h:(t+120)%360,s:e.s,l:e.l}),d.fromHsl({h:(t+240)%360,s:e.s,l:e.l})]},tetrad:function(){var e=this.toHsl(),t=e.h;return[this,d.fromHsl({h:(t+90)%360,s:e.s,l:e.l}),d.fromHsl({h:(t+180)%360,s:e.s,l:e.l}),d.fromHsl({h:(t+270)%360,s:e.s,l:e.l})]},mix:function(e,t){t=0===t?0:t||50;var i,n=this.toRgb(),r=e.toRgb(),s=t/100,o=2*s-1,a=r.a-n.a,l=1-(i=((i=o*a==-1?o:(o+a)/(1+o*a))+1)/2),c={r:r.r*i+n.r*l,g:r.g*i+n.g*l,b:r.b*i+n.b*l,a:r.a*s+n.a*(1-s)};return new d(c)},isValid:function(){return!0}});function f(e){return e<=1&&(e=100*e+"%"),e}return d.equals=function(e,t){return!(!e||!t)&&(e=d.parse(e),t=d.parse(t),e.toRgbString()==t.toRgbString())},d.random=function(){return d.fromRatio({r:h(),g:h(),b:h()})},d.fromRgba=function(e,t,i,n){return new d({r:e,g:t,b:i,a:n})},d.fromRgb=function(e,t,i){return new d({r:e,g:t,b:i})},d.fromHsl=function(e,t,i,n){var r=s.hslToRgb(e,t,i);return new d(r)},d.fromHsv=function(e,t,i,n){var r=s.hsvToRgb(e,t,i);return new d(r)},d.parse=function(e){if(e instanceof d)return e;var t={r:0,g:0,b:0},i=1,n=!1,r=!1;return"string"==typeof e&&(e=s.strToRgb(e)),"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=s.rgbToRgb(e.r,e.g,e.b),n=!0,r="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=f(e.s),e.v=f(e.v),t=s.hsvToRgb(e.h,e.s,e.v),n=!0,r="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=f(e.s),e.l=f(e.l),t=s.hslToRgb(e.h,e.s,e.l),n=!0,r="hsl"),e.hasOwnProperty("a")&&(i=e.a)),new d({ok:n,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i},{format:e.format||r})},i.Color=d}),define("skylark-domx-plugins-colors/helper",["skylark-domx-browser","skylark-domx-query","skylark-graphics-colors/Color"],function(e,t,i){e.isIE;return{paletteTemplate:function(e,n,r,s){for(var o=[],a=0;a<e.length;a++){var l=e[a];if(l){var c=i.parse(l),h=c.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";h+=i.equals(n,l)?" sp-thumb-active":"";var u=c.toString(s.preferredFormat||"rgb"),d="background-color:"+c.toRgbString();o.push('<span title="'+u+'" data-color="'+c.toRgbString()+'" class="'+h+'"><span class="sp-thumb-inner" style="'+d+';" /></span>')}else{o.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="sp-clear-display"></span>').attr("title",s.texts.noColorSelectedText)).html())}}return"<div class='sp-cf "+r+"'>"+o.join("")+"</div>"}}}),define("skylark-domx-plugins-colors/Indicator",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins-base"],function(e,t,i,n,r,s,o,a){var l=a.Plugin.inherit({klassName:"Indicator",pluginName:"lark.colors.indicator",options:{},_construct:function(e,t){a.Plugin.prototype._construct.call(this,e,t),this.listenTo(this.elmx(),"mousedown",e=>{this._start(e)})},_move:function(e){if(this._dragging){var t=this._offset,i=e.pageX,n=e.pageY,r=this._maxWidth,s=this._maxHeight,o=Math.max(0,Math.min(i-t.left,r)),a=Math.max(0,Math.min(n-t.top,s)),l=this.options.onmove;l&&l.apply(this._elm,[o,a,e])}},_start:function(e){var t=e.which?3==e.which:2==e.button;if(!t&&!this._dragging){var i=this.options.onstart;if(!i||!1!==i.apply(this._elm,arguments)){this._dragging=!0;var n=this.$();this._maxHeight=n.height(),this._maxWidth=n.width(),this._offset=n.offset();var s=this.$(document);this.listenTo(s,{mousemove:e=>{this._move(e)},mouseup:e=>{this._stop(e)}}),s.find("body").addClass("sp-dragging"),this._move(e),r.stop(e)}}},_stop:function(e){var t=this.$(document);this._dragging&&(this.unlistenTo(t),t.find("body").removeClass("sp-dragging"),onstop=this.options.onstop,onstop&&this._delay(function(){onstop.apply(this._elm,arguments)})),this._dragging=!1}});return a.register(l),l}),define("skylark-domx-plugins-colors/ColorPicker",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins-base","skylark-graphics-colors/Color","./colors","./helper","./Indicator"],function(e,t,i,n,r,s,o,a,l,c,h,u){"use strict";var d=a.Plugin.inherit({klassName:"ColorPicker",pluginName:"lark.colors.picker",options:{selectors:{dragger:".sp-color",dragHelper:".sp-dragger",slider:".sp-hue",slideHelper:".sp-slider",alphaSliderInner:".sp-alpha-inner",alphaSlider:".sp-alpha",alphaSlideHelper:".sp-alpha-handle",textInput:".sp-input",initialColorContainer:".sp-initial",cancelButton:".sp-cancel",clearButton:".sp-clear",chooseButton:".sp-choose"},draggingClass:"sp-dragging",texts:{cancelText:"cancel",chooseText:"choose",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected"},states:{showInput:!1,allowEmpty:!1,showButtons:!0,showInitial:!1,showAlpha:!1},preferredFormat:"hex",color:!1},_drawInitial:function(){var e=this.options;if(this.stating("showInitial")){var t=this._initialColor,i=this.current();this.$initialColorContainer.html(h.paletteTemplate([t,i],i,"sp-palette-row-initial",e))}},_updateHelperLocations:function(){var e=this._currentSaturation,t=this._currentValue;if(this.stating("allowEmpty")&&this._isEmpty)this.$alphaSlideHelper.hide(),this.$slideHelper.hide(),this.$dragHelper.hide();else{this.$alphaSlideHelper.show(),this.$slideHelper.show(),this.$dragHelper.show();var i=e*this._dragWidth,n=this._dragHeight-t*this._dragHeight;i=Math.max(-this._dragHelperHeight,Math.min(this._dragWidth-this._dragHelperHeight,i-this._dragHelperHeight)),n=Math.max(-this._dragHelperHeight,Math.min(this._dragHeight-this._dragHelperHeight,n-this._dragHelperHeight)),this.$dragHelper.css({top:n+"px",left:i+"px"});var r=this._currentAlpha*this._alphaWidth;this.$alphaSlideHelper.css({left:r-this._alphaSlideHelperWidth/2+"px"});var s=this._currentHue*this._slideHeight;this.$slideHelper.css({top:s-this._slideHelperHeight+"px"})}},_updateOriginalInput:function(e){var t=this.current();l.equals(t,this._colorOnShow);t&&(t.toString(this._currentPreferredFormat),this.emit("picked",t))},_updateUI:function(){this.options;this._dragWidth=this.$dragger.width(),this._dragHeight=this.$dragger.height(),this._dragHelperHeight=this.$dragHelper.height(),this._slideWidth=this.$slider.width(),this._slideHeight=this.$slider.height(),this._slideHelperHeight=this.$slideHelper.height(),this._alphaWidth=this.$alphaSlider.width(),this._alphaSlideHelperWidth=this.$alphaSlideHelper.width(),this.$textInput.removeClass("sp-validation-error"),this._updateHelperLocations();var e=l.parse({h:360*this._currentHue,s:1,v:1});this.$dragger.css("background-color",e.toHexString());var i=this._currentPreferredFormat;this._currentAlpha<1&&(0!==this._currentAlpha||"name"!==i)&&("hex"!==i&&"hex3"!==i&&"hex6"!==i&&"name"!==i||(i="rgb"));var n=this.current(),r="";if(!n&&this.stating("allowEmpty"));else{var s=n.toHexString();n.toRgbString();if(this.stating("showAlpha")){var o=n.toRgb();o.a=0;var a=l.parse(o).toRgbString(),c="linear-gradient(left, "+a+", "+s+")";t.isIE?this.$alphaSliderInner.css("filter",l.parse(a).toFilter({gradientType:1},s)):(this.$alphaSliderInner.css("background","-webkit-"+c),this.$alphaSliderInner.css("background","-moz-"+c),this.$alphaSliderInner.css("background","-ms-"+c),this.$alphaSliderInner.css("background","linear-gradient(to right, "+a+", "+s+")"))}r=n.toString(i)}this.stating("showInput")&&this.$textInput.val(r),this.stating("showPalette")&&this._drawPalette(),this._drawInitial()},_applyOptions:function(){var e=this.options;this._states={allowEmpty:e.states.allowEmpty,showInput:e.states.showInput,showAlpha:e.states.showAlpha,showButtons:e.states.showButtons,showInitial:e.states.showInitial},this._applyStates(),this.reflow()},_construct:function(e,t){a.Plugin.prototype._construct.call(this,e,t);var i=this.$el=this.$(),n=this.options,r=(n.theme,this.$dragger=i.find(n.selectors.dragger),this.$dragHelper=i.find(n.selectors.dragHelper),this.$slider=i.find(n.selectors.slider),this.$slideHelper=i.find(n.selectors.slideHelper),this.$alphaSliderInner=i.find(n.selectors.alphaSliderInner),this.$alphaSlider=i.find(n.selectors.alphaSlider),this.$alphaSlideHelper=i.find(n.selectors.alphaSlideHelper),this.$textInput=i.find(n.selectors.textInput),this.$initialColorContainer=i.find(n.selectors.initialColorContainer),this.$cancelButton=i.find(n.selectors.cancelButton),this.$clearButton=i.find(n.selectors.clearButton),this.$chooseButton=i.find(n.selectors.chooseButton),this._initialColor=n.color);this._currentPreferredFormat=n.preferredFormat,this._isEmpty=!r;this._init()},_init:function(){var e=this,i=this.options;function n(){(e._dragHeight<=0||e._dragWidth<=0||e._slideHeight<=0)&&e.reflow(),e._isDragging=!0,e.$el.addClass(e.options.draggingClass),e._shiftMovementDirection=null}function o(){e._isDragging=!1,e.$el.removeClass(e.options.draggingClass)}function a(){e._updateOriginalInput(),e._updateUI()}function c(){var t=e.$textInput.val();if(null!==t&&""!==t||!e._allowEmpty){var i=l.parse(t);i.isValid()?(e.current(i),a()):e.$textInput.addClass("sp-validation-error")}else e.current(null),a()}this._applyOptions(),this.$textInput.change(c),this.$textInput.on("paste",function(){setTimeout(c,1)}),this.$textInput.keydown(function(e){13==e.keyCode&&c()}),this.$cancelButton.text(i.texts.cancelText),this.listenTo(this.$cancelButton,"click",function(t){s.stop(t),e.revert(),e.emit("canceled")}),this.$clearButton.attr("title",i.texts.clearText),this.listenTo(this.$clearButton,"click",function(t){s.stop(t),e._isEmpty=!0,a()}),this.$chooseButton.text(i.texts.chooseText),this.listenTo(this.$chooseButton,"click",function(t){s.stop(t),e._updateOriginalInput(!0),e.emit("choosed")}),this.$alphaSlider.plugin("domx.indicator",{onmove:function(t,i,n){e._currentAlpha=t/e._alphaWidth,e._isEmpty=!1,n.shiftKey&&(e._currentAlpha=Math.round(10*e._currentAlpha)/10),a()},onstart:n,onstop:o}),this.$slider.plugin("domx.indicator",{onmove:function(t,i,n){e._currentHue=parseFloat(i/e._slideHeight),e._isEmpty=!1,e.stating("showAlpha")||(e._currentAlpha=1),a()},onstart:n,onstop:o}),this.$dragger.plugin("domx.indicator",{onmove:function(t,i,n){if(n.shiftKey){if(!e._shiftMovementDirection){var r=e._currentSaturation*e._dragWidth,s=e._dragHeight-e._currentValue*e._dragHeight,o=Math.abs(t-r)>Math.abs(i-s);e._shiftMovementDirection=o?"x":"y"}}else e._shiftMovementDirection=null;var l=!e._shiftMovementDirection||"x"===e._shiftMovementDirection,c=!e._shiftMovementDirection||"y"===e._shiftMovementDirection;l&&(e._currentSaturation=parseFloat(t/e._dragWidth)),c&&(e._currentValue=parseFloat((e._dragHeight-i)/e._dragHeight)),e._isEmpty=!1,e.stating("showAlpha")||(e._currentAlpha=1),a()},onstart:n,onstop:o}),this.current(this._initialColor),e._updateUI();var h=t.isIE?"mousedown.ColorPicker":"click.ColorPicker touchstart.ColorPicker";this.$initialColorContainer.on(h,".sp-thumb-el:nth-child(1)",{ignore:!0},function(t){t.data&&t.data.ignore,e.current(r(t.target).closest(".sp-thumb-el").data("color")),a();return!1})},revert:function(){this.current(this._initialColor,!0),this._updateOriginalInput(!0)},current:function(e){if(void 0===e)return this._allowEmpty&&this._isEmpty?null:l.parse({h:360*this._currentHue,s:this._currentSaturation,v:this._currentValue,a:Math.round(1e3*this._currentAlpha)/1e3});var t,i;l.equals(e,this.current())?this._updateUI():(!e&&this.stating("allowEmpty")?this._isEmpty=!0:(this._isEmpty=!1,t=l.parse(e),i=t.toHsv(),this._currentHue=i.h%360/360,this._currentSaturation=i.s,this._currentValue=i.v,this._currentAlpha=i.a),this._updateUI())},_applyStates:function(){var e=this._states;this.$el.toggleClass("sp-input-disabled",!e.showInput).toggleClass("sp-clear-enabled",!!e.allowEmpty).toggleClass("sp-alpha-enabled",e.showAlpha).toggleClass("sp-buttons-disabled",!e.showButtons).toggleClass("sp-initial-disabled",!e.showInitial),e.allowEmpty||this.$clearButton.hide(),this._dragWidth=this.$dragger.width(),this._dragHeight=this.$dragger.height(),this._dragHelperHeight=this.$dragHelper.height(),this._slideWidth=this.$slider.width(),this._slideHeight=this.$slider.height(),this._slideHelperHeight=this.$slideHelper.height(),this._alphaWidth=this.$alphaSlider.width(),this._alphaSlideHelperWidth=this.$alphaSlideHelper.width()},stating:function(e,t){if(void 0===t)return this._states[e];this._states[e]=t,this._applyStates()},reflow:function(){this._updateHelperLocations()}});return a.register(d),c.ColorPicker=d}),define("skylark-domx-plugins-colors/ColorPalette",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-fx","skylark-domx-plugins-base","skylark-graphics-colors/Color","./colors","./helper"],function(e,t,i,n,r,s,o,a,l,c,h,u,d){"use strict";t.noop;var f=c.Plugin.inherit({klassName:"ColorPalette",pluginName:"lark.colors.palette",options:{selectors:{},texts:{},states:{showSelectionPalette:!0},palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[]},_addColorToSelectionPalette:function(e){if(this.stating("showSelectionPalette")){var i=h.parse(e).toRgbString();if(!this._paletteLookup[i]&&-1===t.inArray(i,this._selectionPalette))for(this._selectionPalette.push(i);this._selectionPalette.length>this._maxSelectionSize;)this._selectionPalette.shift()}},getUniqueSelectionPalette:function(){var e=[],t=this.options;if(this.stating("showPalette"))for(var i=0;i<this._selectionPalette.length;i++){var n=h.parse(this._selectionPalette[i]).toRgbString();this._paletteLookup[n]||e.push(this._selectionPalette[i])}return e.reverse().slice(0,t.maxSelectionSize)},_drawPalette:function(){var e=this.options,i=this.current(),n=t.map(this._paletteArray,function(t,n){return d.paletteTemplate(t,i,"sp-palette-row sp-palette-row-"+n,e)});this._selectionPalette&&n.push(d.paletteTemplate(this.getUniqueSelectionPalette(),i,"sp-palette-row sp-palette-row-selection",e)),this.$el.html(n.join(""))},_updateUI:function(){this._drawPalette()},_applyOptions:function(){var e=this.options;if(this._states={showSelectionPalette:e.showSelectionPalette},e.palette)for(var i=this._palette=e.palette.slice(0),n=this._paletteArray=t.isArray(i[0])?i:[i],r=this._paletteLookup={},s=0;s<n.length;s++)for(var o=0;o<n[s].length;o++){var a=h.parse(n[s][o]).toRgbString();r[a]=!0}this._applyStates()},_construct:function(e,t){c.Plugin.prototype._construct.call(this,e,t),this.$el=this.$(),this._init()},_init:function(){var e=this,t=this.options;this._initialColor=t.color,this._selectionPalette=t.selectionPalette.slice(0);this._applyOptions(),this._initialColor?(this.current(this._initialColor),e._addColorToSelectionPalette(this._initialColor)):this._updateUI();var n=i.isIE?"mousedown.palette":"click.palette touchstart.palette";this.$el.on(n,".sp-thumb-el",function(t){return e.current(s(t.target).closest(".sp-thumb-el").data("color")),e.emit("selected",e.current()),!1})},_applyStates:function(){},stating:function(e,t){if(void 0===t)return this._states[e];this._states[e]=t,this._applyStates()},reflow:function(){this._drawPalette()},current:function(e){if(void 0===e)return this._current;this._current=e,this._updateUI()}});return c.register(f),u.ColorPalette=f}),define("skylark-domx-plugins-colors/ColorPane",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-fx","skylark-domx-plugins-base","skylark-domx-plugins-popups","skylark-graphics-colors/Color","./colors","./ColorPicker","./ColorPalette"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f){"use strict";var p=l.Plugin.inherit({klassName:"ColorPane",pluginName:"lark.colors.pane",options:{selectors:{pickerContainer:".sp-picker-container",toggleButton:".sp-palette-toggle",paletteContainer:".sp-palette"},draggingClass:"sp-dragging",texts:{togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected"},states:{showPalette:!1,showPaletteOnly:!1,togglePaletteOnly:!1,showSelectionPalette:!0,showInput:!1,allowEmpty:!1,showButtons:!0,showInitial:!1,showAlpha:!1},color:!1,maxSelectionSize:7},_updateUI:function(){this.stating("showPalette")&&this.palette._updateUI(),this.picker._updateUI()},_applyOptions:function(){var e=this.options;this._states={allowEmpty:e.states.allowEmpty,showInput:e.states.showInput,showAlpha:e.states.showAlpha,showButtons:e.states.showButtons,togglePaletteOnly:e.states.togglePaletteOnly,showPalette:e.states.showPalette,showPaletteOnly:e.states.showPaletteOnly,showSelectionPalette:e.showSelectionPalette,showInitial:e.states.showInitial},this._applyStates(),this.reflow()},_construct:function(e,t){l.Plugin.prototype._construct.call(this,e,t);var i=this.$el=this.$(),n=this.options,r=(n.theme,this.$pickerContainer=i.find(n.selectors.pickerContainer)),s=this.$paletteContainer=i.find(n.selectors.paletteContainer),o=(this.$toggleButton=i.find(n.selectors.toggleButton),this._initialColor=n.color);this._isEmpty=!o;s[0]&&(this.palette=f.instantiate(s[0],{selectionPalette:n.selectionPalette,color:n.color,palette:n.palette,selectionPalette:n.selectionPalette})),r[0]&&(this.picker=d.instantiate(r[0],{color:n.color,states:{showInput:n.states.showInput,allowEmpty:n.states.allowEmpty,showButtons:n.states.showButtons,showInitial:n.states.showInitial,showAlpha:n.states.showAlpha}}),this.listenTo(this.picker,"canceled",e=>{this.emit("canceled")}),this.listenTo(this.picker,"choosed",e=>{this.emit("choosed")}),this.listenTo(this.picker,"picked",(e,t)=>{this.emit("picked",t)})),this._init()},_init:function(){var e=this;this.options;t.isIE&&this.$container.find("*:not(input)").attr("unselectable","on"),this._applyOptions(),this.listenTo(this.$toggleButton,"click",function(t){s.stop(t),e.stating("showPaletteOnly",!e.stating("showPaletteOnly"))}),this.listenTo(this.palette,"selected",function(t,i){e.picker.current(i)})},revert:function(){this.set(this._colorOnShow,!0),this._updateOriginalInput(!0)},get:function(){return this.picker.current()},set:function(e){this.picker.current(e),this.palette.current(e)},_applyStates:function(){var e=this._states;e.showPaletteOnly&&(e.showPalette=!0),this.$toggleButton.text(e.showPaletteOnly?this.option("texts.togglePaletteMoreText"):this.option("texts.togglePaletteLessText")),this.$el.toggleClass("sp-input-disabled",!e.showInput).toggleClass("sp-clear-enabled",!!e.allowEmpty).toggleClass("sp-alpha-enabled",e.showAlpha).toggleClass("sp-buttons-disabled",!e.showButtons).toggleClass("sp-palette-buttons-disabled",!e.togglePaletteOnly).toggleClass("sp-palette-disabled",!e.showPalette).toggleClass("sp-palette-only",e.showPaletteOnly).toggleClass("sp-initial-disabled",!e.showInitial),e.showPaletteOnly&&this.$el.css("left","-="+(this.$pickerContainer.outerWidth(!0)+5))},stating:function(e,t){if(void 0===t)return this._states[e];this._states[e]=t,this._applyStates()},reflow:function(){this.stating("showPalette")&&this.palette.reflow(),this.picker.reflow()}});return l.register(p),u.ColorPane=p}),define("skylark-domx-plugins-colors/ColorBox",["skylark-langx/langx","skylark-domx-noder","skylark-domx-finder","skylark-domx-query","skylark-domx-eventer","skylark-domx-styler","skylark-domx-plugins-base","skylark-domx-plugins-popups","skylark-graphics-colors/Color","./colors","./ColorPane"],function(e,t,i,n,r,s,o,a,l,c,h){"use strict";var u=o.Plugin.inherit({klassName:"ColorBox",pluginName:"lark.colors.box",options:{pane:{states:{showPalette:!1,showPaletteOnly:!1,togglePaletteOnly:!1,showSelectionPalette:!0,showInput:!1,allowEmpty:!1,showButtons:!0,showInitial:!1,showAlpha:!1},maxSelectionSize:7,palette:void 0,selectionPalette:void 0},color:!1},_updateUI:function(){var e=this.get();if(this.$previewElement.removeClass("sp-clear-display"),this.$previewElement.css("background-color","transparent"),!e&&this.stating("allowEmpty"))this.$previewElement.addClass("sp-clear-display");else{e.toHexString();var t=e.toRgbString();this.$previewElement.css("background-color",t),e.toString()}this.pane._updateUI()},_applyOptions:function(){this.reflow()},_construct:function(t,i){o.Plugin.prototype._construct.call(this,t,i),this.$el=this.$();var r=this.options,s=this.$pane=n(r.pane.template);this.$previewElement=this.$el.find(".sp-preview-inner");s[0]&&(this.pane=h.instantiate(s[0],e.mixin({color:r.color},r.pane))),this._init()},_init:function(){var e=this;this.options;this._applyOptions();var t=!1;function i(){t&&(t=!1,e.$pane.hide())}this.$pane.hide(),this.listenTo(this.$el,"click touchstart",function(n){t?i():function(){if(t)return;t=!0,e.$pane.show(),e.reflow(),e._updateUI()}(),r.stop(n)}),this.listenTo(this.pane,"picked",(e,t)=>{this.$previewElement.css("background-color",t.toRgbString())}),this.listenTo(this.pane,"canceled choosed",e=>{i()})},revert:function(){this.pane.revert()},get:function(){return this.pane.get()},set:function(e){this.pane.set(e)},reflow:function(){this.$pane.css("position","absolute"),this.$pane.offset(a.calcOffset(this.$pane[0],this.$el[0])),this.pane.reflow()}});return o.register(u),c.ColorBox=u}),define("skylark-domx-plugins-colors/colorer",["skylark-langx/langx","skylark-domx-data","skylark-domx-query","./colors","./ColorBox","./ColorPane"],function(e,t,i,n,r,s){var o=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),a=["<div class='sp-container'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>","</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("");function l(t,n){var l=(n=e.mixin({color:!1,flat:!1,appendTo:"body",maxSelectionSize:7,preferredFormat:!1,containerClassName:"",replacerClassName:"",theme:"sp-light",offset:null,pane:{}},n)).theme,c=n.flat,h=n.appendTo,u=i(t),d=i(a,t.ownerDocument).addClass(l),f=u.is("input"),p=(f&&u.attr("type"),this._shouldReplace=f&&!c),m=p?i(o).addClass(l).addClass(n.className).addClass(n.replacerClassName):i([]);if(delete n.flat,delete n.appendTo,n.color=n.color||f&&u.val(),p&&u.after(m).hide(),d.toggleClass("sp-flat",c).addClass(n.containerClassName),c){u.after(d).hide();var g=new s(d[0],n);return n.picked&&g.on("picked",n.picked),n.choosed&&g.on("choosed",n.choosed),n.canceled&&g.on("canceled",n.canceled),d.show(),g}var v="parent"===h?u.parent():i(h);return 1!==v.length&&(v=i("body")),v.append(d),n.pane.template=d,new r(m[0],n)}return i.fn.colorer=function(e){var i=this[0];if(i){var n=t.data(i,"domx.colorer");return n||(n=l(i,e),t.data(i,"domx.colorer",n)),n}},n.colorer=l}),define("skylark-domx-plugins-colors/Drag",[],function(){var e={obj:null,gradx:null,init:function(t,i,n,r,s,o,a,l,c,h){t.onmousedown=e.start,t.hmode=!a,t.vmode=!l,t.root=i&&null!=i?i:t,t.hmode&&isNaN(parseInt(t.root.style.left))&&(t.root.style.left="0px"),!t.hmode&&isNaN(parseInt(t.root.style.right))&&(t.root.style.right="0px"),t.minX=void 0!==n?n:null,t.minY=void 0!==s?s:null,t.maxX=void 0!==r?r:null,t.maxY=void 0!==o?o:null,t.xMapper=c||null,t.yMapper=h||null,t.root.onDragStart=new Function,t.root.onDragEnd=new Function,t.root.onDrag=new Function},start:function(t){e.gradx.current_slider_id="#"+this.id;var i=e.obj=this;t=e.fixE(t);var n=parseInt(i.vmode?i.root.style.top:i.root.style.bottom),r=parseInt(i.hmode?i.root.style.left:i.root.style.right);return i.root.onDragStart(r,n),i.lastMouseX=t.clientX,i.lastMouseY=t.clientY,i.hmode?(null!=i.minX&&(i.minMouseX=t.clientX-r+i.minX),null!=i.maxX&&(i.maxMouseX=i.minMouseX+i.maxX-i.minX)):(null!=i.minX&&(i.maxMouseX=-i.minX+t.clientX+r),null!=i.maxX&&(i.minMouseX=-i.maxX+t.clientX+r)),i.vmode?(null!=i.minY&&(i.minMouseY=t.clientY-n+i.minY),null!=i.maxY&&(i.maxMouseY=i.minMouseY+i.maxY-i.minY)):(null!=i.minY&&(i.maxMouseY=-i.minY+t.clientY+n),null!=i.maxY&&(i.minMouseY=-i.maxY+t.clientY+n)),document.onmousemove=e.drag,document.onmouseup=e.end,!1},drag:function(t){t=e.fixE(t);var i=e.obj;e.gradx.update_style_array(),e.gradx.apply_style(e.gradx.panel,e.gradx.get_style_value());var n=e.gradx.gx("#"+i.id).css("left");parseInt(n)>60&&parseInt(n)<390&&e.gradx.gx("#gradx_slider_info").css("left",n).show();var r=e.gradx.gx("#"+i.id).css("backgroundColor"),s=e.gradx.get_rgb_obj(r);e.gradx.cp.colorer().set(s);var o,a,l=t.clientY,c=t.clientX,h=parseInt(i.vmode?i.root.style.top:i.root.style.bottom),u=parseInt(i.hmode?i.root.style.left:i.root.style.right);return null!=i.minX&&(c=i.hmode?Math.max(c,i.minMouseX):Math.min(c,i.maxMouseX)),null!=i.maxX&&(c=i.hmode?Math.min(c,i.maxMouseX):Math.max(c,i.minMouseX)),null!=i.minY&&(l=i.vmode?Math.max(l,i.minMouseY):Math.min(l,i.maxMouseY)),null!=i.maxY&&(l=i.vmode?Math.min(l,i.maxMouseY):Math.max(l,i.minMouseY)),o=u+(c-i.lastMouseX)*(i.hmode?1:-1),a=h+(l-i.lastMouseY)*(i.vmode?1:-1),i.xMapper?o=i.xMapper(h):i.yMapper&&(a=i.yMapper(u)),e.obj.root.style[i.hmode?"left":"right"]=o+"px",e.obj.lastMouseX=c,e.obj.lastMouseY=l,e.obj.root.onDrag(o,a),!1},end:function(){document.onmousemove=null,document.onmouseup=null,e.obj.root.onDragEnd(parseInt(e.obj.root.style[e.obj.hmode?"left":"right"]),parseInt(e.obj.root.style[e.obj.vmode?"top":"bottom"])),e.obj=null},fixE:function(e){return void 0===e&&(e=window.event),void 0===e.layerX&&(e.layerX=e.offsetX),void 0===e.layerY&&(e.layerY=e.offsetY),e}};return e}),define("skylark-domx-plugins-colors/Gradienter",["skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins-base","skylark-graphics-colors/Color","./colors","./colorer","./Drag"],function(e,t,i,n,r,s,o,a,l,c,h){"use strict";void 0===s.fn.draggable&&(s.fn.draggable=function(){var e=document.getElementById(this.attr("id"));return e.style.top="121px",h.init(e,null,26,426,86,86),this});return l.Gradienter=function(t,i){var n={targets:[],sliders:[],direction:"left",type:"linear",code_shown:!1,change:function(e,t){}},r=h.gradx={rand_RGB:[],rand_pos:[],id:null,slider_ids:[],slider_index:0,sliders:[],direction:"left",type:"linear",shape:"cover",slider_hovered:[],jQ_present:!0,code_shown:!1,load_jQ:function(){this.gx=s},add_event:function(e,t,i){var n,r,s;r=t,s=i,(n=e).attachEvent?n.attachEvent("on"+r,function(){s.call(n)}):n.addEventListener&&n.addEventListener(r,s,!1)},get_random_position:function(){var e;do{e=parseInt(100*Math.random())}while(this.rand_pos.indexOf(e)>-1);return this.rand_pos.push(e),e},get_random_rgb:function(){var e,t,i,n;do{e=parseInt(255*Math.random()),t=parseInt(255*Math.random()),i=parseInt(255*Math.random()),n="rgb("+e+", "+t+", "+i+")"}while(this.rand_RGB.indexOf(n)>-1);return this.rand_RGB.push(n),n},update_target:function(e){if(this.targets.length>0){var t,i,n,s=this.targets.length,o=e.length;for(t=0;t<s;t++)for(n=r.gx(this.targets[t]),i=0;i<o;i++)n.css("background-image",e[i])}},apply_style:function(e,t){var i="linear";if("linear"!=r.type&&(i="radial"),t.indexOf(this.direction)>-1)var n=["-webkit-"+i+"-gradient("+t+")","-moz-"+i+"-gradient("+t+")","-ms-"+i+"-gradient("+t+")","-o-"+i+"-gradient("+t+")",i+"-gradient("+t+")"];else n=[t];for(var s=n.length,o="";s>0;)s--,e.css("background",n[s]),o+="background: "+n[s]+";\n";this.change(this.sliders,n),this.update_target(n),r.gx("#gradx_code").html(o)},apply_default_styles:function(){this.update_style_array();var e=this.get_style_value();this.apply_style(this.panel,e)},update_style_array:function(){this.sliders=[];var e,t,i,n,s=r.slider_ids.length;for(e=0;e<s;e++)n="#"+r.slider_ids[e],t=parseInt(r.gx(n).css("left")),i=parseInt(t/r.container_width*100),i-=6,r.sliders.push([r.gx(n).css("background-color"),i]);this.sliders.sort(function(e,t){return e[1]>t[1]?1:-1})},get_style_value:function(){var e=r.slider_ids.length;if(1===e)t=this.sliders[0][0];else{for(var t="",i="",n=0;n<e;n++)""==this.sliders[n][1]?t+=i+this.sliders[n][0]:(this.sliders[n][1]>100&&(this.sliders[n][1]=100),t+=i+(this.sliders[n][0]+" ")+this.sliders[n][1]+"%"),i=" , ";t="linear"==this.type?this.direction+" , "+t:this.direction+" , "+this.type+" "+this.shape+" , "+t}return t},get_rgb_obj:function(e){return e=(e=(e=e.split("("))[1]).split(","),{r:parseInt(e[0]),g:parseInt(e[1]),b:parseInt(e[2])}},load_info:function(e){var t="#"+e.id;if(this.current_slider_id=t,this.slider_ids.indexOf(e.id)>-1){var i=r.gx(t).css("backgroundColor"),n=this.get_rgb_obj(i),s=r.gx(t).css("left");parseInt(s)>26&&parseInt(s)<426&&r.gx("#gradx_slider_info").css("left",s).show(),this.set_colorpicker(n),console.log(n)}},add_slider:function(e){var t,i,n,s;0===e.length&&(e=[{color:r.get_random_rgb(),position:r.get_random_position()},{color:r.get_random_rgb(),position:r.get_random_position()}]);var o=e;for(n in o){if(void 0===o[n].position)break;var a=26;s=parseInt(o[n].position*this.container_width/100)+a+"px",t="gradx_slider_"+this.slider_index,this.sliders.push([o[n].color,o[n].position]),this.slider_ids.push(t),i="<div class='gradx_slider' id='"+t+"'></div>",r.gx("#gradx_start_sliders_"+this.id).append(i),r.gx("#"+t).css("backgroundColor",o[n].color).css("left",s),this.slider_index++}for(var l=0,c=this.slider_ids.length;l<c;l++)r.gx("#"+this.slider_ids[l]).draggable({containment:"parent",axis:"x",start:function(){r.jQ_present&&(r.current_slider_id="#"+r.gx(this).attr("id"))},drag:function(){r.update_style_array(),r.apply_style(r.panel,r.get_style_value());var e=r.gx(r.current_slider_id).css("left");parseInt(e)>26&&parseInt(e)<426&&r.gx("#gradx_slider_info").css("left",e).show();var t=r.gx(r.current_slider_id).css("backgroundColor"),i=r.get_rgb_obj(t);r.cp.colorer().set(i)}}).click(function(){return r.load_info(this),!1})},set_colorpicker:function(e){r.cp.colorer({picked:function(e,t){if(0!=r.current_slider_id){var i=t.toRgbString();r.gx(r.current_slider_id).css("background-color",i),r.update_style_array(),r.apply_style(r.panel,r.get_style_value())}},choosed:function(e){r.gx("#gradx_slider_info").hide()},canceled:function(e){r.gx("#gradx_slider_info").hide()},flat:!0,showAlpha:!0,color:e,clickoutFiresChange:!0,showInput:!0,showButtons:!1})},generate_options:function(e){for(var t,i,n=e.length,r="",s=0;s<n;s++)t=(t=e[s].split(" "))[0],i=s<2?t[1]:"",t=t.replace("-"," "),r+="<option value="+e[s]+" "+i+">"+t+"</option>";return r},generate_radial_options:function(){var e;e=["horizontal-center disabled","center selected","left","right"],r.gx("#gradx_gradient_subtype").html(r.generate_options(e)),e=["vertical-center disabled","center selected","top","bottom"],r.gx("#gradx_gradient_subtype2").html(r.generate_options(e)).show()},generate_linear_options:function(){var e;e=["horizontal-center disabled","left selected","right","top","bottom"],r.gx("#gradx_gradient_subtype").html(r.generate_options(e)),r.gx("#gradx_gradient_subtype2").hide()},destroy:function(){var e={targets:[],sliders:[],direction:"left",type:"linear",code_shown:!1,change:function(e,t){}};for(var t in e)r[t]=e[t]},load_gradx:function(e,t){this.me=r.gx(e),this.id=e.replace("#",""),e=this.id,this.current_slider_id=!1;var i="<div class='gradx'>\n<div id='gradx_add_slider' class='gradx_add_slider gradx_btn'><i class='icon icon-add'></i>add</div>\n<div class='gradx_slectboxes'>\n<select id='gradx_gradient_type' class='gradx_gradient_type'>\n    <option value='linear'>Linear</option>\n    <option value='circle'>Radial - Circle</option>\n    <option value='ellipse'>Radial - Ellipse</option>\n</select>\n<select id='gradx_gradient_subtype' class='gradx_gradient_type'>\n    <option id='gradx_gradient_subtype_desc' value='gradient-direction' disabled>gradient direction</option>\n    <option value='left' selected>Left</option>\n    <option value='right'>Right</option>\n    <option value='top'>Top</option>\n    <option value='bottom'>Bottom</option>\n</select>\n<select id='gradx_gradient_subtype2' class='gradx_gradient_type gradx_hide'>\n</select>\n<select id='gradx_radial_gradient_size' class='gradx_gradient_type gradx_hide'>\n</select>\n</div>\n<div class='gradx_container' id='gradx_"+e+"'>\n    <div id='gradx_stop_sliders_"+e+"'></div>\n    <div class='gradx_panel' id='gradx_panel_"+e+"'></div>\n    <div class='gradx_start_sliders' id='gradx_start_sliders_"+e+"'>\n        <div class='cp-default' id='gradx_slider_info'>\n            <div id='gradx_slider_controls'>\n                <div id='gradx_delete_slider' class='gradx_btn'><i class='icon icon-remove'></i>delete</div>\n            </div>\n            <div id='gradx_slider_content'></div>\n        </div> \n    </div>\n</div>\n<div id='gradx_show_code' class='gradx_show_code gradx_btn'><i class='icon icon-file-css'></i><span>show the code</span></div>\n<div id='gradx_show_presets' style='display:none' class='gradx_show_presets gradx_btn'><i class='icon icon-preset'></i><span>show presets</span></div>\n<textarea class='gradx_code' id='gradx_code'></textarea>\n</div>";this.me.html(i);var n="";if(n=r.generate_options(["gradient-size disabled","closest-side selected","closest-corner","farthest-side","farthest-corner","contain","cover"]),r.gx("#gradx_radial_gradient_size").html(n),this.container=r.gx("#gradx_"+e),this.panel=r.gx("#gradx_panel_"+e),this.container_width=400,this.add_slider(t),r.add_event(document,"click",function(){if(!r.slider_hovered[e])return r.gx("#gradx_slider_info").hide(),!1}),r.gx("#gradx_add_slider").click(function(){r.add_slider([{color:r.get_random_rgb(),position:r.get_random_position()}]),r.update_style_array(),r.apply_style(r.panel,r.get_style_value())}),r.cp=r.gx("#gradx_slider_content"),r.set_colorpicker("blue"),r.gx("#gradx_delete_slider").click(function(){r.gx(r.current_slider_id).remove(),r.gx("#gradx_slider_info").hide();for(var e=r.current_slider_id.replace("#",""),t=0;t<r.slider_ids.length;t++)r.slider_ids[t]==e&&r.slider_ids.splice(t,1);r.update_style_array(),r.apply_style(r.panel,r.get_style_value()),r.current_slider_id=!1}),r.gx("#gradx_code").focus(function(){var e=r.gx(this);e.select(),e.mouseup(function(){return e.off("mouseup"),!1})}),r.gx("#gradx_gradient_type").change(function(){var e=r.gx(this).val();"linear"!==e?r.generate_radial_options():(r.generate_linear_options(),r.gx("#gradx_gradient_subtype").val("left")),r.type=e,r.direction=r.gx("#gradx_gradient_subtype").val(),r.apply_style(r.panel,r.get_style_value())}),"linear"!==this.type){var s;if(r.gx("#gradx_gradient_type").val(this.type),r.generate_radial_options(),"left"!==this.direction)s=this.direction.indexOf(",")>-1?this.direction.split(","):this.direction.split(" "),o=s[0],a=s[1],r.gx("#gradx_gradient_subtype").val(o),r.gx("#gradx_gradient_subtype2").val(a);else var o=r.gx("#gradx_gradient_subtype").val(),a=r.gx("#gradx_gradient_subtype2").val();r.direction=o+" "+a,r.apply_style(r.panel,r.get_style_value())}else"left"!==this.direction&&r.gx("#gradx_gradient_subtype").val(this.direction);r.gx("#gradx_gradient_subtype").change(function(){if("linear"===r.type)r.direction=r.gx(this).val();else{var e=r.gx(this).val(),t=r.gx("#gradx_gradient_subtype2").val();r.direction=e+" "+t}r.apply_style(r.panel,r.get_style_value())}),r.gx("#gradx_gradient_subtype2").change(function(){var e=r.gx("#gradx_gradient_subtype").val(),t=r.gx(this).val();r.direction=e+" "+t,r.apply_style(r.panel,r.get_style_value())}),r.gx("#gradx_radial_gradient_size").change(function(){r.shape=r.gx(this).val(),r.apply_style(r.panel,r.get_style_value())}),r.gx("#gradx_show_code").click(function(){r.code_shown?(r.code_shown=!1,r.gx("#gradx_show_code span").text("show the code"),r.gx("#gradx_code").hide()):(r.gx("#gradx_show_code span").text("hide the code"),r.gx("#gradx_code").show(),r.code_shown=!0)}),r.code_shown&&(r.gx("#gradx_show_code span").text("hide the code"),r.gx("#gradx_code").show()),r.add_event(document.getElementById("gradx_slider_info"),"mouseout",function(){r.slider_hovered[e]=!1}),r.add_event(document.getElementById("gradx_slider_info"),"mouseover",function(){r.slider_hovered[e]=!0})}};for(var o in r.load_jQ(),e.mixin(n,i),n)r[o]=n[o];r.load_gradx(t,r.sliders),r.apply_default_styles()}}),define("skylark-domx-plugins-colors/main",["skylark-domx-query","./colors","./colorer","./ColorPalette","./ColorPicker","./ColorPane","./Gradienter"],function(e,t,i){return t}),define("skylark-domx-plugins-colors",["skylark-domx-plugins-colors/main"],function(e){return e}),define("skylark-domx-forms/forms",["skylark-langx/skylark"],function(e){return e.attach("domx.forms",{})}),define("skylark-domx-forms/deserialize",["skylark-langx/langx","skylark-domx-query","./forms"],function(e,t,i){function n(e,t,i){var n=i[e];return void 0===n?i[e]=[t]:n.push(t),i}var r={checked:["radio","checkbox"],selected:["option","select-one","select-multiple"],value:["button","color","date","datetime","datetime-local","email","hidden","month","number","password","range","reset","search","submit","tel","text","textarea","time","url","week"]};function s(t,i,n,s,o){var a=function(t){var i=function(e){return(e.type||e.nodeName).toLowerCase()}(t),n=void 0;return e.each(r,function(t,r){if(e.inArray(i,r)>-1)return n=t,!1}),n}(t);if("value"==a&&i==s)t.value=n,o.call(t,n);else if("checked"==a||"selected"==a){var l=[];t.options?e.each(t.options,function(e,t){l.push(t)}):l.push(t),t.multiple&&0==s&&(t.selectedIndex=-1),e.each(l,function(e,t){t.value==n&&(t[a]=!0,o.call(t,n))})}}var o={change:e.noop,complete:e.noop};return i.deserialize=function(i,r,a){e.isFunction(a)&&(a={complete:a});a=e.extend(o,a||{}),r=function(t){var i={},r=/\+/g;e.isPlainObject(t)?(e.extend(i,t),e.each(i,function(t,n){e.isArray(n)||(i[t]=[n])})):e.isArray(t)?e.each(t,function(e,t){n(t.name,t.value,i)}):"string"==typeof t&&e.each(t.split("&"),function(e,t){var s=t.split("="),o=decodeURIComponent(s[0].replace(r,"%20")),a=decodeURIComponent(s[1].replace(r,"%20"));n(o,a,i)});return i}(r);var l=function(i,r){var s={},o=t(i).map(function(){return this.elements?e.makeArray(this.elements):this}).filter(r||":input:not(:disabled)").get();return e.each(o,function(e,t){n(t.name,t,s)}),s}(i,a.filter);return e.each(r,function(t,i){e.each(l[t],function(t,n){e.each(i,function(e,i){s(n,t,i,e,a.change)})})}),a.complete.call(i),this}}),define("skylark-domx-forms/serializeArray",["skylark-langx/langx","skylark-domx-data","./forms"],function(e,t,i){return i.serializeArray=function(i){var n,r,s=[],o=function(e){if(e.forEach)return e.forEach(o);s.push({name:n,value:e})};return e.each(i.elements,function(e,i){r=i.type,(n=i.name)&&"fieldset"!=i.nodeName.toLowerCase()&&!i.disabled&&"submit"!=r&&"reset"!=r&&"button"!=r&&"file"!=r&&("radio"!=r&&"checkbox"!=r||i.checked)&&o(t.val(i))}),s}}),define("skylark-domx-forms/serializeObject",["skylark-langx/langx","./forms","./serializeArray"],function(e,t,i){return t.serializeObject=function(t){var n={};return e.each(i(t),function(t,i){var r=i.name,s=i.value;n[r]=void 0===n[r]?s:e.isArray(n[r])?n[r].concat(s):[n[r],s]}),n}}),define("skylark-domx-forms/serialize",["skylark-langx/langx","./forms","./serializeArray"],function(e,t,i){return t.serialize=function(e){var t=[];return i(e).forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")}}),define("skylark-domx-forms/main",["./forms","skylark-domx-velm","skylark-domx-query","./deserialize","./serializeArray","./serializeObject","./serialize"],function(e,t,i){return t.delegate(["deserialize","serializeArray","serializeObject","serialize"],e),i.fn.deserialize=i.wraps.wrapper_value(e.deserialize,e,e.deserialize),i.fn.serializeArray=i.wraps.wrapper_value(e.serializeArray,e,e.serializeArray),i.fn.serializeObject=i.wraps.wrapper_value(e.serializeObject,e,e.serializeObject),i.fn.serialize=i.wraps.wrapper_value(e.serialize,e,e.serialize),e}),define("skylark-domx-forms",["skylark-domx-forms/main"],function(e){return e}),define("skylark-jquery/core",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-data","skylark-domx-eventer","skylark-domx-finder","skylark-domx-forms","skylark-domx-fx","skylark-domx-styler","skylark-domx-query","skylark-langx-scripter"],function(e,t,i,n,r,s,o,a,l,c,h,u){var d,f=Array.prototype.filter;Array.prototype.slice;return(d=h).fn.jquery="2.2.0",d.browser=i,d.camelCase=t.camelCase,d.cleanData=function(e){for(var t,i=0;void 0!==(t=e[i]);i++)r.cleanData(t)},d.removeData=function(e,t){r.removeData(e,t)},d.each=t.each,d.extend=t.extend,d.grep=function(e,t){return f.call(e,t)},d.attr=function(e,t){return r.attr(e,t)},d.isArray=t.isArray,d.isEmptyObject=t.isEmptyObject,d.isFunction=t.isFunction,d.isWindow=t.isWindow,d.isPlainObject=t.isPlainObject,d.isNumeric=t.isNumber,d.inArray=t.inArray,d.makeArray=t.makeArray,d.map=t.map,d.noop=function(){},d.parseJSON=window.JSON.parse,d.proxy=t.proxy,d.trim=t.trim,d.type=t.type,d.fn.extend=function(e){t.mixin(d.fn,e)},function(e){e.Event=function(e,i){if(t.isString(e)){var n=e;return s.create(n,i)}return s.proxy(e,i)},e.event={},e.event.special=s.special,e.fn.submit=function(t){if(0 in arguments)this.bind("submit",t);else if(this.length){var i=e.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this},e.fn.triggerHandler=e.fn.trigger,e.fn.delegate=function(e,t,i){return this.on(t,e,i)},e.fn.undelegate=function(e,t,i){return this.off(t,e,i)},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.bind=function(e,t,i,n){return this.on(e,t,i,n)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.ready=function(e){return s.ready(e),this},e.fn.stop=function(){return this},e.fn.moveto=function(e,t){return this.animate({left:e+"px",top:t+"px"},.4)},e.ready=s.ready,e.on=s.on,e.off=s.off}(h),function(e){e.uuid=0,e.support=i.support,e.expr={},e.expr[":"]=e.expr.pseudos=e.expr.filters=o.pseudos,e.expr.createPseudo=function(e){return e},e.cssHooks=c.cssHooks,e.contains=n.contains,e.css=c.css,e.data=r.data,e.fx=l,e.fx.step={},e.speed=function(t,i,n){var r=t&&"object"==typeof t?e.extend({},t):{complete:n||!n&&i||e.isFunction(t)&&t,duration:t,easing:n&&i||i&&!e.isFunction(i)&&i};return e.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in e.fx.speeds?r.duration=e.fx.speeds[r.duration]:r.duration=e.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){e.isFunction(r.old)&&r.old.call(this),r.queue&&e.dequeue(this,r.queue)},r},e.easing={},e.offset={},e.offset.setOffset=function(t,i,n){var r=e.css(t,"position");"static"===r&&(t.style.position="relative");var s,o,a=e(t),l=a.offset(),c=e.css(t,"top"),h=e.css(t,"left"),u=("absolute"===r||"fixed"===r)&&e.inArray("auto",[c,h])>-1,d={},f={};u?(f=a.position(),s=f.top,o=f.left):(s=parseFloat(c)||0,o=parseFloat(h)||0),e.isFunction(i)&&(i=i.call(t,n,l)),null!=i.top&&(d.top=i.top-l.top+s),null!=i.left&&(d.left=i.left-l.left+o),"using"in i?i.using.call(t,d):a.css(d)},e._data=function(e,t){return e.hasAttribute?r.data(e,t):{}};var t=e.fn.text;e.fn.text=function(e){var i=t.apply(this,arguments);return void 0===i&&(i=""),i},e.fn.pos=e.fn.position}(h),h.parseHTML=function(e){return n.createFragment(e)},h.uniqueSort=h.unique=t.uniq,h.skylark=e,window.jQuery=window.$=h}),define("skylark-jquery/ajax",["skylark-langx/langx","skylark-net-http/Xhr","./core"],function(e,t,i){var n=0;function r(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function s(e,t,n,r){return i.isFunction(e)?(r=t,n=e,t=void 0,e=void 0):i.isFunction(t)&&(r=n,n=t,t=void 0),i.isFunction(n)||(r=n,n=void 0),{url:e,data:t,success:n,dataType:r}}i.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){i.fn[t]=function(e){return this.on(t,e)}}),i.ajaxJSONP=function(t){var s,o,a=new e.Deferred,l=t.jsonpCallback,c=(i.isFunction(l)?l():l)||"jsonp"+ ++n,h=document.createElement("script"),u=window[c],d=function(e){i(h).triggerHandler("error",e||"abort")},f={abort:d};for(var p in t.data)t.url=r(t.url,p+"="+t.data[p]);return i(h).on("load error",function(e,t){clearTimeout(o),i(h).off().remove(),"error"!=e.type&&s?a.resolve(s[0],200,f):a.reject(e),window[c]=u,s&&i.isFunction(u)&&u(s[0]),u=s=void 0}),window[c]=function(){s=arguments},h.src=t.url.replace(/\?(.+)=\?/,"?$1="+c),document.head.appendChild(h),t.timeout>0&&(o=setTimeout(function(){d("timeout")},t.timeout)),a},i.ajaxSettings={processData:!0},i.ajax=function(n,s){if(n?s?s.url=n:s=e.isString(n)?{url:n}:n:s={url:"./"},"jsonp"==(s=e.mixin({},i.ajaxSettings,s)).dataType){var o=/\?.+=\?/.test(s.url);return o||(s.url=r(s.url,s.jsonp?s.jsonp+"=?":!1===s.jsonp?"":"callback=?")),i.ajaxJSONP(s)}var a=t.request(s.url,s);return(a=a.then(function(e,t,n){i(document).trigger("ajaxSucess"),s.success&&s.success.apply(this,arguments);s.complete&&s.complete.apply(this,arguments);return e},function(){i(document).trigger("ajaxError"),s.error&&s.error.apply(this,arguments)})).success=a.done,a.error=a.fail,a.complete=a.always,a},i.get=function(){return i.ajax(s.apply(null,arguments))},i.post=function(){var e=s.apply(null,arguments);return e.type="POST",i.ajax(e)},i.getJSON=function(){var e=s.apply(null,arguments);return e.dataType="json",i.ajax(e)};var o=i.fn.load;function a(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,r=0,s=t.toLowerCase().match(l)||[];if(jQuery.isFunction(i))for(;n=s[r++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}i.fn.load=function(e,t,n){if("string"!=typeof e&&o)return o.apply(this,arguments);if(!this.length)return this;var r,a=this,l=s(e,t,n),c=l.url&&l.url.split(/\s/),h=l.success;return c&&c.length>1&&(l.url=c[0],r=c[1]),l.data&&"object"==typeof l.data&&(l.type="POST"),l.success=function(e){a.html(r?i("<div>").html(e.replace(rscript,"")).find(r):e),h&&h.apply(a,arguments)},i.ajax(l),this},i.param=t.param;var l=/\S+/g;return i.ajaxPrefilter=a({}),i.ajaxTransport=a({}),i.ajaxSetup=function(i,n){e.mixin(t.defaultOptions,i,n)},i.getScript=function(e,t){return i.get(e,void 0,t,"script")},i}),define("skylark-jquery/callbacks",["./core"],function(e){return e.Callbacks=function(t){var i,n,r,s,o,a,l=[],c=!(t=e.extend({},t)).once&&[],h=function(e){for(i=t.memory&&e,n=!0,a=s||0,s=0,o=l.length,r=!0;l&&a<o;++a)if(!1===l[a].apply(e[0],e[1])&&t.stopOnFalse){i=!1;break}r=!1,l&&(c?c.length&&h(c.shift()):i?l.length=0:u.disable())},u={add:function(){if(l){var n=l.length,a=function(i){e.each(i,function(e,i){"function"==typeof i?t.unique&&u.has(i)||l.push(i):i&&i.length&&"string"!=typeof i&&a(i)})};a(arguments),r?o=l.length:i&&(s=n,h(i))}return this},remove:function(){return l&&e.each(arguments,function(t,i){for(var n;(n=e.inArray(i,l,n))>-1;)l.splice(n,1),r&&(n<=o&&--o,n<=a&&--a)}),this},has:function(t){return!(!l||!(t?e.inArray(t,l)>-1:l.length))},empty:function(){return o=l.length=0,this},disable:function(){return l=c=i=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,i||u.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||n&&!c||(t=[e,(t=t||[]).slice?t.slice():t],r?c.push(t):h(t)),this},fire:function(){return u.fireWith(this,arguments)},fired:function(){return!!n}};return u},e}),define("skylark-jquery/deferred",["./core","skylark-langx/langx"],function(e,t){return e.Deferred=function(){var e=new t.Deferred,i={promise:function(){return e.promise}};return["resolve","resolveWith","reject","rejectWith","notify","then","done","fail","progress","always","state"].forEach(function(t){i[t]=function(){var n=e[t].apply(e,arguments);return n==e&&(n=i),n}}),i},e.when=function(){var e=t.Deferred.all(t.makeArray(arguments)),i=e.then;return e.then=function(t,n){return i.call(e,function(e){return t&&t.apply(null,e)},n)},e},e}),define("skylark-jquery/queue",["skylark-langx/langx","./core","./callbacks"],function(e,t){var i="Sky"+("1.0"+Math.random()).replace(/\D/g,""),n=/\S+/g,r=[].push;function s(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=i+Math.random()}s.uid=1,s.accepts=function(e){return!e.nodeType||(1===e.nodeType||9===e.nodeType)},s.prototype={key:function(e){if(!s.accepts(e))return 0;var i={},n=e[this.expando];if(!n){n=s.uid++;try{i[this.expando]={value:n},Object.defineProperties(e,i)}catch(r){i[this.expando]=n,t.extend(e,i)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,i,n){var r,s=this.key(e),o=this.cache[s];if("string"==typeof i)o[i]=n;else if(t.isEmptyObject(o))t.extend(this.cache[s],i);else for(r in i)o[r]=i[r];return o},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,i,n){var r;return void 0===i||i&&"string"==typeof i&&void 0===n?void 0!==(r=this.get(e,i))?r:this.get(e,t.camelCase(i)):(this.set(e,i,n),void 0!==n?n:i)},remove:function(e,i){var r,s,o,a=this.key(e),l=this.cache[a];if(void 0===i)this.cache[a]={};else{t.isArray(i)?s=i.concat(i.map(t.camelCase)):(o=t.camelCase(i),s=i in l?[i,o]:(s=o)in l?[s]:s.match(n)||[]),r=s.length;for(;r--;)delete l[s[r]]}},hasData:function(e){return!t.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var o=new s;return t.extend(t,{queue:function(e,i,n){var r;if(e)return i=(i||"fx")+"queue",r=o.get(e,i),n&&(!r||t.isArray(n)?r=o.access(e,i,t.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,i){i=i||"fx";var n=t.queue(e,i),r=n.length,s=n.shift(),o=t._queueHooks(e,i);"inprogress"===s&&(s=n.shift(),r--),s&&("fx"===i&&n.unshift("inprogress"),delete o.stop,s.call(e,function(){t.dequeue(e,i)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,i){var n=i+"queueHooks";return o.get(e,n)||o.access(e,n,{empty:t.Callbacks("once memory").add(function(){o.remove(e,[i+"queue",n])})})},makeArray:function(e,i){var n=i||[];return null!=e&&(!function(e){var i=e.length,n=t.type(e);if(t.isWindow(e))return!1;if(1===e.nodeType&&i)return!0;return"array"===n||"function"!==n&&(0===i||"number"==typeof i&&i>0&&i-1 in e)}(Object(e))?r.call(n,e):t.merge(n,"string"==typeof e?[e]:e)),n},merge:function(e,t){var i=t.length,n=e.length,r=0;if("number"==typeof i)for(;r<i;r++)e[n++]=t[r];else for(;void 0!==t[r];)e[n++]=t[r++];return e.length=n,e}}),t.extend(t.fn,{queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),arguments.length<n?t.queue(this[0],e):void 0===i?this:this.each(function(){var n=t.queue(this,e,i);t._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&t.dequeue(this,e)})},dequeue:function(e){return this.each(function(){t.dequeue(this,e)})},delay:function(e,i){return e=t.fx&&t.fx.speeds[e]||e,i=i||"fx",this.queue(i,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,r=1,s=t.Deferred(),a=this,l=this.length,c=function(){--r||s.resolveWith(a,[a])};for("string"!=typeof e&&(i=e,e=void 0),e=e||"fx";l--;)(n=o.get(a[l],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(c));return c(),s.promise(i)}}),t}),define("skylark-jquery/JqueryPlugin",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx/langx","skylark-domx-data","skylark-domx-eventer","skylark-domx-plugins-base","skylark-domx-query"],function(e,t,i,n,r,s,o,a){var l=0,c=o.Plugin.inherit({klassName:"JqPlugin",pluginEventPrefix:"",options:{create:null},destroy:function(){this.overrided(),this.element.off(this.eventNamespace),this.bindings.off(this.eventNamespace)},_construct:function(e,t){e=a(e||this.defaultElement||this)[0],this.element=a(e),this.uuid=l++,this.eventNamespace="."+this.pluginName+this.uuid,this.bindings=a(),this.classesElementLookup={},this.hoverable=a(),this.focusable=a(),e!==this&&(r.data(e,this.pluginName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=a(e.style?e.ownerDocument:e.document||e),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.overrided(e,t),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_initOptions:function(e){e=n.mixin(this._getCreateOptions(),e),this.overrided(e)},_getCreateOptions:function(){return{}},_getCreateEventData:n.noop,_super:function(){if(this.overrided)return this.overrided.apply(this,arguments)},_superApply:function(e){if(this.overrided)return this.overrided.apply(this,e)},_create:n.noop,_init:n.noop,_classes:function(e){var i=[],r=this;function s(t,s){var o,l;for(l=0;l<t.length;l++)o=r.classesElementLookup[t[l]]||a(),e.add?(e.element.each(function(e,t){var i=n.map(r.classesElementLookup,function(e){return e}).some(function(e){return a(e).is(t)});i||r._on(a(t),{remove:"_untrackClassesElement"})}),o=a(n.uniq(o.get().concat(e.element.get())))):o=a(o.not(e.element).get()),r.classesElementLookup[t[l]]=o,i.push(t[l]),s&&e.classes[t[l]]&&i.push(e.classes[t[l]])}return(e=t.mixin({element:this.element,classes:this.options.classes||{}},e)).keys&&s(e.keys.match(/\S+/g)||[],!0),e.extra&&s(e.extra.match(/\S+/g)||[]),i.join(" ")},_untrackClassesElement:function(e){var t=this;n.each(t.classesElementLookup,function(n,r){-1!==i.inArray(e.target,r)&&(t.classesElementLookup[n]=a(r.not(e.target).get()))}),this._off(a(e.target))},_removeClass:function(e,t,i){return this._toggleClass(e,t,i,!1)},_addClass:function(e,t,i){return this._toggleClass(e,t,i,!0)},_toggleClass:function(e,t,i,n){n="boolean"==typeof n?n:i;var r="string"==typeof e||null===e,s={extra:r?t:i,keys:r?e:t,element:r?this.element:e,add:n};return s.element.toggleClass(this._classes(s),n),this},_on:function(e,i,n){var r,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=r=a(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,r=this.widget()),t.each(n,function(t,n){function o(){if(e||!0!==s.options.disabled&&!a(this).hasClass("ui-state-disabled"))return("string"==typeof n?s[n]:n).apply(s,arguments)}"string"!=typeof n&&(o.guid=n.guid=n.guid||o.guid||a.guid++);var l=t.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+s.eventNamespace,h=l[2];h?r.on(c,h,o):i.on(c,o)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(t),this.bindings=a(this.bindings.not(e).get()),this.focusable=a(this.focusable.not(e).get()),this.hoverable=a(this.hoverable.not(e).get())},_trigger:function(t,i,n){var r,o,a=this.options[t];if(n=n||{},(i=s.proxy(i)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(r in o)r in i||(i[r]=o[r]);return this.element.trigger(i,n),!(e.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})}});return c}),define("skylark-jquery/widget",["skylark-langx/langx","skylark-domx-plugins-base","./core","./JqueryPlugin"],function(e,t,i,n){var r,s=Array.prototype.hasOwnProperty,o=Array.prototype.slice;return i.cleanData=(r=i.cleanData,function(e){var t,n,s;for(s=0;null!=(n=e[s]);s++)(t=i._data(n,"events"))&&t.remove&&i(n).triggerHandler("remove");r(e)}),i.widget=function(e,n,r){var s,o,a=e.split(".")[0];e=e.split(".")[1];var l=a+"-"+e;r||(r=n,n=i.Widget),i.isArray(r)&&(r=i.extend.apply(null,[{}].concat(r))),i.expr.pseudos[l.toLowerCase()]=function(e){return!!i.data(e,l)},i[a]=i[a]||{},s=i[a][e];var c=n.prototype,h={};for(var u in r){var d=r[u];i.isPlainObject(d)?h[u]=i.isPlainObject(c[u])?i.widget.extend({},c[u],d):i.widget.extend({},d):h[u]=d}var f=i.widget.extend({widgetEventPrefix:s&&n.prototype.widgetEventPrefix||e},{options:n.prototype.options},h,{name:l,namespace:a,widgetName:e,pluginName:"jqueryui."+(a?a+".":"")+e,widgetFullName:l});return o=i[a][e]=n.inherit(f),i.extend(o,s,{version:r.version,_proto:f,_childConstructors:[]}),s?(i.each(s._childConstructors,function(e,t){var n=t.prototype;i.widget(n.namespace+"."+n.widgetName,o,t._proto)}),delete s._childConstructors):n._childConstructors&&n._childConstructors.push(o),t.register(o,e,l),o},i.widget.extend=function(e){for(var t,n,r=o.call(arguments,1),a=0,l=r.length;a<l;a++)for(t in r[a])n=r[a][t],s.call(r[a],t)&&void 0!==n&&(i.isPlainObject(n)?e[t]=i.isPlainObject(e[t])?i.widget.extend({},e[t],n):i.widget.extend({},n):e[t]=n);return e},i.Widget=n.inherit({widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},widget:function(){return this.element},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(e){var t,n,r;for(t in e)r=this.classesElementLookup[t],e[t]!==this.options.classes[t]&&r&&r.length&&(n=i(r.get()),this._removeClass(r,t),n.addClass(this._classes({element:n,keys:t,classes:e,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(i(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(i(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(i(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(i(e.currentTarget),null,"ui-state-focus")}})}}),i.Widget._childConstructors=[],i.each({show:"fadeIn",hide:"fadeOut"},function(e,t){i.Widget.prototype["_"+e]=function(n,r,s){var o;"string"==typeof r&&(r={effect:r});var a=r?!0===r||"number"==typeof r?t:r.effect||t:e;"number"==typeof(r=r||{})&&(r={duration:r}),o=!i.isEmptyObject(r),r.complete=s,r.delay&&n.delay(r.delay),o&&i.effects&&i.effects.effect[a]?n[e](r):a!==e&&n[a]?n[a](r.duration,r.easing,s):n.queue(function(t){i(this)[e](),s&&s.call(n[0]),t()})}}),i.widget}),define("skylark-jquery/main",["./core","./ajax","./callbacks","./deferred","./queue","./JqueryPlugin","./widget"],function(e){return e}),define("skylark-jquery",["skylark-jquery/main"],function(e){return e}),define("skylark-appify-routers/routers",["skylark-langx/skylark","skylark-langx/langx"],function(e,t){return e.attach("appify.routers",{createEvent:function(e,i){var n=new CustomEvent(e,i);return t.safeMixin(n,i)}})}),define("skylark-appify-routers/route",["skylark-langx/langx","./routers"],function(e,t){var i=t.createEvent,n=e.Evented.inherit({klassName:"Route",init:function(t,i){var n=(i=e.mixin({},i)).pathto||"",r=n,s=r.match(/\:([a-zA-Z0-9_]+)/g);null!==s?(s=s.map(function(e){return e.substring(1)}),r=r.replace(/\:([a-zA-Z0-9_]+)/g,"(.*?)")):s=[],r="*"===r?"(.*)":r.replace("/","\\/"),this._setting=i,this.name=t,this.pathto=n,this.paramNames=s,this.params=r,this.regex=new RegExp("^"+r+"$","");var o=this;["entering","entered","exiting","exited"].forEach(function(t){e.isFunction(i[t])&&o.on(t,i[t])})},enter:function(t,n){if(n){var r=this._entering(t),s=this;return e.Deferred.when(r).then(function(){var e=i("entering",{route:s,result:!0});return s.trigger(e),e.result})}return this._entered(t),this.trigger(i("entered",e.safeMixin({route:this},t))),this},exit:function(t,n){if(n){var r=this._exiting(t);if(!r)return!1;var s=i("exiting",{route:this,result:!0});return this.trigger(s),s.result}return this._exited(t),this.trigger(i("exited",e.safeMixin({route:this},t))),this},match:function(e){var t=this.paramNames,i=e.indexOf("?"),e=~i?e.slice(0,i):decodeURIComponent(e),n=this.regex.exec(e);if(!n)return!1;for(var r={},s=1,o=n.length;s<o;++s){var a=t[s-1],l=decodeURIComponent(n[s]);r[a]=l}return r},path:function(e){var t=this.pathto;return e&&(t=t.replace(/:([a-zA-Z0-9_]+)/g,function(t,i){return e[i]})),t},_entering:function(e){return!0},_entered:function(e){return!0},_exiting:function(e){return!0},_exited:function(e){return!0}});return t.Route=n}),define("skylark-appify-routers/router",["skylark-langx/langx","./routers","./route"],function(e,t,i){var n=t.createEvent;return t.Router=function(){var t,r,s,o,a={},l={},c=new e.Evented,h=this;function u(i){if(t){var s=t.route.exit({path:t.path,params:t.params},!0);if(!s)return}if(r=t,!(t=i).route){var o=f(t.path);t.route=o.route,t.params=o.params}var a=t.route.enter({force:t.force,path:t.path,params:t.params},!0);e.Deferred.when(a).then(function(){c.trigger(n("routing",{current:t,previous:r})),t.route.enter({path:t.path,params:t.params},!1),r&&r.route.exit({path:r.path,params:r.params},!1),c.trigger(n("routed",{current:t,previous:r}))})}function d(e,i){if(!i&&t&&t.path==e)return!1;var r=f(e);if(r)if(r.path=e,h.useHistoryApi){var o={force:i,path:e};window.history.pushState(o,document.title,(s+e).replace("//","/")),window.dispatchEvent(n("popstate",{state:o}))}else if(h.useHashbang){var a="#!"+e;window.location.hash!==a?window.location.hash=a:u(r)}else u(r);return!0}function f(t,i){var n=!1;return!i&&(n=l[t])?n:(e.each(a,function(e,i){var r=i.match(t);return!r||(n={route:i,params:r},!1)}),n&&!i&&(l[t]=n),n)}function p(t){if(!e.isDefined(t))return e.mixin({},a);for(var i in t)a[i]=new h.Route(i,t[i])}e.mixin(h,{Route:i,current:function(){return t},go:d,map:f,hub:function(){return c},off:function(){c.off.apply(c,arguments)},on:function(){c.on.apply(c,arguments)},one:function(){c.one.apply(c,arguments)},path:function(e,t){var i,n=a[e];n&&(i=n.path(t));return i},previous:function(){return r},baseUrl:function(t){return e.isDefined(t)?(s=t,this):s},homePath:function(t){return e.isDefined(t)?(o=t,this):o},route:function(t,i){if(e.isDefined(i)){var n={};return n[t]=i,p(n),this}return a[t]},routes:p,start:function(){null==h.useHashbang&&null==h.useHistoryApi&&(window.location.host&&window.history.pushState?h.useHistoryApi=!0:h.useHashbang=!0);var e="";h.useHistoryApi?(e=window.location.pathname,void 0===s&&(s=e.replace(/\/$/,"")),e=e.replace(s,"")||o||"/"):e=h.useHashbang&&(window.location.hash.replace("#!","")||o)||"/";e.startsWith("/")||(e="/"+e);h.useHistoryApi?window.addEventListener("popstate",function(e){e.state&&u(e.state),e.preventDefault()}):h.useHashbang&&window.addEventListener("hashchange",function(e){u({path:window.location.hash.replace(/^#!/,"")}),e.preventDefault()});d(e)},trigger:function(e){return c.trigger(e),this},useHistoryApi:null,useHashbang:null})}}),define("skylark-appify-routers/main",["./routers","./router","./route"],function(e){return e}),define("skylark-appify-routers",["skylark-appify-routers/main"],function(e){return e}),define("skylark-appify-spa/spa",["skylark-langx/skylark","skylark-langx/langx","skylark-appify-routers"],function(e,t,i){var n=t.Deferred;function r(e,i){var n=new CustomEvent(e,i);return t.safeMixin(n,i)}var s,o=new i.Router,a=o.Route=o.Route.inherit({klassName:"SpaRoute",init:function(e,i){this.overrided(e,i),this.content=i.content,this.forceRefresh=i.forceRefresh,this.data=i.data;var n=this;["preparing","rendering","rendered"].forEach(function(e){t.isFunction(i[e])&&n.on(e,i[e])})},_entering:function(e){return this.forceRefresh||e.force||!this._prepared?this.prepare():this},getConfigData:function(e){return e?this.data[e]:this.data},getNamedValue:function(){return window.location.pathname.match(this.regex)},prepare:function(){var e=new n,t=this._setting,i=t.controller,s=(this.controller,this);t.content,t.contentPath;return require([i.type],function(t){s.controller=new t(i),e.resolve()}),e.then(function(){var e=r("preparing",{route:s,result:!0});return s.trigger(e),n.when(e.result).then(function(){s._prepared=!0})})},render:function(e){var t=r("rendering",{route:this,context:e,content:this.content});return this.trigger(t),t.content},trigger:function(e){var t=this.controller;return t?t.perform(e):this.overrided(e)}}),l=t.Evented.inherit({klassName:"SpaRouteController",init:function(e,t){t=t||{},this.content=t.content,this.data=t.data},getConfigData:function(e){return e?this.data[e]:this.data},perform:function(e){var t=e.type;if(this[t])return this[t].call(this,e)}}),c=t.Evented.inherit({klassName:"SpaPage",init:function(e){e=t.mixin({routeViewer:"body"},e),this._params=e,this._rvc=document.querySelector(e.routeViewer),this._router=o,o.on("routed",t.proxy(this,"refresh"))},prepare:function(){},refresh:function(){var e=o.current(),i=(o.previous(),e.route.render(e));void 0!==i&&null!==i&&(t.isString(i)?this._rvc.innerHTML=i:(this._rvc.innerHTML="",this._rvc.appendChild(i)),e.route.trigger(r("rendered",{route:e.route,content:i})))}}),h=t.Evented.inherit({klassName:"SpaPlugin",init:function(e,i){this.name=e,t.isString(i.hookers)&&(i.hookers=i.hookers.split(" ")),this._setting=i},isHooked:function(e){var t=this._setting.hookers||[];return t.indexOf(e)>-1},prepare:function(){var e=new n,i=this._setting,s=i.controller,a=this.controller,l=this;return require([s.type],function(n){a=l.controller=new n(s),o.on(i.hookers,{plugin:l},t.proxy(a.perform,a)),e.resolve()}),e.then(function(){var e=r("preparing",{plugin:l,result:!0});return l.trigger(e),n.when(e.result).then(function(){l._prepared=!0})})},trigger:function(e){var t=this.controller;return t?t.perform(e):this.overrided(e)}}),u=t.Evented.inherit({klassName:"SpaPluginController",init:function(e){this.plugin=e},perform:function(e){var t=e.type;if(this[t])return this[t].call(this,e)}}),d=t.Evented.inherit({klassName:"SpaApplication",init:function(e){if(s)return s;var i=this._plugins={};e=this._config=t.mixin({plugins:{}},e,!0),t.each(e.plugins,function(e,t){i[e]=new h(e,t)}),o.routes(e.routes),this._router=o,this._page=new f.Page(e.page),document.title=e.title;var n=e.baseUrl;void 0===n&&(n=e.baseUrl=new t.URL(document.baseURI).pathname),o.baseUrl(n),e.homePath&&o.homePath(e.homePath),s=this},baseUrl:function(){return o.baseUrl()},getConfig:function(e){return e?this._config[e]:this._config},go:function(e,t){return o.go(e,t),this},page:function(){return this._page},prepare:function(){if(this._prepared)return n.resolve();var e=this,i=t.map(this._plugins,function(e,t){if(e.isHooked("starting"))return e.prepare()});return n.all(i).then(function(){o.trigger(r("starting",{spa:e}));var i=t.map(o.routes(),function(e,t){if(!1===e.lazy)return e.prepare()}),s=t.map(e._plugins,function(e,t){if(!e.isHooked("starting"))return e.prepare()});return n.all(i.concat(s)).then(function(){e._prepared=!0})})},run:function(){this._router.start(),o.trigger(r("started",{spa:this}))}}),f=function(e){return s||(window[e.name||"app"]=s=new f.Application(e)),s};return t.mixin(f,{Application:d,Page:c,Plugin:h,PluginController:u,Route:a,router:o,RouteController:l}),e.attach("appify.spa",f)}),define("skylark-appify-spa/main",["./spa"],function(e){return e}),define("skylark-appify-spa",["skylark-appify-spa/main"],function(e){return e}),define("skylark-appify-shells/shells",["skylark-langx/skylark"],function(e){return e.attach("appify.shells")}),define("skylark-nprogress/nprogress",[],function(){return function(){var e={version:"0.2.0"},t=e.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function i(e,t,i){return e<t?t:e>i?i:e}function n(e){return 100*(-1+e)}e.configure=function(e){var i,n;for(i in e)void 0!==(n=e[i])&&e.hasOwnProperty(i)&&(t[i]=n);return this},e.status=null,e.set=function(r){var s=e.isStarted();r=i(r,t.minimum,1),e.status=1===r?null:r;var l=e.render(!s),c=l.querySelector(t.barSelector),h=t.speed,u=t.easing;return l.offsetWidth,o(function(i){""===t.positionUsing&&(t.positionUsing=e.getPositioningCSS()),a(c,function(e,i,r){var s;s="translate3d"===t.positionUsing?{transform:"translate3d("+n(e)+"%,0,0)"}:"translate"===t.positionUsing?{transform:"translate("+n(e)+"%,0)"}:{"margin-left":n(e)+"%"};return s.transition="all "+i+"ms "+r,s}(r,h,u)),1===r?(a(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout(function(){a(l,{transition:"all "+h+"ms linear",opacity:0}),setTimeout(function(){e.remove(),i()},h)},h)):setTimeout(i,h)}),this},e.isStarted=function(){return"number"==typeof e.status},e.start=function(){e.status||e.set(0);var i=function(){setTimeout(function(){e.status&&(e.trickle(),i())},t.trickleSpeed)};return t.trickle&&i(),this},e.done=function(t){return t||e.status?e.inc(.3+.5*Math.random()).set(1):this},e.inc=function(t){var n=e.status;return n?("number"!=typeof t&&(t=(1-n)*i(Math.random()*n,.1,.95)),n=i(n+t,0,.994),e.set(n)):e.start()},e.trickle=function(){return e.inc(Math.random()*t.trickleRate)},r=0,s=0,e.promise=function(t){return t&&"resolved"!==t.state()?(0===s&&e.start(),r++,s++,t.always(function(){0==--s?(r=0,e.done()):e.set((r-s)/r)}),this):this},e.render=function(i){if(e.isRendered())return document.getElementById("nprogress");c(document.documentElement,"nprogress-busy");var r=document.createElement("div");r.id="nprogress",r.innerHTML=t.template;var s,o=r.querySelector(t.barSelector),l=i?"-100":n(e.status||0),h=document.querySelector(t.parent);return a(o,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),t.showSpinner||(s=r.querySelector(t.spinnerSelector))&&d(s),h!=document.body&&c(h,"nprogress-custom-parent"),h.appendChild(r),r},e.remove=function(){h(document.documentElement,"nprogress-busy"),h(document.querySelector(t.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&d(e)},e.isRendered=function(){return!!document.getElementById("nprogress")},e.getPositioningCSS=function(){var e=document.body.style,t="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return t+"Perspective"in e?"translate3d":t+"Transform"in e?"translate":"margin"};var r,s;var o=function(){var e=[];function t(){var i=e.shift();i&&i(t)}return function(i){e.push(i),1==e.length&&t()}}(),a=function(){var e=["Webkit","O","Moz","ms"],t={};function i(i){return i=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()}),t[i]||(t[i]=function(t){var i=document.body.style;if(t in i)return t;var n,r=e.length,s=t.charAt(0).toUpperCase()+t.slice(1);for(;r--;)if((n=e[r]+s)in i)return n;return t}(i))}function n(e,t,n){t=i(t),e.style[t]=n}return function(e,t){var i,r,s=arguments;if(2==s.length)for(i in t)void 0!==(r=t[i])&&t.hasOwnProperty(i)&&n(e,i,r);else n(e,s[1],s[2])}}();function l(e,t){var i="string"==typeof e?e:u(e);return i.indexOf(" "+t+" ")>=0}function c(e,t){var i=u(e),n=i+t;l(i,t)||(e.className=n.substring(1))}function h(e,t){var i,n=u(e);l(e,t)&&(i=n.replace(" "+t+" "," "),e.className=i.substring(1,i.length-1))}function u(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function d(e){e&&e.parentNode&&e.parentNode.removeChild(e)}return e}}),define("skylark-nprogress/main",["./nprogress"],function(e){return e}),define("skylark-nprogress",["skylark-nprogress/main"],function(e){return e}),define("skylark-bootbox4/bootbox",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-query","skylark-domx-data","skylark-domx-styler"],function(e,t,i){"use strict";var n={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},r={locale:"en",backdrop:"static",animate:!0,className:null,closeButton:!0,show:!0,container:"body"},s={};function o(e){var t=f[r.locale];return t?t[e]:f.en[e]}function a(e,i,n){e.stopPropagation(),e.preventDefault();var r=t.isFunction(n)&&!1===n.call(i,e);r||i.modal("hide")}function l(e,i){var n=0;t.each(e,function(e,t){i(e,t,n++)})}function c(e,i,n){return t.extend(!0,{},e,function(e,t){var i=e.length,n={};if(i<1||i>2)throw new Error("Invalid argument length");2===i||"string"==typeof e[0]?(n[t[0]]=e[0],n[t[1]]=e[1]):n=e[0];return n}(i,n))}function h(e,t,i,n){var r={className:"bootbox-"+e,buttons:u.apply(null,t)};return d(c(r,n,i),t)}function u(){for(var e={},t=0,i=arguments.length;t<i;t++){var n=arguments[t],r=n.toLowerCase(),s=n.toUpperCase();e[r]={label:o(s)}}return e}function d(e,t){var i={};return l(t,function(e,t){i[t]=!0}),l(e.buttons,function(e){if(void 0===i[e])throw new Error("button key "+e+" is not allowed (options are "+t.join("\n")+")")}),e}s.alert=function(){var e;if((e=h("alert",["ok"],["message","callback"],arguments)).callback&&!t.isFunction(e.callback))throw new Error("alert requires callback property to be a function when provided");return e.buttons.ok.callback=e.onEscape=function(){return!t.isFunction(e.callback)||e.callback.call(this)},s.dialog(e)},s.confirm=function(){var e;if((e=h("confirm",["cancel","confirm"],["message","callback"],arguments)).buttons.cancel.callback=e.onEscape=function(){return e.callback.call(this,!1)},e.buttons.confirm.callback=function(){return e.callback.call(this,!0)},!t.isFunction(e.callback))throw new Error("confirm requires a callback");return s.dialog(e)},s.prompt=function(){var e,r,o,a,h,f,p;if(a=i(n.form),r={className:"bootbox-prompt",buttons:u("cancel","confirm"),value:"",inputType:"text"},e=d(c(r,arguments,["title","callback"]),["cancel","confirm"]),f=void 0===e.show||e.show,e.message=a,e.buttons.cancel.callback=e.onEscape=function(){return e.callback.call(this,null)},e.buttons.confirm.callback=function(){var t;switch(e.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":t=h.val();break;case"checkbox":var n=h.find("input:checked");t=[],l(n,function(e,n){t.push(i(n).val())})}return e.callback.call(this,t)},e.show=!1,!e.title)throw new Error("prompt requires a title");if(!t.isFunction(e.callback))throw new Error("prompt requires a callback");if(!n.inputs[e.inputType])throw new Error("invalid prompt type");switch(h=i(n.inputs[e.inputType]),e.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":h.val(e.value);break;case"select":var m={};if(p=e.inputOptions||[],!t.isArray(p))throw new Error("Please pass an array of input options");if(!p.length)throw new Error("prompt with select requires options");l(p,function(e,t){var n=h;if(void 0===t.value||void 0===t.text)throw new Error("given options in wrong format");t.group&&(m[t.group]||(m[t.group]=i("<optgroup/>").attr("label",t.group)),n=m[t.group]),n.append("<option value='"+t.value+"'>"+t.text+"</option>")}),l(m,function(e,t){h.append(t)}),h.val(e.value);break;case"checkbox":var g=t.isArray(e.value)?e.value:[e.value];if(!(p=e.inputOptions||[]).length)throw new Error("prompt with checkbox requires options");if(!p[0].value||!p[0].text)throw new Error("given options in wrong format");h=i("<div/>"),l(p,function(t,r){var s=i(n.inputs[e.inputType]);s.find("input").attr("value",r.value),s.find("label").append(r.text),l(g,function(e,t){t===r.value&&s.find("input").prop("checked",!0)}),h.append(s)})}return e.placeholder&&h.attr("placeholder",e.placeholder),e.pattern&&h.attr("pattern",e.pattern),e.maxlength&&h.attr("maxlength",e.maxlength),a.append(h),a.on("submit",function(e){e.preventDefault(),e.stopPropagation(),o.find(".btn-primary").click()}),(o=s.dialog(e)).off("shown.bs.modal"),o.on("shown.bs.modal",function(){h.focus()}),!0===f&&o.modal("show"),o},s.dialog=function(e){e=function(e){var i,n;if("object"!=typeof e)throw new Error("Please supply an object of options");if(!e.message)throw new Error("Please specify a message");(e=t.extend({},r,e)).buttons||(e.buttons={});return i=e.buttons,n=function(e){var t,i=0;for(t in e)i++;return i}(i),l(i,function(e,r,s){if(t.isFunction(r)&&(r=i[e]={callback:r}),"object"!==t.type(r))throw new Error("button with key "+e+" must be an object");r.label||(r.label=e),r.className||(r.className=n<=2&&s===n-1?"btn-primary":"btn-default")}),e}(e);var s=i(n.dialog),o=s.find(".modal-dialog"),c=s.find(".modal-body"),h=e.buttons,u="",d={onEscape:e.onEscape};if(void 0===i.fn.modal)throw new Error("$.fn.modal is not defined; please double check you have included the Bootstrap JavaScript library. See http://getbootstrap.com/javascript/ for more details.");if(l(h,function(e,t){u+="<button data-bb-handler='"+e+"' type='button' class='btn "+t.className+"'>"+t.label+"</button>",d[e]=t.callback}),c.find(".bootbox-body").html(e.message),!0===e.animate&&s.addClass("fade"),e.className&&s.addClass(e.className),"large"===e.size?o.addClass("modal-lg"):"small"===e.size&&o.addClass("modal-sm"),e.title&&c.before(n.header),e.closeButton){var f=i(n.closeButton);e.title?s.find(".modal-header").prepend(f):f.css("margin-top","-10px").prependTo(c)}return e.title&&s.find(".modal-title").html(e.title),u.length&&(c.after(n.footer),s.find(".modal-footer").html(u)),s.on("hidden.bs.modal",function(e){e.target===this&&s.remove()}),s.on("shown.bs.modal",function(){s.find(".btn-primary:first").focus()}),"static"!==e.backdrop&&s.on("click.dismiss.bs.modal",function(e){s.children(".modal-backdrop").length&&(e.currentTarget=s.children(".modal-backdrop").get(0)),e.target===e.currentTarget&&s.trigger("escape.close.bb")}),s.on("escape.close.bb",function(e){d.onEscape&&a(e,s,d.onEscape)}),s.on("click",".modal-footer button",function(e){var t=i(this).data("bb-handler");a(e,s,d[t])}),s.on("click",".bootbox-close-button",function(e){a(e,s,d.onEscape)}),s.on("keyup",function(e){27===e.which&&s.trigger("escape.close.bb")}),i(e.container).append(s),s.modal({backdrop:!!e.backdrop&&"static",keyboard:!1,show:!1}),e.show&&s.modal("show"),s},s.setDefaults=function(){var e={};2===arguments.length?e[arguments[0]]=arguments[1]:e=arguments[0],t.extend(r,e)},s.hideAll=function(){return i(".bootbox").modal("hide"),s};var f={bg_BG:{OK:"Ок",CANCEL:"Отказ",CONFIRM:"Потвърждавам"},br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zrušit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"Εντάξει",CANCEL:"Ακύρωση",CONFIRM:"Επιβεβαίωση"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fa:{OK:"قبول",CANCEL:"لغو",CONFIRM:"تایید"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},hu:{OK:"OK",CANCEL:"Mégsem",CONFIRM:"Megerősít"},hr:{OK:"OK",CANCEL:"Odustani",CONFIRM:"Potvrdi"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"キャンセル",CONFIRM:"確認"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sq:{OK:"OK",CANCEL:"Anulo",CONFIRM:"Prano"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},th:{OK:"ตกลง",CANCEL:"ยกเลิก",CONFIRM:"ยืนยัน"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return s.addLocale=function(e,i){return t.each(["OK","CANCEL","CONFIRM"],function(e,t){if(!i[t])throw new Error("Please supply a translation for '"+t+"'")}),f[e]={OK:i.OK,CANCEL:i.CANCEL,CONFIRM:i.CONFIRM},s},s.removeLocale=function(e){return delete f[e],s},s.setLocale=function(e){return s.setDefaults("locale",e)},s.init=function(e){return init(e||i)},e.attach("itg.bootbox",s)}),define("skylark-bootbox4/main",["./bootbox"],function(e){return e}),define("skylark-bootbox4",["skylark-bootbox4/main"],function(e){return e}),define("skylark-visibility/fallback",[],function(){if(!document.visibilityState&&!document.webkitVisibilityState){document.hidden=!1,document.visibilityState="visible";var e=null,t=function(){document.createEvent?(e||(e=document.createEvent("HTMLEvents")).initEvent("visibilitychange",!0,!0),document.dispatchEvent(e)):"object"==typeof Visibility&&Visibility._change.call(Visibility,{})},i=function(){document.hidden=!1,document.visibilityState="visible",t()},n=function(){document.hidden=!0,document.visibilityState="hidden",t()};document.addEventListener?(window.addEventListener("focus",i,!0),window.addEventListener("blur",n,!0)):(document.attachEvent("onfocusin",i),document.attachEvent("onfocusout",n))}}),define("skylark-visibility/core",["./fallback"],function(){if(window.Visibility)return window.Visibility;var e=-1,t={onVisible:function(e){var i=t.isSupported();if(!i||!t.hidden())return e(),i;var n=t.change(function(i,r){t.hidden()||(t.unbind(n),e())});return n},change:function(i){if(!t.isSupported())return!1;var n=e+=1;return t._callbacks[n]=i,t._listen(),n},unbind:function(e){delete t._callbacks[e]},afterPrerendering:function(e){var i=t.isSupported();if(!i||"prerender"!=t.state())return e(),i;var n=t.change(function(i,r){"prerender"!=r&&(t.unbind(n),e())});return n},hidden:function(){return!(!t._doc.hidden&&!t._doc.webkitHidden)},state:function(){return t._doc.visibilityState||t._doc.webkitVisibilityState||"visible"},isSupported:function(){return void 0!==t._doc.hidden||void 0!==t._doc.webkitHidden},_doc:document||{},_callbacks:{},_change:function(e){var i=t.state();for(var n in t._callbacks)t._callbacks[n].call(t._doc,e,i)},_listen:function(){if(!t._init){var e="visibilitychange";t._doc.webkitVisibilityState&&(e="webkit"+e);var i=function(){t._change.apply(t,arguments)};t._doc.addEventListener?t._doc.addEventListener(e,i):t._doc.attachEvent(e,i),t._init=!0}}};return window.Visibility=t}),define("skylark-visibility/visibility",["./core"],function(e){var t,i=-1;return(t=e).every=function(e,n,r){t._time(),r||(r=n,n=null);var s=i+=1;return t._timers[s]={visible:e,hidden:n,callback:r},t._run(s,!1),t.isSupported()&&t._listen(),s},t.stop=function(e){return!!t._timers[e]&&(t._stop(e),delete t._timers[e],!0)},t._timers={},t._time=function(){t._timed||(t._timed=!0,t._wasHidden=t.hidden(),t.change(function(){t._stopRun(),t._wasHidden=t.hidden()}))},t._run=function(e,i){var n,r=t._timers[e];if(t.hidden()){if(null===r.hidden)return;n=r.hidden}else n=r.visible;var s=function(){r.last=new Date,r.callback.call(window)};if(i){var o=new Date-r.last;n>o?r.delay=setTimeout(function(){r.id=setInterval(s,n),s()},n-o):(r.id=setInterval(s,n),s())}else r.id=setInterval(s,n)},t._stop=function(e){var i=t._timers[e];clearInterval(i.id),clearTimeout(i.delay),delete i.id,delete i.delay},t._stopRun=function(e){var i=t.hidden(),n=t._wasHidden;if(i&&!n||!i&&n)for(var r in t._timers)t._stop(r),t._run(r,!i)},t}),define("skylark-visibility/main",["./visibility"],function(e){return e}),define("skylark-visibility",["skylark-visibility/main"],function(e){return e}),define("skylark-tinycon/tinycon",["skylark-langx-ns"],function(e){var t,i={},n=null,r=null,s=null,o=null,a={},l=window.devicePixelRatio||1,c=16*l,h={width:7,height:9,font:10*l+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},u=(t=navigator.userAgent.toLowerCase(),function(e){return-1!==t.indexOf(e)}),d={ie:u("trident"),chrome:u("chrome"),webkit:u("chrome")||u("safari"),safari:u("safari")&&!u("chrome"),mozilla:u("mozilla")&&!u("chrome")&&!u("safari")},f=function(){if(!r||!n){var e=function(){for(var e=document.getElementsByTagName("link"),t=0,i=e.length;t<i;t++)if((e[t].getAttribute("rel")||"").match(/\bicon\b/i))return e[t];return!1}();n=e?e.getAttribute("href"):"/favicon.ico",r||(r=n)}return n},p=function(){return o||((o=document.createElement("canvas")).width=c,o.height=c),o},m=function(e){if(e){!function(){for(var e=document.getElementsByTagName("link"),t=document.getElementsByTagName("head")[0],i=0,n=e.length;i<n;i++){var r=void 0!==e[i];r&&(e[i].getAttribute("rel")||"").match(/\bicon\b/i)&&t.removeChild(e[i])}}();var t=document.createElement("link");t.type="image/x-icon",t.rel="icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}},g=function(e){if(a.fallback){var t=document.title;"("===t[0]&&(t=t.slice(t.indexOf(" "))),document.title=(e+"").length>0?"("+e+") "+t:t}},v=function(e,t,i){"number"==typeof t&&t>99&&a.abbreviate&&(t=k(t));var n=(t+"").length-1,r=a.width*l+6*l*n,s=a.height*l,o=c-s,h=c-r-l,u=16*l,f=16*l,p=2*l;e.font=(d.webkit?"bold ":"")+a.font,e.fillStyle=a.background,e.strokeStyle=a.background,e.lineWidth=l,e.beginPath(),e.moveTo(h+p,o),e.quadraticCurveTo(h,o,h,o+p),e.lineTo(h,u-p),e.quadraticCurveTo(h,u,h+p,u),e.lineTo(f-p,u),e.quadraticCurveTo(f,u,f,u-p),e.lineTo(f,o+p),e.quadraticCurveTo(f,o,f-p,o),e.closePath(),e.fill(),e.beginPath(),e.strokeStyle="rgba(0,0,0,0.3)",e.moveTo(h+p/2,u),e.lineTo(f-p/2,u),e.stroke(),e.fillStyle=a.color,e.textAlign="right",e.textBaseline="top",e.fillText(t,2===l?29:15,d.mozilla?7*l:6*l)},y=function(){p().getContext&&m(p().toDataURL())},k=function(e){for(var t=[["G",1e9],["M",1e6],["k",1e3]],i=0;i<t.length;++i)if(e>=t[i][1]){e=b(e/t[i][1])+t[i][0];break}return e},b=function(e,t){var i=new Number(e);return i.toFixed(t)};return i.setOptions=function(e){for(var t in a={},e.colour&&(e.color=e.colour),h)a[t]=e.hasOwnProperty(t)?e[t]:h[t];return this},i.setImage=function(e){return n=e,y(),this},i.setBubble=function(e,t){return function(e,t){if(!p().getContext||d.ie||d.safari||"force"===a.fallback)return g(e);var i=p().getContext("2d"),t=t||"#000000",n=f();(s=document.createElement("img")).onload=function(){i.clearRect(0,0,c,c),i.drawImage(s,0,0,s.width,s.height,0,0,c,c),(e+"").length>0&&v(i,e,t),y()},!n.match(/^data/)&&a.crossOrigin&&(s.crossOrigin="anonymous");s.src=n}(e=e||"",t),this},i.reset=function(){n=r,m(r)},i.setOptions(h),e.attach("itg.tinycon",i)}),define("skylark-tinycon/main",["./tinycon"],function(e){return e}),define("skylark-tinycon",["skylark-tinycon/main"],function(e){return e}),define("skylark-appify-shells/shell",["skylark-langx/langx","skylark-domx-css","skylark-langx-scripter","skylark-domx-finder","skylark-domx-query","skylark-domx-plugins-base","skylark-nprogress","skylark-bootbox4","skylark-visibility","skylark-tinycon","./shells"],function(e,t,i,n,r,s,o,a,l,c,h){function u(e,t){e.find("strong").html(t.title),e.find("p").html(t.message),e.attr("class","alert alert-dismissable alert-"+t.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),t.timeout&&f(e,t.timeout),e.children().fadeOut(100),t.translate(e.html(),function(t){e.children().fadeIn(100),e.html(t)}),e.off("click").removeClass("pointer"),"function"==typeof t.clickfn&&e.addClass("pointer").on("click",function(i){r(i.target).is(".close")||t.clickfn(),d(e)})}function d(e){e.fadeOut(500,function(){r(this).remove()})}function f(e,t){var i=setTimeout(function(){d(e)},t);e.attr("timeoutId",i),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(t+450)+"ms linear, background-color "+(t+450)+"ms ease-in"),e.addClass("animate")},50),e.on("mouseenter",function(){r(this).css("transition-duration",0)})}var p=s.Plugin.inherit({options:{i18n:{locale:"en",translate:function(t){return e.Deferred.resolve(t)}},alerts:{container:"",titles:{success:"[[global:alert.success]]",error:"[[global:alert.error]]"}},templator:{parse:null},skins:{}},_construct:function(e){s.Plugin.prototype._construct.call(this,document.body,e),this._titleObj={active:!1,interval:void 0,titles:[]};var t=this;t.isFocused=!0,l.change(function(e,i){"visible"===i?(t.isFocused=!0,t.alternatingTitle("")):"hidden"===i&&(t.isFocused=!1)})},progress:function(){return o},alert:function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:(new Date).getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";var t=r("#"+e.alert_id);e.translate=e.translate||this.option("i18n.translate"),t.length?u(t,e):(e.parseTemplate=e.parseTemplate||this.option("templator.parse"),e.container=e.container||this.option("alerts.container"),function(e,t){e.parseTemplate("alert",e,function(t){e.translate(t,function(t){var i=r("#"+e.alert_id);if(i.length)return u(i,e);(i=r(t)).fadeIn(200),e.container.prepend(i),i.find("button").on("click",function(){return"function"==typeof e.closefn&&e.closefn(),d(i),!1}),e.timeout&&f(i,e.timeout),"function"==typeof e.clickfn&&i.addClass("pointer").on("click",function(t){r(t.target).is(".close")||e.clickfn(),d(i)})})})}(e))},removeAlert:function(e){r("#alert_button_"+e).remove()},alertSuccess:function(e,t){this.alert({title:this.option("alerts.titles.success"),message:e,type:"success",timeout:t||5e3})},alertError:function(e,t){e=e.message||e,this.alert({title:this.option("alerts.titles.error"),message:e,type:"danger",timeout:t||1e4})},alternatingTitle:function(e){if("string"==typeof e){var t=this._titleObj;if(e.length>0&&!app.isFocused){t.titles[0]||(t.titles[0]=window.document.title);var i=this.option("i18n.translate");i(e,function(e){t.titles[1]=e,t.interval&&clearInterval(t.interval),t.interval=setInterval(function(){var e=t.titles[1^t.titles.indexOf(window.document.title)];e&&(window.document.title=r("<div/>").html(e).text())},2e3)})}else t.interval&&clearInterval(t.interval),t.titles[0]&&(window.document.title=r("<div/>").html(t.titles[0]).text())}},refreshTitle:function(e){var t=this,i=this.option("i18n.translate"),n=this._titleObj;i(e,function(e){n.titles[0]=e,t.alternatingTitle("")})},tinycon:function(t,i){e.isUndefined(i)&&e.isPlainObject(t)&&(i=t,t=void 0),e.isDefined(i)&&c.setOptions(i),e.isDefined(t)&&c.setBubble(t)},reskin:function(e,t,i){if(i||(i=document.getElementById("skinSheet"))){var n=r("body").attr("class").split(/\s+/).filter(function(e){return e.startsWith("skin-")}),s=n[0].slice(5);if(e!==(s="noskin"!==s?s:"")){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=t,o.onload=function(){i.parentNode.removeChild(i),r("body").removeClass(n.join(" ")),r("body").addClass("skin-"+(e||"noskin"))},document.head.appendChild(o)}}},loadStyleSheet:function(e,i,n,r){return t.loadStyleSheet(e,i,n,r)},removeStyleSheet:function(e){return t.removeStyleSheet(e)},loadScript:function(e,t,n){return i.loadJavaScript(e,t,n)},removeScript:function(e){return i.deleteJavaScript(e)}});return h.Shell=p}),define("skylark-appify-shells/main",["./shells","./shell"],function(e){return e}),define("skylark-appify-shells",["skylark-appify-shells/main"],function(e){return e}),define("skylark-data-entities/entities",["skylark-langx/langx"],function(e){function t(){return t}return e.mixin(t,{emulateHTTP:!1,emulateJSON:!1,backends:{}}),t}),define("skylark-data-entities/Entity",["skylark-langx/langx","./entities"],function(e,t){var i=function(e,t){var i=t.error;t.error=function(n){i&&i.call(t.context,e,n,t),e.trigger("error",e,n,t)}},n=e.Stateful.inherit({sync:function(){return t.sync.apply(this,arguments)},matches:function(t){return e.isMatch(this.attributes,t)},fetch:function(t){var n=this,r=(t=e.mixin({parse:!0},t)).success;return t.success=function(e){var i=t.parse?n.parse(e,t):e;if(!n.set(i,t))return!1;r&&r.call(t.context,n,e,t),n.trigger("sync",n,e,t)},i(this,t),this.sync("read",this,t)},save:function(t,n,r){var s;null==t||"object"==typeof t?(s=t,r=n):(s={})[t]=n;var o=(r=e.mixin({validate:!0,parse:!0},r)).wait;if(s&&!o){if(!this.set(s,r))return!1}else if(!this._validate(s,r))return!1;var a=this,l=r.success,c=this.attributes;r.success=function(t){a.attributes=c;var i=r.parse?a.parse(t,r):t;if(o&&(i=e.mixin({},s,i)),i&&!a.set(i,r))return!1;l&&l.call(r.context,a,t,r),a.trigger("sync",a,t,r)},i(this,r),s&&o&&(this.attributes=e.mixin({},c,s));var h=this.isNew()?"create":r.patch?"patch":"update";"patch"!==h||r.attrs||(r.attrs=s);var u=this.sync(h,this,r);return this.attributes=c,u},destroy:function(t){var n=this,r=(t=t?e.clone(t):{}).success,s=t.wait,o=function(){n.stopListening(),n.trigger("destroy",n,n.collection,t)};t.success=function(e){s&&o(),r&&r.call(t.context,n,e,t),n.isNew()||n.trigger("sync",n,e,t)};var a=!1;return this.isNew()?e.defer(t.success):(i(this,t),a=this.sync("delete",this,t)),s||o(),a},url:function(){var t=e.result(this,"urlRoot")||e.result(this.collection,"url")||urlError();if(this.isNew())return t;var i=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(i)},parse:function(e,t){return e}});return t.Entity=n}),define("skylark-data-entities/Collection",["skylark-langx/langx","./entities","./Entity"],function(e,t,i){var n=e.Evented.inherit({_construct:function(t,i){i||(i={}),i.entity&&(this.entity=i.entity),void 0!==i.comparator&&(this.comparator=i.comparator),this._reset(),t&&this.reset(t,e.mixin({silent:!0},i))}}),r={add:!0,remove:!0,merge:!0},s={add:!0,remove:!1},o=function(e,t,i){i=Math.min(Math.max(i,0),e.length);var n,r=Array(e.length-i),s=t.length;for(n=0;n<r.length;n++)r[n]=e[n+i];for(n=0;n<s;n++)e[n+i]=t[n];for(n=0;n<r.length;n++)e[n+s+i]=r[n]};return n.partial({entity:i,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,i){return this.set(t,e.mixin({merge:!1},i,s))},remove:function(t,i){i=e.mixin({},i);var n=!e.isArray(t);t=n?[t]:t.slice();var r=this._removeEntitys(t,i);return!i.silent&&r.length&&(i.changes={added:[],merged:[],removed:r},this.trigger("update",this,i)),n?r[0]:r},set:function(t,i){if(null!=t){(i=e.mixin({},r,i)).parse&&!this._isEntity(t)&&(t=this.parse(t,i)||[]);var n=!e.isArray(t);t=n?[t]:t.slice();var s=i.at;null!=s&&(s=+s),s>this.length&&(s=this.length),s<0&&(s+=this.length+1);var a,l,c=[],h=[],u=[],d=[],f={},p=i.add,m=i.merge,g=i.remove,v=!1,y=this.comparator&&null==s&&!1!==i.sort,k=e.isString(this.comparator)?this.comparator:null;for(l=0;l<t.length;l++){a=t[l];var b=this.get(a);if(b){if(m&&a!==b){var x=this._isEntity(a)?a.attributes:a;i.parse&&(x=b.parse(x,i)),b.set(x,i),u.push(b),y&&!v&&(v=b.hasChanged(k))}f[b.cid]||(f[b.cid]=!0,c.push(b)),t[l]=b}else p&&(a=t[l]=this._prepareEntity(a,i))&&(h.push(a),this._addReference(a,i),f[a.cid]=!0,c.push(a))}if(g){for(l=0;l<this.length;l++)a=this.entities[l],f[a.cid]||d.push(a);d.length&&this._removeEntitys(d,i)}var w=!1,_=!y&&p&&g;if(c.length&&_?(w=this.length!==c.length||this.entities.some(function(e,t){return e!==c[t]}),this.entities.length=0,o(this.entities,c,0),this.length=this.entities.length):h.length&&(y&&(v=!0),o(this.entities,h,null==s?this.length:s),this.length=this.entities.length),v&&this.sort({silent:!0}),!i.silent){for(l=0;l<h.length;l++)null!=s&&(i.index=s+l),(a=h[l]).trigger("add",a,this,i);(v||w)&&this.trigger("sort",this,i),(h.length||d.length||u.length)&&(i.changes={added:h,removed:d,merged:u},this.trigger("update",this,i))}return n?t[0]:t}},reset:function(t,i){i=i?e.clone(i):{};for(var n=0;n<this.entities.length;n++)this._removeReference(this.entities[n],i);return i.previousEntitys=this.entities,this._reset(),t=this.add(t,e.mixin({silent:!0},i)),i.silent||this.trigger("reset",this,i),t},push:function(t,i){return this.add(t,e.mixin({at:this.length},i))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(t,i){return this.add(t,e.mixin({at:0},i))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return slice.apply(this.entities,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.entityId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.entities[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(t){var i=this.comparator;if(!i)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=i.length;return e.isFunction(i)&&(i=e.proxy(i,this)),1===n||e.isString(i)?this.entities=this.sortBy(i):this.entities.sort(i),t.silent||this.trigger("sort",this,t),this},pluck:function(e){return this.map(e+"")},fetch:function(t){var i=(t=e.mixin({parse:!0},t)).success,n=this;return t.success=function(e){var r=t.reset?"reset":"set";n[r](e,t),i&&i.call(t.context,n,e,t),n.trigger("sync",n,e,t)},function(e,t){var i=t.error;t.error=function(n){i&&i.call(t.context,e,n,t),e.trigger("error",e,n,t)}}(this,t),this.sync("read",this,t)},create:function(t,i){var n=(i=i?e.clone(i):{}).wait;if(!(t=this._prepareEntity(t,i)))return!1;n||this.add(t,i);var r=this,s=i.success;return i.success=function(e,t,i){n&&r.add(e,i),s&&s.call(i.context,e,t,i)},t.save(null,i),t},parse:function(e,t){return e},clone:function(){return new this.constructor(this.entities,{entity:this.entity,comparator:this.comparator})},entityId:function(e){return e[this.entity.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.entities=[],this._byId={}},_prepareEntity:function(t,i){if(this._isEntity(t))return t.collection||(t.collection=this),t;(i=i?e.clone(i):{}).collection=this;var n=new this.entity(t,i);return n.validationError?(this.trigger("invalid",this,n.validationError,i),!1):n},_removeEntitys:function(e,t){for(var i=[],n=0;n<e.length;n++){var r=this.get(e[n]);if(r){var s=this.indexOf(r);this.entities.splice(s,1),this.length--,delete this._byId[r.cid];var o=this.entityId(r.attributes);null!=o&&delete this._byId[o],t.silent||(t.index=s,r.trigger("remove",r,this,t)),i.push(r),this._removeReference(r,t)}}return i},_isEntity:function(e){return e instanceof i},_addReference:function(e,t){this._byId[e.cid]=e;var i=this.entityId(e.attributes);null!=i&&(this._byId[i]=e),e.on("all",this._onEntityEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var i=this.entityId(e.attributes);null!=i&&delete this._byId[i],this===e.collection&&delete e.collection,e.off("all",this._onEntityEvent,this)},_onEntityEvent:function(e,t,i,n){if(t){if(("add"===e||"remove"===e)&&i!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){var r=this.entityId(t.previousAttributes()),s=this.entityId(t.attributes);r!==s&&(null!=r&&delete this._byId[r],null!=s&&(this._byId[s]=t))}}this.trigger.apply(this,arguments)}}),t.Collection=n}),define("skylark-data-entities/backends/registry",[],function(){var e={};return{add:function(t,i){e[t]=i},remove:function(e){delete provides[e]},get:function(t){return e[t]}}}),define("skylark-data-entities/sync",["skylark-langx/langx","./entities","./backends/registry"],function(e,t,i){return t.sync=function(t,n,r){if(!r.backend)throw new Error("The backend is not specified");var s=i.get(r.backend);if(!s)throw new Error("The backend is not defined:"+r.backend);var o=s.sync;if(!o)throw new Error("The backend sync method is not defined:"+r.backend);var a=e.mixin({},s.options,r);return o.apply(this,[t,n,a])}}),define("skylark-data-entities/backends/ajaxSync",["skylark-langx/langx","../entities"],function(e,t){var i={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};return t.backends.ajaxSync=function(n,r,s){var o=i[n];e.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};s.url||(a.url=e.result(r,"url")||urlError());null!=s.data||!r||"create"!==n&&"update"!==n&&"patch"!==n||(a.contentType="application/json",a.data=JSON.stringify(s.attrs||r.toJSON(s)));s.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{entity:a.data}:{});if(s.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",s.emulateJSON&&(a.data._method=o);var l=s.beforeSend;s.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",o),l)return l.apply(this,arguments)}}"GET"===a.type||s.emulateJSON||(a.processData=!1);var c=s.error;s.error=function(e,t,i){s.textStatus=t,s.errorThrown=i,c&&c.call(s.context,e,t,i)};var h=s.xhr=e.Xhr.request(e.mixin(a,s));return r.trigger("request",r,h,s),h}}),define("skylark-data-entities/backends/localSync",["skylark-langx/langx","../entities"],function(e,t){function i(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var n=e.klass({_construct:function(e){this.name=e;var t=this.localStorage().getItem(this.name);this.records=t&&t.split(",")||[]},save:function(){this.localStorage().setItem(this.name,this.records.join(","))},create:function(e){return e.id||(e.id=i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i(),e.set(e.idAttribute,e.id)),this.localStorage().setItem(this.name+"-"+e.id,JSON.stringify(e)),this.records.push(e.id.toString()),this.save(),this.find(e)},update:function(e){return this.localStorage().setItem(this.name+"-"+e.id,JSON.stringify(e)),_.include(this.records,e.id.toString())||this.records.push(e.id.toString()),this.save(),this.find(e)},find:function(e){return this.jsonData(this.localStorage().getItem(this.name+"-"+e.id))},findAll:function(){return _(this.records).chain().map(function(e){return this.jsonData(this.localStorage().getItem(this.name+"-"+e))},this).compact().value()},destroy:function(e){return!e.isNew()&&(this.localStorage().removeItem(this.name+"-"+e.id),this.records=_.reject(this.records,function(t){return t===e.id.toString()}),this.save(),e)},localStorage:function(){return localStorage},jsonData:function(e){return e&&JSON.parse(e)}});function r(t,i,n){var r,s,o=i.localStorage||i.collection.localStorage,a=e.Deferred();try{switch(t){case"read":r=void 0!=i.id?o.find(i):o.findAll();break;case"create":r=o.create(i);break;case"update":r=o.update(i);break;case"delete":r=o.destroy(i)}}catch(e){s=e.code===DOMException.QUOTA_EXCEEDED_ERR&&0===window.localStorage.length?"Private browsing is unsupported":e.message}return r?(i.trigger("sync",i,r,n),n&&n.success&&n.success(r),a&&a.resolve(r)):(s=s||"Record Not Found",n&&n.error&&n.error(s),a&&a.reject(s)),n&&n.complete&&n.complete(r),a&&a.promise()}return t.backends.LocalStorage=r.LocalStorage=n,t.backends.localSync=r}),define("skylark-data-entities/main",["./entities","./Collection","./Entity","./sync","./backends/ajaxSync","./backends/localSync","./backends/registry"],function(e){return e}),define("skylark-data-entities",["skylark-data-entities/main"],function(e){return e}),define("skylark-io-streams/streams",["skylark-langx-ns"],function(e){return e.attach("io.streams")}),define("skylark-langx-chars/chars",["skylark-langx-ns","skylark-langx-types"],function(e,t){return e.attach("langx.chars",{isWhiteSpace:function(e){return 32===e||9===e||13===e||10===e}})}),define("skylark-langx-chars/main",["./chars"],function(e){return e}),define("skylark-langx-chars",["skylark-langx-chars/main"],function(e){return e}),define("skylark-io-streams/decode-stream",["skylark-langx-events","skylark-langx-chars","./streams"],function(e,t,i){var n=new Uint8Array(0),r=e.Emitter.inherit({klassName:"DecodeStream",_construct:function(e){if(this._rawMinBufferLength=e||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=n,this.minBufferLength=512,e)for(;this.minBufferLength<e;)this.minBufferLength*=2},length:{get:function(){throw new Error("Should not access DecodeStream.length")}},isEmpty:{get:function(){for(;!this.eof&&0===this.bufferLength;)this.readBlock();return 0===this.bufferLength}},ensureBuffer:function(e){var t=this.buffer;if(e<=t.byteLength)return t;for(var i=this.minBufferLength;i<e;)i*=2;var n=new Uint8Array(i);return n.set(t),this.buffer=n},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]},getUint16:function(){var e=this.getByte(),t=this.getByte();return-1===e||-1===t?-1:(e<<8)+t},getInt32:function(){var e=this.getByte(),t=this.getByte(),i=this.getByte(),n=this.getByte();return(e<<24)+(t<<16)+(i<<8)+n},getBytes(e,t=!1){var i,n=this.pos;if(e){for(this.ensureBuffer(n+e),i=n+e;!this.eof&&this.bufferLength<i;)this.readBlock();var r=this.bufferLength;i>r&&(i=r)}else{for(;!this.eof;)this.readBlock();i=this.bufferLength}this.pos=i;const s=this.buffer.subarray(n,i);return!t||s instanceof Uint8ClampedArray?s:new Uint8ClampedArray(s)},peekByte:function(){var e=this.getByte();return-1!==e&&this.pos--,e},peekBytes(e,t=!1){var i=this.getBytes(e,t);return this.pos-=i.length,i},makeSubStream:function(e,t,i){for(var n=e+t;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,e,t,i)},getByteRange(e,t){throw new Error("Should not call DecodeStream.getByteRange")},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0},getBaseStreams:function(){return this.str&&this.str.getBaseStreams?this.str.getBaseStreams():[]}});return i.DecodeStream=r}),define("skylark-io-streams/ascii85-stream",["skylark-langx-chars","./streams","./decode-stream"],function(e,t,i){var n=i.inherit({klassName:"Ascii85Stream",_construct:function(e){this.str=e,this.dict=e.dict,this.input=new Uint8Array(5),maybeLength&&(maybeLength*=.8),i.prototype._construct.call(this,maybeLength)},readBlock:function(){for(var t=this.str,i=t.getByte();e.isWhiteSpace(i);)i=t.getByte();if(-1!==i&&126!==i){var n,r,s=this.bufferLength;if(122===i){for(n=this.ensureBuffer(s+4),r=0;r<4;++r)n[s+r]=0;this.bufferLength+=4}else{var o=this.input;for(o[0]=i,r=1;r<5;++r){for(i=t.getByte();e.isWhiteSpace(i);)i=t.getByte();if(o[r]=i,-1===i||126===i)break}if(n=this.ensureBuffer(s+r-1),this.bufferLength+=r-1,r<5){for(;r<5;++r)o[r]=117;this.eof=!0}var a=0;for(r=0;r<5;++r)a=85*a+(o[r]-33);for(r=3;r>=0;--r)n[s+r]=255&a,a>>=8}}else this.eof=!0}});return t.Ascii85Stream=n}),define("skylark-io-streams/ascii-hex-stream",["./streams","./decode-stream"],function(e,t){var i=t.inherit({klassName:"AsciiHexStream",_construct:function(e,i){this.str=e,this.dict=e.dict,this.firstDigit=-1,i&&(i*=.5),t.prototype._construct.call(this,i)},readBlock:function(){var e=this.str.getBytes(8e3);if(e.length){for(var t=e.length+1>>1,i=this.ensureBuffer(this.bufferLength+t),n=this.bufferLength,r=this.firstDigit,s=0,o=e.length;s<o;s++){var a,l=e[s];if(l>=48&&l<=57)a=15&l;else{if(!(l>=65&&l<=70||l>=97&&l<=102)){if(62===l){this.eof=!0;break}continue}a=9+(15&l)}r<0?r=a:(i[n++]=r<<4|a,r=-1)}r>=0&&this.eof&&(i[n++]=r<<4,r=-1),this.firstDigit=r,this.bufferLength=n}else this.eof=!0}});return e.AsciiHexStream=i}),define("skylark-io-streams/_stream",["skylark-langx-events","./streams"],function(e,t){var i=e.Emitter.inherit({klassName:"Stream",_construct:function(e,t,i,n){this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+i||this.bytes.length,this.dict=n},length:{get:function(){return this.end-this.start}},getByte:function(){return this.pos>=this.end?-1:this.bytes[this.pos++]},getUint16:function(){var e=this.getByte(),t=this.getByte();return-1===e||-1===t?-1:(e<<8)+t},getInt32:function(){var e=this.getByte(),t=this.getByte(),i=this.getByte(),n=this.getByte();return(e<<24)+(t<<16)+(i<<8)+n},getBytes(e,t=!1){var i=this.bytes,n=this.pos,r=this.end;if(!e){const e=i.subarray(n,r);return t?new Uint8ClampedArray(e):e}var s=n+e;s>r&&(s=r),this.pos=s;const o=i.subarray(n,s);return t?new Uint8ClampedArray(o):o},peekByte:function(){var e=this.getByte();return-1!==e&&this.pos--,e},peekBytes(e,t=!1){var i=this.getBytes(e,t);return this.pos-=i.length,i},getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),this.bytes.subarray(e,t)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(e,t,n){return new i(this.bytes.buffer,e,t,n)}});return t.Stream=i}),define("skylark-io-streams/chunked-stream",["./streams","./_stream"],function(e,t){var i=t.inherit({klassName:"ChunkedStream",numChunks:0,numChunksLoaded:0,_construct:function(e){for(var t=e.length,i=new Uint8Array(t),n=0;n<t;++n)i[n]=e.charCodeAt(n);DecodeStream.prototype._construct.call(i),this.dict=stream.dict},numChunks:function(){},getMissingChunks:function(){for(var e=[],t=0,i=this.numChunks;t<i;++t)t in this.loadedChunks||e.push(t);return e},getBaseStreams:function(){return[this]},allChunksLoaded:function(){var e=this._;return e.numChunksLoaded===e.numChunks},onReceiveData:function(e,t){var i=e+t.byteLength;assert(e%this.chunkSize==0,"Bad begin offset: "+e);var n=this.bytes.length;assert(i%this.chunkSize==0||i===n,"Bad end offset: "+i),this.bytes.set(new Uint8Array(t),e);for(var r=this.chunkSize,s=Math.floor(e/r),o=Math.floor((i-1)/r)+1,t=s;t<o;++t)t in this.loadedChunks||(this.loadedChunks[t]=!0,++this.numChunksLoaded)},onReceiveInitialData:function(e){this.bytes.set(e),this.initialDataLength=e.length;for(var t=this.end===e.length?this.numChunks:Math.floor(e.length/this.chunkSize),i=0;i<t;i++)this.loadedChunks[i]=!0,++this.numChunksLoaded},ensureRange:function(e,t){if(!(e>=t||t<=this.initialDataLength))for(var i=this.chunkSize,n=Math.floor(e/i),r=Math.floor((t-1)/i)+1,s=n;s<r;++s)if(!(s in this.loadedChunks))throw new MissingDataException(e,t)},nextEmptyChunk:function(e){for(var t=e,i=this.numChunks;t<i;++t)if(!(t in this.loadedChunks))return t;for(var t=0;t<e;++t)if(!(t in this.loadedChunks))return t;return null},hasChunk:function(e){return e in this._.loadedChunks},getByte:function(){var e=this.pos;return e>=this.end?-1:(this.ensureRange(e,e+1),this.bytes[this.pos++])},getBytes:function(e){var t=this.bytes,i=this.pos,n=this.end;if(!e)return this.ensureRange(i,n),t.subarray(i,n);var r=i+e;return r>n&&(r=n),this.ensureRange(i,r),this.pos=r,t.subarray(i,r)},peekBytes:function(e){var t=this.getBytes(e);return this.pos-=t.length,t},getByteRange:function(e,t){return this.ensureRange(e,t),this.bytes.subarray(e,t)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(e,t,i){function n(){}n.prototype=Object.create(this),n.prototype.getMissingChunks=function(){for(var e=this.chunkSize,t=Math.floor(this.start/e),i=Math.floor((this.end-1)/e)+1,n=[],r=t;r<i;++r)r in this.loadedChunks||n.push(r);return n};var r=new n;return r.pos=r.start=e,r.end=e+t||this.end,r.dict=i,r}});return e.ChunkedStream=i}),define("skylark-io-streams/decrypt-stream",["./streams","./decode-stream"],function(e,t){var i=t.inherit({klassName:"DecryptStream",_construct:function(e,i,n){this.str=e,this.dict=e.dict,this.decrypt=n,this.nextChunk=null,this.initialized=!1,t.prototype._construct.call(this,i)},readBlock:function(){var e;if(this.initialized?e=this.nextChunk:(e=this.str.getBytes(512),this.initialized=!0),e&&0!==e.length){this.nextChunk=this.str.getBytes(512);var t=this.nextChunk&&this.nextChunk.length>0,i=this.decrypt;e=i(e,!t);var n,r=this.bufferLength,s=e.length,o=this.ensureBuffer(r+s);for(n=0;n<s;n++)o[r++]=e[n];this.bufferLength=r}else this.eof=!0}});return e.DecryptStream=i}),define("skylark-io-streams/fake-stream",["./streams","./decode-stream"],function(e,t){var i=t.inherit({klassName:"FakeStream",_construct:function(e){this.dict=e.dict,t.prototype._construct.call(this)},readBlock:function(){var e=this.bufferLength;e+=1024;this.ensureBuffer(e);this.bufferLength=e},getBytes:function(e){var t,i=this.pos;if(e){for(this.ensureBuffer(i+e),t=i+e;!this.eof&&this.bufferLength<t;)this.readBlock();var n=this.bufferLength;t>n&&(t=n)}else this.eof=!0,t=this.bufferLength;return this.pos=t,this.buffer.subarray(i,t)}});return e.FakeStream=i}),define("skylark-io-streams/flate-stream",["./streams","./decode-stream"],function(e,t){var i=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),s=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],o=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5],a=t.inherit({klassName:"FlateStream",_construct:function(e,i){this.str=e,this.dict=e.dict;var n=e.getByte(),r=e.getByte();if(-1===n||-1===r)throw new util.FormatError(`Invalid header in flate stream: ${n}, ${r}`);if(8!=(15&n))throw new util.FormatError(`Unknown compression method in flate stream: ${n}, ${r}`);if(((n<<8)+r)%31!=0)throw new util.FormatError(`Bad FCHECK in flate stream: ${n}, ${r}`);if(32&r)throw new util.FormatError(`FDICT bit set in flate stream: ${n}, ${r}`);this.codeSize=0,this.codeBuf=0,t.prototype._construct.call(this,i)},getBits:function(e){for(var t,i=this.str,n=this.codeSize,r=this.codeBuf;n<e;){if(-1===(t=i.getByte()))throw new util.FormatError("Bad encoding in flate stream");r|=t<<n,n+=8}return t=r&(1<<e)-1,this.codeBuf=r>>e,this.codeSize=n-=e,t},getCode:function(e){for(var t,i=this.str,n=e[0],r=e[1],s=this.codeSize,o=this.codeBuf;s<r&&-1!==(t=i.getByte());)o|=t<<s,s+=8;var a=n[o&(1<<r)-1],l=a>>16,c=65535&a;if(l<1||s<l)throw new util.FormatError("Bad encoding in flate stream");return this.codeBuf=o>>l,this.codeSize=s-l,c},generateHuffmanTable:function(e){var t,i=e.length,n=0;for(t=0;t<i;++t)e[t]>n&&(n=e[t]);for(var r=1<<n,s=new Int32Array(r),o=1,a=0,l=2;o<=n;++o,a<<=1,l<<=1)for(var c=0;c<i;++c)if(e[c]===o){var h=0,u=a;for(t=0;t<o;++t)h=h<<1|1&u,u>>=1;for(t=h;t<r;t+=l)s[t]=o<<16|c;++a}return[s,n]},readBlock:function(){var e,t,a=this.str,l=this.getBits(3);if(1&l&&(this.eof=!0),0!==(l>>=1)){var c,h;if(1===l)c=s,h=o;else{if(2!==l)throw new util.FormatError("Unknown block type in flate stream");var u,d=this.getBits(5)+257,f=this.getBits(5)+1,p=this.getBits(4)+4,m=new Uint8Array(i.length);for(u=0;u<p;++u)m[i[u]]=this.getBits(3);var g=this.generateHuffmanTable(m);t=0,u=0;for(var v,y,k,b=d+f,x=new Uint8Array(b);u<b;){var w=this.getCode(g);if(16===w)v=2,y=3,k=t;else if(17===w)v=3,y=3,k=t=0;else{if(18!==w){x[u++]=t=w;continue}v=7,y=11,k=t=0}for(var _=this.getBits(v)+y;_-- >0;)x[u++]=k}c=this.generateHuffmanTable(x.subarray(0,d)),h=this.generateHuffmanTable(x.subarray(d,b))}for(var C=(e=this.buffer)?e.length:0,S=this.bufferLength;;){var A=this.getCode(c);if(A<256)S+1>=C&&(e=this.ensureBuffer(S+1),C=e.length),e[S++]=A;else{if(256===A)return void(this.bufferLength=S);var M=(A=n[A-=257])>>16;M>0&&(M=this.getBits(M)),t=(65535&A)+M,A=this.getCode(h),A=r[A],(M=A>>16)>0&&(M=this.getBits(M));var T=(65535&A)+M;S+t>=C&&(e=this.ensureBuffer(S+t),C=e.length);for(var L=0;L<t;++L,++S)e[S]=e[S-T]}}}else{var $;if(-1===($=a.getByte()))throw new util.FormatError("Bad block header in flate stream");var E=$;if(-1===($=a.getByte()))throw new util.FormatError("Bad block header in flate stream");if(E|=$<<8,-1===($=a.getByte()))throw new util.FormatError("Bad block header in flate stream");var O=$;if(-1===($=a.getByte()))throw new util.FormatError("Bad block header in flate stream");if((O|=$<<8)!==(65535&~E)&&(0!==E||0!==O))throw new util.FormatError("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;const t=this.bufferLength,i=t+E;if(e=this.ensureBuffer(i),this.bufferLength=i,0===E)-1===a.peekByte()&&(this.eof=!0);else{const i=a.getBytes(E);e.set(i,t),i.length<E&&(this.eof=!0)}}}});return e.FlateStream=a}),define("skylark-io-streams/lzw-stream",["./streams","./decode-stream"],function(e,t){var i=t.inherit({klassName:"LZWStream",_construct:function(e,i,n){this.str=e,this.dict=e.dict,this.cachedData=0,this.bitsCached=0;for(var r={earlyChange:n,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(4096),dictionaryLengths:new Uint16Array(4096),dictionaryPrevCodes:new Uint16Array(4096),currentSequence:new Uint8Array(4096),currentSequenceLength:0},s=0;s<256;++s)r.dictionaryValues[s]=s,r.dictionaryLengths[s]=1;this.lzwState=r,t.prototype._construct.call(this,i)},readBits:function(e){for(var t=this.bitsCached,i=this.cachedData;t<e;){var n=this.str.getByte();if(-1===n)return this.eof=!0,null;i=i<<8|n,t+=8}return this.bitsCached=t-=e,this.cachedData=i,this.lastCode=null,i>>>t&(1<<e)-1},readBlock:function(){var e,t,i,n=1024,r=this.lzwState;if(r){var s=r.earlyChange,o=r.nextCode,a=r.dictionaryValues,l=r.dictionaryLengths,c=r.dictionaryPrevCodes,h=r.codeLength,u=r.prevCode,d=r.currentSequence,f=r.currentSequenceLength,p=0,m=this.bufferLength,g=this.ensureBuffer(this.bufferLength+n);for(e=0;e<512;e++){var v=this.readBits(h),y=f>0;if(v<256)d[0]=v,f=1;else{if(!(v>=258)){if(256===v){h=9,o=258,f=0;continue}this.eof=!0,delete this.lzwState;break}if(v<o)for(f=l[v],t=f-1,i=v;t>=0;t--)d[t]=a[i],i=c[i];else d[f++]=d[0]}if(y&&(c[o]=u,l[o]=l[u]+1,a[o]=d[0],h=++o+s&o+s-1?h:0|Math.min(Math.log(o+s)/.6931471805599453+1,12)),u=v,n<(p+=f)){do{n+=512}while(n<p);g=this.ensureBuffer(this.bufferLength+n)}for(t=0;t<f;t++)g[m++]=d[t]}r.nextCode=o,r.codeLength=h,r.prevCode=u,r.currentSequenceLength=f,this.bufferLength=m}}});return e.LZWStream=i}),define("skylark-io-streams/null-stream",["./streams","./_stream"],function(e,t){var i=t.inherit({klassName:"NullStream",_construct:function(){t.prototype._construct.call(this,new Uint8Array(0))}});return e.NullStream=i}),define("skylark-io-streams/predictor-stream",["./streams","./decode-stream"],function(e,t){var i=t.inherit({klassName:"PredictorStream",_construct:function(e,i,n){if(!primitives.isDict(n))return e;var r=this.predictor=n.get("Predictor")||1;if(r<=1)return e;if(2!==r&&(r<10||r>15))throw new Error(`Unsupported predictor: ${r}`);this.readBlock=2===r?this.readBlockTiff:this.readBlockPng,this.str=e,this.dict=e.dict;var s=this.colors=n.get("Colors")||1,o=this.bits=n.get("BitsPerComponent")||8,a=this.columns=n.get("Columns")||1;return this.pixBytes=s*o+7>>3,this.rowBytes=a*s*o+7>>3,t.call(this,i),this},readBlockTiff:function(){var e=this.rowBytes,t=this.bufferLength,i=this.ensureBuffer(t+e),n=this.bits,r=this.colors,s=this.str.getBytes(e);if(this.eof=!s.length,!this.eof){var o,a=0,l=0,c=0,h=0,u=t;if(1===n&&1===r)for(o=0;o<e;++o){var d=s[o]^a;d^=d>>1,d^=d>>2,a=(1&(d^=d>>4))<<7,i[u++]=d}else if(8===n){for(o=0;o<r;++o)i[u++]=s[o];for(;o<e;++o)i[u]=i[u-r]+s[o],u++}else if(16===n){var f=2*r;for(o=0;o<f;++o)i[u++]=s[o];for(;o<e;o+=2){var p=((255&s[o])<<8)+(255&s[o+1])+((255&i[u-f])<<8)+(255&i[u-f+1]);i[u++]=p>>8&255,i[u++]=255&p}}else{var m=new Uint8Array(r+1),g=(1<<n)-1,v=0,y=t,k=this.columns;for(o=0;o<k;++o)for(var b=0;b<r;++b)c<n&&(a=a<<8|255&s[v++],c+=8),m[b]=m[b]+(a>>c-n)&g,c-=n,l=l<<n|m[b],(h+=n)>=8&&(i[y++]=l>>h-8&255,h-=8);h>0&&(i[y++]=(l<<8-h)+(a&(1<<8-h)-1))}this.bufferLength+=e}},readBlockPng:function(){var e=this.rowBytes,t=this.pixBytes,i=this.str.getByte(),n=this.str.getBytes(e);if(this.eof=!n.length,!this.eof){var r=this.bufferLength,s=this.ensureBuffer(r+e),o=s.subarray(r-e,r);0===o.length&&(o=new Uint8Array(e));var a,l,c,h=r;switch(i){case 0:for(a=0;a<e;++a)s[h++]=n[a];break;case 1:for(a=0;a<t;++a)s[h++]=n[a];for(;a<e;++a)s[h]=s[h-t]+n[a]&255,h++;break;case 2:for(a=0;a<e;++a)s[h++]=o[a]+n[a]&255;break;case 3:for(a=0;a<t;++a)s[h++]=(o[a]>>1)+n[a];for(;a<e;++a)s[h]=(o[a]+s[h-t]>>1)+n[a]&255,h++;break;case 4:for(a=0;a<t;++a)l=o[a],c=n[a],s[h++]=l+c;for(;a<e;++a){l=o[a];var u=o[a-t],d=s[h-t],f=d+l-u,p=f-d;p<0&&(p=-p);var m=f-l;m<0&&(m=-m);var g=f-u;g<0&&(g=-g),c=n[a],s[h++]=p<=m&&p<=g?d+c:m<=g?l+c:u+c}break;default:throw new Error(`Unsupported predictor: ${i}`)}this.bufferLength+=e}}});return e.PredictorStream=i}),define("skylark-io-streams/run-length-stream",["skylark-langx-chars","./streams","./decode-stream"],function(e,t,i){var n=i.inherit({klassName:"RunLengthStream",_construct:function(e,t){this.str=e,this.dict=e.dict,i.prototype._construct.call(this,t)},readBlock:function(){var e=this.str.getBytes(2);if(!e||e.length<2||128===e[0])this.eof=!0;else{var t,i=this.bufferLength,n=e[0];if(n<128){if((t=this.ensureBuffer(i+n+1))[i++]=e[1],n>0){var r=this.str.getBytes(n);t.set(r,i),i+=n}}else{n=257-n;var s=e[1];t=this.ensureBuffer(i+n+1);for(var o=0;o<n;o++)t[i++]=s}this.bufferLength=i}}});return t.RunLengthStream=n}),define("skylark-io-streams/streams-sequence-stream",["skylark-langx-chars","./streams","./decode-stream"],function(e,t,i){var n=i.inherit({klassName:"StreamsSequenceStream",_construct:function(e){this.streams=e;let t=0;for(let n=0,r=e.length;n<r;n++){const r=e[n];t+=r instanceof i?r._rawMinBufferLength:r.length}i.prototype._construct.call(this,t)},readBlock:function(){var e=this.streams;if(0!==t.length){e.shift();var i=e.getBytes(),n=this.bufferLength,r=n+i.length,s=this.ensureBuffer(r);s.set(i,n),this.bufferLength=r}else this.eof=!0},getBaseStreams:function(){for(var e=[],t=0,i=this.streams.length;t<i;t++){var n=this.streams[t];n.getBaseStreams&&e.push(...n.getBaseStreams())}return e}});return t.StreamsSequenceStream=n}),define("skylark-io-streams/string-stream",["./streams","./_stream"],function(e,t){var i=t.inherit({klassName:"StringStream",_construct:function(e){for(var i=e.length,n=new Uint8Array(i),r=0;r<i;++r)n[r]=e.charCodeAt(r);t.prototype._construct.call(this,n)}});return e.StringStream=i}),define("skylark-io-streams/main",["./streams","./ascii85-stream","./ascii-hex-stream","./chunked-stream","./decode-stream","./decrypt-stream","./fake-stream","./flate-stream","./lzw-stream","./null-stream","./predictor-stream","./run-length-stream","./_stream","./streams-sequence-stream","./string-stream"],function(e){return e}),define("skylark-io-streams",["skylark-io-streams/main"],function(e){return e}),define("skylark-slax-runtime/skylark",["./slax","skylark-langx","skylark-domx","skylark-domx-files","skylark-domx-images","skylark-domx-plugins-colors","skylark-jquery","skylark-appify-spa","skylark-appify-shells","skylark-data-entities","skylark-io-streams"],function(e,t){return e.skylark=t}),define("skylark-slax-runtime/main",["./slax","./caches","./skylark"],function(e){return e}),define("skylark-slax-runtime",["skylark-slax-runtime/main"],function(e){return e}),define("skylark-domx-plugins-scrolls/scrolls",["skylark-domx-plugins-base/plugins"],function(e){"use strict";return e.scrolls={}}),define("skylark-domx-plugins-scrolls/affix",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(e,t,i,n,r,s,o,a){"use strict";var l=o.Plugin.inherit({klassName:"Affix",pluginName:"lark.scrolls.affix",options:{offset:0,target:window},_construct:function(t,i){this.overrided(t,i),this.$target=s(this.options.target).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)).on("click.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=this.$(),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()},getState:function(e,t,i,n){var r=this.$target.scrollTop(),s=this.$element.offset(),o=this.$target.height();if(null!=i&&"top"==this.affixed)return r<i&&"top";if("bottom"==this.affixed)return null!=i?!(r+this.unpin<=s.top)&&"bottom":!(r+o<=e-n)&&"bottom";var a=null==this.affixed,l=a?r:s.top,c=a?o:t;return null!=i&&r<=i?"top":null!=n&&l+c>=e-n&&"bottom"},getPinnedOffset:function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(l.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},checkPositionWithEventLoop:function(){setTimeout(e.proxy(this.checkPosition,this),1)},checkPosition:function(){if(this.$element.is(":visible")){var e=this.$element.height(),t=this.options.offset,n=t.top,r=t.bottom,o=Math.max(s(document).height(),s(document.body).height());"object"!=typeof t&&(r=n=t),"function"==typeof n&&(n=t.top(this.$element)),"function"==typeof r&&(r=t.bottom(this.$element));var a=this.getState(o,e,n,r);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var c="affix"+(a?"-"+a:""),h=i.create(c+".affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(l.RESET).addClass(c).trigger(c.replace("affix","affixed")+".affix")}"bottom"==a&&this.$element.offset({top:o-e-r})}}});return l.RESET="affix affix-top affix-bottom",o.register(l),a.Affix=l}),define("skylark-bootstrap3/bs3",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query"],function(e,t,i,n,r,s,o){var a=e.ui=e.ui||{},l=a.bs3={},c={BACKSPACE_KEYCODE:8,COMMA_KEYCODE:188,DELETE_KEYCODE:46,DOWN_ARROW_KEYCODE:40,ENTER_KEYCODE:13,TAB_KEYCODE:9,UP_ARROW_KEYCODE:38},h=function(e){return function(t){return t.keyCode===e}},u=h(c.BACKSPACE_KEYCODE),d=h(c.DELETE_KEYCODE),f=h(c.TAB_KEYCODE),p=h(c.UP_ARROW_KEYCODE),m=h(c.DOWN_ARROW_KEYCODE),g=/&[^\s]*;/;return t.mixin(l,{CONST:c,cleanInput:function(e){for(;g.test(e);)e=o("<i>").html(e).text();return o("<i>").text(e).html()},isBackspaceKey:u,isDeleteKey:d,isShiftHeld:function(e){return!0===e.shiftKey},isTabKey:f,isUpArrow:p,isDownArrow:m}),l}),define("skylark-bootstrap3/affix",["skylark-domx-plugins-base","skylark-domx-plugins-scrolls/affix","./bs3"],function(e,t,i){"use strict";var n=i.Affix=t.inherit({klassName:"Affix",pluginName:"bs3.affix"});return n.VERSION="3.3.7",e.register(n,"affix"),n}),define("skylark-bootstrap3/alert",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./bs3"],function(e,t,i,n,r,s,o,a){"use strict";var l=a.Alert=o.Plugin.inherit({klassName:"Alert",pluginName:"bs3.alert",_construct:function(e,t){s(e).on("click",'[data-dismiss="alert"]',this.close)},close:function(e){var n=s(this),r=n.attr("data-target");r||(r=(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]*$)/,""));var o=s("#"===r?[]:r);function a(){o.detach().trigger("closed.bs.alert").remove()}e&&e.preventDefault(),o.length||(o=n.closest(".alert")),o.trigger(e=i.create("close.bs.alert")),e.isDefaultPrevented()||(o.removeClass("in"),t.support.transition&&(o.hasClass("fade")?o.one("transitionEnd",a).emulateTransitionEnd(l.TRANSITION_DURATION):a()))}});return l.VERSION="3.3.7",l.TRANSITION_DURATION=150,o.register(l,"alert"),l}),define("skylark-bootstrap3/button",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./bs3"],function(e,t,i,n,r,s,o,a){"use strict";var l=a.Button=o.Plugin.inherit({klassName:"Button",pluginName:"bs3.button",_construct:function(t,i){var n=this.$element=s(t);this.options=e.mixin({},l.DEFAULTS,i),this.isLoading=!1,n.closest('[data-toggle^="button"]')&&n.on("click.bs.button.data-api",e.proxy(function(e){if(this.toggle(),!s(e.target).is('input[type="radio"], input[type="checkbox"]')){e.preventDefault();var t=this.$element;t.is("input,button")?t.trigger("focus"):t.find("input:visible,button:visible").first().trigger("focus")}},this))},setState:function(t){var i="disabled",n=this.$element,r=n.is("input")?"val":"html",s=n.data();t+="Text",null==s.resetText&&n.data("resetText",n[r]()),setTimeout(e.proxy(function(){n[r](null==s[t]?this.options[t]:s[t]),"loadingText"==t?(this.isLoading=!0,n.addClass(i).attr(i,i).prop(i,!0)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i).prop(i,!1))},this),0)},toggle:function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(e=!1),t.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),e&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")}});return l.VERSION="3.3.7",l.DEFAULTS={loadingText:"loading..."},o.register(l,"button",function(e){"toggle"==e?this.toggle():e&&this.setState(e)}),l}),define("skylark-bootstrap3/transition",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","./bs3"],function(e,t,i,n,r,s,o){"use strict";i.special.bsTransitionEnd=i.special.transitionEnd}),define("skylark-bootstrap3/carousel",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./bs3","./transition"],function(e,t,i,n,r,s,o,a){"use strict";var l=a.Carousel=o.Plugin.inherit({klassName:"Carousel",pluginName:"bs3.carousel",options:{interval:5e3,pause:"hover",wrap:!0,keyboard:!0,selectors:{controls:{toggle:".toggle",prev:".prev",next:".next",close:".close",playPause:".play-pause"},indicators:{container:".carousel-indicators"},slides:{container:"",item:".item"}}},_construct:function(t,i){i=e.mixin({},s(t).data(),i),this.overrided(t,i),this.$element=s(t),this.$indicators=this.$element.find(this.options.selectors.indicators.container),this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null;var n=this;this.options.embeded||(this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs3.carousel",e.proxy(this.pause,this)).on("mouseleave.bs3.carousel",e.proxy(this.cycle,this)),this.$element.on("click.bs3.carousel.data-api","[data-slide],[data-slide-to]",function(e){var t=s(this),i=t.attr("data-slide"),r=t.attr("data-slide-to");"prev"==i?n.prev():"next"==i?n.next():r&&n.to(r),e.preventDefault()}))},keydown:function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},cycle:function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},getItemIndex:function(e){return this.$items=e.parent().children(this.options.selectors.slides.item),this.$items.index(e||this.$active)},getItemForDirection:function(e,t){var i=this.getItemIndex(t),n="prev"==e&&0===i||"next"==e&&i==this.$items.length-1;if(n&&!this.options.wrap)return t;var r="prev"==e?-1:1,s=(i+r)%this.$items.length;return this.$items.eq(s)},to:function(e){var t=this,i=this.getItemIndex(this.$active=this.$element.find(this.options.selectors.slides.item+".active"));if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):i==e?this.pause().cycle():this.slide(e>i?"next":"prev",this.$items.eq(e))},pause:function(e){return e||(this.paused=!0),this.$element.find(this.options.selectors.controls.next+","+this.options.selectors.controls.prev).length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},next:function(){if(!this.sliding)return this.slide("next")},prev:function(){if(!this.sliding)return this.slide("prev")},slide:function(e,n){var r=this.$element.find(this.options.selectors.slides.item+".active"),o=n||this.getItemForDirection(e,r),a=this.interval,l="next"==e?"left":"right",c=this;if(o.hasClass("active"))return this.sliding=!1;var h=o[0],u=i.create("slide.bs.carousel",{relatedTarget:h,direction:l});if(this.$element.trigger(u),!u.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=s(this.$indicators.children()[this.getItemIndex(o)]);d&&d.addClass("active")}var f=i.create("slid.bs.carousel",{relatedTarget:h,direction:l});return t.support.transition&&this.$element.hasClass("slide")?(o.addClass(e),o[0].offsetWidth,r.addClass(l),o.addClass(l),r.one("transitionEnd",function(){o.removeClass([e,l].join(" ")).addClass("active"),r.removeClass(["active",l].join(" ")),c.sliding=!1,setTimeout(function(){c.$element.trigger(f)},0)}).emulateTransitionEnd()):(r.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(f)),a&&this.cycle(),this}}});return l.VERSION="3.3.7",l.TRANSITION_DURATION=600,o.register(l,"carousel",function(e){var t="string"==typeof e?e:e.slide;"number"==typeof e?this.to(e):t?this[t]():e.interval&&this.pause().cycle()}),l}),define("skylark-domx-plugins-toggles/toggles",["skylark-domx-plugins-base/plugins"],function(e){"use strict";return e.toggles={}}),define("skylark-domx-plugins-toggles/collapse",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./toggles"],function(e,t,i,n,r,s){"use strict";var o=r.Plugin.inherit({klassName:"Collapse",pluginName:"lark.toggles.collapse",options:{toggle:!0},_construct:function(e,t){this.overrided(e,t),this.$element=this.$(),this.transitioning=null,this.options.toggle&&this.toggle()},dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){if(!this.transitioning&&!this.$element.hasClass("in")){var n=i.create("show.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.collapse")};if(!t.support.transition)return s.call(this);var a=e.camelCase(["scroll",r].join("-"));this.$element.one("transitionEnd",e.proxy(s,this)).emulateTransitionEnd(o.TRANSITION_DURATION)[r](this.$element[0][a])}}},hide:function(){if(!this.transitioning&&this.$element.hasClass("in")){var n=i.create("hide.collapse");if(this.$element.trigger(n),!n.isDefaultPrevented()){var r=this.dimension();this.$element[r](this.$element[r]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.transitioning=1;var s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.collapse")};if(!t.support.transition)return s.call(this);this.$element[r](0).one("transitionEnd",e.proxy(s,this)).emulateTransitionEnd(o.TRANSITION_DURATION)}}},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}});return o.TRANSITION_DURATION=350,r.register(o),s.Collapse=o}),define("skylark-bootstrap3/collapse",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","skylark-domx-plugins-toggles/collapse","./bs3","./transition"],function(e,t,i,n,r,s,o,a,l){"use strict";var c=l.Collapse=a.inherit({klassName:"Collapse",pluginName:"bs3.collapse",_construct:function(t,i){i=e.mixin({},s(t).data(),i),this.$trigger=s('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),i.parent?this.$parent=this.getParent(i):this.addAriaAndCollapsedClass(s(t),this.$trigger),this.overrided(t,i)},show:function(){var e,t=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");t&&t.length&&(e=t.data("bs.collapse"))&&e.transitioning||(t&&t.length&&(t.collapse("hide"),e||t.data("bs.collapse",null)),this.overrided(),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0))},hide:function(){this.overrided(),this.$trigger.addClass("collapsed").attr("aria-expanded",!1)},getParent:function(t){return t=t||this.options,s(t.parent).find('[data-toggle="collapse"][data-parent="'+t.parent+'"]').each(e.proxy(function(e,t){var i,n,r,o=s(t);this.addAriaAndCollapsedClass((r=(i=o).attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),s(r)),o)},this)).end()},addAriaAndCollapsedClass:function(e,t){var i=e.hasClass("in");e.attr("aria-expanded",i),t.toggleClass("collapsed",!i).attr("aria-expanded",i)}});return c.VERSION="3.3.7",o.register(c,"collapse"),c}),define("skylark-bootstrap3/dropdown",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","skylark-domx-plugins-popups/dropdown","./bs3"],function(e,t,i,n,r,s,o,a,l){"use strict";var c=l.Dropdown=a.inherit({klassName:"Dropdown",pluginName:"bs3.dropdown"});return c.VERSION="3.3.7",o.register(c,"dropdown"),c}),define("skylark-bootstrap3/modal",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./bs3"],function(e,t,i,n,r,s,o,a){"use strict";var l=a.Modal=o.Plugin.inherit({klassName:"Modal",pluginName:"bs3.modal",_construct:function(t,i){i=e.mixin({},l.DEFAULTS,s(t).data(),i),this.overrided(t,i),this.$container=s(i.container||document.body),this.$element=s(t),this.$dialog=this.$element.find(".modal-dialog"),this.$container.is("body")||this.$element.css("position","absolute"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this)),this.options.show&&this.show()},toggle:function(e){return this.isShown?this.hide():this.show(e)},show:function(r){var o=this,a=i.create("show.bs.modal",{relatedTarget:r});this.$element.trigger(a),this.isShown||a.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$container.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){o.$element.one("mouseup.dismiss.bs.modal",function(e){s(e.target).is(o.$element)&&(o.ignoreBackdropClick=!0)})}),this.backdrop(function(){var e=t.support.transition&&o.$element.hasClass("fade");n.isChildOf(o.$element[0],o.$container[0])||o.$element.appendTo(o.$container),o.$element.show().scrollTop(0),o.adjustDialog(),e&&o.$element[0].offsetWidth,o.$element.addClass("in"),o.enforceFocus();var s=i.create("shown.bs.modal",{relatedTarget:r});e?o.$dialog.one("transitionEnd",function(){o.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(l.TRANSITION_DURATION):o.$element.trigger("focus").trigger(s)}))},hide:function(n){n&&n.preventDefault(),n=i.create("hide.bs.modal"),this.$element.trigger(n),this.isShown&&!n.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),s(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("transitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(l.TRANSITION_DURATION):this.hideModal())},enforceFocus:function(){s(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){document===e.target||this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},escape:function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},resize:function(){this.isShown?s(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):s(window).off("resize.bs.modal")},hideModal:function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$container.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(i){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&r;if(this.$backdrop=s(document.createElement("div")).addClass("modal-backdrop "+r).appendTo(this.$container),this.$container.is("body")||this.$backdrop.css("position","absolute"),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!i)return;o?this.$backdrop.one("transitionEnd",i).emulateTransitionEnd(l.BACKDROP_TRANSITION_DURATION):i()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){n.removeBackdrop(),i&&i()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("transitionEnd",a).emulateTransitionEnd(l.BACKDROP_TRANSITION_DURATION):a()}else i&&i()},handleUpdate:function(){this.adjustDialog()},adjustDialog:function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},resetAdjustments:function(){this.$element.css({paddingLeft:"",paddingRight:""})},checkScrollbar:function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},setScrollbar:function(){var e=parseInt(this.$container.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$container.css("padding-right",e+this.scrollbarWidth)},resetScrollbar:function(){this.$container.css("padding-right",this.originalBodyPad)},measureScrollbar:function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$container.append(e);var t=e.offsetWidth-e.clientWidth;return this.$container[0].removeChild(e),t}});return l.VERSION="3.3.7",l.TRANSITION_DURATION=300,l.BACKDROP_TRANSITION_DURATION=150,l.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},o.register(l,"modal",function(e,t){"string"==typeof e?this[e](t):this.options.show&&this.show(t)}),l}),define("skylark-bootstrap3/tooltip",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./bs3"],function(e,t,i,n,r,s,o,a){"use strict";var l=a.Tooltip=o.Plugin.inherit({klassName:"Tooltip",pluginName:"bs3.tooltip",_construct:function(t,i){if(this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.enabled=!0,this.type="tooltip",this.$element=s(t),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&s(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var n=this.options.trigger.split(" "),r=n.length;r--;){var o=n[r];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var a="hover"==o?"mouseenter":"focusin",l="hover"==o?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.mixin({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getDefaults:function(){return l.DEFAULTS},getOptions:function(t){return(t=e.mixin({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},getDelegateOptions:function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},enter:function(e){var t=e instanceof this.constructor?e:s(e.currentTarget).plugin(this.pluginName);if(t||(t=s(e.currentTarget).plugin(this.pluginName,this.getDelegateOptions())),e instanceof i.create&&(t.inState["focusin"==e.type?"focus":"hover"]=!0),t.tip().hasClass("in")||"in"==t.hoverState)t.hoverState="in";else{if(clearTimeout(t.timeout),t.hoverState="in",!t.options.delay||!t.options.delay.show)return t.show();t.timeout=setTimeout(function(){"in"==t.hoverState&&t.show()},t.options.delay.show)}},isInStateTrue:function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},leave:function(e){var t=e instanceof this.constructor?e:s(e.currentTarget).plugin(this.pluginName);if(t||(t=s(e.currentTarget).plugin(this.pluginName,this.getDelegateOptions())),e instanceof i.create&&(t.inState["focusout"==e.type?"focus":"hover"]=!1),!t.isInStateTrue()){if(clearTimeout(t.timeout),t.hoverState="out",!t.options.delay||!t.options.delay.hide)return t.hide();t.timeout=setTimeout(function(){"out"==t.hoverState&&t.hide()},t.options.delay.hide)}},show:function(){var e=i.create("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var r=n.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!r)return;var s=this,o=this.tip(),a=this.getUID(this.type);this.setContent(),o.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&o.addClass("fade");var c="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,u=h.test(c);u&&(c=c.replace(h,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(c).data("bs3."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs3."+this.type);var d=this.getPosition(),f=o[0].offsetWidth,p=o[0].offsetHeight;if(u){var m=c,g=this.getPosition(this.$viewport);c="bottom"==c&&d.bottom+p>g.bottom?"top":"top"==c&&d.top-p<g.top?"bottom":"right"==c&&d.right+f>g.width?"left":"left"==c&&d.left-f<g.left?"right":c,o.removeClass(m).addClass(c)}var v=this.getCalculatedOffset(c,d,f,p);this.applyPlacement(v,c);var y=function(){var e=s.hoverState;s.$element.trigger("shown.bs3."+s.type),s.hoverState=null,"out"==e&&s.leave(s)};t.support.transition&&this.$tip.hasClass("fade")?o.one("transitionEnd",y).emulateTransitionEnd(l.TRANSITION_DURATION):y()}},applyPlacement:function(e,t){var i=this.tip(),n=i[0].offsetWidth,s=i[0].offsetHeight,o=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(a)&&(a=0),e.top+=o,e.left+=a,r.pagePosition(i[0],e),i.addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;"top"==t&&c!=s&&(e.top=e.top+s-c);var h=this.getViewportAdjustedDelta(t,e,l,c);h.left?e.left+=h.left:e.top+=h.top;var u=/top|bottom/.test(t),d=u?2*h.left-n+l:2*h.top-s+c,f=u?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(d,i[0][f],u)},replaceArrow:function(e,t,i){this.arrow().css(i?"left":"top",50*(1-e/t)+"%").css(i?"top":"left","")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(e){var n=this,r=s(this.$tip),o=i.create("hide.bs3."+this.type);function a(){"in"!=n.hoverState&&r.detach(),n.$element&&n.$element.removeAttr("aria-describedby").trigger("hidden.bs3."+n.type),e&&e()}if(this.$element.trigger(o),!o.isDefaultPrevented())return r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("transitionEnd",a).emulateTransitionEnd(l.TRANSITION_DURATION):a(),this.hoverState=null,this},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(t){var i=(t=t||this.$element)[0],n="BODY"==i.tagName,r=i.getBoundingClientRect();null==r.width&&(r=e.mixin({},r,{width:r.right-r.left,height:r.bottom-r.top}));var o=window.SVGElement&&i instanceof window.SVGElement,a=n?{top:0,left:0}:o?null:t.offset(),l={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},c=n?{width:s(window).width(),height:s(window).height()}:null;return e.mixin({},r,l,c,a)},getCalculatedOffset:function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},getViewportAdjustedDelta:function(e,t,i,n){var r={top:0,left:0};if(!this.$viewport)return r;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var a=t.top-s-o.scroll,l=t.top+s-o.scroll+n;a<o.top?r.top=o.top-a:l>o.top+o.height&&(r.top=o.top+o.height-l)}else{var c=t.left-s,h=t.left+s+i;c<o.left?r.left=o.left-c:h>o.right&&(r.left=o.left+o.width-h)}return r},getTitle:function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},getUID:function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},tip:function(){if(!this.$tip&&(this.$tip=s(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(e){var t=this;e&&((t=s(e.currentTarget).plugin(this.pluginName))||(t=s(e.currentTarget).plugin(this.pluginName,this.getDelegateOptions()))),e?(t.inState.click=!t.inState.click,t.isInStateTrue()?t.enter(t):t.leave(t)):t.tip().hasClass("in")?t.leave(t):t.enter(t)},destroy:function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs3."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null,e.$element=null})}});return l.VERSION="3.3.7",l.TRANSITION_DURATION=150,l.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},o.register(l,"tooltip"),l}),define("skylark-bootstrap3/popover",["skylark-domx-browser","skylark-langx/langx","skylark-domx-eventer","skylark-domx-query","skylark-domx-plugins-base","./bs3","./tooltip"],function(e,t,i,n,r,s,o){"use strict";var a=s.Popover=o.inherit({klassName:"Popover",pluginName:"bs3.popover",_construct:function(e,t){this.overrided(e,t),this.type="popover"},getDefaults:function(){return a.DEFAULTS},setContent:function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")}});return a.VERSION="3.3.7",a.DEFAULTS=t.mixin({},o.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),r.register(a,"popover"),a}),define("skylark-domx-plugins-scrolls/scroll-spy",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(e,t,i,n,r,s,o,a){"use strict";var l=o.Plugin.inherit({klassName:"ScrollSpy",pluginName:"lark.scrolls.scrollspy",options:{offset:10},_construct:function(t,i){this.overrided(t,i),this.$body=s(document.body),this.$scrollElement=this.$().is(document.body)?s(window):this.$(),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.scrollspy",e.proxy(this.process,this)),this.refresh(),this.process()},getScrollHeight:function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},refresh:function(){var t=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),e.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=s(this),t=e.data("target")||e.attr("href"),r=/^#./.test(t)&&s(t);return r&&r.length&&r.is(":visible")&&[[r[i]().top+n,t]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),r=this.offsets,s=this.targets,o=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),t>=n)return o!=(e=s[s.length-1])&&this.activate(e);if(o&&t<r[0])return this.activeTarget=null,this.clear();for(e=r.length;e--;)o!=s[e]&&t>=r[e]&&(void 0===r[e+1]||t<r[e+1])&&this.activate(s[e])},activate:function(e){this.activeTarget=e,this.clear();var t=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=s(t).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.scrollspy")},clear:function(){s(this.selector).parentsUntil(this.options.target,".active").removeClass("active")}});return o.register(l),a.ScrollSpy=l}),define("skylark-bootstrap3/scrollspy",["skylark-domx-plugins-base","skylark-domx-plugins-scrolls/scroll-spy","./bs3"],function(e,t,i){"use strict";var n=i.ScrollSpy=t.inherit({klassName:"ScrollSpy",pluginName:"bs3.scrollspy"});return n.VERSION="3.3.7",e.register(n,"scrollspy"),n}),define("skylark-domx-plugins-toggles/tab",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./toggles"],function(e,t,i,n,r,s,o,a){"use strict";var l=o.Plugin.inherit({klassName:"Tab",pluginName:"lark.toggles.tab",_construct:function(t,i){this.element=s(t),this.target=i&&i.target,this.element.on("click.lark.toggles.tab",e.proxy(function(e){e.preventDefault(),this.show()},this))},show:function(){var e=this.element,t=e.closest("ul:not(.dropdown-menu)"),n=this.target||e.data("target");if(n||(n=(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var r=t.find(".active:last a"),o=i.create("hide.lark.toggles.tab",{relatedTarget:e[0]}),a=i.create("show.lark.toggles.tab",{relatedTarget:r[0]});if(r.trigger(o),e.trigger(a),!a.isDefaultPrevented()&&!o.isDefaultPrevented()){var l=s(n);this.activate(e.closest("li"),t),this.activate(l,l.parent(),function(){r.trigger({type:"hidden.lark.toggles.tab",relatedTarget:e[0]}),e.trigger({type:"shown.lark.toggles.tab",relatedTarget:r[0]})})}}},activate:function(e,i,n){var r=i.find("> .active"),s=n&&t.support.transition&&(r.length&&r.hasClass("fade")||!!i.find("> .fade").length);function o(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),n&&n()}r.length&&s?r.one("transitionEnd",o).emulateTransitionEnd(l.TRANSITION_DURATION):o(),r.removeClass("in")}});return l.TRANSITION_DURATION=150,o.register(l),a.Tab=l}),define("skylark-bootstrap3/tab",["skylark-domx-plugins-base","skylark-domx-plugins-toggles/tab","./bs3"],function(e,t,i){"use strict";var n=i.Tab=t.inherit({klassName:"Tab",pluginName:"bs3.tab"});return n.VERSION="3.3.7",e.register(n,"tab"),n}),define("skylark-bootstrap3/taginput",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./bs3"],function(e,t,i,n,r,s,o,a){"use strict";var l={tagClass:function(e){return"label label-info"},focusClass:"focus",itemValue:function(e){return e?e.toString():e},itemText:function(e){return this.itemValue(e)},itemTitle:function(e){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(e,t){t.hide().fadeIn()},trimValue:!1,allowDuplicates:!1,triggerChange:!0},c=a.TagsInput=o.Plugin.inherit({klassName:"TagsInput",pluginName:"bs3.TagsInput",_construct:function(t,i){this.objectItems=i&&i.itemValue,i=e.mixin({},l,s(t).data(),i),this.overrided(t,i),this.isInit=!0,this.itemsArray=[],this.$element=s(t),this.$element.hide(),this.isSelect="SELECT"===t.tagName,this.multiple=this.isSelect&&t.hasAttribute("multiple"),this.placeholderText=t.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=s('<div class="bootstrap-tagsinput"></div>'),this.$input=s('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(),this.isInit=!1},add:function(t,n,r){var o=this;if(!(o.options.maxTags&&o.itemsArray.length>=o.options.maxTags)&&(!1===t||t)){if("string"==typeof t&&o.options.trimValue&&(t=e.trim(t)),"object"==typeof t&&!o.objectItems)throw"Can't add objects when itemValue option is not set";if(!t.toString().match(/^\s*$/)){if(o.isSelect&&!o.multiple&&o.itemsArray.length>0&&o.remove(o.itemsArray[0]),"string"==typeof t&&"INPUT"===this.$element[0].tagName){var a=o.options.delimiterRegex?o.options.delimiterRegex:o.options.delimiter,l=t.split(a);if(l.length>1){for(var c=0;c<l.length;c++)this.add(l[c],!0);return void(n||o.pushVal(o.options.triggerChange))}}var h=o.options.itemValue(t),u=o.options.itemText(t),d=o.options.tagClass(t),p=o.options.itemTitle(t),m=e.grep(o.itemsArray,function(e){return o.options.itemValue(e)===h})[0];if(!m||o.options.allowDuplicates){if(!(o.items().toString().length+t.length+1>o.options.maxInputLength)){var g=i.create("beforeItemAdd",{item:t,cancel:!1,options:r});if(o.$element.trigger(g),!g.cancel){o.itemsArray.push(t);var v=s('<span class="tag '+f(d)+(null!==p?'" title="'+p:"")+'">'+f(u)+'<span data-role="remove"></span></span>');v.data("item",t),o.findInputWrapper().before(v),v.after(" ");var y=s('option[value="'+encodeURIComponent(h)+'"]',o.$element).length||s('option[value="'+f(h)+'"]',o.$element).length;if(o.isSelect&&!y){var k=s("<option selected>"+f(u)+"</option>");k.data("item",t),k.attr("value",h),o.$element.append(k)}n||o.pushVal(o.options.triggerChange),o.options.maxTags!==o.itemsArray.length&&o.items().toString().length!==o.options.maxInputLength||o.$container.addClass("bootstrap-tagsinput-max"),s(".typeahead, .twitter-typeahead",o.$container).length&&o.$input.typeahead("val",""),this.isInit?o.$element.trigger(i.create("itemAddedOnInit",{item:t,options:r})):o.$element.trigger(i.create("itemAdded",{item:t,options:r}))}}}else if(o.options.onTagExists){var b=s(".tag",o.$container).filter(function(){return s(this).data("item")===m});o.options.onTagExists(t,b)}}}},remove:function(t,n,r){var o=this;if(o.objectItems&&(t=(t="object"==typeof t?e.grep(o.itemsArray,function(e){return o.options.itemValue(e)==o.options.itemValue(t)}):e.grep(o.itemsArray,function(e){return o.options.itemValue(e)==t}))[t.length-1]),t){var a=i.create("beforeItemRemove",{item:t,cancel:!1,options:r});if(o.$element.trigger(a),a.cancel)return;s(".tag",o.$container).filter(function(){return s(this).data("item")===t}).remove(),s("option",o.$element).filter(function(){return s(this).data("item")===t}).remove(),-1!==e.inArray(t,o.itemsArray)&&o.itemsArray.splice(e.inArray(t,o.itemsArray),1)}n||o.pushVal(o.options.triggerChange),o.options.maxTags>o.itemsArray.length&&o.$container.removeClass("bootstrap-tagsinput-max"),o.$element.trigger(i.create("itemRemoved",{item:t,options:r}))},removeAll:function(){for(s(".tag",this.$container).remove(),s("option",this.$element).remove();this.itemsArray.length>0;)this.itemsArray.pop();this.pushVal(this.options.triggerChange)},refresh:function(){var e=this;s(".tag",e.$container).each(function(){var t=s(this),i=t.data("item"),n=e.options.itemValue(i),r=e.options.itemText(i),o=e.options.tagClass(i);if(t.attr("class",null),t.addClass("tag "+f(o)),t.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=f(r),e.isSelect){var a=s("option",e.$element).filter(function(){return s(this).data("item")===i});a.attr("value",n)}})},items:function(){return this.itemsArray},pushVal:function(){var t=this,i=e.map(t.items(),function(e){return t.options.itemValue(e).toString()});t.$element.val(i,!0),t.options.triggerChange&&t.$element.trigger("change")},build:function(t){var i=this;if(i.objectItems&&(i.options.freeInput=!1),h(i.options,"itemValue"),h(i.options,"itemText"),u(i.options,"tagClass"),i.options.typeahead){var n=i.options.typeahead||{};u(n,"source"),i.$input.typeahead(e.extend({},n,{source:function(t,r){function s(e){for(var t=[],n=0;n<e.length;n++){var s=i.options.itemText(e[n]);o[s]=e[n],t.push(s)}r(t)}this.map={};var o=this.map,a=n.source(t);e.isFunction(a.success)?a.success(s):e.isFunction(a.then)?a.then(s):e.Deferred.when(a).then(s)},updater:function(e){return i.add(this.map[e]),this.map[e]},matcher:function(e){return-1!==e.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(e){return e.sort()},highlighter:function(e){var t=new RegExp("("+this.query+")","gi");return e.replace(t,"<strong>$1</strong>")}}))}if(i.options.typeaheadjs){var r=i.options.typeaheadjs;e.isArray(r)||(r=[null,r]),s.fn.typeahead.apply(i.$input,r).on("typeahead:selected",e.proxy(function(e,t,n){var s=0;r.some(function(e,t){return e.name===n&&(s=t,!0)}),r[s].valueKey?i.add(t[r[s].valueKey]):i.add(t),i.$input.typeahead("val","")},i))}i.$container.on("click",e.proxy(function(e){i.$element.attr("disabled")||i.$input.removeAttr("disabled"),i.$input.focus()},i)),i.options.addOnBlur&&i.options.freeInput&&i.$input.on("focusout",e.proxy(function(e){0===s(".typeahead, .twitter-typeahead",i.$container).length&&(i.add(i.$input.val()),i.$input.val(""))},i)),i.$container.on({focusin:function(){i.$container.addClass(i.options.focusClass)},focusout:function(){i.$container.removeClass(i.options.focusClass)}}),i.$container.on("keydown","input",e.proxy(function(e){var t=s(e.target),n=i.findInputWrapper();if(i.$element.attr("disabled"))i.$input.attr("disabled","disabled");else{switch(e.which){case 8:if(0===p(t[0])){var r=n.prev();r.length&&i.remove(r.data("item"))}break;case 46:if(0===p(t[0])){var o=n.next();o.length&&i.remove(o.data("item"))}break;case 37:var a=n.prev();0===t.val().length&&a[0]&&(a.before(n),t.focus());break;case 39:var l=n.next();0===t.val().length&&l[0]&&(l.after(n),t.focus())}var c=t.val().length;Math.ceil(c/5);t.attr("size",Math.max(this.inputSize,t.val().length))}},i)),i.$container.on("keypress","input",e.proxy(function(t){var n=s(t.target);if(i.$element.attr("disabled"))i.$input.attr("disabled","disabled");else{var r,o,a,l=n.val(),c=i.options.maxChars&&l.length>=i.options.maxChars;i.options.freeInput&&(r=t,o=i.options.confirmKeys,a=!1,e.each(o,function(e,t){if("number"==typeof t&&r.which===t)return a=!0,!1;if(r.which===t.which){var i=!t.hasOwnProperty("altKey")||r.altKey===t.altKey,n=!t.hasOwnProperty("shiftKey")||r.shiftKey===t.shiftKey,s=!t.hasOwnProperty("ctrlKey")||r.ctrlKey===t.ctrlKey;if(i&&n&&s)return a=!0,!1}}),a||c)&&(0!==l.length&&(i.add(c?l.substr(0,i.options.maxChars):l),n.val("")),!1===i.options.cancelConfirmKeysOnEmpty&&t.preventDefault());var h=n.val().length;Math.ceil(h/5);n.attr("size",Math.max(this.inputSize,n.val().length))}},i)),i.$container.on("click","[data-role=remove]",e.proxy(function(e){i.$element.attr("disabled")||i.remove(s(e.target).closest(".tag").data("item"))},i)),i.options.itemValue===l.itemValue&&("INPUT"===i.$element[0].tagName?i.add(i.$element.val()):s("option",i.$element).each(function(){i.add(s(this).attr("value"),!0)}))},destroy:function(){this.$container.off("keypress","input"),this.$container.off("click","[role=remove]"),this.$container.remove(),this.$element.removeData("tagsinput"),this.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var e=this.$input[0],t=this.$container[0];e&&e.parentNode!==t;)e=e.parentNode;return s(e)}});function h(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(e){return e[i]}}}function u(e,t){if("function"!=typeof e[t]){var i=e[t];e[t]=function(){return i}}}s.fn.tagsinput=function(e,t,i){var n=[];return this.each(function(){var r=s(this).data("tagsinput");if(r)if(e||t){if(void 0!==r[e]){if(3===r[e].length&&void 0!==i)var o=r[e](t,null,i);else var o=r[e](t);void 0!==o&&n.push(o)}}else n.push(r);else r=new c(this,e),s(this).data("tagsinput",r),n.push(r),"SELECT"===this.tagName&&s("option",s(this)).attr("selected","selected"),s(this).val(s(this).val())}),"string"==typeof e?n.length>1?n:n[0]:n},s.fn.tagsinput.Constructor=c;var d=s("<div />");function f(e){return e?d.text(e).html():""}function p(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}return c}),define("skylark-bootstrap3/loadedInit",["skylark-langx/langx","skylark-domx-query","./affix","./alert","./button","./carousel","./collapse","./dropdown","./modal","./popover","./scrollspy","./tab","./taginput","./tooltip","./transition"],function(e,t,i,n,r,s,o,a,l,c,h,u,d){return function(){t(function(){t('[data-spy="affix"]').each(function(){var e=t(this),i=e.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),e.affix(i)}),t(document).on("click.bs3.button.data-api",'[data-toggle^="button"]',function(e){var i=t(e.target).closest(".btn");i.button("toggle"),t(e.target).is('input[type="radio"], input[type="checkbox"]')||(e.preventDefault(),i.is("input,button")?i.trigger("focus"):i.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs3.button.data-api blur.bs3.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))}),t('[data-ride="carousel"]').each(function(){$this=t(this),$this.carousel($this.data())}),t(document).on("click.bs3.carousel.data-api","[data-target][data-slide],[data-target][data-slide-to],[href][data-slide],[href][data-slide-to]",function(i){var n,r=t(this),s=t(r.attr("data-target")||(n=r.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(s.hasClass("carousel")){var o=e.mixin({},s.data(),r.data()),a=r.attr("data-slide-to");a&&(o.interval=!1),s.carousel(o),a&&s.plugin("bs3.carousel").to(a),i.preventDefault()}}),t(document).on("click.bs3.collapse.data-api",'[data-target][data-toggle="collapse"]',function(e){var i=t(this);i.attr("data-target")||e.preventDefault();var n,r,s,o=(s=(n=i).attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),t(s)),a=o.plugin("bs3.collapse"),l=a?"toggle":i.data();o.collapse(l)}),t(document).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",'[data-toggle="dropdown"]',a.prototype.toggle).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown),t(document).on("click.bs3.modal.data-api",'[data-toggle="modal"]',function(i){var n=t(this),r=n.attr("href"),s=t(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs3.modal")?"toggle":e.mixin({remote:!/#/.test(r)&&r},s.data(),n.data());n.is("a")&&i.preventDefault(),s.one("show.bs3.modal",function(e){e.isDefaultPrevented()||s.one("hidden.bs3.modal",function(){n.is(":visible")&&n.trigger("focus")})}),s.modal(o,this)}),t('[data-spy="scroll"]').each(function(){var e=t(this);e.scrollspy(e.data())});var i=function(e){e.preventDefault(),t(this).tab("show")};t(document).on("click.bs3.tab.data-api",'[data-toggle="tab"]',i).on("click.bs3.tab.data-api",'[data-toggle="pill"]',i),t("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}}),define("skylark-data-collection/collections",["skylark-langx/skylark"],function(e){return e.attach("data.collections",{})}),define("skylark-data-collection/Collection",["skylark-langx/Evented","./collections"],function(e,t){var i=t.Collection=e.inherit({klassName:"Collection",_clear:function(){throw new Error("Unimplemented API")},clear:function(){return this._clear(),this.trigger("changed:clear"),this},count:function(){for(var e=0,t=this.iterator();!t.hasNext();)e++;return e},forEach:function(e,t){for(var i=this.iterator();i.hasNext();){var n=i.next();e.call(t||n,n)}return this},iterator:function(){throw new Error("Unimplemented API")},toArray:function(){for(var e=[],t=this.iterator();!t.hasNext();)e.push(t.next());return e}});return i}),define("skylark-data-collection/Map",["./collections","./Collection"],function(e,t){var i=e.Map=t.inherit({klassName:"Map",_getInnerItems:function(){return this._items},_clear:function(){this._items=[]},_findKeyByRegExp:function(e,t){var i=this._getInnerItems();return i.filter(function(i){return!!i.match(e)&&(t&&t(i),!0)})},get:function(e,t){if("string"!=typeof e)throw"hash key is not string!";var i=this._getInnerItems();return i[e]},iterator:function(){var e=0;return{hasNext:function(){return e<this._items.length},next:function(){var t=this._items[e++];return[this._items[t],t]}}},set:function(e,t){if("string"!=typeof e)throw"hash key is not string!";var i=this._getInnerItems();-1==i.indexOf(e)&&i.push(e);var n=i[e];if(n!==t){i[e]=t;var r={};r[e]={name:e,value:t,oldValue:n},this.trigger("changed",{data:r})}return this},remove:function(e){if("string"!=typeof e)throw"hash key is not string!";var t=this._getInnerItems(),i=t.indexOf(e);i>=0&&(delete t[e],delete t[i])},findByRegExp:function(e,t){var i=[],n=this;return this._findKeyByRegExp(e,function(e){var r=n.get(e);t&&t(r),i.push(r)}),i},removeByRegExp:function(e){var t=this;this._findKeyByRegExp(e,function(e){t.remove(e)})},toPlain:function(){for(var e=this._getInnerItems(),t=0;t<e.length;t++){var i=e[t];plain[i]=e[i]}return plain},toString:function(e){var t=this._getInnerItems();return t.join(e||",")},init:function(e){var t=this._items=[];for(var i in e)t.push(i),t[i]=e[i]}});return i}),define("skylark-data-collection/HashMap",["./collections","./Map"],function(e,t){var i=e.HashMap=t.inherit({});return i}),define("skylark-widgets-base/base",["skylark-langx/skylark"],function(e){return e.attach("widgets.base",{actions:{},dnd:{},locales:{},mixins:{},panels:{},skins:{}})}),define("skylark-widgets-base/skins/SkinManager",[],function(){"use strict";var e=[],t=[];return{register:function(i,n){e.push(n),t[n]=i},get:function(i){i||(i=e[0]);return t[i]},getList:function(){return e.slice()}}}),define("skylark-widgets-base/Widget",["skylark-langx-ns","skylark-langx-types","skylark-langx-objects","skylark-langx-events","skylark-langx-numerics/Vector2","skylark-domx-browser","skylark-domx-data","skylark-domx-eventer","skylark-domx-noder","skylark-domx-files","skylark-domx-geom","skylark-domx-velm","skylark-domx-query","skylark-domx-fx","skylark-domx-plugins-base","skylark-data-collection/HashMap","./base","./skins/SkinManager"],function(skylark,types,objects,events,Vector2,browser,datax,eventer,noder,files,geom,elmx,$,fx,plugins,HashMap,base,SkinManager){const NativeEvents={drag:2,dragend:2,dragenter:2,dragexit:2,dragleave:2,dragover:2,dragstart:2,drop:2,abort:3,change:3,selectionchange:3,submit:3,reset:3,fullscreenchange:3,fullscreenerror:3,focus:4,blur:4,focusin:4,focusout:4,keydown:5,keypress:5,keyup:5,message:6,click:7,contextmenu:7,dblclick:7,mousedown:7,mouseup:7,mousemove:7,mouseover:7,mouseout:7,mouseenter:7,mouseleave:7,progress:11,textInput:12,tap:13,touchstart:13,touchmove:13,touchend:13,load:14,resize:14,select:14,scroll:14,unload:14,wheel:15},Plugin=plugins.Plugin;var Widget=Plugin.inherit({klassName:"Widget",_construct:function(e,t,i){e&&!(e instanceof Widget||e.element)&&(i=t,t=e,e=null),types.isHtmlNode(t)?i=this._parse(t,i):(i=t,t=null),types.isString(i)&&(i={tagName:i}),this.overrided(t,i),t?this._velm=this.elmx(this._elm):(this._velm=this._create(),this._elm=this._velm.elm()),Object.defineProperty(this,"state",{value:this.options.state||new HashMap}),this.visible=!0,this.size=new Vector2(0,0),this.location=new Vector2(0,0),this._mode=Widget.TOP_LEFT,this._init();var n=this.options.addons;if(n){var r=this.constructor,s=r.addons;for(var o in n)for(var a=0;a<n[o].length;a++){var l=n[o][a];if(types.isString(l)){var c=l,h=s[o][c],u=h.ctor?h.ctor:h;this.addon(u,h.options)}}}e?this.setParent(e):this._velm.isInDocument()&&this._startup()},_parse:function(elm,options){var optionsAttr=datax.data(elm,"options");if(optionsAttr){var options1=eval("({"+optionsAttr+"})");options=objects.mixin(options1,options)}return options||{}},_create:function(){var e=this.options.template;if(e)return this.elmx(e);var t=this.options.tagName;if(t)return this.elmx(noder.createElement(t,{style:{position:"absolute",overflow:"hidden"}}));throw new Error("The template or tagName is not existed in options!")},_init:function(){var e=this;this.widgetClass&&this._velm.addClass(this.widgetClass),this.state.on("changed",function(t,i){e._refresh(i.data)})},_startup:function(){},isNativeEvent:function(e){if(types.isString(e))return!!NativeEvents[e];if(types.isArray(e)){for(var t=0;t<e.length;t++)if(NativeEvents[e[t]])return!0;return!1}},on:function(e,t,i,n,r,s){this.el_&&this.isNativeEvent(e)?eventer.on(this.el_,e,t,i,n,r,s):Plugin.prototype.on.call(this,e,t,i,n,r,s)},off:function(e,t){this.el_&&this.isNativeEvent(e)?eventer.off(this.el_,e,t):Plugin.prototype.off.call(this,e,t)},listenTo:function(e,t,i,n){types.isString(e)||types.isArray(e)?(n=i,i=t,t=e,this.el_&&this.isNativeEvent(t)?eventer.on(this.el_,t,i,this,n):this.on(t,i,this,n)):e.nodeType?eventer.on(e,t,i,this,n):Plugin.prototype.listenTo.call(this,e,t,i,n)},unlistenTo:function(e,t,i){types.isString(e)||types.isArray(e)?(i=t,t=e,this.el_&&this.isNativeEvent(t)?eventer.off(this.el_,t,i):this.off(t,i)):e.nodeType?eventer.off(e,t,i):Plugin.prototype.unlistenTo.call(this,e,t,i)},updateLocation:function(e){void 0!==e&&(this._mode=e),this._mode===Widget.TOP_LEFT||this._mode===Widget.TOP_RIGHT?this._elm.style.top=this.location.y+"px":this._elm.style.bottom=this.location.y+"px",this._mode===Widget.TOP_LEFT||this._mode===Widget.BOTTOM_LEFT?this._elm.style.left=this.location.x+"px":this._elm.style.right=this.location.x+"px"},updateSize:function(){this._elm.style.width=this.size.x+"px",this._elm.style.height=this.size.y+"px"},setVisibility:function(e){this.visible=e,this.updateVisibility()},updateVisibility:function(){this._elm.style.display=this.visible?"block":"none"},_refresh:function(e){},mapping:{events:{},attributs:{},properties:{},styles:{}},addon:function(e,t){var i=e.categoryName,n=e.addonName;this._addons=this.addons||{};var r=this._addons[i]=this._addons[i]||{};return r[n]=new e(this,t),this},addons:function(e,t){this._addons=this.addons||{};var i=this._addons[e]=this._addons[e]||{};if(void 0==t)return objects.clone(i||null);objects.mixin(i,t)},render:function(){return this._elm},getEnclosing:function(e){return null},getEnclosed:function(){return children=new ArrayList,children},getSkin:function(){return SkinManager.get()},show:function(){this._velm.show()},hide:function(){this._velm.hide()},focus:function(){try{this._velm.focus()}catch(e){}return this},blur:function(){return this._velm.blur(),this},enable:function(){return this.state.set("disabled",!1),this},disable:function(){return this.state.set("disabled",!0),this},addClass:function(e){return this._velm.addClass(e),this},hasClass:function(e){return this._velm.hasClass(e)},offset:function(){return this._velm.pagePosition()},outerWidth:function(){return this._velm.marginSize().width},outerHeight:function(){return this._velm.marginSize().height},removeClass:function(e){return this._velm.removeClass(e),this},toggleClass:function(e){return this._velm.toggleClass(e),this},aria:function(e,t){const i=this,n=i.getEl(i.ariaTarget);return void 0===t?i._aria[e]:(i._aria[e]=t,i.state.get("rendered")&&n.setAttribute("role"===e?e:"aria-"+e,t),i)},attr:function(e,t){var i=this._velm,n=i.attr(e,t);return n==i?this:n},getAttr:function(e){return this._velm.attr(e)},setAttr:function(e,t){return this._velm.attr(e,t),this},removeAttr:function(e){return this._velm.removeAttr(e),this},center:function(){this.location.set((this.parent.size.x-this.size.x)/2,(this.parent.size.y-this.size.y)/2)},css:function(e,t){var i=this._velm,n=i.css(e,t);return n==i?this:n},getStyle:function(e){return this._velm.css(e)},setStyle:function(e,t){return this._velm.css(e,t),this},data:function(e,t){var i=this._velm,n=i.data(e,t);return n==i?this:n},getData:function(e){return this._velm.data(e)},setData:function(e,t){return this._velm.data(e,t),this},parent:{get:function(){return this.getParent()},set:function(e){this.setParent(e)}},getParent:function(){return this._parent},setParent:function(e){var t=this._parent;return this._parent=e,e?(this.mount(e._elm||e.element),e._setupChild&&e._setupChild(this)):t&&this.unmount(),this},prop:function(e,t){var i=this._velm,n=i.prop(e,t);return n==i?this:n},getProp:function(e){return this._velm.prop(e)},setProp:function(e,t){return this._velm.prop(e,t),this},throb:function(e){return this.options.throbber&&(e=objects.defaults(e,this.options.throbber)),noder.throb(this._elm,e)},update:function(){this.updateVisibility(),this.visible&&(this.updateSize(),this.updateLocation())},mount:function(e,t){var i=e.element||e,n=this._elm;t&&"child"!=t?"before"==t?noder.before(i,n):"after"==t?noder.after(i,n):"prepend"==t&&noder.prepend(i,n):noder.append(i,n),this._startup()},unmount:function(){this._velm.remove()},preventDragEvents:function(){this.element.ondrop=Widget.preventDefault,this.element.ondragover=Widget.preventDefault},element:{get:function(){return this._elm},set:function(e){this._elm=e}},position:{get:function(){return this.location},set:function(e){this.location=e}},setAltText:function(e){var t=document.createElement("div");t.style.position="absolute",t.style.display="none",t.style.alignItems="center",t.style.zIndex="10000",t.style.border="3px solid",t.style.borderRadius="5px",t.style.color=Editor.theme.textColor,t.style.backgroundColor=Editor.theme.barColor,t.style.borderColor=Editor.theme.barColor,t.style.height="fit-content",document.body.appendChild(t);var i=document.createTextNode(e);t.appendChild(i);var n=this.destroy;return this.destroy=function(){n.call(this),document.body.contains(t)&&document.body.removeChild(t)},this._elm.style.pointerEvents="auto",this._elm.onmousemove=function(e){t.style.display="flex",t.style.left=e.clientX+8+"px",t.style.top=e.clientY-20+"px"},this._elm.onmouseout=function(){t.style.display="none"},t},setOnClick:function(e){this._elm.onclick=e},removeAllChildren:function(){for(;this._elm.firstChild;)this._elm.removeChild(this._elm.firstChild)},setMode:function(e){this._mode=e,this._elm.style.bottom=null,this._elm.style.right=null,this._elm.style.left=null},destroy:function(){this._parent&&(this._parent.element?this._parent.element.contains(this.element)&&(this._parent.element.removeChild(this.element),this._parent=null):(console.warn("nunuStudio: Parent is not a Element.",this),this._parent.contains(this.element)&&(this._parent.removeChild(this.element),this._parent=null)))}});return Widget.prototype.updateInterface=Widget.prototype.update,Widget.prototype.updatePosition=Widget.prototype.updateLocation,Widget.prototype.attachTo=Widget.prototype.setParent,Widget.prototype._attachTo=Widget.prototype.mount,Widget.prototype.detach=Widget.prototype.unmount,Widget.TOP_LEFT=0,Widget.TOP_RIGHT=1,Widget.BOTTOM_LEFT=2,Widget.BOTTOM_RIGHT=3,Widget.inherit=function(e){var t=plugins.Plugin.inherit.apply(this,arguments);function i(e){t.prototype[e]=function(t){return void 0!==t?(this.state.set(e,t),this):this.state.get(e)}}if(e.state)for(var n in e.state)i(n);return e.pluginName&&plugins.register(t,e.pluginName),t},Widget.register=function(e,t){var i=e.prototype,n=t||i.pluginName;function r(t){e.prototype[t]=function(e){return void 0!==e?(this.state.set(t,e),this):this.state.get(t)}}if(i.state)for(var s in i.state)r(s);return n&&plugins.register(e,n),e},Widget.preventDefault=function(e){e.preventDefault()},base.Widget=Widget}),define("skylark-widgets-coder/util",["skylark-langx/langx","skylark-net-http/Xhr"],function(e,t){"use strict";function i(e,t,n,r,s){n[e](t,function(e,t,n,r,s){return function(t,o){t&&r.push(t),++e<n.length?i(e,o,n,r,s):s(r,o)}}.apply(this,arguments))}var n={html:"html",css:"css",js:"javascript",less:"less",styl:"stylus",coffee:"coffeescript"};return{fetch:function(e,i){t.get(e).then(function(e){i(null,e)},function(e){i(e)})},seq:function(e,t,n=function(){}){var r=[];if(!e.length)return n(r,t);i(0,t,e,r,n)},log:function(){console.log(arguments)},getMode:function(t="",i="",r={}){var s=e.mixin({},n,r);for(let e in s){let t=e.length;if(i.slice(-t++)==="."+e)return s[e]}for(let e in s)if(t===e)return s[e];return t}}}),define("skylark-widgets-coder/template",[],function(){"use strict";return{container:function(){return'\n    <ul class="coder-nav">\n      <li class="coder-nav-item coder-nav-item-result">\n        <a href="#" data-coder-type="result">\n          Result\n        </a>\n      </li>\n      <li class="coder-nav-item coder-nav-item-html">\n        <a href="#" data-coder-type="html">\n          HTML\n        </a>\n      </li>\n      <li class="coder-nav-item coder-nav-item-css">\n        <a href="#" data-coder-type="css">\n          CSS\n        </a>\n      </li>\n      <li class="coder-nav-item coder-nav-item-js">\n        <a href="#" data-coder-type="js">\n          JavaScript\n        </a>\n      </li>\n    </ul>\n    <div class="coder-pane coder-pane-result"><iframe></iframe></div>\n    <div class="coder-pane coder-pane-html"></div>\n    <div class="coder-pane coder-pane-css"></div>\n    <div class="coder-pane coder-pane-js"></div>\n  '},paneActiveClass:function(e){return`coder-pane-active-${e}`},containerClass:function(){return"coder"},hasFileClass:function(e){return`coder-has-${e}`},editorClass:function(e){return`coder-editor coder-editor-${e}`},editorContent:function(e,t=""){return`\n    <textarea data-coder-type="${e}" data-coder-file="${t}"></textarea>\n    <div class="coder-status"></div>\n  `},statusMessage:function(e){return`\n    <p>${e}</p>\n  `},statusClass:function(e){return`coder-status-${e}`},statusActiveClass:function(e){return`coder-status-active-${e}`},pluginClass:function(e){return`coder-plugin-${e}`},statusLoading:function(e){return`Loading <strong>${e}</strong>..`},statusFetchError:function(e){return`There was an error loading <strong>${e}</strong>.`}}}),define("skylark-widgets-coder/addons",[],function(){return{general:{},html:{},css:{},js:{},edit:{}}}),define("skylark-widgets-coder/Coder",["skylark-langx/skylark","skylark-langx/langx","skylark-widgets-base/Widget","skylark-domx-styler","skylark-domx-data","./util","./template","./addons"],function(e,t,i,n,r,s,o,a){"use strict";class l extends i{get klassName(){return"Coder"}get pluginName(){return"lark.coder"}get options(){return{files:[],showBlank:!1,runScripts:!0,pane:"result",debounce:250,addons:{general:["render"]}}}_init(e,i){var n=this.options;!1===n.runScripts&&n.addons.gerneral.push("scriptless"),super._init();var r={};this._get=function(e){return r[e]},this._set=function(e,t){return r[e]=t,r[e]},this._set("cachedContent",{html:null,css:null,js:null});this.$container=this._elm;var s=this._set("paneActive",n.pane),a=this._velm;a.html(o.container()).addClass(o.containerClass()).addClass(o.paneActiveClass(s)).on("keyup",t.debounce(this.change.bind(this),n.debounce)).on("change",t.debounce(this.change.bind(this),n.debounce)).on("click",this.pane.bind(this)),this._set("$status",{});for(let e of["html","css","js"])this.markup(e)}_startup(){var e=this.options;this.paneActive=this._get("paneActive");for(let e of["html","css","js"])this.load(e);if(e.showBlank)for(let e of["html","css","js"])this._velm.addClass(o.hasFileClass(e))}findFile(e){var t=this.options;for(let i in t.files){let n=t.files[i];if(n.type===e)return n}return{}}markup(e){var t=this._elm,i=t.querySelector(`.coder-pane-${e}`),r=this.findFile(e),s=document.createElement("div");s.innerHTML=o.editorContent(e,r.url),s.className=o.editorClass(e),i.appendChild(s),this._get("$status")[e]=i.querySelector(".coder-status"),void 0===r.url&&void 0===r.content||n.addClass(t,o.hasFileClass(e))}load(e){var t=this.findFile(e),i=this._elm.querySelector(`.coder-pane-${e} textarea`);void 0!==t.content?this.setValue(i,t.content):void 0!==t.url?(this.status("loading",[o.statusLoading(t.url)],{type:e,file:t}),s.fetch(t.url,(t,n)=>{t?this.status("error",[o.statusFetchError(t)],{type:e}):(this.clearStatus("loading",{type:e}),this.setValue(i,n))})):this.setValue(i,"")}setValue(e,t){e.value=t,this.change({target:e})}change(e){var t=r.data(e.target,"coder-type");if(t){var i=this._get("cachedContent");i[t]!==e.target.value&&(i[t]=e.target.value,this.emit("change",{type:t,file:r.data(e.target,"coder-file"),content:i[t]}))}}errors(e,t){this.status("error",e,t)}pane(e){if(r.data(e.target,"coder-type")){var t=this._elm,i=this._get("paneActive");n.removeClass(t,o.paneActiveClass(i)),i=this._set("paneActive",r.data(e.target,"coder-type")),n.addClass(t,o.paneActiveClass(i)),e.preventDefault()}}status(e="error",t=[],i={}){if(!t.length)return this.clearStatus(e,i);var r=this._get("$status");n.addClass(r[i.type],o.statusClass(e)),n.addClass(this._elm,o.statusActiveClass(i.type));var s="";t.forEach(function(e){s+=o.statusMessage(e)}),r[i.type].innerHTML=s}clearStatus(e,t){var i=this._get("$status");n.removeClass(i[t.type],o.statusClass(e)),n.removeClass(this._elm,o.statusActiveClass(t.type)),i[t.type].innerHTML=""}}return l.addons=a,e.attach("widgets.Coder",l)}),define("skylark-codemirror-base/util/browser",[],function(){"use strict";let e=navigator.userAgent,t=navigator.platform,i=/gecko\/\d/i.test(e),n=/MSIE \d/.test(e),r=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),s=/Edge\/(\d+)/.exec(e),o=n||r||s,a=o&&(n?document.documentMode||6:+(s||r)[1]),l=!s&&/WebKit\//.test(e),c=l&&/Qt\/\d+\.\d+/.test(e),h=!s&&/Chrome\//.test(e),u=/Opera\//.test(e),d=/Apple Computer/.test(navigator.vendor),f=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),p=/PhantomJS/.test(e),m=!s&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),g=/Android/.test(e),v=m||g||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),y=m||/Mac/.test(t),k=/\bCrOS\b/.test(e),b=/win/i.test(t),x=u&&e.match(/Version\/(\d*\.\d*)/);x&&(x=Number(x[1])),x&&x>=15&&(u=!1,l=!0);let w=y&&(c||u&&(null==x||x<12.11)),_=i||o&&a>=9;return{gecko:i,ie:o,ie_version:a,webkit:l,chrome:h,presto:u,safari:d,mac_geMountainLion:f,phantom:p,ios:m,android:g,mobile:v,mac:y,chromeOS:k,windows:b,flipCtrlCmd:w,captureRightClick:_}}),define("skylark-codemirror-base/util/dom",["./browser"],function(e){"use strict";function t(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}let i;function n(e){for(let t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function r(e,t,i,n){let r=document.createElement(e);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(let e=0;e<t.length;++e)r.appendChild(t[e]);return r}i=document.createRange?function(e,t,i,n){let r=document.createRange();return r.setEnd(n||e,i),r.setStart(e,t),r}:function(e,t,i){let n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(e){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n};let s=function(e){e.select()};return e.ios?s=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:e.ie&&(s=function(e){try{e.select()}catch(e){}}),{classTest:t,rmClass:function(e,i){let n=e.className,r=t(i).exec(n);if(r){let t=n.slice(r.index+r[0].length);e.className=n.slice(0,r.index)+(t?r[1]+t:"")}},removeChildren:n,removeChildrenAndAdd:function(e,t){return n(e).appendChild(t)},elt:r,eltP:function(e,t,i,n){let s=r(e,t,i,n);return s.setAttribute("role","presentation"),s},range:i,contains:function(e,t){3==t.nodeType&&(t=t.parentNode);if(e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)},activeElt:function(){let e;try{e=document.activeElement}catch(t){e=document.body||null}for(;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e},addClass:function(e,i){let n=e.className;t(i).test(n)||(e.className+=(n?" ":"")+i)},joinClasses:function(e,i){let n=e.split(" ");for(let e=0;e<n.length;e++)n[e]&&!t(n[e]).test(i)&&(i+=" "+n[e]);return i},selectInput:s}}),define("skylark-codemirror-base/util/misc",[],function(){"use strict";function e(e,t,i){t||(t={});for(let n in e)!e.hasOwnProperty(n)||!1===i&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}let t=[""];function i(e){return e[e.length-1]}function n(){}let r=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function s(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||r.test(e))}let o=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function a(e){return e.charCodeAt(0)>=768&&o.test(e)}return{bind:function(e){let t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}},copyObj:e,countColumn:function(e,t,i,n,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(let s=n||0,o=r||0;;){let n=e.indexOf("\t",s);if(n<0||n>=t)return o+(t-s);o+=n-s,o+=i-o%i,s=n+1}},Delayed:class{constructor(){this.id=null}set(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},indexOf:function(e,t){for(let i=0;i<e.length;++i)if(e[i]==t)return i;return-1},scrollerGap:30,Pass:{toString:function(){return"CodeMirror.Pass"}},sel_dontScroll:{scroll:!1},sel_mouse:{origin:"*mouse"},sel_move:{origin:"+move"},findColumn:function(e,t,i){for(let n=0,r=0;;){let s=e.indexOf("\t",n);-1==s&&(s=e.length);let o=s-n;if(s==e.length||r+o>=t)return n+Math.min(o,t-r);if(r+=s-n,n=s+1,(r+=i-r%i)>=t)return n}},spaceStr:function(e){for(;t.length<=e;)t.push(i(t)+" ");return t[e]},lst:i,map:function(e,t){let i=[];for(let n=0;n<e.length;n++)i[n]=t(e[n],n);return i},insertSorted:function(e,t,i){let n=0,r=i(t);for(;n<e.length&&i(e[n])<=r;)n++;e.splice(n,0,t)},createObj:function(t,i){let r;Object.create?r=Object.create(t):(n.prototype=t,r=new n);i&&e(i,r);return r},isWordCharBasic:s,isWordChar:function(e,t){return t?!!(t.source.indexOf("\\w")>-1&&s(e))||t.test(e):s(e)},isEmpty:function(e){for(let t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0},isExtendingChar:a,skipExtendingChars:function(e,t,i){for(;(i<0?t>0:t<e.length)&&a(e.charAt(t));)t+=i;return t},findFirst:function(e,t,i){let n=t>i?-1:1;for(;;){if(t==i)return t;let r=(t+i)/2,s=n<0?Math.ceil(r):Math.floor(r);if(s==t)return e(s)?t:i;e(s)?i=s:t=s+n}}}}),define("skylark-codemirror-base/display/Display",["../util/browser","../util/dom","../util/misc"],function(e,t,i){"use strict";return{Display:function(n,r,s){let o=this;this.input=s,o.scrollbarFiller=t.elt("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=t.elt("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=t.eltP("div",null,"CodeMirror-code"),o.selectionDiv=t.elt("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=t.elt("div",null,"CodeMirror-cursors"),o.measure=t.elt("div",null,"CodeMirror-measure"),o.lineMeasure=t.elt("div",null,"CodeMirror-measure"),o.lineSpace=t.eltP("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none");let a=t.eltP("div",[o.lineSpace],"CodeMirror-lines");o.mover=t.elt("div",[a],null,"position: relative"),o.sizer=t.elt("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=t.elt("div",null,null,"position: absolute; height: "+i.scrollerGap+"px; width: 1px;"),o.gutters=t.elt("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=t.elt("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=t.elt("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),e.ie&&e.ie_version<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0);e.webkit||e.gecko&&e.mobile||(o.scroller.draggable=!0);n&&(n.appendChild?n.appendChild(o.wrapper):n(o.wrapper));o.viewFrom=o.viewTo=r.first,o.reportedViewFrom=o.reportedViewTo=r.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,s.init(o)}}}),define("skylark-codemirror-base/line/utils_line",["../util/misc"],function(e){"use strict";return{getLine:function(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");let i=e;for(;!i.lines;)for(let e=0;;++e){let n=i.children[e],r=n.chunkSize();if(t<r){i=n;break}t-=r}return i.lines[t]},getBetween:function(e,t,i){let n=[],r=t.line;return e.iter(t.line,i.line+1,e=>{let s=e.text;r==i.line&&(s=s.slice(0,i.ch)),r==t.line&&(s=s.slice(t.ch)),n.push(s),++r}),n},getLines:function(e,t,i){let n=[];return e.iter(t,i,e=>{n.push(e.text)}),n},updateLineHeight:function(e,t){let i=t-e.height;if(i)for(let t=e;t;t=t.parent)t.height+=i},lineNo:function(t){if(null==t.parent)return null;let i=t.parent,n=e.indexOf(i.lines,t);for(let e=i.parent;e;i=e,e=e.parent)for(let t=0;e.children[t]!=i;++t)n+=e.children[t].chunkSize();return n+i.first},lineAtHeight:function(e,t){let i=e.first;e:do{for(let n=0;n<e.children.length;++n){let r=e.children[n],s=r.height;if(t<s){e=r;continue e}t-=s,i+=r.chunkSize()}return i}while(!e.lines);let n=0;for(;n<e.lines.length;++n){let i=e.lines[n],r=i.height;if(t<r)break;t-=r}return i+n},isLine:function(e,t){return t>=e.first&&t<e.first+e.size},lineNumberFor:function(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}}}),define("skylark-codemirror-base/line/pos",["./utils_line"],function(e){"use strict";function t(e,i,n=null){if(!(this instanceof t))return new t(e,i,n);this.line=e,this.ch=i,this.sticky=n}function i(e,t){return e.line-t.line||e.ch-t.ch}function n(i,n){if(n.line<i.first)return t(i.first,0);let r=i.first+i.size-1;return n.line>r?t(r,e.getLine(i,r).text.length):function(e,i){let n=e.ch;return null==n||n>i?t(e.line,i):n<0?t(e.line,0):e}(n,e.getLine(i,n.line).text.length)}return{Pos:t,cmp:i,equalCursorPos:function(e,t){return e.sticky==t.sticky&&0==i(e,t)},copyPos:function(e){return t(e.line,e.ch)},maxPos:function(e,t){return i(e,t)<0?t:e},minPos:function(e,t){return i(e,t)<0?e:t},clipLine:function(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))},clipPos:n,clipPosArray:function(e,t){let i=[];for(let r=0;r<t.length;r++)i[r]=n(e,t[r]);return i}}}),define("skylark-codemirror-base/line/saw_special_spans",[],function(){"use strict";let exports={sawReadOnlySpans:!1,sawCollapsedSpans:!1,seeReadOnlySpans:function(){exports.sawReadOnlySpans=!0},seeCollapsedSpans:function(){exports.sawCollapsedSpans=!0}};return exports}),define("skylark-codemirror-base/line/spans",["../util/misc","./pos","./saw_special_spans","./utils_line"],function(e,t,i,n){"use strict";function r(e,t,i){this.marker=e,this.from=t,this.to=i}function s(e,t){if(e)for(let i=0;i<e.length;++i){let n=e[i];if(n.marker==t)return n}}function o(e){for(let t=0;t<e.length;++t){let i=e[t];null!=i.from&&i.from==i.to&&!1!==i.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function a(e){return e.inclusiveLeft?-1:0}function l(e){return e.inclusiveRight?1:0}function c(e,i){let n=e.lines.length-i.lines.length;if(0!=n)return n;let r=e.find(),s=i.find(),o=t.cmp(r.from,s.from)||a(e)-a(i);if(o)return-o;let c=t.cmp(r.to,s.to)||l(e)-l(i);return c||i.id-e.id}function h(e,t){let n,r=i.sawCollapsedSpans&&e.markedSpans;if(r)for(let e,i=0;i<r.length;++i)(e=r[i]).marker.collapsed&&null==(t?e.from:e.to)&&(!n||c(n,e.marker)<0)&&(n=e.marker);return n}function u(e){return h(e,!0)}function d(e){return h(e,!1)}function f(e){let t;for(;t=u(e);)e=t.find(-1,!0).line;return e}function p(e,t){let n=i.sawCollapsedSpans&&t.markedSpans;if(n)for(let i,r=0;r<n.length;++r)if((i=n[r]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&m(e,t,i))return!0}}function m(e,t,i){if(null==i.to){let t=i.marker.find(1,!0);return m(e,t.line,s(t.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(let n,r=0;r<t.markedSpans.length;++r)if((n=t.markedSpans[r]).marker.collapsed&&!n.marker.widgetNode&&n.from==i.to&&(null==n.to||n.to!=i.from)&&(n.marker.inclusiveLeft||i.marker.inclusiveRight)&&m(e,t,n))return!0}function g(e){if(0==e.height)return 0;let t,i=e.text.length,n=e;for(;t=u(n);){let e=t.find(0,!0);n=e.from.line,i+=e.from.ch-e.to.ch}for(n=e;t=d(n);){let e=t.find(0,!0);i-=n.text.length-e.from.ch,n=e.to.line,i+=n.text.length-e.to.ch}return i}return{MarkedSpan:r,getMarkedSpanFor:s,removeMarkedSpan:function(e,t){let i;for(let n=0;n<e.length;++n)e[n]!=t&&(i||(i=[])).push(e[n]);return i},addMarkedSpan:function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)},stretchSpansOverChange:function(i,a){if(a.full)return null;let l=n.isLine(i,a.from.line)&&n.getLine(i,a.from.line).markedSpans,c=n.isLine(i,a.to.line)&&n.getLine(i,a.to.line).markedSpans;if(!l&&!c)return null;let h=a.from.ch,u=a.to.ch,d=0==t.cmp(a.from,a.to),f=function(e,t,i){let n;if(e)for(let s=0;s<e.length;++s){let o=e[s],a=o.marker,l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(l||o.from==t&&"bookmark"==a.type&&(!i||!o.marker.insertLeft)){let e=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(n||(n=[])).push(new r(a,o.from,e?null:o.to))}}return n}(l,h,d),p=function(e,t,i){let n;if(e)for(let s=0;s<e.length;++s){let o=e[s],a=o.marker,l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(l||o.from==t&&"bookmark"==a.type&&(!i||o.marker.insertLeft)){let e=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(n||(n=[])).push(new r(a,e?null:o.from-t,null==o.to?null:o.to-t))}}return n}(c,u,d),m=1==a.text.length,g=e.lst(a.text).length+(m?h:0);if(f)for(let e=0;e<f.length;++e){let t=f[e];if(null==t.to){let e=s(p,t.marker);e?m&&(t.to=null==e.to?null:e.to+g):t.to=h}}if(p)for(let e=0;e<p.length;++e){let t=p[e];if(null!=t.to&&(t.to+=g),null==t.from){let e=s(f,t.marker);e||(t.from=g,m&&(f||(f=[])).push(t))}else t.from+=g,m&&(f||(f=[])).push(t)}f&&(f=o(f));p&&p!=f&&(p=o(p));let v=[f];if(!m){let e,t=a.text.length-2;if(t>0&&f)for(let t=0;t<f.length;++t)null==f[t].to&&(e||(e=[])).push(new r(f[t].marker,null,null));for(let i=0;i<t;++i)v.push(e);v.push(p)}return v},removeReadOnlyRanges:function(i,n,r){let s=null;if(i.iter(n.line,r.line+1,t=>{if(t.markedSpans)for(let i=0;i<t.markedSpans.length;++i){let n=t.markedSpans[i].marker;!n.readOnly||s&&-1!=e.indexOf(s,n)||(s||(s=[])).push(n)}}),!s)return null;let o=[{from:n,to:r}];for(let e=0;e<s.length;++e){let i=s[e],n=i.find(0);for(let e=0;e<o.length;++e){let r=o[e];if(t.cmp(r.to,n.from)<0||t.cmp(r.from,n.to)>0)continue;let s=[e,1],a=t.cmp(r.from,n.from),l=t.cmp(r.to,n.to);(a<0||!i.inclusiveLeft&&!a)&&s.push({from:r.from,to:n.from}),(l>0||!i.inclusiveRight&&!l)&&s.push({from:n.to,to:r.to}),o.splice.apply(o,s),e+=s.length-3}}return o},detachMarkedSpans:function(e){let t=e.markedSpans;if(!t)return;for(let i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null},attachMarkedSpans:function(e,t){if(!t)return;for(let i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t},compareCollapsedMarkers:c,collapsedSpanAtStart:u,collapsedSpanAtEnd:d,collapsedSpanAround:function(e,t){let n,r=i.sawCollapsedSpans&&e.markedSpans;if(r)for(let e=0;e<r.length;++e){let i=r[e];i.marker.collapsed&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!n||c(n,i.marker)<0)&&(n=i.marker)}return n},conflictingCollapsedRange:function(e,r,s,o,c){let h=n.getLine(e,r),u=i.sawCollapsedSpans&&h.markedSpans;if(u)for(let e=0;e<u.length;++e){let i=u[e];if(!i.marker.collapsed)continue;let n=i.marker.find(0),r=t.cmp(n.from,s)||a(i.marker)-a(c),h=t.cmp(n.to,o)||l(i.marker)-l(c);if(!(r>=0&&h<=0||r<=0&&h>=0)&&(r<=0&&(i.marker.inclusiveRight&&c.inclusiveLeft?t.cmp(n.to,s)>=0:t.cmp(n.to,s)>0)||r>=0&&(i.marker.inclusiveRight&&c.inclusiveLeft?t.cmp(n.from,o)<=0:t.cmp(n.from,o)<0)))return!0}},visualLine:f,visualLineEnd:function(e){let t;for(;t=d(e);)e=t.find(1,!0).line;return e},visualLineContinued:function(e){let t,i;for(;t=d(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i},visualLineNo:function(e,t){let i=n.getLine(e,t),r=f(i);return i==r?t:n.lineNo(r)},visualLineEndNo:function(e,t){if(t>e.lastLine())return t;let i,r=n.getLine(e,t);if(!p(e,r))return t;for(;i=d(r);)r=i.find(1,!0).line;return n.lineNo(r)+1},lineIsHidden:p,heightAtLine:function(e){let t=0,i=(e=f(e)).parent;for(let n=0;n<i.lines.length;++n){let r=i.lines[n];if(r==e)break;t+=r.height}for(let e=i.parent;e;e=(i=e).parent)for(let n=0;n<e.children.length;++n){let r=e.children[n];if(r==i)break;t+=r.height}return t},lineLength:g,findMaxLine:function(e){let t=e.display,i=e.doc;t.maxLine=n.getLine(i,i.first),t.maxLineLength=g(t.maxLine),t.maxLineChanged=!0,i.iter(e=>{let i=g(e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}}}),define("skylark-codemirror-base/util/bidi",["./misc"],function(e){"use strict";let t=null;let i=function(){let t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";function n(e){return e<=247?t.charAt(e):1424<=e&&e<=1524?"R":1536<=e&&e<=1785?i.charAt(e-1536):1774<=e&&e<=2220?"r":8192<=e&&e<=8203?"w":8204==e?"b":"L"}let r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,s=/[stwN]/,o=/[LRr]/,a=/[Lb1n]/,l=/[1n]/;function c(e,t,i){this.level=e,this.from=t,this.to=i}return function(t,i){let h="ltr"==i?"L":"R";if(0==t.length||"ltr"==i&&!r.test(t))return!1;let u=t.length,d=[];for(let e=0;e<u;++e)d.push(n(t.charCodeAt(e)));for(let e=0,t=h;e<u;++e){let i=d[e];"m"==i?d[e]=t:t=i}for(let e=0,t=h;e<u;++e){let i=d[e];"1"==i&&"r"==t?d[e]="n":o.test(i)&&(t=i,"r"==i&&(d[e]="R"))}for(let e=1,t=d[0];e<u-1;++e){let i=d[e];"+"==i&&"1"==t&&"1"==d[e+1]?d[e]="1":","!=i||t!=d[e+1]||"1"!=t&&"n"!=t||(d[e]=t),t=i}for(let e=0;e<u;++e){let t=d[e];if(","==t)d[e]="N";else if("%"==t){let t;for(t=e+1;t<u&&"%"==d[t];++t);let i=e&&"!"==d[e-1]||t<u&&"1"==d[t]?"1":"N";for(let n=e;n<t;++n)d[n]=i;e=t-1}}for(let e=0,t=h;e<u;++e){let i=d[e];"L"==t&&"1"==i?d[e]="L":o.test(i)&&(t=i)}for(let e=0;e<u;++e)if(s.test(d[e])){let t;for(t=e+1;t<u&&s.test(d[t]);++t);let i="L"==(e?d[e-1]:h),n="L"==(t<u?d[t]:h),r=i==n?i?"L":"R":h;for(let i=e;i<t;++i)d[i]=r;e=t-1}let f,p=[];for(let e=0;e<u;)if(a.test(d[e])){let t=e;for(++e;e<u&&a.test(d[e]);++e);p.push(new c(0,t,e))}else{let t=e,i=p.length;for(++e;e<u&&"L"!=d[e];++e);for(let n=t;n<e;)if(l.test(d[n])){t<n&&p.splice(i,0,new c(1,t,n));let r=n;for(++n;n<e&&l.test(d[n]);++n);p.splice(i,0,new c(2,r,n)),t=n}else++n;t<e&&p.splice(i,0,new c(1,t,e))}return"ltr"==i&&(1==p[0].level&&(f=t.match(/^\s+/))&&(p[0].from=f[0].length,p.unshift(new c(0,0,f[0].length))),1==e.lst(p).level&&(f=t.match(/\s+$/))&&(e.lst(p).to-=f[0].length,p.push(new c(0,u-f[0].length,u)))),"rtl"==i?p.reverse():p}}();return{iterateBidiSections:function(e,t,i,n){if(!e)return n(t,i,"ltr",0);let r=!1;for(let s=0;s<e.length;++s){let o=e[s];(o.from<i&&o.to>t||t==i&&o.to==t)&&(n(Math.max(o.from,t),Math.min(o.to,i),1==o.level?"rtl":"ltr",s),r=!0)}r||n(t,i,"ltr")},bidiOther:t,getBidiPartAt:function(e,i,n){let r;t=null;for(let s=0;s<e.length;++s){let o=e[s];if(o.from<i&&o.to>i)return s;o.to==i&&(o.from!=o.to&&"before"==n?r=s:t=s),o.from==i&&(o.from!=o.to&&"before"!=n?r=s:t=s)}return null!=r?r:t},getOrder:function(e,t){let n=e.order;null==n&&(n=e.order=i(e.text,t));return n}}}),define("skylark-codemirror-base/util/event",["./browser","./misc"],function(e,t){"use strict";const i=[];let n=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{let r=e._handlers||(e._handlers={});r[t]=(r[t]||i).concat(n)}};function r(e,t){return e._handlers&&e._handlers[t]||i}function s(e,i,n){if(e.removeEventListener)e.removeEventListener(i,n,!1);else if(e.detachEvent)e.detachEvent("on"+i,n);else{let r=e._handlers,s=r&&r[i];if(s){let e=t.indexOf(s,n);e>-1&&(r[i]=s.slice(0,e).concat(s.slice(e+1)))}}}function o(e,t){let i=r(e,t);if(!i.length)return;let n=Array.prototype.slice.call(arguments,2);for(let e=0;e<i.length;++e)i[e].apply(null,n)}function a(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function l(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function c(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}return{on:n,getHandlers:r,off:s,signal:o,signalDOMEvent:function(e,t,i){"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}});return o(e,i||t.type,e,t),c(t)||t.codemirrorIgnore},signalCursorActivity:function(e){let i=e._handlers&&e._handlers.cursorActivity;if(!i)return;let n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]);for(let e=0;e<i.length;++e)-1==t.indexOf(n,i[e])&&n.push(i[e])},hasHandler:function(e,t){return r(e,t).length>0},eventMixin:function(e){e.prototype.on=function(e,t){n(this,e,t)},e.prototype.off=function(e,t){s(this,e,t)}},e_preventDefault:a,e_stopPropagation:l,e_defaultPrevented:c,e_stop:function(e){a(e),l(e)},e_target:function(e){return e.target||e.srcElement},e_button:function(t){let i=t.which;null==i&&(1&t.button?i=1:2&t.button?i=3:4&t.button&&(i=2));e.mac&&t.ctrlKey&&1==i&&(i=3);return i}}}),define("skylark-codemirror-base/util/feature_detection",["./dom","./browser"],function(e,t){"use strict";let i,n,r=function(){if(t.ie&&t.ie_version<9)return!1;let i=e.elt("div");return"draggable"in i||"dragDrop"in i}();let s=3!="\n\nb".split(/\n/).length?e=>{let t=0,i=[],n=e.length;for(;t<=n;){let n=e.indexOf("\n",t);-1==n&&(n=e.length);let r=e.slice(t,"\r"==e.charAt(n-1)?n-1:n),s=r.indexOf("\r");-1!=s?(i.push(r.slice(0,s)),t+=s+1):(i.push(r),t=n+1)}return i}:e=>e.split(/\r\n?|\n/),o=window.getSelection?e=>{try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:e=>{let t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},a=(()=>{let t=e.elt("div");return"oncopy"in t||(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)})(),l=null;return{dragAndDrop:r,zeroWidthElement:function(n){if(null==i){let r=e.elt("span","​");e.removeChildrenAndAdd(n,e.elt("span",[r,document.createTextNode("x")])),0!=n.firstChild.offsetHeight&&(i=r.offsetWidth<=1&&r.offsetHeight>2&&!(t.ie&&t.ie_version<8))}let r=i?e.elt("span","​"):e.elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r},hasBadBidiRects:function(t){if(null!=n)return n;let i=e.removeChildrenAndAdd(t,document.createTextNode("AخA")),r=e.range(i,0,1).getBoundingClientRect(),s=e.range(i,1,2).getBoundingClientRect();return e.removeChildren(t),!(!r||r.left==r.right)&&(n=s.right-r.right<3)},splitLinesAuto:s,hasSelection:o,hasCopyEvent:a,hasBadZoomedRects:function(t){if(null!=l)return l;let i=e.removeChildrenAndAdd(t,e.elt("span","x")),n=i.getBoundingClientRect(),r=e.range(i,0,1).getBoundingClientRect();return l=Math.abs(n.left-r.left)>1}}}),define("skylark-codemirror-base/modes",["./util/misc"],function(e){"use strict";let t={},i={};function n(t){if("string"==typeof t&&i.hasOwnProperty(t))t=i[t];else if(t&&"string"==typeof t.name&&i.hasOwnProperty(t.name)){let n=i[t.name];"string"==typeof n&&(n={name:n}),(t=e.createObj(n,t)).name=n.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return n("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return n("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}let r={};return{modes:t,mimeModes:i,defineMode:function(e,i){arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2));t[e]=i},defineMIME:function(e,t){i[e]=t},resolveMode:n,getMode:function e(i,s){s=n(s);let o=t[s.name];if(!o)return e(i,"text/plain");let a=o(i,s);if(r.hasOwnProperty(s.name)){let e=r[s.name];for(let t in e)e.hasOwnProperty(t)&&(a.hasOwnProperty(t)&&(a["_"+t]=a[t]),a[t]=e[t])}a.name=s.name;s.helperType&&(a.helperType=s.helperType);if(s.modeProps)for(let e in s.modeProps)a[e]=s.modeProps[e];return a},modeExtensions:r,extendMode:function(t,i){let n=r.hasOwnProperty(t)?r[t]:r[t]={};e.copyObj(i,n)},copyState:function(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);let i={};for(let e in t){let n=t[e];n instanceof Array&&(n=n.concat([])),i[e]=n}return i},innerMode:function(e,t){let i;for(;e.innerMode&&(i=e.innerMode(t))&&i.mode!=e;)t=i.state,e=i.mode;return i||{mode:e,state:t}},startState:function(e,t,i){return!e.startState||e.startState(t,i)}}}),define("skylark-codemirror-base/util/StringStream",["./misc"],function(e){"use strict";return class{constructor(e,t,i){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i}eol(){return this.pos>=this.string.length}sol(){return this.pos==this.lineStart}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t,i=this.string.charAt(this.pos);if(t="string"==typeof e?i==e:i&&(e.test?e.test(i):e(i)))return++this.pos,i}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=e.countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?e.countColumn(this.string,this.lineStart,this.tabSize):0)}indentation(){return e.countColumn(this.string,null,this.tabSize)-(this.lineStart?e.countColumn(this.string,this.lineStart,this.tabSize):0)}match(e,t,i){if("string"!=typeof e){let i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}{let n=e=>i?e.toLowerCase():e,r=this.string.substr(this.pos,e.length);if(n(r)==n(e))return!1!==t&&(this.pos+=e.length),!0}}current(){return this.string.slice(this.start,this.pos)}hideFirstChars(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}lookAhead(e){let t=this.lineOracle;return t&&t.lookAhead(e)}baseToken(){let e=this.lineOracle;return e&&e.baseToken(this.pos)}}}),define("skylark-codemirror-base/line/highlight",["../util/misc","../modes","../util/StringStream","./utils_line","./pos"],function(e,t,i,n,r){"use strict";class s{constructor(e,t){this.state=e,this.lookAhead=t}}class o{constructor(e,t,i,n){this.state=t,this.doc=e,this.line=i,this.maxLookAhead=n||0,this.baseTokens=null,this.baseTokenPos=1}lookAhead(e){let t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t}baseToken(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;let t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}}nextLine(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--}static fromSaved(e,i,n){return i instanceof s?new o(e,t.copyState(e.mode,i.state),n,i.lookAhead):new o(e,t.copyState(e.mode,i),n)}save(e){let i=!1!==e?t.copyState(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new s(i,this.maxLookAhead):i}}function a(e,t,i,n){let r=[e.state.modeGen],s={};p(e,t.text,e.doc.mode,i,(e,t)=>r.push(e,t),s,n);let o=i.state;for(let n=0;n<e.state.overlays.length;++n){i.baseTokens=r;let a=e.state.overlays[n],l=1,c=0;i.state=!0,p(e,t.text,a.mode,i,(e,t)=>{let i=l;for(;c<e;){let t=r[l];t>e&&r.splice(l,1,e,r[l+1],t),l+=2,c=Math.min(e,t)}if(t)if(a.opaque)r.splice(i,l-i,e,"overlay "+t),l=i+2;else for(;i<l;i+=2){let e=r[i+1];r[i+1]=(e?e+" ":"")+"overlay "+t}},s),i.state=o,i.baseTokens=null,i.baseTokenPos=1}return{styles:r,classes:s.bgClass||s.textClass?s:null}}function l(i,r,a){let l=i.doc,h=i.display;if(!l.mode.startState)return new o(l,!0,r);let u=function(t,i,r){let o,a,l=t.doc,c=r?-1:i-(t.doc.mode.innerMode?1e3:100);for(let h=i;h>c;--h){if(h<=l.first)return l.first;let i=n.getLine(l,h-1),c=i.stateAfter;if(c&&(!r||h+(c instanceof s?c.lookAhead:0)<=l.modeFrontier))return h;let u=e.countColumn(i.text,null,t.options.tabSize);(null==a||o>u)&&(a=h-1,o=u)}return a}(i,r,a),d=u>l.first&&n.getLine(l,u-1).stateAfter,f=d?o.fromSaved(l,d,u):new o(l,t.startState(l.mode),u);return l.iter(u,r,e=>{c(i,e.text,f);let t=f.line;e.stateAfter=t==r-1||t%5==0||t>=h.viewFrom&&t<h.viewTo?f.save():null,f.nextLine()}),a&&(l.modeFrontier=f.line),f}function c(e,t,n,r){let s=e.doc.mode,o=new i(t,e.options.tabSize,n);for(o.start=o.pos=r||0,""==t&&h(s,n.state);!o.eol();)u(s,o,n.state),o.start=o.pos}function h(e,i){if(e.blankLine)return e.blankLine(i);if(!e.innerMode)return;let n=t.innerMode(e,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}function u(e,i,n,r){for(let s=0;s<10;s++){r&&(r[0]=t.innerMode(e,n).mode);let s=e.token(i,n);if(i.pos>i.start)return s}throw new Error("Mode "+e.name+" failed to advance stream.")}class d{constructor(e,t,i){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=i}}function f(e,t){if(e)for(;;){let i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);let n=i[1]?"bgClass":"textClass";null==t[n]?t[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+i[2])}return e}function p(e,t,n,r,s,o,a){let l=n.flattenSpans;null==l&&(l=e.options.flattenSpans);let d,p=0,m=null,g=new i(t,e.options.tabSize,r),v=e.options.addModeClass&&[null];for(""==t&&f(h(n,r.state),o);!g.eol();){if(g.pos>e.options.maxHighlightLength?(l=!1,a&&c(e,t,r,g.pos),g.pos=t.length,d=null):d=f(u(n,g,r.state,v),o),v){let e=v[0].name;e&&(d="m-"+(d?e+" "+d:e))}if(!l||m!=d){for(;p<g.start;)p=Math.min(g.start,p+5e3),s(p,m);m=d}g.start=g.pos}for(;p<g.pos;){let e=Math.min(g.pos,p+5e3);s(e,m),p=e}}return{highlightLine:a,getLineStyles:function(e,i,r){if(!i.styles||i.styles[0]!=e.state.modeGen){let s=l(e,n.lineNo(i)),o=i.text.length>e.options.maxHighlightLength&&t.copyState(e.doc.mode,s.state),c=a(e,i,s);o&&(s.state=o),i.stateAfter=s.save(!o),i.styles=c.styles,c.classes?i.styleClasses=c.classes:i.styleClasses&&(i.styleClasses=null),r===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))}return i.styles},getContextBefore:l,processLine:c,takeToken:function(e,s,o,a){let c,h=e.doc,f=h.mode;s=r.clipPos(h,s);let p,m=n.getLine(h,s.line),g=l(e,s.line,o),v=new i(m.text,e.options.tabSize,g);a&&(p=[]);for(;(a||v.pos<s.ch)&&!v.eol();)v.start=v.pos,c=u(f,v,g.state),a&&p.push(new d(v,c,t.copyState(h.mode,g.state)));return a?p:new d(v,c,g.state)},retreatFrontier:function(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),e.highlightFrontier<t-10)return;let i=e.first;for(let r=t-1;r>i;r--){let o=n.getLine(e,r).stateAfter;if(o&&(!(o instanceof s)||r+o.lookAhead<t)){i=r+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,i)}}}),define("skylark-codemirror-base/line/line_data",["../util/bidi","../util/browser","../util/dom","../util/event","../util/feature_detection","../util/misc","./highlight","./spans","./utils_line"],function(e,t,i,n,r,s,o,a,l){"use strict";class c{constructor(e,t,i){this.text=e,a.attachMarkedSpans(this,t),this.height=i?i(this):1}lineNo(){return l.lineNo(this)}}n.eventMixin(c);let h={},u={};function d(e,t){if(!e||/^\s*$/.test(e))return null;let i=t.addModeClass?u:h;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function f(e,n,r,o,a,l,c){if(!n)return;let h,u=e.splitSpaces?function(e,t){if(e.length>1&&!/  /.test(e))return e;let i=t,n="";for(let t=0;t<e.length;t++){let r=e.charAt(t);" "!=r||!i||t!=e.length-1&&32!=e.charCodeAt(t+1)||(r=" "),n+=r,i=" "==r}return n}(n,e.trailingSpace):n,d=e.cm.state.specialChars,f=!1;if(d.test(n)){h=document.createDocumentFragment();let r=0;for(;;){d.lastIndex=r;let o,a=d.exec(n),l=a?a.index-r:n.length-r;if(l){let n=document.createTextNode(u.slice(r,r+l));t.ie&&t.ie_version<9?h.appendChild(i.elt("span",[n])):h.appendChild(n),e.map.push(e.pos,e.pos+l,n),e.col+=l,e.pos+=l}if(!a)break;if(r+=l+1,"\t"==a[0]){let t=e.cm.options.tabSize,n=t-e.col%t;(o=h.appendChild(i.elt("span",s.spaceStr(n),"cm-tab"))).setAttribute("role","presentation"),o.setAttribute("cm-text","\t"),e.col+=n}else"\r"==a[0]||"\n"==a[0]?((o=h.appendChild(i.elt("span","\r"==a[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",a[0]),e.col+=1):((o=e.cm.options.specialCharPlaceholder(a[0])).setAttribute("cm-text",a[0]),t.ie&&t.ie_version<9?h.appendChild(i.elt("span",[o])):h.appendChild(o),e.col+=1);e.map.push(e.pos,e.pos+1,o),e.pos++}}else e.col+=n.length,h=document.createTextNode(u),e.map.push(e.pos,e.pos+n.length,h),t.ie&&t.ie_version<9&&(f=!0),e.pos+=n.length;if(e.trailingSpace=32==u.charCodeAt(n.length-1),r||o||a||f||l){let t=r||"";o&&(t+=o),a&&(t+=a);let n=i.elt("span",[h],t,l);if(c)for(let e in c)c.hasOwnProperty(e)&&"style"!=e&&"class"!=e&&n.setAttribute(e,c[e]);return e.content.appendChild(n)}e.content.appendChild(h)}function p(e,t){return(i,n,r,s,o,a,l)=>{r=r?r+" cm-force-border":"cm-force-border";let c=i.pos,h=c+n.length;for(;;){let u;for(let e=0;e<t.length&&!((u=t[e]).to>c&&u.from<=c);e++);if(u.to>=h)return e(i,n,r,s,o,a,l);e(i,n.slice(0,u.to-c),r,s,null,a,l),s=null,n=n.slice(u.to-c),c=u.to}}}function m(e,t,i,n){let r=!n&&i.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!n&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",i.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t,e.trailingSpace=!1}function g(e,t,i){let n=e.markedSpans,r=e.text,s=0;if(!n){for(let e=1;e<i.length;e+=2)t.addToken(t,r.slice(s,s=i[e]),d(i[e+1],t.cm.options));return}let o,a,l,c,h,u,f,p=r.length,g=0,v=1,y="",k=0;for(;;){if(k==g){l=c=h=a="",f=null,u=null,k=1/0;let e,i=[];for(let t=0;t<n.length;++t){let r=n[t],s=r.marker;if("bookmark"==s.type&&r.from==g&&s.widgetNode)i.push(s);else if(r.from<=g&&(null==r.to||r.to>g||s.collapsed&&r.to==g&&r.from==g)){if(null!=r.to&&r.to!=g&&k>r.to&&(k=r.to,c=""),s.className&&(l+=" "+s.className),s.css&&(a=(a?a+";":"")+s.css),s.startStyle&&r.from==g&&(h+=" "+s.startStyle),s.endStyle&&r.to==k&&(e||(e=[])).push(s.endStyle,r.to),s.title&&((f||(f={})).title=s.title),s.attributes)for(let e in s.attributes)(f||(f={}))[e]=s.attributes[e];s.collapsed&&(!u||n.compareCollapsedMarkers(u.marker,s)<0)&&(u=r)}else r.from>g&&k>r.from&&(k=r.from)}if(e)for(let t=0;t<e.length;t+=2)e[t+1]==k&&(c+=" "+e[t]);if(!u||u.from==g)for(let e=0;e<i.length;++e)m(t,0,i[e]);if(u&&(u.from||0)==g){if(m(t,(null==u.to?p+1:u.to)-g,u.marker,null==u.from),null==u.to)return;u.to==g&&(u=!1)}}if(g>=p)break;let e=Math.min(p,k);for(;;){if(y){let i=g+y.length;if(!u){let n=i>e?y.slice(0,e-g):y;t.addToken(t,n,o?o+l:l,h,g+n.length==k?c:"",a,f)}if(i>=e){y=y.slice(e-g),g=e;break}g=i,h=""}y=r.slice(s,s=i[v++]),o=d(i[v++],t.cm.options)}}}function v(e,t,i){this.line=t,this.rest=a.visualLineContinued(t),this.size=this.rest?l.lineNo(s.lst(this.rest))-i+1:1,this.node=this.text=null,this.hidden=a.lineIsHidden(e,t)}return{Line:c,updateLine:function(e,t,i,n){e.text=t,e.stateAfter&&(e.stateAfter=null);e.styles&&(e.styles=null);null!=e.order&&(e.order=null);a.detachMarkedSpans(e),a.attachMarkedSpans(e,i);let r=n?n(e):1;r!=e.height&&l.updateLineHeight(e,r)},cleanUpLine:function(e){e.parent=null,a.detachMarkedSpans(e)},buildLineContent:function(s,a){let c=i.eltP("span",null,null,t.webkit?"padding-right: .1px":null),h={pre:i.eltP("pre",[c],"CodeMirror-line"),content:c,col:0,pos:0,cm:s,trailingSpace:!1,splitSpaces:s.getOption("lineWrapping")};a.measure={};for(let t=0;t<=(a.rest?a.rest.length:0);t++){let n,c=t?a.rest[t-1]:a.line;h.pos=0,h.addToken=f,r.hasBadBidiRects(s.display.measure)&&(n=e.getOrder(c,s.doc.direction))&&(h.addToken=p(h.addToken,n)),h.map=[];let u=a!=s.display.externalMeasured&&l.lineNo(c);g(c,h,o.getLineStyles(s,c,u)),c.styleClasses&&(c.styleClasses.bgClass&&(h.bgClass=i.joinClasses(c.styleClasses.bgClass,h.bgClass||"")),c.styleClasses.textClass&&(h.textClass=i.joinClasses(c.styleClasses.textClass,h.textClass||""))),0==h.map.length&&h.map.push(0,0,h.content.appendChild(r.zeroWidthElement(s.display.measure))),0==t?(a.measure.map=h.map,a.measure.cache={}):((a.measure.maps||(a.measure.maps=[])).push(h.map),(a.measure.caches||(a.measure.caches=[])).push({}))}if(t.webkit){let e=h.content.lastChild;(/\bcm-tab\b/.test(e.className)||e.querySelector&&e.querySelector(".cm-tab"))&&(h.content.className="cm-tab-wrap-hack")}n.signal(s,"renderLine",s,a.line,h.pre),h.pre.className&&(h.textClass=i.joinClasses(h.pre.className,h.textClass||""));return h},defaultSpecialCharPlaceholder:function(e){let t=i.elt("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t},LineView:v,buildViewArray:function(e,t,i){let n,r=[];for(let s=t;s<i;s=n){let t=new v(e.doc,l.getLine(e.doc,s),s);n=s+t.size,r.push(t)}return r}}}),define("skylark-codemirror-base/util/operation_group",["./event"],function(e){"use strict";let t=null;let i=null;function n(){let e=i;i=null;for(let t=0;t<e.length;++t)e[t]()}return{pushOperation:function(e){t?t.ops.push(e):e.ownsGroup=t={ops:[e],delayedCallbacks:[]}},finishOperation:function(e,i){let n=e.ownsGroup;if(!n)return;try{!function(e){let t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i].call(null);for(let t=0;t<e.ops.length;t++){let i=e.ops[t];if(i.cursorActivityHandlers)for(;i.cursorActivityCalled<i.cursorActivityHandlers.length;)i.cursorActivityHandlers[i.cursorActivityCalled++].call(null,i.cm)}}while(i<t.length)}(n)}finally{t=null,i(n)}},signalLater:function(r,s){let o=e.getHandlers(r,s);if(!o.length)return;let a,l=Array.prototype.slice.call(arguments,2);t?a=t.delayedCallbacks:i?a=i:(a=i=[],setTimeout(n,0));for(let e=0;e<o.length;++e)a.push(()=>o[e].apply(null,l))}}}),define("skylark-codemirror-base/display/update_line",["../line/line_data","../line/utils_line","../util/browser","../util/dom","../util/operation_group"],function(e,t,i,n,r){"use strict";function s(e){return e.node==e.text&&(e.node=n.elt("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),i.ie&&i.ie_version<8&&(e.node.style.zIndex=2)),e.node}function o(t,i){let n=t.display.externalMeasured;return n&&n.line==i.line?(t.display.externalMeasured=null,i.measure=n.measure,n.built):e.buildLineContent(t,i)}function a(e,t){let i=t.text.className,n=o(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,l(e,t)):i&&(t.text.className=i)}function l(e,t){!function(e,t){let i=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;i&&(i+=" CodeMirror-linebackground");if(t.background)i?t.background.className=i:(t.background.parentNode.removeChild(t.background),t.background=null);else if(i){let r=s(t);t.background=r.insertBefore(n.elt("div",null,i),r.firstChild),e.display.input.setUneditable(t.background)}}(e,t),t.line.wrapClass?s(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");let i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function c(e,i,r,o){if(i.gutter&&(i.node.removeChild(i.gutter),i.gutter=null),i.gutterBackground&&(i.node.removeChild(i.gutterBackground),i.gutterBackground=null),i.line.gutterClass){let t=s(i);i.gutterBackground=n.elt("div",null,"CodeMirror-gutter-background "+i.line.gutterClass,`left: ${e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth}px; width: ${o.gutterTotalWidth}px`),e.display.input.setUneditable(i.gutterBackground),t.insertBefore(i.gutterBackground,i.text)}let a=i.line.gutterMarkers;if(e.options.lineNumbers||a){let l=s(i),c=i.gutter=n.elt("div",null,"CodeMirror-gutter-wrapper",`left: ${e.options.fixedGutter?o.fixedPos:-o.gutterTotalWidth}px`);if(e.display.input.setUneditable(c),l.insertBefore(c,i.text),i.line.gutterClass&&(c.className+=" "+i.line.gutterClass),!e.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(i.lineNumber=c.appendChild(n.elt("div",t.lineNumberFor(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt",`left: ${o.gutterLeft["CodeMirror-linenumbers"]}px; width: ${e.display.lineNumInnerWidth}px`))),a)for(let t=0;t<e.options.gutters.length;++t){let i=e.options.gutters[t],r=a.hasOwnProperty(i)&&a[i];r&&c.appendChild(n.elt("div",[r],"CodeMirror-gutter-elt",`left: ${o.gutterLeft[i]}px; width: ${o.gutterWidth[i]}px`))}}}function h(e,t,i){t.alignable&&(t.alignable=null);for(let e,i=t.node.firstChild;i;i=e)e=i.nextSibling,"CodeMirror-linewidget"==i.className&&t.node.removeChild(i);u(e,t,i)}function u(e,t,i){if(d(e,t.line,t,i,!0),t.rest)for(let n=0;n<t.rest.length;n++)d(e,t.rest[n],t,i,!1)}function d(e,t,i,o,a){if(!t.widgets)return;let l=s(i);for(let s=0,c=t.widgets;s<c.length;++s){let t=c[s],h=n.elt("div",[t.node],"CodeMirror-linewidget");t.handleMouseEvents||h.setAttribute("cm-ignore-events","true"),f(t,h,i,o),e.display.input.setUneditable(h),a&&t.above?l.insertBefore(h,i.gutter||i.text):l.appendChild(h),r.signalLater(t,"redraw")}}function f(e,t,i,n){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);let r=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(r-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}return{updateLineForChanges:function(e,t,i,n){for(let r=0;r<t.changes.length;r++){let s=t.changes[r];"text"==s?a(e,t):"gutter"==s?c(e,t,i,n):"class"==s?l(e,t):"widget"==s&&h(e,t,n)}t.changes=null},buildLineElement:function(e,t,i,n){let r=o(e,t);t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass);r.textClass&&(t.textClass=r.textClass);return l(e,t),c(e,t,i,n),u(e,t,n),t.node}}}),define("skylark-codemirror-base/measurement/widgets",["../util/dom","../util/event"],function(e,t){"use strict";return{widgetHeight:function(t){if(null!=t.height)return t.height;let i=t.doc.cm;if(!i)return 0;if(!e.contains(document.body,t.node)){let n="position: relative;";t.coverGutter&&(n+="margin-left: -"+i.display.gutters.offsetWidth+"px;"),t.noHScroll&&(n+="width: "+i.display.wrapper.clientWidth+"px;"),e.removeChildrenAndAdd(i.display.measure,e.elt("div",[t.node],null,n))}return t.height=t.node.parentNode.offsetHeight},eventInWidget:function(e,i){for(let n=t.e_target(i);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}}}),define("skylark-codemirror-base/measurement/position_measurement",["../line/line_data","../line/pos","../line/spans","../line/utils_line","../util/bidi","../util/browser","../util/dom","../util/event","../util/feature_detection","../util/misc","../display/update_line","./widgets"],function(e,t,i,n,r,s,o,a,l,c,h,u){"use strict";function d(e){return e.lineSpace.offsetTop}function f(e){if(e.cachedPaddingH)return e.cachedPaddingH;let t=o.removeChildrenAndAdd(e.measure,o.elt("pre","x")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function p(e){return c.scrollerGap-e.display.nativeBarWidth}function m(e){return e.display.scroller.clientWidth-p(e)-e.display.barWidth}function g(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(let i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(let t=0;t<e.rest.length;t++)if(n.lineNo(e.rest[t])>i)return{map:e.measure.maps[t],cache:e.measure.caches[t],before:!0}}function v(e,t,i,n){return b(e,k(e,t),i,n)}function y(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[B(e,t)];let i=e.display.externalMeasured;return i&&t>=i.lineN&&t<i.lineN+i.size?i:void 0}function k(t,r){let s=n.lineNo(r),a=y(t,s);a&&!a.text?a=null:a&&a.changes&&(h.updateLineForChanges(t,a,s,H(t)),t.curOp.forceUpdate=!0),a||(a=function(t,r){r=i.visualLine(r);let s=n.lineNo(r),a=t.display.externalMeasured=new e.LineView(t.doc,r,s);a.lineN=s;let l=a.built=e.buildLineContent(t,a);return a.text=l.pre,o.removeChildrenAndAdd(t.display.lineMeasure,l.pre),a}(t,r));let l=g(a,r,s);return{line:r,view:a,rect:null,map:l.map,cache:l.cache,before:l.before,hasHeights:!1}}function b(e,t,i,n,r){t.before&&(i=-1);let a,h=i+(n||"");return t.cache.hasOwnProperty(h)?a=t.cache[h]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(!function(e,t,i){let n=e.options.lineWrapping,r=n&&m(e);if(!t.measure.heights||n&&t.measure.width!=r){let e=t.measure.heights=[];if(n){t.measure.width=r;let n=t.text.firstChild.getClientRects();for(let t=0;t<n.length-1;t++){let r=n[t],s=n[t+1];Math.abs(r.bottom-s.bottom)>2&&e.push((r.bottom+s.top)/2-i.top)}}e.push(i.bottom-i.top)}}(e,t.view,t.rect),t.hasHeights=!0),(a=function(e,t,i,n){let r,a=_(t.map,i,n),h=a.node,u=a.start,d=a.end,f=a.collapse;if(3==h.nodeType){for(let e=0;e<4;e++){for(;u&&c.isExtendingChar(t.line.text.charAt(a.coverStart+u));)--u;for(;a.coverStart+d<a.coverEnd&&c.isExtendingChar(t.line.text.charAt(a.coverStart+d));)++d;if((r=s.ie&&s.ie_version<9&&0==u&&d==a.coverEnd-a.coverStart?h.parentNode.getBoundingClientRect():C(o.range(h,u,d).getClientRects(),n)).left||r.right||0==u)break;d=u,u-=1,f="right"}s.ie&&s.ie_version<11&&(r=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!l.hasBadZoomedRects(e))return t;let i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*n,bottom:t.bottom*n}}(e.display.measure,r))}else{let t;u>0&&(f=n="right"),r=e.options.lineWrapping&&(t=h.getClientRects()).length>1?t["right"==n?t.length-1:0]:h.getBoundingClientRect()}if(s.ie&&s.ie_version<9&&!u&&(!r||!r.left&&!r.right)){let t=h.parentNode.getClientRects()[0];r=t?{left:t.left,right:t.left+F(e.display),top:t.top,bottom:t.bottom}:w}let p=r.top-t.rect.top,m=r.bottom-t.rect.top,g=(p+m)/2,v=t.view.measure.heights,y=0;for(;y<v.length-1&&!(g<v[y]);y++);let k=y?v[y-1]:0,b=v[y],x={left:("right"==f?r.right:r.left)-t.rect.left,right:("left"==f?r.left:r.right)-t.rect.left,top:k,bottom:b};r.left||r.right||(x.bogus=!0);e.options.singleCursorHeightPerLine||(x.rtop=p,x.rbottom=m);return x}(e,t,i,n)).bogus||(t.cache[h]=a)),{left:a.left,right:a.right,top:r?a.rtop:a.top,bottom:r?a.rbottom:a.bottom}}let x,w={left:0,right:0,top:0,bottom:0};function _(e,t,i){let n,r,s,o,a,l;for(let c=0;c<e.length;c+=3)if(a=e[c],l=e[c+1],t<a?(r=0,s=1,o="left"):t<l?s=(r=t-a)+1:(c==e.length-3||t==l&&e[c+3]>t)&&(r=(s=l-a)-1,t>=l&&(o="right")),null!=r){if(n=e[c+2],a==l&&i==(n.insertLeft?"left":"right")&&(o=i),"left"==i&&0==r)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)n=e[2+(c-=3)],o="left";if("right"==i&&r==l-a)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)n=e[(c+=3)+2],o="right";break}return{node:n,start:r,end:s,collapse:o,coverStart:a,coverEnd:l}}function C(e,t){let i=w;if("left"==t)for(let t=0;t<e.length&&(i=e[t]).left==i.right;t++);else for(let t=e.length-1;t>=0&&(i=e[t]).left==i.right;t--);return i}function S(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(let t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function A(e){e.display.externalMeasure=null,o.removeChildren(e.display.lineMeasure);for(let t=0;t<e.display.view.length;t++)S(e.display.view[t])}function M(){return s.chrome&&s.android?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function T(){return s.chrome&&s.android?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function L(e){let t=0;if(e.widgets)for(let i=0;i<e.widgets.length;++i)e.widgets[i].above&&(t+=u.widgetHeight(e.widgets[i]));return t}function $(e,t,n,r,s){if(!s){let e=L(t);n.top+=e,n.bottom+=e}if("line"==r)return n;r||(r="local");let o=i.heightAtLine(t);if("local"==r?o+=d(e.display):o-=e.display.viewOffset,"page"==r||"window"==r){let t=e.display.lineSpace.getBoundingClientRect();o+=t.top+("window"==r?0:T());let i=t.left+("window"==r?0:M());n.left+=i,n.right+=i}return n.top+=o,n.bottom+=o,n}function E(e,t,i,s,o,a){function l(t,n){let r=b(e,o,t,n?"right":"left",a);return n?r.left=r.right:r.right=r.left,$(e,s,r,i)}s=s||n.getLine(e.doc,t.line),o||(o=k(e,s));let c=r.getOrder(s,e.doc.direction),h=t.ch,u=t.sticky;if(h>=s.text.length?(h=s.text.length,u="before"):h<=0&&(h=0,u="after"),!c)return l("before"==u?h-1:h,"before"==u);function d(e,t,i){let n=c[t],r=1==n.level;return l(i?e-1:e,r!=i)}let f=r.getBidiPartAt(c,h,u),p=r.bidiOther,m=d(h,f,"before"==u);return null!=p&&(m.other=d(h,p,"before"!=u)),m}function O(e,i,n,r,s){let o=t.Pos(e,i,n);return o.xRel=s,r&&(o.outside=!0),o}function R(e,t,r){let s=e.doc;if((r+=e.display.viewOffset)<0)return O(s.first,0,null,!0,-1);let o=n.lineAtHeight(s,r),a=s.first+s.size-1;if(o>a)return O(s.first+s.size-1,n.getLine(s,a).text.length,null,!0,1);t<0&&(t=0);let l=n.getLine(s,o);for(;;){let a=P(e,l,o,t,r),c=i.collapsedSpanAround(l,a.ch+(a.xRel>0?1:0));if(!c)return a;let h=c.find(1);if(h.line==o)return h;l=n.getLine(s,o=h.line)}}function D(e,t,i,n){n-=L(t);let r=t.text.length,s=c.findFirst(t=>b(e,i,t-1).bottom<=n,r,0);return r=c.findFirst(t=>b(e,i,t).top>n,s,r),{begin:s,end:r}}function I(e,t,i,n){return!(e.bottom<=i)&&(e.top>i||(n?e.left:e.right)>t)}function P(e,n,s,o,a){a-=i.heightAtLine(n);let l=k(e,n),h=L(n),d=0,f=n.text.length,p=!0,m=r.getOrder(n,e.doc.direction);if(m){let i=(e.options.lineWrapping?function(e,t,i,n,r,s,o){let{begin:a,end:l}=D(e,t,n,o);/\s/.test(t.text.charAt(l-1))&&l--;let c=null,h=null;for(let t=0;t<r.length;t++){let i=r[t];if(i.from>=l||i.to<=a)continue;let o=1!=i.level,u=b(e,n,o?Math.min(l,i.to)-1:Math.max(a,i.from)).right,d=u<s?s-u+1e9:u-s;(!c||h>d)&&(c=i,h=d)}c||(c=r[r.length-1]);c.from<a&&(c={from:a,to:c.to,level:c.level});c.to>l&&(c={from:c.from,to:l,level:c.level});return c}:function(e,i,n,r,s,o,a){let l=c.findFirst(l=>{let c=s[l],h=1!=c.level;return I(E(e,t.Pos(n,h?c.to:c.from,h?"before":"after"),"line",i,r),o,a,!0)},0,s.length-1),h=s[l];if(l>0){let c=1!=h.level,u=E(e,t.Pos(n,c?h.from:h.to,c?"after":"before"),"line",i,r);I(u,o,a,!0)&&u.top>a&&(h=s[l-1])}return h})(e,n,s,l,m,o,a);p=1!=i.level,d=p?i.from:i.to-1,f=p?i.to:i.from-1}let g,v,y=null,x=null,w=c.findFirst(t=>{let i=b(e,l,t);return i.top+=h,i.bottom+=h,!!I(i,o,a,!1)&&(i.top<=a&&i.left<=o&&(y=t,x=i),!0)},d,f),_=!1;if(x){let e=o-x.left<x.right-o,t=e==p;w=y+(t?0:1),v=t?"after":"before",g=e?x.left:x.right}else{p||w!=f&&w!=d||w++,v=0==w?"after":w==n.text.length?"before":b(e,l,w-(p?1:0)).bottom+u.widgetHeight<=a==p?"after":"before";let i=E(e,t.Pos(s,w,v),"line",n,l);g=i.left,_=a<i.top||a>=i.bottom}return w=c.skipExtendingChars(n.text,w,1),O(s,w,v,_,o-g)}function N(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==x){x=o.elt("pre");for(let e=0;e<49;++e)x.appendChild(document.createTextNode("x")),x.appendChild(o.elt("br"));x.appendChild(document.createTextNode("x"))}o.removeChildrenAndAdd(e.measure,x);let t=x.offsetHeight/50;return t>3&&(e.cachedTextHeight=t),o.removeChildren(e.measure),t||1}function F(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;let t=o.elt("span","xxxxxxxxxx"),i=o.elt("pre",[t]);o.removeChildrenAndAdd(e.measure,i);let n=t.getBoundingClientRect(),r=(n.right-n.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function H(e){let t=e.display,i={},n={},r=t.gutters.clientLeft;for(let s=t.gutters.firstChild,o=0;s;s=s.nextSibling,++o)i[e.options.gutters[o]]=s.offsetLeft+s.clientLeft+r,n[e.options.gutters[o]]=s.clientWidth;return{fixedPos:z(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function z(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function W(e){let t=N(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/F(e.display)-3);return s=>{if(i.lineIsHidden(e.doc,s))return 0;let o=0;if(s.widgets)for(let e=0;e<s.widgets.length;e++)s.widgets[e].height&&(o+=s.widgets[e].height);return n?o+(Math.ceil(s.text.length/r)||1)*t:o+t}}function B(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;let i=e.display.view;for(let e=0;e<i.length;e++)if((t-=i[e].size)<0)return e}return{paddingTop:d,paddingVert:function(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight},paddingH:f,scrollGap:p,displayWidth:m,displayHeight:function(e){return e.display.scroller.clientHeight-p(e)-e.display.barHeight},mapFromLineView:g,measureChar:v,findViewForLine:y,prepareMeasureForLine:k,measureCharPrepared:b,nodeAndOffsetInLineMap:_,clearLineMeasurementCacheFor:S,clearLineMeasurementCache:A,clearCaches:function(e){A(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0);e.display.lineNumChars=null},intoCoordSystem:$,fromCoordSystem:function(e,t,i){if("div"==i)return t;let n=t.left,r=t.top;if("page"==i)n-=M(),r-=T();else if("local"==i||!i){let t=e.display.sizer.getBoundingClientRect();n+=t.left,r+=t.top}let s=e.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:r-s.top}},charCoords:function(e,t,i,r,s){r||(r=n.getLine(e.doc,t.line));return $(e,r,v(e,r,t.ch,s),i)},cursorCoords:E,estimateCoords:function(e,r){let s=0;r=t.clipPos(e.doc,r),e.options.lineWrapping||(s=F(e.display)*r.ch);let o=n.getLine(e.doc,r.line),a=i.heightAtLine(o)+d(e.display);return{left:s,right:s,top:a,bottom:a+o.height}},coordsChar:R,wrappedLineExtentChar:function(e,t,i,n){i||(i=k(e,t));let r=$(e,t,b(e,i,n),"line").top;return D(e,t,i,r)},textHeight:N,charWidth:F,getDimensions:H,compensateForHScroll:z,estimateHeight:W,estimateLineHeights:function(e){let t=e.doc,i=W(e);t.iter(e=>{let t=i(e);t!=e.height&&n.updateLineHeight(e,t)})},posFromMouse:function(e,i,r,s){let o=e.display;if(!r&&"true"==a.e_target(i).getAttribute("cm-not-content"))return null;let l,h,u=o.lineSpace.getBoundingClientRect();try{l=i.clientX-u.left,h=i.clientY-u.top}catch(i){return null}let d,p=R(e,l,h);if(s&&1==p.xRel&&(d=n.getLine(e.doc,p.line).text).length==p.ch){let i=c.countColumn(d,d.length,e.options.tabSize)-d.length;p=t.Pos(p.line,Math.max(0,Math.round((l-f(e.display).left)/F(e.display))-i))}return p},findViewIndex:B}}),define("skylark-codemirror-base/display/selection",["../line/pos","../line/spans","../line/utils_line","../measurement/position_measurement","../util/bidi","../util/dom"],function(e,t,i,n,r,s){"use strict";function o(e,t,i){let r=n.cursorCoords(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),o=i.appendChild(s.elt("div"," ","CodeMirror-cursor"));if(o.style.left=r.left+"px",o.style.top=r.top+"px",o.style.height=Math.max(0,r.bottom-r.top)*e.options.cursorHeight+"px",r.other){let e=i.appendChild(s.elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));e.style.display="",e.style.left=r.other.left+"px",e.style.top=r.other.top+"px",e.style.height=.85*(r.other.bottom-r.other.top)+"px"}}function a(e,t){return e.top-t.top||e.left-t.left}function l(o,l,c){let h=o.display,u=o.doc,d=document.createDocumentFragment(),f=n.paddingH(o.display),p=f.left,m=Math.max(h.sizerWidth,n.displayWidth(o)-h.sizer.offsetLeft)-f.right,g="ltr"==u.direction;function v(e,t,i,n){t<0&&(t=0),t=Math.round(t),n=Math.round(n),d.appendChild(s.elt("div",null,"CodeMirror-selected",`position: absolute; left: ${e}px;\n                             top: ${t}px; width: ${null==i?m-e:i}px;\n                             height: ${n-t}px`))}function y(t,s,l){let c,h,d=i.getLine(u,t),f=d.text.length;function y(i,r){return n.charCoords(o,e.Pos(t,i),"div",d,r)}function k(e,t,i){let r=n.wrappedLineExtentChar(o,d,null,e),s="ltr"==t==("after"==i)?"left":"right",a="after"==i?r.begin:r.end-(/\s/.test(d.text.charAt(r.end-1))?2:1);return y(a,s)[s]}let b=r.getOrder(d,u.direction);return r.iterateBidiSections(b,s||0,null==l?f:l,(e,t,i,n)=>{let r="ltr"==i,o=y(e,r?"left":"right"),u=y(t-1,r?"right":"left"),d=null==s&&0==e,x=null==l&&t==f,w=0==n,_=!b||n==b.length-1;if(u.top-o.top<=3){let e=(g?d:x)&&w,t=(g?x:d)&&_,i=e?p:(r?o:u).left,n=t?m:(r?u:o).right;v(i,o.top,n-i,o.bottom)}else{let n,s,a,l;r?(n=g&&d&&w?p:o.left,s=g?m:k(e,i,"before"),a=g?p:k(t,i,"after"),l=g&&x&&_?m:u.right):(n=g?k(e,i,"before"):p,s=!g&&d&&w?m:o.right,a=!g&&x&&_?p:u.left,l=g?k(t,i,"after"):m),v(n,o.top,s-n,o.bottom),o.bottom<u.top&&v(p,o.bottom,null,u.top),v(a,u.top,l-a,u.bottom)}(!c||a(o,c)<0)&&(c=o),a(u,c)<0&&(c=u),(!h||a(o,h)<0)&&(h=o),a(u,h)<0&&(h=u)}),{start:c,end:h}}let k=l.from(),b=l.to();if(k.line==b.line)y(k.line,k.ch,b.ch);else{let e=i.getLine(u,k.line),n=i.getLine(u,b.line),r=t.visualLine(e)==t.visualLine(n),s=y(k.line,k.ch,r?e.text.length+1:null).end,o=y(b.line,r?0:null,b.ch).start;r&&(s.top<o.top-2?(v(s.right,s.top,null,s.bottom),v(p,o.top,o.left,o.bottom)):v(s.right,s.top,o.left-s.right,s.bottom)),s.bottom<o.top&&v(p,s.bottom,null,o.top)}c.appendChild(d)}return{updateSelection:function(e){e.display.input.showSelection(e.display.input.prepareSelection())},prepareSelection:function(e,t=!0){let i=e.doc,n={},r=n.cursors=document.createDocumentFragment(),s=n.selection=document.createDocumentFragment();for(let n=0;n<i.sel.ranges.length;n++){if(!t&&n==i.sel.primIndex)continue;let a=i.sel.ranges[n];if(a.from().line>=e.display.viewTo||a.to().line<e.display.viewFrom)continue;let c=a.empty();(c||e.options.showCursorWhenSelecting)&&o(e,a.head,r),c||l(e,a,s)}return n},drawSelectionCursor:o,restartBlink:function(e){if(!e.state.focused)return;let t=e.display;clearInterval(t.blinker);let i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(()=>t.cursorDiv.style.visibility=(i=!i)?"":"hidden",e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}}),define("skylark-codemirror-base/display/focus",["./selection","../util/browser","../util/dom","../util/event"],function(e,t,i,n){"use strict";function r(r,s){r.state.delayingBlurEvent&&(r.state.delayingBlurEvent=!1),"nocursor"!=r.options.readOnly&&(r.state.focused||(n.signal(r,"focus",r,s),r.state.focused=!0,i.addClass(r.display.wrapper,"CodeMirror-focused"),r.curOp||r.display.selForContextMenu==r.doc.sel||(r.display.input.reset(),t.webkit&&setTimeout(()=>r.display.input.reset(!0),20)),r.display.input.receivedFocus()),e.restartBlink(r))}function s(e,t){e.state.delayingBlurEvent||(e.state.focused&&(n.signal(e,"blur",e,t),e.state.focused=!1,i.rmClass(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(()=>{e.state.focused||(e.display.shift=!1)},150))}return{ensureFocus:function(e){e.state.focused||(e.display.input.focus(),r(e))},delayBlurEvent:function(e){e.state.delayingBlurEvent=!0,setTimeout(()=>{e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,s(e))},100)},onFocus:r,onBlur:s}}),define("skylark-codemirror-base/display/update_lines",["../line/spans","../line/utils_line","../measurement/position_measurement","../util/browser"],function(e,t,i,n){"use strict";function r(e){if(e.widgets)for(let t=0;t<e.widgets.length;++t){let i=e.widgets[t],n=i.node.parentNode;n&&(i.height=n.offsetHeight)}}return{updateHeightsInViewport:function(e){let s=e.display,o=s.lineDiv.offsetTop;for(let a=0;a<s.view.length;a++){let l,c=s.view[a],h=e.options.lineWrapping,u=0;if(c.hidden)continue;if(n.ie&&n.ie_version<8){let e=c.node.offsetTop+c.node.offsetHeight;l=e-o,o=e}else{let e=c.node.getBoundingClientRect();l=e.bottom-e.top,!h&&c.text.firstChild&&(u=c.text.firstChild.getBoundingClientRect().right-e.left-1)}let d=c.line.height-l;if((d>.005||d<-.005)&&(t.updateLineHeight(c.line,l),r(c.line),c.rest))for(let e=0;e<c.rest.length;e++)r(c.rest[e]);if(u>e.display.sizerWidth){let t=Math.ceil(u/i.charWidth(e.display));t>e.display.maxLineLength&&(e.display.maxLineLength=t,e.display.maxLine=c.line,e.display.maxLineChanged=!0)}}},visibleLines:function(n,r,s){let o=s&&null!=s.top?Math.max(0,s.top):n.scroller.scrollTop;o=Math.floor(o-i.paddingTop(n));let a=s&&null!=s.bottom?s.bottom:o+n.wrapper.clientHeight,l=t.lineAtHeight(r,o),c=t.lineAtHeight(r,a);if(s&&s.ensure){let i=s.ensure.from.line,o=s.ensure.to.line;i<l?(l=i,c=t.lineAtHeight(r,e.heightAtLine(t.getLine(r,i))+n.wrapper.clientHeight)):Math.min(o,r.lastLine())>=c&&(l=t.lineAtHeight(r,e.heightAtLine(t.getLine(r,o))-n.wrapper.clientHeight),c=o)}return{from:l,to:Math.max(c,l+1)}}}}),define("skylark-codemirror-base/display/view_tracking",["../line/line_data","../line/saw_special_spans","../line/spans","../measurement/position_measurement","../util/misc"],function(e,t,i,n,r){"use strict";function s(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function o(e,r,s,o){let a,l=n.findViewIndex(e,r),c=e.display.view;if(!t.sawCollapsedSpans||s==e.doc.first+e.doc.size)return{index:l,lineN:s};let h=e.display.viewFrom;for(let e=0;e<l;e++)h+=c[e].size;if(h!=r){if(o>0){if(l==c.length-1)return null;a=h+c[l].size-r,l++}else a=h-r;r+=a,s+=a}for(;i.visualLineNo(e.doc,s)!=s;){if(l==(o<0?0:c.length-1))return null;s+=o*c[l-(o<0?1:0)].size,l+=o}return{index:l,lineN:s}}return{regChange:function(n,r,a,l){null==r&&(r=n.doc.first);null==a&&(a=n.doc.first+n.doc.size);l||(l=0);let c=n.display;l&&a<c.viewTo&&(null==c.updateLineNumbers||c.updateLineNumbers>r)&&(c.updateLineNumbers=r);if(n.curOp.viewChanged=!0,r>=c.viewTo)t.sawCollapsedSpans&&i.visualLineNo(n.doc,r)<c.viewTo&&s(n);else if(a<=c.viewFrom)t.sawCollapsedSpans&&i.visualLineEndNo(n.doc,a+l)>c.viewFrom?s(n):(c.viewFrom+=l,c.viewTo+=l);else if(r<=c.viewFrom&&a>=c.viewTo)s(n);else if(r<=c.viewFrom){let e=o(n,a,a+l,1);e?(c.view=c.view.slice(e.index),c.viewFrom=e.lineN,c.viewTo+=l):s(n)}else if(a>=c.viewTo){let e=o(n,r,r,-1);e?(c.view=c.view.slice(0,e.index),c.viewTo=e.lineN):s(n)}else{let t=o(n,r,r,-1),i=o(n,a,a+l,1);t&&i?(c.view=c.view.slice(0,t.index).concat(e.buildViewArray(n,t.lineN,i.lineN)).concat(c.view.slice(i.index)),c.viewTo+=l):s(n)}let h=c.externalMeasured;h&&(a<h.lineN?h.lineN+=l:r<h.lineN+h.size&&(c.externalMeasured=null))},regLineChange:function(e,t,i){e.curOp.viewChanged=!0;let s=e.display,o=e.display.externalMeasured;o&&t>=o.lineN&&t<o.lineN+o.size&&(s.externalMeasured=null);if(t<s.viewFrom||t>=s.viewTo)return;let a=s.view[n.findViewIndex(e,t)];if(null==a.node)return;let l=a.changes||(a.changes=[]);-1==r.indexOf(l,i)&&l.push(i)},resetView:s,adjustView:function(t,i,r){let s=t.display;0==s.view.length||i>=s.viewTo||r<=s.viewFrom?(s.view=e.buildViewArray(t,i,r),s.viewFrom=i):(s.viewFrom>i?s.view=e.buildViewArray(t,i,s.viewFrom).concat(s.view):s.viewFrom<i&&(s.view=s.view.slice(n.findViewIndex(t,i))),s.viewFrom=i,s.viewTo<r?s.view=s.view.concat(e.buildViewArray(t,s.viewTo,r)):s.viewTo>r&&(s.view=s.view.slice(0,n.findViewIndex(t,r))));s.viewTo=r},countDirtyView:function(e){let t=e.display.view,i=0;for(let e=0;e<t.length;e++){let n=t[e];n.hidden||n.node&&!n.changes||++i}return i}}}),define("skylark-codemirror-base/display/update_display",["../line/saw_special_spans","../line/spans","../line/utils_line","../measurement/position_measurement","../util/browser","../util/dom","../util/event","../util/misc","./update_line","./selection","./update_lines","./view_tracking"],function(e,t,i,n,r,s,o,a,l,c,h,u){"use strict";class d{constructor(e,t,i){let r=e.display;this.viewport=t,this.visible=h.visibleLines(r,e.doc,t),this.editorIsHidden=!r.wrapper.offsetWidth,this.wrapperHeight=r.wrapper.clientHeight,this.wrapperWidth=r.wrapper.clientWidth,this.oldDisplayWidth=n.displayWidth(e),this.force=i,this.dims=n.getDimensions(e),this.events=[]}signal(e,t){o.hasHandler(e,t)&&this.events.push(arguments)}finish(){for(let e=0;e<this.events.length;e++)o.signal.apply(null,this.events[e])}}function f(o,c){let h=o.display,d=o.doc;if(c.editorIsHidden)return u.resetView(o),!1;if(!c.force&&c.visible.from>=h.viewFrom&&c.visible.to<=h.viewTo&&(null==h.updateLineNumbers||h.updateLineNumbers>=h.viewTo)&&h.renderedView==h.view&&0==u.countDirtyView(o))return!1;o.maybeUpdateLineNumberWidth()&&(u.resetView(o),c.dims=n.getDimensions(o));let f=d.first+d.size,p=Math.max(c.visible.from-o.options.viewportMargin,d.first),m=Math.min(f,c.visible.to+o.options.viewportMargin);h.viewFrom<p&&p-h.viewFrom<20&&(p=Math.max(d.first,h.viewFrom)),h.viewTo>m&&h.viewTo-m<20&&(m=Math.min(f,h.viewTo)),e.sawCollapsedSpans&&(p=t.visualLineNo(o.doc,p),m=t.visualLineEndNo(o.doc,m));let g=p!=h.viewFrom||m!=h.viewTo||h.lastWrapHeight!=c.wrapperHeight||h.lastWrapWidth!=c.wrapperWidth;u.adjustView(o,p,m),h.viewOffset=t.heightAtLine(i.getLine(o.doc,h.viewFrom)),o.display.mover.style.top=h.viewOffset+"px";let v=u.countDirtyView(o);if(!g&&0==v&&!c.force&&h.renderedView==h.view&&(null==h.updateLineNumbers||h.updateLineNumbers>=h.viewTo))return!1;let y=function(e){if(e.hasFocus())return null;let t=s.activeElt();if(!t||!s.contains(e.display.lineDiv,t))return null;let i={activeElt:t};if(window.getSelection){let t=window.getSelection();t.anchorNode&&t.extend&&s.contains(e.display.lineDiv,t.anchorNode)&&(i.anchorNode=t.anchorNode,i.anchorOffset=t.anchorOffset,i.focusNode=t.focusNode,i.focusOffset=t.focusOffset)}return i}(o);return v>4&&(h.lineDiv.style.display="none"),function(e,t,n){let o=e.display,c=e.options.lineNumbers,h=o.lineDiv,u=h.firstChild;function d(t){let i=t.nextSibling;return r.webkit&&r.mac&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}let f=o.view,p=o.viewFrom;for(let r=0;r<f.length;r++){let o=f[r];if(o.hidden);else if(o.node&&o.node.parentNode==h){for(;u!=o.node;)u=d(u);let r=c&&null!=t&&t<=p&&o.lineNumber;o.changes&&(a.indexOf(o.changes,"gutter")>-1&&(r=!1),l.updateLineForChanges(e,o,p,n)),r&&(s.removeChildren(o.lineNumber),o.lineNumber.appendChild(document.createTextNode(i.lineNumberFor(e.options,p)))),u=o.node.nextSibling}else{let t=l.buildLineElement(e,o,p,n);h.insertBefore(t,u)}p+=o.size}for(;u;)u=d(u)}(o,h.updateLineNumbers,c.dims),v>4&&(h.lineDiv.style.display=""),h.renderedView=h.view,function(e){if(!e||!e.activeElt||e.activeElt==s.activeElt())return;if(e.activeElt.focus(),e.anchorNode&&s.contains(document.body,e.anchorNode)&&s.contains(document.body,e.focusNode)){let t=window.getSelection(),i=document.createRange();i.setEnd(e.anchorNode,e.anchorOffset),i.collapse(!1),t.removeAllRanges(),t.addRange(i),t.extend(e.focusNode,e.focusOffset)}}(y),s.removeChildren(h.cursorDiv),s.removeChildren(h.selectionDiv),h.gutters.style.height=h.sizer.style.minHeight=0,g&&(h.lastWrapHeight=c.wrapperHeight,h.lastWrapWidth=c.wrapperWidth,o.startWorker(400)),h.updateLineNumbers=null,!0}function p(e,t){let i=t.viewport;for(let r=!0;(r&&e.options.lineWrapping&&t.oldDisplayWidth!=n.displayWidth(e)||(i&&null!=i.top&&(i={top:Math.min(e.doc.height+n.paddingVert(e.display)-n.displayHeight(e),i.top)}),t.visible=h.visibleLines(e.display,e.doc,i),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&f(e,t);r=!1){h.updateHeightsInViewport(e);let i=e.measureForScrollbars();c.updateSelection(e),e.updateScrollbars(i),m(e,i),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function m(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+n.scrollGap(e)+"px"}return{DisplayUpdate:d,maybeClipScrollbars:function(e){let t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=n.scrollGap(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=n.scrollGap(e)+"px",t.scrollbarsClipped=!0)},updateDisplayIfNeeded:f,postUpdateDisplay:p,updateDisplaySimple:function(e,t){let i=new d(e,t);if(f(e,i)){h.updateHeightsInViewport(e),p(e,i);let t=e.measureForScrollbars();c.updateSelection(e),e.updateScrollbars(t),m(e,t),i.finish()}},updateGutterSpace:function(e){let t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"},setDocumentHeight:m}}),define("skylark-codemirror-base/display/gutters",["../util/dom","../util/misc","./update_display"],function(e,t,i){"use strict";return{updateGutters:function(t){let n=t.display.gutters,r=t.options.gutters;e.removeChildren(n);let s=0;for(;s<r.length;++s){let i=r[s],o=n.appendChild(e.elt("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(t.display.lineGutter=o,o.style.width=(t.display.lineNumWidth||1)+"px")}n.style.display=s?"":"none",i.updateGutterSpace(t)},setGuttersForLineNumbers:function(e){let i=t.indexOf(e.gutters,"CodeMirror-linenumbers");-1==i&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):i>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(i,1))}}}),define("skylark-codemirror-base/display/line_numbers",["../line/utils_line","../measurement/position_measurement","../util/dom","./update_display"],function(e,t,i,n){"use strict";return{alignHorizontally:function(e){let i=e.display,n=i.view;if(!(i.alignWidgets||i.gutters.firstChild&&e.options.fixedGutter))return;let r=t.compensateForHScroll(i)-i.scroller.scrollLeft+e.doc.scrollLeft,s=i.gutters.offsetWidth,o=r+"px";for(let t=0;t<n.length;t++)if(!n[t].hidden){e.options.fixedGutter&&(n[t].gutter&&(n[t].gutter.style.left=o),n[t].gutterBackground&&(n[t].gutterBackground.style.left=o));let i=n[t].alignable;if(i)for(let e=0;e<i.length;e++)i[e].style.left=o}e.options.fixedGutter&&(i.gutters.style.left=r+s+"px")},maybeUpdateLineNumberWidth:function(t){if(!t.options.lineNumbers)return!1;let r=t.doc,s=e.lineNumberFor(t.options,r.first+r.size-1),o=t.display;if(s.length!=o.lineNumChars){let e=o.measure.appendChild(i.elt("div",[i.elt("div",s)],"CodeMirror-linenumber CodeMirror-gutter-elt")),r=e.firstChild.offsetWidth,a=e.offsetWidth-r;return o.lineGutter.style.width="",o.lineNumInnerWidth=Math.max(r,o.lineGutter.offsetWidth-a)+1,o.lineNumWidth=o.lineNumInnerWidth+a,o.lineNumChars=o.lineNumInnerWidth?s.length:-1,o.lineGutter.style.width=o.lineNumWidth+"px",n.updateGutterSpace(t),!0}return!1}}}),define("skylark-codemirror-base/display/scrolling",["../line/pos","../measurement/position_measurement","../util/browser","../util/dom","../util/event","./line_numbers","./update_display"],function(e,t,i,n,r,s,o){"use strict";function a(e,i){let n=e.display,r=t.textHeight(e.display);i.top<0&&(i.top=0);let s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:n.scroller.scrollTop,o=t.displayHeight(e),a={};i.bottom-i.top>o&&(i.bottom=i.top+o);let l=e.doc.height+t.paddingVert(n),c=i.top<r,h=i.bottom>l-r;if(i.top<s)a.scrollTop=c?0:i.top;else if(i.bottom>s+o){let e=Math.min(i.top,(h?l:i.bottom)-o);e!=s&&(a.scrollTop=e)}let u=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:n.scroller.scrollLeft,d=t.displayWidth(e)-(e.options.fixedGutter?n.gutters.offsetWidth:0),f=i.right-i.left>d;return f&&(i.right=i.left+d),i.left<10?a.scrollLeft=0:i.left<u?a.scrollLeft=Math.max(0,i.left-(f?0:10)):i.right>d+u-3&&(a.scrollLeft=i.right+(f?0:10)-d),a}function l(e,t,i){null==t&&null==i||c(e),null!=t&&(e.curOp.scrollLeft=t),null!=i&&(e.curOp.scrollTop=i)}function c(e){let i=e.curOp.scrollToPos;if(i){e.curOp.scrollToPos=null;let n=t.estimateCoords(e,i.from),r=t.estimateCoords(e,i.to);h(e,n,r,i.margin)}}function h(e,t,i,n){let r=a(e,{left:Math.min(t.left,i.left),top:Math.min(t.top,i.top)-n,right:Math.max(t.right,i.right),bottom:Math.max(t.bottom,i.bottom)+n});l(e,r.scrollLeft,r.scrollTop)}function u(e,t){Math.abs(e.doc.scrollTop-t)<2||(i.gecko||o.updateDisplaySimple(e,{top:t}),d(e,t,!0),i.gecko&&o.updateDisplaySimple(e),e.startWorker(e,100))}function d(e,t,i){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),(e.display.scroller.scrollTop!=t||i)&&(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function f(e,t,i,n){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!n||(e.doc.scrollLeft=t,s.alignHorizontally(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}return{maybeScrollWindow:function(e,s){if(r.signalDOMEvent(e,"scrollCursorIntoView"))return;let o=e.display,a=o.sizer.getBoundingClientRect(),l=null;s.top+a.top<0?l=!0:s.bottom+a.top>(window.innerHeight||document.documentElement.clientHeight)&&(l=!1);if(null!=l&&!i.phantom){let i=n.elt("div","​",null,`position: absolute;\n                         top: ${s.top-o.viewOffset-t.paddingTop(e.display)}px;\n                         height: ${s.bottom-s.top+t.scrollGap(e)+o.barHeight}px;\n                         left: ${s.left}px; width: ${Math.max(2,s.right-s.left)}px;`);e.display.lineSpace.appendChild(i),i.scrollIntoView(l),e.display.lineSpace.removeChild(i)}},scrollPosIntoView:function(i,n,r,s){null==s&&(s=0);let o;i.options.lineWrapping||n!=r||(n=n.ch?e.Pos(n.line,"before"==n.sticky?n.ch-1:n.ch,"after"):n,r="before"==n.sticky?e.Pos(n.line,n.ch+1,"before"):n);for(let e=0;e<5;e++){let e=!1,l=t.cursorCoords(i,n),c=r&&r!=n?t.cursorCoords(i,r):l;o={left:Math.min(l.left,c.left),top:Math.min(l.top,c.top)-s,right:Math.max(l.left,c.left),bottom:Math.max(l.bottom,c.bottom)+s};let h=a(i,o),d=i.doc.scrollTop,p=i.doc.scrollLeft;if(null!=h.scrollTop&&(u(i,h.scrollTop),Math.abs(i.doc.scrollTop-d)>1&&(e=!0)),null!=h.scrollLeft&&(f(i,h.scrollLeft),Math.abs(i.doc.scrollLeft-p)>1&&(e=!0)),!e)break}return o},scrollIntoView:function(e,t){let i=a(e,t);null!=i.scrollTop&&u(e,i.scrollTop);null!=i.scrollLeft&&f(e,i.scrollLeft)},addToScrollTop:function(e,t){if(null==t)return;c(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+t},ensureCursorVisible:function(e){c(e);let t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}},scrollToCoords:l,scrollToRange:function(e,t){c(e),e.curOp.scrollToPos=t},scrollToCoordsRange:h,updateScrollTop:u,setScrollTop:d,setScrollLeft:f}}),define("skylark-codemirror-base/display/scrollbars",["../util/dom","../util/event","../measurement/position_measurement","../util/browser","./update_lines","../util/misc","./scrolling"],function(e,t,i,n,r,s,o){"use strict";function a(e){let t=e.display,n=t.gutters.offsetWidth,r=Math.round(e.doc.height+i.paddingVert(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:r,scrollHeight:r+i.scrollGap(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function l(e,t){let i=e.display,n=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=n.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=n.bottom)+"px",i.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=n.bottom+"px",i.scrollbarFiller.style.width=n.right+"px"):i.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}let c={native:class{constructor(i,r,s){this.cm=s;let o=this.vert=e.elt("div",[e.elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),a=this.horiz=e.elt("div",[e.elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=a.tabIndex=-1,i(o),i(a),t.on(o,"scroll",()=>{o.clientHeight&&r(o.scrollTop,"vertical")}),t.on(a,"scroll",()=>{a.clientWidth&&r(a.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,n.ie&&n.ie_version<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}update(e){let t=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0";let i=e.viewHeight-(t?n:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=i?n+"px":"0",this.horiz.style.left=e.barLeft+"px";let t=e.viewWidth-e.barLeft-(i?n:0);this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?n:0,bottom:t?n:0}}setScrollLeft(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")}setScrollTop(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")}zeroWidthHack(){let e=n.mac&&!n.mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new s.Delayed,this.disableVert=new s.Delayed}enableZeroWidthBar(e,t,i){e.style.pointerEvents="auto",t.set(1e3,function n(){let r=e.getBoundingClientRect();let s="vert"==i?document.elementFromPoint(r.right-1,(r.top+r.bottom)/2):document.elementFromPoint((r.right+r.left)/2,r.bottom-1);s!=e?e.style.pointerEvents="none":t.set(1e3,n)})}clear(){let e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},null:class{update(){return{bottom:0,right:0}}setScrollLeft(){}setScrollTop(){}clear(){}}};return{measureForScrollbars:a,updateScrollbars:function(e,t){t||(t=a(e));let i=e.display.barWidth,n=e.display.barHeight;l(e,t);for(let t=0;t<4&&i!=e.display.barWidth||n!=e.display.barHeight;t++)i!=e.display.barWidth&&e.options.lineWrapping&&r.updateHeightsInViewport(e),l(e,a(e)),i=e.display.barWidth,n=e.display.barHeight},scrollbarModel:c,initScrollbars:function(i){i.display.scrollbars&&(i.display.scrollbars.clear(),i.display.scrollbars.undefined&&e.rmClass(i.display.wrapper,i.display.scrollbars.undefined));i.display.scrollbars=new c[i.options.scrollbarStyle](e=>{i.display.wrapper.insertBefore(e,i.display.scrollbarFiller),t.on(e,"mousedown",()=>{i.state.focused&&setTimeout(()=>i.display.input.focus(),0)}),e.setAttribute("cm-not-content","true")},(e,t)=>{"horizontal"==t?o.setScrollLeft(i,e):o.updateScrollTop(i,e)},i),i.display.scrollbars.undefined&&e.addClass(i.display.wrapper,i.display.scrollbars.undefined)}}}),define("skylark-codemirror-base/display/operations",["../line/pos","../line/spans","../measurement/position_measurement","../util/event","../util/dom","../util/operation_group","./focus","./scrollbars","./selection","./scrolling","./update_display","./update_lines"],function(e,t,i,n,r,s,o,a,l,c,h,u){"use strict";let d=0;function f(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++d},s.pushOperation(e.curOp)}function p(e){let t=e.curOp;t&&s.finishOperation(t,e=>{for(let t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;!function(e){let t=e.ops;for(let e=0;e<t.length;e++)m(t[e]);for(let e=0;e<t.length;e++)i=t[e],i.updatedDisplay=i.mustUpdate&&h.updateDisplayIfNeeded(i.cm,i.update);var i;for(let e=0;e<t.length;e++)g(t[e]);for(let e=0;e<t.length;e++)v(t[e]);for(let e=0;e<t.length;e++)y(t[e])}(e)})}function m(e){let i=e.cm,n=i.display;h.maybeClipScrollbars(i),e.updateMaxLine&&t.findMaxLine(i),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&i.options.lineWrapping,e.update=e.mustUpdate&&new h.DisplayUpdate(i,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function g(e){let t=e.cm,n=t.display;e.updatedDisplay&&u.updateHeightsInViewport(t),e.barMeasure=a.measureForScrollbars(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=i.measureChar(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+i.scrollGap(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-i.displayWidth(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function v(e){let t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&c.setScrollLeft(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);let i=e.focus&&e.focus==r.activeElt();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,i),(e.updatedDisplay||e.startHeight!=t.doc.height)&&a.updateScrollbars(t,e.barMeasure),e.updatedDisplay&&h.setDocumentHeight(t,e.barMeasure),e.selectionChanged&&l.restartBlink(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),i&&o.ensureFocus(e.cm)}function y(t){let i=t.cm,r=i.display,s=i.doc;if(t.updatedDisplay&&h.postUpdateDisplay(i,t.update),null==r.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null!=t.scrollTop&&c.setScrollTop(i,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&c.setScrollLeft(i,t.scrollLeft,!0,!0),t.scrollToPos){let n=c.scrollPosIntoView(i,e.clipPos(s,t.scrollToPos.from),e.clipPos(s,t.scrollToPos.to),t.scrollToPos.margin);c.maybeScrollWindow(i,n)}let o=t.maybeHiddenMarkers,a=t.maybeUnhiddenMarkers;if(o)for(let e=0;e<o.length;++e)o[e].lines.length||n.signal(o[e],"hide");if(a)for(let e=0;e<a.length;++e)a[e].lines.length&&n.signal(a[e],"unhide");r.wrapper.offsetHeight&&(s.scrollTop=i.display.scroller.scrollTop),t.changeObjs&&n.signal(i,"changes",i,t.changeObjs),t.update&&t.update.finish()}return{startOperation:f,endOperation:p,runInOp:function(e,t){if(e.curOp)return t();f(e);try{return t()}finally{p(e)}},operation:function(e,t){return function(){if(e.curOp)return t.apply(e,arguments);f(e);try{return t.apply(e,arguments)}finally{p(e)}}},methodOp:function(e){return function(){if(this.curOp)return e.apply(this,arguments);f(this);try{return e.apply(this,arguments)}finally{p(this)}}},docMethodOp:function(e){return function(){let t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);f(t);try{return e.apply(this,arguments)}finally{p(t)}}}}}),define("skylark-codemirror-base/display/scroll_events",["../util/browser","../util/event","./update_display","./scrolling"],function(e,t,i,n){"use strict";let r=0,s=null;function o(e){let t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}}return e.ie?s=-.53:e.gecko?s=15:e.chrome?s=-.7:e.safari&&(s=-1/3),{wheelEventPixels:function(e){let t=o(e);return t.x*=s,t.y*=s,t},onScrollWheel:function(a,l){let c=o(l),h=c.x,u=c.y,d=a.display,f=d.scroller,p=f.scrollWidth>f.clientWidth,m=f.scrollHeight>f.clientHeight;if(!(h&&p||u&&m))return;if(u&&e.mac&&e.webkit)e:for(let e=l.target,t=d.view;e!=f;e=e.parentNode)for(let i=0;i<t.length;i++)if(t[i].node==e){a.display.currentWheelTarget=e;break e}if(h&&!e.gecko&&!e.presto&&null!=s)return u&&m&&n.updateScrollTop(a,Math.max(0,f.scrollTop+u*s)),n.setScrollLeft(a,Math.max(0,f.scrollLeft+h*s)),(!u||u&&m)&&t.e_preventDefault(l),void(d.wheelStartX=null);if(u&&null!=s){let e=u*s,t=a.doc.scrollTop,n=t+d.wrapper.clientHeight;e<0?t=Math.max(0,t+e-50):n=Math.min(a.doc.height,n+e+50),i.updateDisplaySimple(a,{top:t,bottom:n})}r<20&&(null==d.wheelStartX?(d.wheelStartX=f.scrollLeft,d.wheelStartY=f.scrollTop,d.wheelDX=h,d.wheelDY=u,setTimeout(()=>{if(null==d.wheelStartX)return;let e=f.scrollLeft-d.wheelStartX,t=f.scrollTop-d.wheelStartY,i=t&&d.wheelDY&&t/d.wheelDY||e&&d.wheelDX&&e/d.wheelDX;d.wheelStartX=d.wheelStartY=null,i&&(s=(s*r+i)/(r+1),++r)},200)):(d.wheelDX+=h,d.wheelDY+=u))}}}),define("skylark-codemirror-base/display/highlight_worker",["../line/highlight","../modes","../util/misc","./operations","./view_tracking"],function(e,t,i,n,r){"use strict";function s(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,i.bind(o,e))}function o(i){let o=i.doc;if(o.highlightFrontier>=i.display.viewTo)return;let a=+new Date+i.options.workTime,l=e.getContextBefore(i,o.highlightFrontier),c=[];o.iter(l.line,Math.min(o.first+o.size,i.display.viewTo+500),n=>{if(l.line>=i.display.viewFrom){let r=n.styles,s=n.text.length>i.options.maxHighlightLength?t.copyState(o.mode,l.state):null,a=e.highlightLine(i,n,l,!0);s&&(l.state=s),n.styles=a.styles;let h=n.styleClasses,u=a.classes;u?n.styleClasses=u:h&&(n.styleClasses=null);let d=!r||r.length!=n.styles.length||h!=u&&(!h||!u||h.bgClass!=u.bgClass||h.textClass!=u.textClass);for(let e=0;!d&&e<r.length;++e)d=r[e]!=n.styles[e];d&&c.push(l.line),n.stateAfter=l.save(),l.nextLine()}else n.text.length<=i.options.maxHighlightLength&&e.processLine(i,n.text,l),n.stateAfter=l.line%5==0?l.save():null,l.nextLine();if(+new Date>a)return s(i,i.options.workDelay),!0}),o.highlightFrontier=l.line,o.modeFrontier=Math.max(o.modeFrontier,l.line),c.length&&n.runInOp(i,()=>{for(let e=0;e<c.length;e++)r.regLineChange(i,c[e],"text")})}return{startWorker:s}}),define("skylark-codemirror-base/model/selection",["../line/pos","../util/misc"],function(e,t){"use strict";class i{constructor(e,t){this.ranges=e,this.primIndex=t}primary(){return this.ranges[this.primIndex]}equals(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(let i=0;i<this.ranges.length;i++){let n=this.ranges[i],r=t.ranges[i];if(!e.equalCursorPos(n.anchor,r.anchor)||!e.equalCursorPos(n.head,r.head))return!1}return!0}deepCopy(){let t=[];for(let i=0;i<this.ranges.length;i++)t[i]=new n(e.copyPos(this.ranges[i].anchor),e.copyPos(this.ranges[i].head));return new i(t,this.primIndex)}somethingSelected(){for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1}contains(t,i){i||(i=t);for(let n=0;n<this.ranges.length;n++){let r=this.ranges[n];if(e.cmp(i,r.from())>=0&&e.cmp(t,r.to())<=0)return n}return-1}}class n{constructor(e,t){this.anchor=e,this.head=t}from(){return e.minPos(this.anchor,this.head)}to(){return e.maxPos(this.anchor,this.head)}empty(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}}return{Selection:i,Range:n,normalizeSelection:function(r,s,o){let a=r&&r.options.selectionsMayTouch,l=s[o];s.sort((t,i)=>e.cmp(t.from(),i.from())),o=t.indexOf(s,l);for(let t=1;t<s.length;t++){let i=s[t],r=s[t-1],l=e.cmp(r.to(),i.from());if(a&&!i.empty()?l>0:l>=0){let a=e.minPos(r.from(),i.from()),l=e.maxPos(r.to(),i.to()),c=r.empty()?i.from()==i.head:r.from()==r.head;t<=o&&--o,s.splice(--t,2,new n(c?l:a,c?a:l))}}return new i(s,o)},simpleSelection:function(e,t){return new i([new n(e,t||e)],0)}}}),define("skylark-codemirror-base/model/change_measurement",["../line/pos","../util/misc","./selection"],function(e,t,i){"use strict";function n(i){return i.text?e.Pos(i.from.line+i.text.length-1,t.lst(i.text).length+(1==i.text.length?i.from.ch:0)):i.to}function r(t,i){if(e.cmp(t,i.from)<0)return t;if(e.cmp(t,i.to)<=0)return n(i);let r=t.line+i.text.length-(i.to.line-i.from.line)-1,s=t.ch;return t.line==i.to.line&&(s+=n(i).ch-i.to.ch),e.Pos(r,s)}function s(t,i,n){return t.line==i.line?e.Pos(n.line,t.ch-i.ch+n.ch):e.Pos(n.line+(t.line-i.line),t.ch)}return{changeEnd:n,computeSelAfterChange:function(e,t){let n=[];for(let s=0;s<e.sel.ranges.length;s++){let o=e.sel.ranges[s];n.push(new i.Range(r(o.anchor,t),r(o.head,t)))}return i.normalizeSelection(e.cm,n,e.sel.primIndex)},computeReplacedSel:function(t,r,o){let a=[],l=e.Pos(t.first,0),c=l;for(let h=0;h<r.length;h++){let u=r[h],d=s(u.from,l,c),f=s(n(u),l,c);if(l=u.to,c=f,"around"==o){let n=t.sel.ranges[h],r=e.cmp(n.head,n.anchor)<0;a[h]=new i.Range(r?f:d,r?d:f)}else a[h]=new i.Range(d,d)}return new i.Selection(a,t.sel.primIndex)}}}),define("skylark-codemirror-base/display/mode_state",["../modes","./view_tracking"],function(e,t){"use strict";function i(e){e.doc.iter(e=>{e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,e.startWorker(e,100),e.state.modeGen++,e.curOp&&t.regChange(e)}return{loadMode:function(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),i(t)},resetModeState:i}}),define("skylark-codemirror-base/model/document_data",["../display/mode_state","../display/operations","../display/view_tracking","../line/line_data","../line/spans","../line/utils_line","../measurement/position_measurement","../util/dom","../util/misc","../util/operation_group"],function(e,t,i,n,r,s,o,a,l,c){"use strict";function h(e,t){return 0==t.from.ch&&0==t.to.ch&&""==l.lst(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function u(e){("rtl"==e.doc.direction?a.addClass:a.rmClass)(e.display.lineDiv,"CodeMirror-rtl")}return{isWholeLineUpdate:h,updateDoc:function(e,t,i,r){function o(e){return i?i[e]:null}function a(e,i,s){n.updateLine(e,i,s,r),c.signalLater(e,"change",e,t)}function u(e,t){let i=[];for(let s=e;s<t;++s)i.push(new n.Line(p[s],o(s),r));return i}let d=t.from,f=t.to,p=t.text,m=s.getLine(e,d.line),g=s.getLine(e,f.line),v=l.lst(p),y=o(p.length-1),k=f.line-d.line;if(t.full)e.insert(0,u(0,p.length)),e.remove(p.length,e.size-p.length);else if(h(e,t)){let t=u(0,p.length-1);a(g,g.text,y),k&&e.remove(d.line,k),t.length&&e.insert(d.line,t)}else if(m==g)if(1==p.length)a(m,m.text.slice(0,d.ch)+v+m.text.slice(f.ch),y);else{let t=u(1,p.length-1);t.push(new n.Line(v+m.text.slice(f.ch),y,r)),a(m,m.text.slice(0,d.ch)+p[0],o(0)),e.insert(d.line+1,t)}else if(1==p.length)a(m,m.text.slice(0,d.ch)+p[0]+g.text.slice(f.ch),o(0)),e.remove(d.line+1,k);else{a(m,m.text.slice(0,d.ch)+p[0],o(0)),a(g,v+g.text.slice(f.ch),y);let t=u(1,p.length-1);k>1&&e.remove(d.line+1,k-1),e.insert(d.line+1,t)}c.signalLater(e,"change",e,t)},linkedDocs:function(e,t,i){!function e(n,r,s){if(n.linked)for(let o=0;o<n.linked.length;++o){let a=n.linked[o];if(a.doc==r)continue;let l=s&&a.sharedHist;i&&!l||(t(a.doc,l),e(a.doc,n,l))}}(e,null,!0)},attachDoc:function(t,n){if(n.cm)throw new Error("This document is already in use.");t.doc=n,n.cm=t,o.estimateLineHeights(t),e.loadMode(t),u(t),t.options.lineWrapping||r.findMaxLine(t);t.options.mode=n.modeOption,i.regChange(t)},directionChanged:function(e){t.runInOp(e,()=>{u(e),i.regChange(e)})}}}),define("skylark-codemirror-base/model/history",["../line/pos","../line/spans","../line/utils_line","../util/event","../util/misc","./change_measurement","./document_data","./selection"],function(e,t,i,n,r,s,o,a){"use strict";function l(t,n){let r={from:e.copyPos(n.from),to:s.changeEnd(n),text:i.getBetween(t,n.from,n.to)};return u(t,r,n.from.line,n.to.line+1),o.linkedDocs(t,e=>u(e,r,n.from.line,n.to.line+1),!0),r}function c(e){for(;e.length;){let t=r.lst(e);if(!t.ranges)break;e.pop()}}function h(e,t){let i=r.lst(t);i&&i.ranges&&i.equals(e)||t.push(e)}function u(e,t,i,n){let r=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,n),i=>{i.markedSpans&&((r||(r=t["spans_"+e.id]={}))[s]=i.markedSpans),++s})}function d(e){if(!e)return null;let t;for(let i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}return{History:function(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1},historyChangeFromChange:l,addChangeToHistory:function(t,i,o,a){let u=t.history;u.undone.length=0;let d,f,p=+new Date;if((u.lastOp==a||u.lastOrigin==i.origin&&i.origin&&("+"==i.origin.charAt(0)&&u.lastModTime>p-(t.cm?t.cm.options.historyEventDelay:500)||"*"==i.origin.charAt(0)))&&(d=function(e,t){if(t)return c(e.done),r.lst(e.done);if(e.done.length&&!r.lst(e.done).ranges)return r.lst(e.done);if(e.done.length>1&&!e.done[e.done.length-2].ranges)return e.done.pop(),r.lst(e.done)}(u,u.lastOp==a)))f=r.lst(d.changes),0==e.cmp(i.from,i.to)&&0==e.cmp(i.from,f.to)?f.to=s.changeEnd(i):d.changes.push(l(t,i));else{let e=r.lst(u.done);for(e&&e.ranges||h(t.sel,u.done),d={changes:[l(t,i)],generation:u.generation},u.done.push(d);u.done.length>u.undoDepth;)u.done.shift(),u.done[0].ranges||u.done.shift()}u.done.push(o),u.generation=++u.maxGeneration,u.lastModTime=u.lastSelTime=p,u.lastOp=u.lastSelOp=a,u.lastOrigin=u.lastSelOrigin=i.origin,f||n.signal(t,"historyAdded")},addSelectionToHistory:function(e,t,i,n){let s=e.history,o=n&&n.origin;i==s.lastSelOp||o&&s.lastSelOrigin==o&&(s.lastModTime==s.lastSelTime&&s.lastOrigin==o||function(e,t,i,n){let r=t.charAt(0);return"*"==r||"+"==r&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,o,r.lst(s.done),t))?s.done[s.done.length-1]=t:h(t,s.done);s.lastSelTime=+new Date,s.lastSelOrigin=o,s.lastSelOp=i,n&&!1!==n.clearRedo&&c(s.undone)},pushSelectionToHistory:h,mergeOldSpans:function(e,i){let n=function(e,t){let i=t["spans_"+e.id];if(!i)return null;let n=[];for(let e=0;e<t.text.length;++e)n.push(d(i[e]));return n}(e,i),r=t.stretchSpansOverChange(e,i);if(!n)return r;if(!r)return n;for(let e=0;e<n.length;++e){let t=n[e],i=r[e];if(t&&i)e:for(let e=0;e<i.length;++e){let n=i[e];for(let e=0;e<t.length;++e)if(t[e].marker==n.marker)continue e;t.push(n)}else i&&(n[e]=i)}return n},copyHistoryArray:function(e,t,i){let n=[];for(let o=0;o<e.length;++o){let l=e[o];if(l.ranges){n.push(i?a.Selection.prototype.deepCopy.call(l):l);continue}let c=l.changes,h=[];n.push({changes:h});for(let e=0;e<c.length;++e){let i,n=c[e];if(h.push({from:n.from,to:n.to,text:n.text}),t)for(var s in n)(i=s.match(/^spans_(\d+)$/))&&r.indexOf(t,Number(i[1]))>-1&&(r.lst(h)[s]=n[s],delete n[s])}}return n}}}),define("skylark-codemirror-base/model/selection_updates",["../util/operation_group","../display/scrolling","../line/pos","../line/utils_line","../util/event","../util/misc","./history","./selection"],function(e,t,i,n,r,s,o,a){"use strict";function l(e,t,n,r){if(r){let r=e.anchor;if(n){let e=i.cmp(t,r)<0;e!=i.cmp(n,r)<0?(r=t,t=n):e!=i.cmp(t,n)<0&&(t=n)}return new a.Range(r,t)}return new a.Range(n||t,t)}function c(e,t,i){h(e,t,i),o.addSelectionToHistory(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function h(e,n,s){(r.hasHandler(e,"beforeSelectionChange")||e.cm&&r.hasHandler(e.cm,"beforeSelectionChange"))&&(n=function(e,t,n){let s={ranges:t.ranges,update:function(t){this.ranges=[];for(let n=0;n<t.length;n++)this.ranges[n]=new a.Range(i.clipPos(e,t[n].anchor),i.clipPos(e,t[n].head))},origin:n&&n.origin};r.signal(e,"beforeSelectionChange",e,s),e.cm&&r.signal(e.cm,"beforeSelectionChange",e.cm,s);return s.ranges!=t.ranges?a.normalizeSelection(e.cm,s.ranges,s.ranges.length-1):t}(e,n,s));let o=s&&s.bias||(i.cmp(n.primary().head,e.sel.primary().head)<0?-1:1);u(e,d(e,n,o,!0)),s&&!1===s.scroll||!e.cm||t.ensureCursorVisible(e.cm)}function u(t,i){i.equals(t.sel)||(t.sel=i,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,r.signalCursorActivity(t.cm)),e.signalLater(t,"cursorActivity",t))}function d(e,t,i,n){let r;for(let s=0;s<t.ranges.length;s++){let o=t.ranges[s],l=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[s],c=p(e,o.anchor,l&&l.anchor,i,n),h=p(e,o.head,l&&l.head,i,n);(r||c!=o.anchor||h!=o.head)&&(r||(r=t.ranges.slice(0,s)),r[s]=new a.Range(c,h))}return r?a.normalizeSelection(e.cm,r,t.primIndex):t}function f(e,t,s,o,a){let l=n.getLine(e,t.line);if(l.markedSpans)for(let n=0;n<l.markedSpans.length;++n){let c=l.markedSpans[n],h=c.marker;if((null==c.from||(h.inclusiveLeft?c.from<=t.ch:c.from<t.ch))&&(null==c.to||(h.inclusiveRight?c.to>=t.ch:c.to>t.ch))){if(a&&(r.signal(h,"beforeCursorEnter"),h.explicitlyCleared)){if(l.markedSpans){--n;continue}break}if(!h.atomic)continue;if(s){let n,r=h.find(o<0?1:-1);if((o<0?h.inclusiveRight:h.inclusiveLeft)&&(r=m(e,r,-o,r&&r.line==t.line?l:null)),r&&r.line==t.line&&(n=i.cmp(r,s))&&(o<0?n<0:n>0))return f(e,r,t,o,a)}let c=h.find(o<0?-1:1);return(o<0?h.inclusiveLeft:h.inclusiveRight)&&(c=m(e,c,o,c.line==t.line?l:null)),c?f(e,c,t,o,a):null}}return t}function p(e,t,n,r,s){let o=r||1,a=f(e,t,n,o,s)||!s&&f(e,t,n,o,!0)||f(e,t,n,-o,s)||!s&&f(e,t,n,-o,!0);return a||(e.cantEdit=!0,i.Pos(e.first,0))}function m(e,t,r,s){return r<0&&0==t.ch?t.line>e.first?i.clipPos(e,i.Pos(t.line-1)):null:r>0&&t.ch==(s||n.getLine(e,t.line)).text.length?t.line<e.first+e.size-1?i.Pos(t.line+1,0):null:new i.Pos(t.line,t.ch+r)}return{extendRange:l,extendSelection:function(e,t,i,n,r){null==r&&(r=e.cm&&(e.cm.display.shift||e.extend));c(e,new a.Selection([l(e.sel.primary(),t,i,r)],0),n)},extendSelections:function(e,t,i){let n=[],r=e.cm&&(e.cm.display.shift||e.extend);for(let i=0;i<e.sel.ranges.length;i++)n[i]=l(e.sel.ranges[i],t[i],null,r);let s=a.normalizeSelection(e.cm,n,e.sel.primIndex);c(e,s,i)},replaceOneSelection:function(e,t,i,n){let r=e.sel.ranges.slice(0);r[t]=i,c(e,a.normalizeSelection(e.cm,r,e.sel.primIndex),n)},setSimpleSelection:function(e,t,i,n){c(e,a.simpleSelection(t,i),n)},setSelectionReplaceHistory:function(e,t,i){let n=e.history.done,r=s.lst(n);r&&r.ranges?(n[n.length-1]=t,h(e,t,i)):c(e,t,i)},setSelection:c,setSelectionNoUndo:h,reCheckSelection:function(e){u(e,d(e,e.sel,null,!1))},skipAtomic:p,selectAll:function(e){e.setSelection(i.Pos(e.firstLine(),0),i.Pos(e.lastLine()),s.sel_dontScroll)}}}),define("skylark-codemirror-base/model/changes",["../line/highlight","../display/highlight_worker","../display/operations","../display/view_tracking","../line/pos","../line/saw_special_spans","../line/spans","../line/utils_line","../measurement/position_measurement","../util/event","../util/misc","../util/operation_group","./change_measurement","./document_data","./history","./selection","./selection_updates"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g){"use strict";function v(e,t,i){let n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:()=>n.canceled=!0};return i&&(n.update=((t,i,s,o)=>{t&&(n.from=r.clipPos(e,t)),i&&(n.to=r.clipPos(e,i)),s&&(n.text=s),void 0!==o&&(n.origin=o)})),c.signal(e,"beforeChange",e,n),e.cm&&c.signal(e.cm,"beforeChange",e.cm,n),n.canceled?(e.cm&&(e.cm.curOp.updateInput=2),null):{from:n.from,to:n.to,text:n.text,origin:n.origin}}function y(e,t,n){if(e.cm){if(!e.cm.curOp)return i.operation(e.cm,y)(e,t,n);if(e.cm.state.suppressEdits)return}if((c.hasHandler(e,"beforeChange")||e.cm&&c.hasHandler(e.cm,"beforeChange"))&&!(t=v(e,t,!0)))return;let r=s.sawReadOnlySpans&&!n&&o.removeReadOnlyRanges(e,t.from,t.to);if(r)for(let i=r.length-1;i>=0;--i)k(e,{from:r[i].from,to:r[i].to,text:i?[""]:t.text,origin:t.origin});else k(e,t)}function k(e,t){if(1==t.text.length&&""==t.text[0]&&0==r.cmp(t.from,t.to))return;let i=d.computeSelAfterChange(e,t);p.addChangeToHistory(e,t,i,e.cm?e.cm.curOp.id:NaN),x(e,t,i,o.stretchSpansOverChange(e,t));let n=[];f.linkedDocs(e,(e,i)=>{i||-1!=h.indexOf(n,e.history)||(C(e.history,t),n.push(e.history)),x(e,t,null,o.stretchSpansOverChange(e,t))})}function b(e,t){if(0!=t&&(e.first+=t,e.sel=new m.Selection(h.map(e.sel.ranges,e=>new m.Range(r.Pos(e.anchor.line+t,e.anchor.ch),r.Pos(e.head.line+t,e.head.ch))),e.sel.primIndex),e.cm)){n.regChange(e.cm,e.first,e.first-t,t);for(let t=e.cm.display,i=t.viewFrom;i<t.viewTo;i++)t.regLineChange(e.cm,i,"gutter")}}function x(s,p,m,v){if(s.cm&&!s.cm.curOp)return i.operation(s.cm,x)(s,p,m,v);if(p.to.line<s.first)return void b(s,p.text.length-1-(p.to.line-p.from.line));if(p.from.line>s.lastLine())return;if(p.from.line<s.first){let e=p.text.length-1-(s.first-p.from.line);b(s,e),p={from:r.Pos(s.first,0),to:r.Pos(p.to.line+e,p.to.ch),text:[h.lst(p.text)],origin:p.origin}}let y=s.lastLine();p.to.line>y&&(p={from:p.from,to:r.Pos(y,a.getLine(s,y).text.length),text:[p.text[0]],origin:p.origin}),p.removed=a.getBetween(s,p.from,p.to),m||(m=d.computeSelAfterChange(s,p)),s.cm?function(i,r,s){let h=i.doc,d=i.display,p=r.from,m=r.to,g=!1,v=p.line;i.options.lineWrapping||(v=a.lineNo(o.visualLine(a.getLine(h,p.line))),h.iter(v,m.line+1,e=>{if(e==d.maxLine)return g=!0,!0}));h.sel.contains(r.from,r.to)>-1&&c.signalCursorActivity(i);f.updateDoc(h,r,s,l.estimateHeight(i)),i.options.lineWrapping||(h.iter(v,p.line+r.text.length,e=>{let t=o.lineLength(e);t>d.maxLineLength&&(d.maxLine=e,d.maxLineLength=t,d.maxLineChanged=!0,g=!1)}),g&&(i.curOp.updateMaxLine=!0));e.retreatFrontier(h,p.line),t.startWorker(i,400);let y=r.text.length-(m.line-p.line)-1;r.full?n.regChange(i):p.line!=m.line||1!=r.text.length||f.isWholeLineUpdate(i.doc,r)?n.regChange(i,p.line,m.line+1,y):n.regLineChange(i,p.line,"text");let k=c.hasHandler(i,"changes"),b=c.hasHandler(i,"change");if(b||k){let e={from:p,to:m,text:r.text,removed:r.removed,origin:r.origin};b&&u.signalLater(i,"change",i,e),k&&(i.curOp.changeObjs||(i.curOp.changeObjs=[])).push(e)}i.display.selForContextMenu=null}(s.cm,p,v):f.updateDoc(s,p,v),g.setSelectionNoUndo(s,m,h.sel_dontScroll)}function w(e,t,i,n){i<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function _(e,t,i,n){for(let s=0;s<e.length;++s){let o=e[s],a=!0;if(o.ranges){o.copied||((o=e[s]=o.deepCopy()).copied=!0);for(let e=0;e<o.ranges.length;e++)w(o.ranges[e].anchor,t,i,n),w(o.ranges[e].head,t,i,n)}else{for(let e=0;e<o.changes.length;++e){let s=o.changes[e];if(i<s.from.line)s.from=r.Pos(s.from.line+n,s.from.ch),s.to=r.Pos(s.to.line+n,s.to.ch);else if(t<=s.to.line){a=!1;break}}a||(e.splice(0,s+1),s=0)}}}function C(e,t){let i=t.from.line,n=t.to.line,r=t.text.length-(n-i)-1;_(e.done,i,n,r),_(e.undone,i,n,r)}return{makeChange:y,makeChangeFromHistory:function(e,t,i){let n=e.cm&&e.cm.state.suppressEdits;if(n&&!i)return;let r,s=e.history,o=e.sel,a="undo"==t?s.done:s.undone,l="undo"==t?s.undone:s.done,u=0;for(;u<a.length&&(r=a[u],i?!r.ranges||r.equals(e.sel):r.ranges);u++);if(u==a.length)return;for(s.lastOrigin=s.lastSelOrigin=null;;){if(!(r=a.pop()).ranges){if(n)return void a.push(r);break}if(p.pushSelectionToHistory(r,l),i&&!r.equals(e.sel))return void g.setSelection(e,r,{clearRedo:!1});o=r}let m=[];p.pushSelectionToHistory(o,l),l.push({changes:m,generation:s.generation}),s.generation=r.generation||++s.maxGeneration;let y=c.hasHandler(e,"beforeChange")||e.cm&&c.hasHandler(e.cm,"beforeChange");for(let i=r.changes.length-1;i>=0;--i){let n=r.changes[i];if(n.origin=t,y&&!v(e,n,!1))return void(a.length=0);m.push(p.historyChangeFromChange(e,n));let s=i?d.computeSelAfterChange(e,n):h.lst(a);x(e,n,s,p.mergeOldSpans(e,n)),!i&&e.cm&&e.cm.scrollIntoView({from:n.from,to:d.changeEnd(n)});let o=[];f.linkedDocs(e,(e,t)=>{t||-1!=h.indexOf(o,e.history)||(C(e.history,n),o.push(e.history)),x(e,n,null,p.mergeOldSpans(e,n))})}},replaceRange:function(e,t,i,n,s){n||(n=i);r.cmp(n,i)<0&&([i,n]=[n,i]);"string"==typeof t&&(t=e.splitLines(t));y(e,{from:i,to:n,text:t,origin:s})},changeLine:function(e,t,i,s){let o=t,l=t;"number"==typeof t?l=a.getLine(e,r.clipLine(e,t)):o=a.lineNo(t);if(null==o)return null;s(l,o)&&e.cm&&n.regLineChange(e.cm,o,i);return l}}}),define("skylark-codemirror-base/model/chunk",["../line/line_data","../util/misc","../util/operation_group"],function(e,t,i){"use strict";function n(e){this.lines=e,this.parent=null;let t=0;for(let i=0;i<e.length;++i)e[i].parent=this,t+=e[i].height;this.height=t}function r(e){this.children=e;let t=0,i=0;for(let n=0;n<e.length;++n){let r=e[n];t+=r.chunkSize(),i+=r.height,r.parent=this}this.size=t,this.height=i,this.parent=null}return n.prototype={chunkSize(){return this.lines.length},removeInner(t,n){for(let r=t,s=t+n;r<s;++r){let t=this.lines[r];this.height-=t.height,e.cleanUpLine(t),i.signalLater(t,"delete")}this.lines.splice(t,n)},collapse(e){e.push.apply(e,this.lines)},insertInner(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(let e=0;e<t.length;++e)t[e].parent=this},iterN(e,t,i){for(let n=e+t;e<n;++e)if(i(this.lines[e]))return!0}},r.prototype={chunkSize(){return this.size},removeInner(e,t){this.size-=t;for(let i=0;i<this.children.length;++i){let n=this.children[i],r=n.chunkSize();if(e<r){let s=Math.min(t,r-e),o=n.height;if(n.removeInner(e,s),this.height-=o-n.height,r==s&&(this.children.splice(i--,1),n.parent=null),0==(t-=s))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof n))){let e=[];this.collapse(e),this.children=[new n(e)],this.children[0].parent=this}},collapse(e){for(let t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner(e,t,i){this.size+=t.length,this.height+=i;for(let r=0;r<this.children.length;++r){let s=this.children[r],o=s.chunkSize();if(e<=o){if(s.insertInner(e,t,i),s.lines&&s.lines.length>50){let e=s.lines.length%25+25;for(let t=e;t<s.lines.length;){let e=new n(s.lines.slice(t,t+=25));s.height-=e.height,this.children.splice(++r,0,e),e.parent=this}s.lines=s.lines.slice(0,e),this.maybeSpill()}break}e-=o}},maybeSpill(){if(this.children.length<=10)return;let e=this;do{let i=e.children.splice(e.children.length-5,5),n=new r(i);if(e.parent){e.size-=n.size,e.height-=n.height;let i=t.indexOf(e.parent.children,e);e.parent.children.splice(i+1,0,n)}else{let t=new r(e.children);t.parent=e,e.children=[t,n],e=t}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()},iterN(e,t,i){for(let n=0;n<this.children.length;++n){let r=this.children[n],s=r.chunkSize();if(e<s){let n=Math.min(t,s-e);if(r.iterN(e,n,i))return!0;if(0==(t-=n))break;e=0}else e-=s}}},{LeafChunk:n,BranchChunk:r}}),define("skylark-codemirror-base/model/line_widget",["../display/operations","../display/scrolling","../display/view_tracking","../line/spans","../line/utils_line","../measurement/widgets","./changes","../util/event","../util/operation_group"],function(e,t,i,n,r,s,o,a,l){"use strict";class c{constructor(e,t,i){if(i)for(let e in i)i.hasOwnProperty(e)&&(this[e]=i[e]);this.doc=e,this.node=t}clear(){let t=this.doc.cm,n=this.line.widgets,o=this.line,a=r.lineNo(o);if(null==a||!n)return;for(let e=0;e<n.length;++e)n[e]==this&&n.splice(e--,1);n.length||(o.widgets=null);let c=s.widgetHeight(this);r.updateLineHeight(o,Math.max(0,o.height-c)),t&&(e.runInOp(t,()=>{h(t,o,-c),i.regLineChange(t,a,"widget")}),l.signalLater(t,"lineWidgetCleared",t,this,a))}changed(){let t=this.height,i=this.doc.cm,o=this.line;this.height=null;let a=s.widgetHeight(this)-t;a&&(n.lineIsHidden(this.doc,o)||r.updateLineHeight(o,o.height+a),i&&e.runInOp(i,()=>{i.curOp.forceUpdate=!0,h(i,o,a),l.signalLater(i,"lineWidgetChanged",i,this,r.lineNo(o))}))}}function h(e,i,r){n.heightAtLine(i)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&t.addToScrollTop(e,r)}return a.eventMixin(c),{LineWidget:c,addLineWidget:function(e,i,a,h){let u=new c(e,a,h),d=e.cm;d&&u.noHScroll&&(d.display.alignWidgets=!0);o.changeLine(e,i,"widget",i=>{let o=i.widgets||(i.widgets=[]);if(null==u.insertAt?o.push(u):o.splice(Math.min(o.length-1,Math.max(0,u.insertAt)),0,u),u.line=i,d&&!n.lineIsHidden(e,i)){let o=n.heightAtLine(i)<e.scrollTop;r.updateLineHeight(i,i.height+s.widgetHeight(u)),o&&t.addToScrollTop(d,u.height),d.curOp.forceUpdate=!0}return!0}),d&&l.signalLater(d,"lineWidgetAdded",d,u,"number"==typeof i?i:r.lineNo(i));return u}}}),define("skylark-codemirror-base/model/mark_text",["../util/dom","../util/event","../display/operations","../line/pos","../line/utils_line","../measurement/position_measurement","../line/saw_special_spans","../line/spans","../util/misc","../util/operation_group","../measurement/widgets","../display/view_tracking","./document_data","./history","./selection_updates"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p){"use strict";let m=0;class g{constructor(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++m}clear(){if(this.explicitlyCleared)return;let e=this.doc.cm,n=e&&!e.curOp;if(n&&i.startOperation(e),t.hasHandler(this,"clear")){let e=this.find();e&&c.signalLater(this,"clear",e.from,e.to)}let o=null,l=null;for(let t=0;t<this.lines.length;++t){let i=this.lines[t],n=a.getMarkedSpanFor(i.markedSpans,this);e&&!this.collapsed?u.regLineChange(e,r.lineNo(i),"text"):e&&(null!=n.to&&(l=r.lineNo(i)),null!=n.from&&(o=r.lineNo(i))),i.markedSpans=a.removeMarkedSpan(i.markedSpans,n),null==n.from&&this.collapsed&&!a.lineIsHidden(this.doc,i)&&e&&r.updateLineHeight(i,s.textHeight(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(let t=0;t<this.lines.length;++t){let i=a.visualLine(this.lines[t]),n=a.lineLength(i);n>e.display.maxLineLength&&(e.display.maxLine=i,e.display.maxLineLength=n,e.display.maxLineChanged=!0)}null!=o&&e&&this.collapsed&&u.regChange(e,o,l+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&p.reCheckSelection(e.doc)),e&&c.signalLater(e,"markerCleared",e,this,o,l),n&&i.endOperation(e),this.parent&&this.parent.clear()}find(e,t){let i,s;null==e&&"bookmark"==this.type&&(e=1);for(let o=0;o<this.lines.length;++o){let l=this.lines[o],c=a.getMarkedSpanFor(l.markedSpans,this);if(null!=c.from&&(i=n.Pos(t?l:r.lineNo(l),c.from),-1==e))return i;if(null!=c.to&&(s=n.Pos(t?l:r.lineNo(l),c.to),1==e))return s}return i&&{from:i,to:s}}changed(){let e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&i.runInOp(n,()=>{let i=e.line,o=r.lineNo(e.line),l=s.findViewForLine(n,o);if(l&&(s.clearLineMeasurementCacheFor(l),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!a.lineIsHidden(t.doc,i)&&null!=t.height){let e=t.height;t.height=null;let n=h.widgetHeight(t)-e;n&&r.updateLineHeight(i,i.height+n)}c.signalLater(n,"markerChanged",n,this)})}attachLine(e){if(!this.lines.length&&this.doc.cm){let e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=l.indexOf(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)}detachLine(e){if(this.lines.splice(l.indexOf(this.lines,e),1),!this.lines.length&&this.doc.cm){let e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}}}function v(s,h,k,b,x){if(b&&b.shared)return function(e,t,i,r,s){(r=l.copyObj(r)).shared=!1;let o=[v(e,t,i,r,s)],a=o[0],c=r.widgetNode;return d.linkedDocs(e,e=>{c&&(r.widgetNode=c.cloneNode(!0)),o.push(v(e,n.clipPos(e,t),n.clipPos(e,i),r,s));for(let t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;a=l.lst(o)}),new y(o,a)}(s,h,k,b,x);if(s.cm&&!s.cm.curOp)return i.operation(s.cm,v)(s,h,k,b,x);let w=new g(s,x),_=n.cmp(h,k);if(b&&l.copyObj(b,w,!1),_>0||0==_&&!1!==w.clearWhenEmpty)return w;if(w.replacedWith&&(w.collapsed=!0,w.widgetNode=e.eltP("span",[w.replacedWith],"CodeMirror-widget"),b.handleMouseEvents||w.widgetNode.setAttribute("cm-ignore-events","true"),b.insertLeft&&(w.widgetNode.insertLeft=!0)),w.collapsed){if(a.conflictingCollapsedRange(s,h.line,h,k,w)||h.line!=k.line&&a.conflictingCollapsedRange(s,k.line,h,k,w))throw new Error("Inserting collapsed marker partially overlapping an existing one");o.seeCollapsedSpans()}w.addToHistory&&f.addChangeToHistory(s,{from:h,to:k,origin:"markText"},s.sel,NaN);let C,S=h.line,A=s.cm;if(s.iter(S,k.line+1,e=>{A&&w.collapsed&&!A.options.lineWrapping&&a.visualLine(e)==A.display.maxLine&&(C=!0),w.collapsed&&S!=h.line&&r.updateLineHeight(e,0),a.addMarkedSpan(e,new a.MarkedSpan(w,S==h.line?h.ch:null,S==k.line?k.ch:null)),++S}),w.collapsed&&s.iter(h.line,k.line+1,e=>{a.lineIsHidden(s,e)&&r.updateLineHeight(e,0)}),w.clearOnEnter&&t.on(w,"beforeCursorEnter",()=>w.clear()),w.readOnly&&(o.seeReadOnlySpans(),(s.history.done.length||s.history.undone.length)&&s.clearHistory()),w.collapsed&&(w.id=++m,w.atomic=!0),A){if(C&&(A.curOp.updateMaxLine=!0),w.collapsed)u.regChange(A,h.line,k.line+1);else if(w.className||w.startStyle||w.endStyle||w.css||w.attributes||w.title)for(let e=h.line;e<=k.line;e++)u.regLineChange(A,e,"text");w.atomic&&p.reCheckSelection(A.doc),c.signalLater(A,"markerAdded",A,w)}return w}t.eventMixin(g);class y{constructor(e,t){this.markers=e,this.primary=t;for(let t=0;t<e.length;++t)e[t].parent=this}clear(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(let e=0;e<this.markers.length;++e)this.markers[e].clear();c.signalLater(this,"clear")}}find(e,t){return this.primary.find(e,t)}}return t.eventMixin(y),{TextMarker:g,markText:v,SharedTextMarker:y,findSharedMarkers:function(e){return e.findMarks(n.Pos(e.first,0),e.clipPos(n.Pos(e.lastLine())),e=>e.parent)},copySharedMarkers:function(e,t){for(let i=0;i<t.length;i++){let r=t[i],s=r.find(),o=e.clipPos(s.from),a=e.clipPos(s.to);if(n.cmp(o,a)){let t=v(e,o,a,r.primary,r.primary.type);r.markers.push(t),t.parent=r}}},detachSharedMarkers:function(e){for(let t=0;t<e.length;t++){let i=e[t],n=[i.primary.doc];d.linkedDocs(i.primary.doc,e=>n.push(e));for(let e=0;e<i.markers.length;e++){let t=i.markers[e];-1==l.indexOf(n,t.doc)&&(t.parent=null,i.markers.splice(e--,1))}}}}}),define("skylark-codemirror-base/model/Doc",["../display/operations","../line/line_data","../line/pos","../line/spans","../line/utils_line","../util/dom","../util/feature_detection","../util/misc","../display/scrolling","./changes","./change_measurement","./chunk","./document_data","./history","./line_widget","./mark_text","./selection","./selection_updates"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v){"use strict";let y=0,k=function(e,n,r,s,o){if(!(this instanceof k))return new k(e,n,r,s,o);null==r&&(r=0),u.BranchChunk.call(this,[new u.LeafChunk([new t.Line("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=r;let l=i.Pos(r,0);this.sel=g.simpleSelection(l),this.history=new f.History(null),this.id=++y,this.modeOption=n,this.lineSep=s,this.direction="rtl"==o?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),d.updateDoc(this,{from:l,to:l,text:e}),v.setSelection(this,g.simpleSelection(l),a.sel_dontScroll)};return k.prototype=a.createObj(u.BranchChunk.prototype,{constructor:k,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){let i=0;for(let e=0;e<t.length;++e)i+=t[e].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){let t=r.getLines(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:e.docMethodOp(function(e){let t=i.Pos(this.first,0),n=this.first+this.size-1;c.makeChange(this,{from:t,to:i.Pos(n,r.getLine(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&l.scrollToCoords(this.cm,0,0),v.setSelection(this,g.simpleSelection(t),a.sel_dontScroll)}),replaceRange:function(e,t,n,r){t=i.clipPos(this,t),n=n?i.clipPos(this,n):t,c.replaceRange(this,e,t,n,r)},getRange:function(e,t,n){let s=r.getBetween(this,i.clipPos(this,e),i.clipPos(this,t));return!1===n?s:s.join(n||this.lineSeparator())},getLine:function(e){let t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){if(r.isLine(this,e))return r.getLine(this,e)},getLineNumber:function(e){return r.lineNo(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=r.getLine(this,e)),n.visualLine(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return i.clipPos(this,e)},getCursor:function(e){let t,i=this.sel.primary();return t=null==e||"head"==e?i.head:"anchor"==e?i.anchor:"end"==e||"to"==e||!1===e?i.to():i.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:e.docMethodOp(function(e,t,n){v.setSimpleSelection(this,i.clipPos(this,"number"==typeof e?i.Pos(e,t||0):e),null,n)}),setSelection:e.docMethodOp(function(e,t,n){v.setSimpleSelection(this,i.clipPos(this,e),i.clipPos(this,t||e),n)}),extendSelection:e.docMethodOp(function(e,t,n){v.extendSelection(this,i.clipPos(this,e),t&&i.clipPos(this,t),n)}),extendSelections:e.docMethodOp(function(e,t){v.extendSelections(this,i.clipPosArray(this,e),t)}),extendSelectionsBy:e.docMethodOp(function(e,t){let n=a.map(this.sel.ranges,e);v.extendSelections(this,i.clipPosArray(this,n),t)}),setSelections:e.docMethodOp(function(e,t,n){if(!e.length)return;let r=[];for(let t=0;t<e.length;t++)r[t]=new g.Range(i.clipPos(this,e[t].anchor),i.clipPos(this,e[t].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),v.setSelection(this,g.normalizeSelection(this.cm,r,t),n)}),addSelection:e.docMethodOp(function(e,t,n){let r=this.sel.ranges.slice(0);r.push(new g.Range(i.clipPos(this,e),i.clipPos(this,t||e))),v.setSelection(this,g.normalizeSelection(this.cm,r,r.length-1),n)}),getSelection:function(e){let t,i=this.sel.ranges;for(let e=0;e<i.length;e++){let n=r.getBetween(this,i[e].from(),i[e].to());t=t?t.concat(n):n}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){let t=[],i=this.sel.ranges;for(let n=0;n<i.length;n++){let s=r.getBetween(this,i[n].from(),i[n].to());!1!==e&&(s=s.join(e||this.lineSeparator())),t[n]=s}return t},replaceSelection:function(e,t,i){let n=[];for(let t=0;t<this.sel.ranges.length;t++)n[t]=e;this.replaceSelections(n,t,i||"+input")},replaceSelections:e.docMethodOp(function(e,t,i){let n=[],r=this.sel;for(let t=0;t<r.ranges.length;t++){let s=r.ranges[t];n[t]={from:s.from(),to:s.to(),text:this.splitLines(e[t]),origin:i}}let s=t&&"end"!=t&&h.computeReplacedSel(this,n,t);for(let e=n.length-1;e>=0;e--)c.makeChange(this,n[e]);s?v.setSelectionReplaceHistory(this,s):this.cm&&l.ensureCursorVisible(this.cm)}),undo:e.docMethodOp(function(){c.makeChangeFromHistory(this,"undo")}),redo:e.docMethodOp(function(){c.makeChangeFromHistory(this,"redo")}),undoSelection:e.docMethodOp(function(){c.makeChangeFromHistory(this,"undo",!0)}),redoSelection:e.docMethodOp(function(){c.makeChangeFromHistory(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){let e=this.history,t=0,i=0;for(let i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(let t=0;t<e.undone.length;t++)e.undone[t].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){this.history=new f.History(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:f.copyHistoryArray(this.history.done),undone:f.copyHistoryArray(this.history.undone)}},setHistory:function(e){let t=this.history=new f.History(this.history.maxGeneration);t.done=f.copyHistoryArray(e.done.slice(0),null,!0),t.undone=f.copyHistoryArray(e.undone.slice(0),null,!0)},setGutterMarker:e.docMethodOp(function(e,t,i){return c.changeLine(this,e,"gutter",e=>{let n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=i,!i&&a.isEmpty(n)&&(e.gutterMarkers=null),!0})}),clearGutter:e.docMethodOp(function(e){this.iter(t=>{t.gutterMarkers&&t.gutterMarkers[e]&&c.changeLine(this,t,"gutter",()=>(t.gutterMarkers[e]=null,a.isEmpty(t.gutterMarkers)&&(t.gutterMarkers=null),!0))})}),lineInfo:function(e){let t;if("number"==typeof e){if(!r.isLine(this,e))return null;if(t=e,!(e=r.getLine(this,e)))return null}else if(null==(t=r.lineNo(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:e.docMethodOp(function(e,t,i){return c.changeLine(this,e,"gutter"==t?"gutter":"class",e=>{let n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(s.classTest(i).test(e[n]))return!1;e[n]+=" "+i}else e[n]=i;return!0})}),removeLineClass:e.docMethodOp(function(e,t,i){return c.changeLine(this,e,"gutter"==t?"gutter":"class",e=>{let n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[n];if(!r)return!1;if(null==i)e[n]=null;else{let t=r.match(s.classTest(i));if(!t)return!1;let o=t.index+t[0].length;e[n]=r.slice(0,t.index)+(t.index&&o!=r.length?" ":"")+r.slice(o)||null}return!0})}),addLineWidget:e.docMethodOp(function(e,t,i){return p.addLineWidget(this,e,t,i)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return m.markText(this,i.clipPos(this,e),i.clipPos(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){let n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=i.clipPos(this,e),m.markText(this,e,e,n,"bookmark")},findMarksAt:function(e){e=i.clipPos(this,e);let t=[],n=r.getLine(this,e.line).markedSpans;if(n)for(let i=0;i<n.length;++i){let r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=i.clipPos(this,e),t=i.clipPos(this,t);let r=[],s=e.line;return this.iter(e.line,t.line+1,i=>{let o=i.markedSpans;if(o)for(let i=0;i<o.length;i++){let a=o[i];null!=a.to&&s==e.line&&e.ch>=a.to||null==a.from&&s!=e.line||null!=a.from&&s==t.line&&a.from>=t.ch||n&&!n(a.marker)||r.push(a.marker.parent||a.marker)}++s}),r},getAllMarks:function(){let e=[];return this.iter(t=>{let i=t.markedSpans;if(i)for(let t=0;t<i.length;++t)null!=i[t].from&&e.push(i[t].marker)}),e},posFromIndex:function(e){let t,n=this.first,r=this.lineSeparator().length;return this.iter(i=>{let s=i.text.length+r;if(s>e)return t=e,!0;e-=s,++n}),i.clipPos(this,i.Pos(n,t))},indexFromPos:function(e){let t=(e=i.clipPos(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;let n=this.lineSeparator().length;return this.iter(this.first,e.line,e=>{t+=e.text.length+n}),t},copy:function(e){let t=new k(r.getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});let t=this.first,i=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to);let n=new k(r.getLines(this,t,i),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],p.copySharedMarkers(n,p.findSharedMarkers(this)),n},unlinkDoc:function(e){if(e.doc&&(e=e.doc),this.linked)for(let t=0;t<this.linked.length;++t){let i=this.linked[t];if(i.doc==e){this.linked.splice(t,1),e.unlinkDoc(this),p.detachSharedMarkers(p.findSharedMarkers(this));break}}if(e.history==this.history){let t=[e.id];d.linkedDocs(e,e=>t.push(e.id),!0),e.history=new f.History(null),e.history.done=f.copyHistoryArray(this.history.done,t),e.history.undone=f.copyHistoryArray(this.history.undone,t)}},iterLinkedDocs:function(e){d.linkedDocs(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):o.splitLinesAuto(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:e.docMethodOp(function(e){"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(e=>e.order=null),this.cm&&d.directionChanged(this.cm))})}),k.prototype.eachLine=k.prototype.iter,k}),define("skylark-codemirror-base/edit/drop_events",["../display/selection","../display/operations","../line/pos","../measurement/position_measurement","../measurement/widgets","../model/changes","../model/change_measurement","../model/selection","../model/selection_updates","../util/browser","../util/dom","../util/event","../util/misc"],function(e,t,i,n,r,s,o,a,l,c,h,u,d){"use strict";let f=0;function p(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}return{onDrop:function(e){let r=this;if(p(r),u.signalDOMEvent(r,e)||e.eventInWidget(r.display,e))return;u.e_preventDefault(e),c.ie&&(f=+new Date);let h=n.posFromMouse(r,e,!0),m=e.dataTransfer.files;if(!h||r.isReadOnly())return;if(m&&m.length&&window.FileReader&&window.File){let e=m.length,n=Array(e),l=0,c=(c,u)=>{if(r.options.allowDropFileTypes&&-1==d.indexOf(r.options.allowDropFileTypes,c.type))return;let f=new FileReader;f.onload=t.operation(r,()=>{let t=f.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(t)&&(t=""),n[u]=t,++l==e){let e={from:h=i.clipPos(r.doc,h),to:h,text:r.doc.splitLines(n.join(r.doc.lineSeparator())),origin:"paste"};s.makeChange(r.doc,e),u.setSelectionReplaceHistory(r.doc,a.simpleSelection(h,o.changeEnd(e)))}}),f.readAsText(c)};for(let t=0;t<e;++t)c(m[t],t)}else{if(r.state.draggingText&&r.doc.sel.contains(h)>-1)return r.state.draggingText(e),void setTimeout(()=>r.display.input.focus(),20);try{let t=e.dataTransfer.getData("Text");if(t){let e;if(r.state.draggingText&&!r.state.draggingText.copy&&(e=r.listSelections()),l.setSelectionNoUndo(r.doc,a.simpleSelection(h,h)),e)for(let t=0;t<e.length;++t)s.replaceRange(r.doc,"",e[t].anchor,e[t].head,"drag");r.replaceSelection(t,"around","paste"),r.display.input.focus()}}catch(e){}}},onDragStart:function(e,t){if(c.ie&&(!e.state.draggingText||+new Date-f<100))return void u.e_stop(t);if(u.signalDOMEvent(e,t)||t.eventInWidget(e.display,t))return;if(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!c.safari){let i=h.elt("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",c.presto&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),c.presto&&i.parentNode.removeChild(i)}},onDragOver:function(t,i){let r=n.posFromMouse(t,i);if(!r)return;let s=document.createDocumentFragment();e.drawSelectionCursor(t,r,s),t.display.dragCursor||(t.display.dragCursor=h.elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv));h.removeChildrenAndAdd(t.display.dragCursor,s)},clearDragCursor:p}}),define("skylark-codemirror-base/edit/global_events",["../display/focus","../util/event"],function(e,t){"use strict";function i(e){if(!document.getElementsByClassName)return;let t=document.getElementsByClassName("CodeMirror"),i=[];for(let e=0;e<t.length;e++){let n=t[e].CodeMirror;n&&i.push(n)}i.length&&i[0].operation(()=>{for(let t=0;t<i.length;t++)e(i[t])})}let n=!1;function r(e){let t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}return{ensureGlobalHandlers:function(){if(n)return;(function(){let n;t.on(window,"resize",()=>{null==n&&(n=setTimeout(()=>{n=null,i(r)},100))}),t.on(window,"blur",()=>i(e.onBlur))})(),n=!0}}}),define("skylark-codemirror-base/input/keynames",[],function(){"use strict";let e={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};for(let t=0;t<10;t++)e[t+48]=e[t+96]=String(t);for(let t=65;t<=90;t++)e[t]=String.fromCharCode(t);for(let t=1;t<=12;t++)e[t+111]=e[t+63235]="F"+t;return{keyNames:e}}),define("skylark-codemirror-base/input/keymap",["../util/browser","../util/misc","./keynames"],function(e,t,i){"use strict";let n={};function r(e){let t,i,n,r,s=e.split(/-(?!$)/);e=s[s.length-1];for(let e=0;e<s.length-1;e++){let o=s[e];if(/^(cmd|meta|m)$/i.test(o))r=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))i=!0;else{if(!/^s(hift)?$/i.test(o))throw new Error("Unrecognized modifier name: "+o);n=!0}}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function s(t,i,n){let r=t;return i.altKey&&"Alt"!=r&&(t="Alt-"+t),(e.flipCtrlCmd?i.metaKey:i.ctrlKey)&&"Ctrl"!=r&&(t="Ctrl-"+t),(e.flipCtrlCmd?i.ctrlKey:i.metaKey)&&"Cmd"!=r&&(t="Cmd-"+t),!n&&i.shiftKey&&"Shift"!=r&&(t="Shift-"+t),t}function o(e){return"string"==typeof e?n[e]:e}return n.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},n.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},n.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},n.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},n.default=e.mac?n.macDefault:n.pcDefault,{keyMap:n,normalizeKeyMap:function(e){let i={};for(let n in e)if(e.hasOwnProperty(n)){let s=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==s){delete e[n];continue}let o=t.map(n.split(" "),r);for(let e=0;e<o.length;e++){let t,n;e==o.length-1?(n=o.join(" "),t=s):(n=o.slice(0,e+1).join(" "),t="...");let r=i[n];if(r){if(r!=t)throw new Error("Inconsistent bindings for "+n)}else i[n]=t}delete e[n]}for(let t in i)e[t]=i[t];return e},lookupKey:function e(t,i,n,r){i=o(i);let s=i.call?i.call(t,r):i[t];if(!1===s)return"nothing";if("..."===s)return"multi";if(null!=s&&n(s))return"handled";if(i.fallthrough){if("[object Array]"!=Object.prototype.toString.call(i.fallthrough))return e(t,i.fallthrough,n,r);for(let s=0;s<i.fallthrough.length;s++){let o=e(t,i.fallthrough[s],n,r);if(o)return o}}},isModifierKey:function(e){let t="string"==typeof e?e:i.keyNames[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},addModifierNames:s,keyName:function(t,n){if(e.presto&&34==t.keyCode&&t.char)return!1;let r=i.keyNames[t.keyCode];if(null==r||t.altGraphKey)return!1;3==t.keyCode&&t.code&&(r=t.code);return s(r,t,n)},getKeyMap:o}}),define("skylark-codemirror-base/edit/deleteNearSelection",["../display/operations","../display/scrolling","../line/pos","../model/changes","../util/misc"],function(e,t,i,n,r){"use strict";return{deleteNearSelection:function(s,o){let a=s.doc.sel.ranges,l=[];for(let e=0;e<a.length;e++){let t=o(a[e]);for(;l.length&&i.cmp(t.from,r.lst(l).to)<=0;){let e=l.pop();if(i.cmp(e.from,t.from)<0){t.from=e.from;break}}l.push(t)}e.runInOp(s,()=>{for(let e=l.length-1;e>=0;e--)n.replaceRange(s.doc,"",l[e].from,l[e].to,"+delete");t.ensureCursorVisible(s)})}}}),define("skylark-codemirror-base/input/movement",["../line/pos","../measurement/position_measurement","../util/bidi","../util/misc"],function(e,t,i,n){"use strict";function r(e,t,i){let r=n.skipExtendingChars(e.text,t+i,i);return r<0||r>e.text.length?null:r}function s(t,i,n){let s=r(t,i.ch,n);return null==s?null:new e.Pos(i.line,s,n<0?"after":"before")}return{moveLogically:s,endOfLine:function(s,o,a,l,c){if(s){let s=i.getOrder(a,o.doc.direction);if(s){let i,h=c<0?n.lst(s):s[0],u=c<0==(1==h.level),d=u?"after":"before";if(h.level>0||"rtl"==o.doc.direction){let e=t.prepareMeasureForLine(o,a);i=c<0?a.text.length-1:0;let s=t.measureCharPrepared(o,e,i).top;i=n.findFirst(i=>t.measureCharPrepared(o,e,i).top==s,c<0==(1==h.level)?h.from:h.to-1,i),"before"==d&&(i=r(a,i,1))}else i=c<0?h.to:h.from;return new e.Pos(l,i,d)}}return new e.Pos(l,c<0?a.text.length:0,c<0?"before":"after")},moveVisually:function(i,n,o,a){let l=l.getOrder(n,i.doc.direction);if(!l)return s(n,o,a);o.ch>=n.text.length?(o.ch=n.text.length,o.sticky="before"):o.ch<=0&&(o.ch=0,o.sticky="after");let c=l.getBidiPartAt(l,o.ch,o.sticky),h=l[c];if("ltr"==i.doc.direction&&h.level%2==0&&(a>0?h.to>o.ch:h.from<o.ch))return s(n,o,a);let u,d=(t,i)=>r(n,t instanceof e.Pos?t.ch:t,i),f=e=>i.options.lineWrapping?(u=u||t.prepareMeasureForLine(i,n),t.wrappedLineExtentChar(i,n,u,e)):{begin:0,end:n.text.length},p=f("before"==o.sticky?d(o,-1):o.ch);if("rtl"==i.doc.direction||1==h.level){let t=1==h.level==a<0,i=d(o,t?1:-1);if(null!=i&&(t?i<=h.to&&i<=p.end:i>=h.from&&i>=p.begin)){let n=t?"before":"after";return new e.Pos(o.line,i,n)}}let m=(t,i,n)=>{let r=(t,i)=>i?new e.Pos(o.line,d(t,1),"before"):new e.Pos(o.line,t,"after");for(;t>=0&&t<l.length;t+=i){let e=l[t],s=i>0==(1!=e.level),o=s?n.begin:d(n.end,-1);if(e.from<=o&&o<e.to)return r(o,s);if(o=s?e.from:d(e.to,-1),n.begin<=o&&o<n.end)return r(o,s)}},g=m(c+a,a,p);if(g)return g;let v=a>0?p.end:d(p.begin,-1);if(null!=v&&!(a>0&&v==n.text.length)&&(g=m(a>0?0:l.length-1,a,f(v))))return g;return null}}}),define("skylark-codemirror-base/edit/commands",["./deleteNearSelection","../display/operations","../display/scrolling","../input/movement","../line/pos","../line/spans","../line/utils_line","../model/selection","../model/selection_updates","../util/misc","../util/bidi"],function(e,t,i,n,r,s,o,a,l,c,h){"use strict";let u={selectAll:l.selectAll,singleSelection:e=>e.setSelection(e.getCursor("anchor"),e.getCursor("head"),c.sel_dontScroll),killLine:t=>e.deleteNearSelection(t,e=>{if(e.empty()){let i=o.getLine(t.doc,e.head.line).text.length;return e.head.ch==i&&e.head.line<t.lastLine()?{from:e.head,to:r.Pos(e.head.line+1,0)}:{from:e.head,to:r.Pos(e.head.line,i)}}return{from:e.from(),to:e.to()}}),deleteLine:t=>e.deleteNearSelection(t,e=>({from:r.Pos(e.from().line,0),to:r.clipPos(t.doc,r.Pos(e.to().line+1,0))})),delLineLeft:t=>e.deleteNearSelection(t,e=>({from:r.Pos(e.from().line,0),to:e.from()})),delWrappedLineLeft:t=>e.deleteNearSelection(t,e=>{let i=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:0,top:i},"div");return{from:n,to:e.from()}}),delWrappedLineRight:t=>e.deleteNearSelection(t,e=>{let i=t.charCoords(e.head,"div").top+5,n=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:i},"div");return{from:e.from(),to:n}}),undo:e=>e.undo(),redo:e=>e.redo(),undoSelection:e=>e.undoSelection(),redoSelection:e=>e.redoSelection(),goDocStart:e=>e.extendSelection(r.Pos(e.firstLine(),0)),goDocEnd:e=>e.extendSelection(r.Pos(e.lastLine())),goLineStart:e=>e.extendSelectionsBy(t=>d(e,t.head.line),{origin:"+move",bias:1}),goLineStartSmart:e=>e.extendSelectionsBy(t=>f(e,t.head),{origin:"+move",bias:1}),goLineEnd:e=>e.extendSelectionsBy(t=>(function(e,t){let i=o.getLine(e.doc,t),r=s.visualLineEnd(i);r!=i&&(t=o.lineNo(r));return n.endOfLine(!0,e,i,t,-1)})(e,t.head.line),{origin:"+move",bias:-1}),goLineRight:e=>e.extendSelectionsBy(t=>{let i=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},c.sel_move),goLineLeft:e=>e.extendSelectionsBy(t=>{let i=e.cursorCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},c.sel_move),goLineLeftSmart:e=>e.extendSelectionsBy(t=>{let i=e.cursorCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return n.ch<e.getLine(n.line).search(/\S/)?f(e,t.head):n},c.sel_move),goLineUp:e=>e.moveV(-1,"line"),goLineDown:e=>e.moveV(1,"line"),goPageUp:e=>e.moveV(-1,"page"),goPageDown:e=>e.moveV(1,"page"),goCharLeft:e=>e.moveH(-1,"char"),goCharRight:e=>e.moveH(1,"char"),goColumnLeft:e=>e.moveH(-1,"column"),goColumnRight:e=>e.moveH(1,"column"),goWordLeft:e=>e.moveH(-1,"word"),goGroupRight:e=>e.moveH(1,"group"),goGroupLeft:e=>e.moveH(-1,"group"),goWordRight:e=>e.moveH(1,"word"),delCharBefore:e=>e.deleteH(-1,"char"),delCharAfter:e=>e.deleteH(1,"char"),delWordBefore:e=>e.deleteH(-1,"word"),delWordAfter:e=>e.deleteH(1,"word"),delGroupBefore:e=>e.deleteH(-1,"group"),delGroupAfter:e=>e.deleteH(1,"group"),indentAuto:e=>e.indentSelection("smart"),indentMore:e=>e.indentSelection("add"),indentLess:e=>e.indentSelection("subtract"),insertTab:e=>e.replaceSelection("\t"),insertSoftTab:e=>{let t=[],i=e.listSelections(),n=e.options.tabSize;for(let r=0;r<i.length;r++){let s=i[r].from(),o=c.countColumn(e.getLine(s.line),s.ch,n);t.push(c.spaceStr(n-o%n))}e.replaceSelections(t)},defaultTab:e=>{e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:e=>t.runInOp(e,()=>{let t=e.listSelections(),i=[];for(let n=0;n<t.length;n++){if(!t[n].empty())continue;let s=t[n].head,l=o.getLine(e.doc,s.line).text;if(l)if(s.ch==l.length&&(s=new r.Pos(s.line,s.ch-1)),s.ch>0)s=new r.Pos(s.line,s.ch+1),e.replaceRange(l.charAt(s.ch-1)+l.charAt(s.ch-2),r.Pos(s.line,s.ch-2),s,"+transpose");else if(s.line>e.doc.first){let t=o.getLine(e.doc,s.line-1).text;t&&(s=new r.Pos(s.line,1),e.replaceRange(l.charAt(0)+e.doc.lineSeparator()+t.charAt(t.length-1),r.Pos(s.line-1,t.length-1),s,"+transpose"))}i.push(new a.Range(s,s))}e.setSelections(i)}),newlineAndIndent:e=>t.runInOp(e,()=>{let t=e.listSelections();for(let i=t.length-1;i>=0;i--)e.replaceRange(e.doc.lineSeparator(),t[i].anchor,t[i].head,"+input");t=e.listSelections();for(let i=0;i<t.length;i++)e.indentLine(t[i].from().line,null,!0);i.ensureCursorVisible(e)}),openLine:e=>e.replaceSelection("\n","start"),toggleOverwrite:e=>e.toggleOverwrite()};function d(e,t){let i=o.getLine(e.doc,t),r=s.visualLine(i);return r!=i&&(t=o.lineNo(r)),n.endOfLine(!0,e,r,t,1)}function f(e,t){let i=d(e,t.line),n=o.getLine(e.doc,i.line),s=h.getOrder(n,e.doc.direction);if(!s||0==s[0].level){let e=Math.max(0,n.text.search(/\S/)),s=t.line==i.line&&t.ch<=e&&t.ch;return r.Pos(i.line,s?0:e,i.sticky)}return i}return{commands:u}}),define("skylark-codemirror-base/edit/key_events",["../util/operation_group","../display/selection","../input/keymap","../measurement/widgets","../util/browser","../util/dom","../util/event","../util/feature_detection","../util/misc","./commands"],function(e,t,i,n,r,s,o,a,l,c){"use strict";function h(e,t,i){if("string"==typeof t&&!(t=c.commands[t]))return!1;e.display.input.ensurePolled();let n=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),r=t(e)!=l.Pass}finally{e.display.shift=n,e.state.suppressEdits=!1}return r}let u=new l.Delayed;function d(e,t,n,r){let s=e.state.keySeq;if(s){if(i.isModifierKey(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:u.set(50,()=>{e.state.keySeq==s&&(e.state.keySeq=null,e.display.input.reset())}),f(e,s+" "+t,n,r))return!0}return f(e,t,n,r)}function f(n,r,s,a){let l=function(e,t,n){for(let r=0;r<e.state.keyMaps.length;r++){let s=i.lookupKey(t,e.state.keyMaps[r],n,e);if(s)return s}return e.options.extraKeys&&i.lookupKey(t,e.options.extraKeys,n,e)||i.lookupKey(t,e.options.keyMap,n,e)}(n,r,a);return"multi"==l&&(n.state.keySeq=r),"handled"==l&&e.signalLater(n,"keyHandled",n,r,s),"handled"!=l&&"multi"!=l||(o.e_preventDefault(s),t.restartBlink(n)),!!l}function p(e,t){let n=i.keyName(t,!0);return!!n&&(t.shiftKey&&!e.state.keySeq?d(e,"Shift-"+n,t,t=>h(e,t,!0))||d(e,n,t,t=>{if("string"==typeof t?/^go[A-Z]/.test(t):t.motion)return h(e,t)}):d(e,n,t,t=>h(e,t)))}let m=null;return{dispatchKey:d,onKeyDown:function(e){let t=this;if(t.curOp.focus=s.activeElt(),o.signalDOMEvent(t,e))return;r.ie&&r.ie_version<11&&27==e.keyCode&&(e.returnValue=!1);let i=e.keyCode;t.display.shift=16==i||e.shiftKey;let n=p(t,e);r.presto&&(m=n?i:null,!n&&88==i&&!a.hasCopyEvent&&(r.mac?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut"));18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){let t=e.display.lineDiv;function i(e){18!=e.keyCode&&e.altKey||(s.rmClass(t,"CodeMirror-crosshair"),o.off(document,"keyup",i),o.off(document,"mouseover",i))}s.addClass(t,"CodeMirror-crosshair"),o.on(document,"keyup",i),o.on(document,"mouseover",i)}(t)},onKeyUp:function(e){16==e.keyCode&&(this.doc.sel.shift=!1);o.signalDOMEvent(this,e)},onKeyPress:function(e){let t=this;if(n.eventInWidget(t.display,e)||o.signalDOMEvent(t,e)||e.ctrlKey&&!e.altKey||r.mac&&e.metaKey)return;let i=e.keyCode,s=e.charCode;if(r.presto&&i==m)return m=null,void o.e_preventDefault(e);if(r.presto&&(!e.which||e.which<10)&&p(t,e))return;let a=String.fromCharCode(null==s?i:s);if("\b"==a)return;if(function(e,t,i){return d(e,"'"+i+"'",t,t=>h(e,t,!0))}(t,e,a))return;t.display.input.onKeyPress(e)}}}),define("skylark-codemirror-base/edit/mouse_events",["../display/focus","../display/operations","../display/update_lines","../line/pos","../line/utils_line","../measurement/position_measurement","../measurement/widgets","../model/selection","../model/selection_updates","../util/browser","../util/bidi","../util/dom","../util/event","../util/feature_detection","../util/misc","../input/keymap","./key_events","./commands"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v){"use strict";const y=400;class k{constructor(e,t,i){this.time=e,this.pos=t,this.button=i}compare(e,t,i){return this.time+y>e&&0==n.cmp(t,this.pos)&&i==this.button}}let b,x;function w(i,r,s,o){c.ie?setTimeout(p.bind(e.ensureFocus,i),0):i.curOp.focus=u.activeElt();let a,h=function(e,t,i){let n=e.getOption("configureMouse"),r=n?n(e,t,i):{};if(null==r.unit){let e=c.chromeOS?i.shiftKey&&i.metaKey:i.altKey;r.unit=e?"rectangle":"single"==t?"char":"double"==t?"word":"line"}(null==r.extend||e.doc.extend)&&(r.extend=e.doc.extend||i.shiftKey);null==r.addNew&&(r.addNew=c.mac?i.metaKey:i.ctrlKey);null==r.moveOnDrag&&(r.moveOnDrag=!(c.mac?i.altKey:i.ctrlKey));return r}(i,s,o),m=i.doc.sel;i.options.dragDrop&&f.dragAndDrop&&!i.isReadOnly()&&"single"==s&&(a=m.contains(r))>-1&&(n.cmp((a=m.ranges[a]).from(),r)<0||r.xRel>0)&&(n.cmp(a.to(),r)>0||r.xRel<0)?function(i,n,r,s){let o=i.display,a=!1,h=t.operation(i,e=>{c.webkit&&(o.scroller.draggable=!1),i.state.draggingText=!1,d.off(o.wrapper.ownerDocument,"mouseup",h),d.off(o.wrapper.ownerDocument,"mousemove",u),d.off(o.scroller,"dragstart",f),d.off(o.scroller,"drop",h),a||(d.e_preventDefault(e),s.addNew||l.extendSelection(i.doc,r,null,null,s.extend),c.webkit||c.ie&&9==c.ie_version?setTimeout(()=>{o.wrapper.ownerDocument.body.focus(),o.input.focus()},20):o.input.focus())}),u=function(e){a=a||Math.abs(n.clientX-e.clientX)+Math.abs(n.clientY-e.clientY)>=10},f=()=>a=!0;c.webkit&&(o.scroller.draggable=!0);i.state.draggingText=h,h.copy=!s.moveOnDrag,o.scroller.dragDrop&&o.scroller.dragDrop();d.on(o.wrapper.ownerDocument,"mouseup",h),d.on(o.wrapper.ownerDocument,"mousemove",u),d.on(o.scroller,"dragstart",f),d.on(o.scroller,"drop",h),e.delayBlurEvent(i),setTimeout(()=>o.input.focus(),20)}(i,o,r,h):C(i,o,r,h)}function _(e,t,i){if("char"==i)return new a.Range(t,t);if("word"==i)return e.findWordAt(t);if("line"==i)return new a.Range(n.Pos(t.line,0),n.clipPos(e.doc,n.Pos(t.line+1,0)));let r=i(e,t);return new a.Range(r.from,r.to)}function C(e,o,c,f){let m=e.display,g=e.doc;d.e_preventDefault(o);let v,y,k=g.sel,b=k.ranges;if(f.addNew&&!f.extend?(y=g.sel.contains(c),v=y>-1?b[y]:new a.Range(c,c)):(v=g.sel.primary(),y=g.sel.primIndex),"rectangle"==f.unit)f.addNew||(v=new a.Range(c,c)),c=s.posFromMouse(e,o,!0,!0),y=-1;else{let t=_(e,c,f.unit);v=f.extend?l.extendRange(v,t.anchor,t.head,f.extend):t}f.addNew?-1==y?(y=b.length,l.setSelection(g,a.normalizeSelection(e,b.concat([v]),y),{scroll:!1,origin:"*mouse"})):b.length>1&&b[y].empty()&&"char"==f.unit&&!f.extend?(l.setSelection(g,a.normalizeSelection(e,b.slice(0,y).concat(b.slice(y+1)),0),{scroll:!1,origin:"*mouse"}),k=g.sel):l.replaceOneSelection(g,y,v,p.sel_mouse):(y=0,l.setSelection(g,new a.Selection([v],0),p.sel_mouse),k=g.sel);let x=c;function w(t){if(0!=n.cmp(x,t))if(x=t,"rectangle"==f.unit){let i=[],s=e.options.tabSize,o=p.countColumn(r.getLine(g,c.line).text,c.ch,s),h=p.countColumn(r.getLine(g,t.line).text,t.ch,s),u=Math.min(o,h),d=Math.max(o,h);for(let o=Math.min(c.line,t.line),l=Math.min(e.lastLine(),Math.max(c.line,t.line));o<=l;o++){let e=r.getLine(g,o).text,t=p.findColumn(e,u,s);u==d?i.push(new a.Range(n.Pos(o,t),n.Pos(o,t))):e.length>t&&i.push(new a.Range(n.Pos(o,t),n.Pos(o,p.findColumn(e,d,s))))}i.length||i.push(new a.Range(c,c)),l.setSelection(g,a.normalizeSelection(e,k.ranges.slice(0,y).concat(i),y),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{let i,s=v,o=_(e,t,f.unit),c=s.anchor;n.cmp(o.anchor,c)>0?(i=o.head,c=n.minPos(s.from(),o.anchor)):(i=o.anchor,c=n.maxPos(s.to(),o.head));let u=k.ranges.slice(0);u[y]=function(e,t){let{anchor:i,head:s}=t,o=r.getLine(e.doc,i.line);if(0==n.cmp(i,s)&&i.sticky==s.sticky)return t;let l=h.getOrder(o);if(!l)return t;let c=h.getBidiPartAt(l,i.ch,i.sticky),u=l[c];if(u.from!=i.ch&&u.to!=i.ch)return t;let d,f=c+(u.from==i.ch==(1!=u.level)?0:1);if(0==f||f==l.length)return t;if(s.line!=i.line)d=(s.line-i.line)*("ltr"==e.doc.direction?1:-1)>0;else{let e=h.getBidiPartAt(l,s.ch,s.sticky),t=e-c||(s.ch-i.ch)*(1==u.level?-1:1);d=e==f-1||e==f?t<0:t>0}let p=l[f+(d?-1:0)],m=d==(1==p.level),g=m?p.from:p.to,v=m?"after":"before";return i.ch==g&&i.sticky==v?t:new a.Range(new n.Pos(i.line,g,v),s)}(e,new a.Range(n.clipPos(g,c),i)),l.setSelection(g,a.normalizeSelection(e,u,y),p.sel_mouse)}}let C=m.wrapper.getBoundingClientRect(),S=0;function A(t){e.state.selectingText=!1,S=1/0,d.e_preventDefault(t),m.input.focus(),d.off(m.wrapper.ownerDocument,"mousemove",M),d.off(m.wrapper.ownerDocument,"mouseup",T),g.history.lastSelOrigin=null}let M=t.operation(e,r=>{0!==r.buttons&&d.e_button(r)?function r(o){let a=++S;let l=s.posFromMouse(e,o,!0,"rectangle"==f.unit);if(!l)return;if(0!=n.cmp(l,x)){e.curOp.focus=u.activeElt(),w(l);let n=i.visibleLines(m,g);(l.line>=n.to||l.line<n.from)&&setTimeout(t.operation(e,()=>{S==a&&r(o)}),150)}else{let i=o.clientY<C.top?-20:o.clientY>C.bottom?20:0;i&&setTimeout(t.operation(e,()=>{S==a&&(m.scroller.scrollTop+=i,r(o))}),50)}}(r):A(r)}),T=t.operation(e,A);e.state.selectingText=T,d.on(m.wrapper.ownerDocument,"mousemove",M),d.on(m.wrapper.ownerDocument,"mouseup",T)}function S(e,t,i,n){let s,o;if(t.touches)s=t.touches[0].clientX,o=t.touches[0].clientY;else try{s=t.clientX,o=t.clientY}catch(t){return!1}if(s>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&d.e_preventDefault(t);let a=e.display,l=a.lineDiv.getBoundingClientRect();if(o>l.bottom||!d.hasHandler(e,i))return d.e_defaultPrevented(t);o-=l.top-a.viewOffset;for(let n=0;n<e.options.gutters.length;++n){let l=a.gutters.childNodes[n];if(l&&l.getBoundingClientRect().right>=s){let s=r.lineAtHeight(e.doc,o),a=e.options.gutters[n];return d.signal(e,i,e,s,a,t),d.e_defaultPrevented(t)}}}function A(e,t){return S(e,t,"gutterClick",!0)}return{onMouseDown:function(t){let i=this,n=i.display;if(d.signalDOMEvent(i,t)||n.activeTouch&&n.input.supportsTouch())return;if(n.input.ensurePolled(),n.shift=t.shiftKey,o.eventInWidget(n,t))return void(c.webkit||(n.scroller.draggable=!1,setTimeout(()=>n.scroller.draggable=!0,100)));if(A(i,t))return;let r=s.posFromMouse(i,t),a=d.e_button(t),h=r?function(e,t){let i=+new Date;return x&&x.compare(i,e,t)?(b=x=null,"triple"):b&&b.compare(i,e,t)?(x=new k(i,e,t),b=null,"double"):(b=new k(i,e,t),x=null,"single")}(r,a):"single";window.focus(),1==a&&i.state.selectingText&&i.state.selectingText(t);if(r&&function(e,t,i,n,r){let s="Click";"double"==n?s="Double"+s:"triple"==n&&(s="Triple"+s);return s=(1==t?"Left":2==t?"Middle":"Right")+s,g.dispatchKey(e,m.addModifierNames(s,r),r,t=>{if("string"==typeof t&&(t=v.commands[t]),!t)return!1;let n=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n=t(e,i)!=p.Pass}finally{e.state.suppressEdits=!1}return n})}(i,a,r,h,t))return;1==a?r?w(i,r,h,t):d.e_target(t)==n.scroller&&d.e_preventDefault(t):2==a?(r&&l.extendSelection(i.doc,r),setTimeout(()=>n.input.focus(),20)):3==a&&(c.captureRightClick?i.display.input.onContextMenu(t):e.delayBlurEvent(i))},clickInGutter:A,onContextMenu:function(e,t){if(o.eventInWidget(e.display,t)||function(e,t){return!!d.hasHandler(e,"gutterContextMenu")&&S(e,t,"gutterContextMenu",!1)}(e,t))return;if(d.signalDOMEvent(e,t,"contextmenu"))return;c.captureRightClick||e.display.input.onContextMenu(t)}}}),define("skylark-codemirror-base/edit/utils",["../measurement/position_measurement"],function(e){"use strict";return{themeChanged:function(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),e.clearCaches(t)}}}),define("skylark-codemirror-base/edit/options",["../display/focus","../display/gutters","../display/line_numbers","../display/mode_state","../display/scrollbars","../display/selection","../display/view_tracking","../input/keymap","../line/line_data","../line/pos","../line/spans","../measurement/position_measurement","../model/changes","../util/browser","../util/dom","../util/event","./utils"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g){"use strict";let v={toString:function(){return"CodeMirror.Init"}};function y(e){t.updateGutters(e),o.regChange(e),i.alignHorizontally(e)}function k(e,t,i){let n=i&&i!=v;if(!t!=!n){let i=e.display.dragFunctions,n=t?m.on:m.off;n(e.display.scroller,"dragstart",i.start),n(e.display.scroller,"dragenter",i.enter),n(e.display.scroller,"dragover",i.over),n(e.display.scroller,"dragleave",i.leave),n(e.display.scroller,"drop",i.drop)}}function b(e){e.options.lineWrapping?(p.addClass(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(p.rmClass(e.display.wrapper,"CodeMirror-wrap"),h.findMaxLine(e)),u.estimateLineHeights(e),o.regChange(e),u.clearCaches(e),setTimeout(()=>r.updateScrollbars(e),100)}return{Init:v,defaults:{},optionHandlers:{},defineOptions:function(i){let h=i.optionHandlers;function p(e,t,n,r){i.defaults[e]=t,n&&(h[e]=r?(e,t,i)=>{i!=v&&n(e,t,i)}:n)}i.defineOption=p,i.Init=v,p("value","",(e,t)=>e.setValue(t),!0),p("mode",null,(e,t)=>{e.doc.modeOption=t,n.loadMode(e)},!0),p("indentUnit",2,n.loadMode,!0),p("indentWithTabs",!1),p("smartIndent",!0),p("tabSize",4,e=>{n.resetModeState(e),u.clearCaches(e),o.regChange(e)},!0),p("lineSeparator",null,(e,t)=>{if(e.doc.lineSep=t,!t)return;let i=[],n=e.doc.first;e.doc.iter(e=>{for(let r=0;;){let s=e.text.indexOf(t,r);if(-1==s)break;r=s+t.length,i.push(c.Pos(n,s))}n++});for(let n=i.length-1;n>=0;n--)d.replaceRange(e.doc,t,i[n],c.Pos(i[n].line,i[n].ch+t.length))}),p("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,(e,t,i)=>{e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),i!=v&&e.refresh()}),p("specialCharPlaceholder",l.defaultSpecialCharPlaceholder,e=>e.refresh(),!0),p("electricChars",!0),p("inputStyle",f.mobile?"contenteditable":"textarea",()=>{throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),p("spellcheck",!1,(e,t)=>e.getInputField().spellcheck=t,!0),p("autocorrect",!1,(e,t)=>e.getInputField().autocorrect=t,!0),p("autocapitalize",!1,(e,t)=>e.getInputField().autocapitalize=t,!0),p("rtlMoveVisually",!f.windows),p("wholeLineUpdateBefore",!0),p("theme","default",e=>{g.themeChanged(e),y(e)},!0),p("keyMap","default",(e,t,i)=>{let n=a.getKeyMap(t),r=i!=v&&a.getKeyMap(i);r&&r.detach&&r.detach(e,n),n.attach&&n.attach(e,r||null)}),p("extraKeys",null),p("configureMouse",null),p("lineWrapping",!1,b,!0),p("gutters",[],e=>{t.setGuttersForLineNumbers(e.options),y(e)},!0),p("fixedGutter",!0,(e,t)=>{e.display.gutters.style.left=t?u.compensateForHScroll(e.display)+"px":"0",e.refresh()},!0),p("coverGutterNextToScrollbar",!1,e=>r.updateScrollbars(e),!0),p("scrollbarStyle","native",e=>{r.initScrollbars(e),r.updateScrollbars(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),p("lineNumbers",!1,e=>{t.setGuttersForLineNumbers(e.options),y(e)},!0),p("firstLineNumber",1,y,!0),p("lineNumberFormatter",e=>e,y,!0),p("showCursorWhenSelecting",!1,s.updateSelection,!0),p("resetSelectionOnContextMenu",!0),p("lineWiseCopyCut",!0),p("pasteLinesPerSelection",!0),p("selectionsMayTouch",!1),p("readOnly",!1,(t,i)=>{"nocursor"==i&&(e.onBlur(t),t.display.input.blur()),t.display.input.readOnlyChanged(i)}),p("disableInput",!1,(e,t)=>{t||e.display.input.reset()},!0),p("dragDrop",!0,k),p("allowDropFileTypes",null),p("cursorBlinkRate",530),p("cursorScrollMargin",0),p("cursorHeight",1,s.updateSelection,!0),p("singleCursorHeightPerLine",!0,s.updateSelection,!0),p("workTime",100),p("workDelay",100),p("flattenSpans",!0,n.resetModeState,!0),p("addModeClass",!1,n.resetModeState,!0),p("pollInterval",100),p("undoDepth",200,(e,t)=>e.doc.history.undoDepth=t),p("historyEventDelay",1250),p("viewportMargin",10,e=>e.refresh(),!0),p("maxHighlightLength",1e4,n.resetModeState,!0),p("moveInputWithCursor",!0,(e,t)=>{t||e.display.input.resetPosition()}),p("tabindex",null,(e,t)=>e.display.input.getField().tabIndex=t||""),p("autofocus",null),p("direction","ltr",(e,t)=>e.doc.setDirection(t),!0),p("phrases",null)}}}),define("skylark-codemirror-base/edit/CodeMirror",["../display/Display","../display/focus","../display/gutters","../display/line_numbers","../display/operations","../display/scrollbars","../display/scroll_events","../display/scrolling","../line/pos","../measurement/position_measurement","../measurement/widgets","../model/Doc","../model/document_data","../model/selection","../model/selection_updates","../util/browser","../util/event","../util/misc","./drop_events","./global_events","./key_events","./mouse_events","./utils","./options"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v,y,k,b,x,w,_){"use strict";function C(A,M){if(!(this instanceof C))return new C(A,M);this.options=M=M?v.copyObj(M):{},v.copyObj(_.defaults,M,!1),i.setGuttersForLineNumbers(M);let T=M.value;"string"==typeof T?T=new u(T,M.mode,null,M.lineSeparator,M.direction):M.mode&&(T.modeOption=M.mode),this.doc=T;let L=new C.inputStyles[M.inputStyle](this),$=this.display=new e.Display(A,T,L);$.wrapper.CodeMirror=this,i.updateGutters(this),w.themeChanged(this),M.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),s.initScrollbars(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new v.Delayed,keySeq:null,specialChars:null},M.autofocus&&!m.mobile&&$.input.focus(),m.ie&&m.ie_version<11&&setTimeout(()=>this.display.input.reset(!0),20),function(e){let i=e.display;g.on(i.scroller,"mousedown",r.operation(e,x.onMouseDown)),m.ie&&m.ie_version<11?g.on(i.scroller,"dblclick",r.operation(e,t=>{if(g.signalDOMEvent(e,t))return;let i=c.posFromMouse(e,t);if(!i||x.clickInGutter(e,t)||h.eventInWidget(e.display,t))return;g.e_preventDefault(t);let n=e.findWordAt(i);p.extendSelection(e.doc,n.anchor,n.head)})):g.on(i.scroller,"dblclick",t=>g.signalDOMEvent(e,t)||g.e_preventDefault(t));g.on(i.scroller,"contextmenu",t=>x.onContextMenu(e,t));let n,s={end:0};function u(){i.activeTouch&&(n=setTimeout(()=>i.activeTouch=null,1e3),(s=i.activeTouch).end=+new Date)}function d(e,t){if(null==t.left)return!0;let i=t.left-e.left,n=t.top-e.top;return i*i+n*n>400}g.on(i.scroller,"touchstart",t=>{if(!g.signalDOMEvent(e,t)&&!function(e){if(1!=e.touches.length)return!1;let t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(t)&&!x.clickInGutter(e,t)){i.input.ensurePolled(),clearTimeout(n);let e=+new Date;i.activeTouch={start:e,moved:!1,prev:e-s.end<=300?s:null},1==t.touches.length&&(i.activeTouch.left=t.touches[0].pageX,i.activeTouch.top=t.touches[0].pageY)}}),g.on(i.scroller,"touchmove",()=>{i.activeTouch&&(i.activeTouch.moved=!0)}),g.on(i.scroller,"touchend",t=>{let n=i.activeTouch;if(n&&!h.eventInWidget(i,t)&&null!=n.left&&!n.moved&&new Date-n.start<300){let r,s=e.coordsChar(i.activeTouch,"page");r=!n.prev||d(n,n.prev)?new f.Range(s,s):!n.prev.prev||d(n,n.prev.prev)?e.findWordAt(s):new f.Range(l.Pos(s.line,0),l.clipPos(e.doc,l.Pos(s.line+1,0))),e.setSelection(r.anchor,r.head),e.focus(),g.e_preventDefault(t)}u()}),g.on(i.scroller,"touchcancel",u),g.on(i.scroller,"scroll",()=>{i.scroller.clientHeight&&(a.updateScrollTop(e,i.scroller.scrollTop),a.setScrollLeft(e,i.scroller.scrollLeft,!0),g.signal(e,"scroll",e))}),g.on(i.scroller,"mousewheel",t=>o.onScrollWheel(e,t)),g.on(i.scroller,"DOMMouseScroll",t=>o.onScrollWheel(e,t)),g.on(i.wrapper,"scroll",()=>i.wrapper.scrollTop=i.wrapper.scrollLeft=0),i.dragFunctions={enter:t=>{g.signalDOMEvent(e,t)||g.e_stop(t)},over:t=>{g.signalDOMEvent(e,t)||(y.onDragOver(e,t),g.e_stop(t))},start:t=>y.onDragStart(e,t),drop:r.operation(e,y.onDrop),leave:t=>{g.signalDOMEvent(e,t)||y.clearDragCursor(e)}};let v=i.input.getField();g.on(v,"keyup",t=>b.onKeyUp.call(e,t)),g.on(v,"keydown",r.operation(e,b.onKeyDown)),g.on(v,"keypress",r.operation(e,b.onKeyPress)),g.on(v,"focus",i=>t.onFocus(e,i)),g.on(v,"blur",i=>t.onBlur(e,i))}(this),k.ensureGlobalHandlers(),r.startOperation(this),this.curOp.forceUpdate=!0,d.attachDoc(this,T),M.autofocus&&!m.mobile||this.hasFocus()?setTimeout(v.bind(t.onFocus,this),20):t.onBlur(this);for(let e in _.optionHandlers)_.optionHandlers.hasOwnProperty(e)&&_.optionHandlers[e](this,M[e],_.Init);n.maybeUpdateLineNumberWidth(this),M.finishInit&&M.finishInit(this);for(let e=0;e<S.length;++e)S[e](this);r.endOperation(this),m.webkit&&M.lineWrapping&&"optimizelegibility"==getComputedStyle($.lineDiv).textRendering&&($.lineDiv.style.textRendering="auto")}C.defaults=_.defaults,C.optionHandlers=_.optionHandlers;let S=[];return C.defineInitHook=(e=>S.push(e)),C}),define("skylark-codemirror-base/input/indent",["../line/highlight","../line/pos","../line/utils_line","../model/changes","../model/selection","../model/selection_updates","../util/misc"],function(e,t,i,n,r,s,o){"use strict";return{indentLine:function(a,l,c,h){let u,d=a.doc;null==c&&(c="add");"smart"==c&&(d.mode.indent?u=e.getContextBefore(a,l).state:c="prev");let f=a.options.tabSize,p=i.getLine(d,l),m=o.countColumn(p.text,null,f);p.stateAfter&&(p.stateAfter=null);let g,v=p.text.match(/^\s*/)[0];if(h||/\S/.test(p.text)){if("smart"==c&&((g=d.mode.indent(u,p.text.slice(v.length),p.text))==o.Pass||g>150)){if(!h)return;c="prev"}}else g=0,c="not";"prev"==c?g=l>d.first?o.countColumn(i.getLine(d,l-1).text,null,f):0:"add"==c?g=m+a.options.indentUnit:"subtract"==c?g=m-a.options.indentUnit:"number"==typeof c&&(g=m+c);g=Math.max(0,g);let y="",k=0;if(a.options.indentWithTabs)for(let e=Math.floor(g/f);e;--e)k+=f,y+="\t";k<g&&(y+=o.spaceStr(g-k));if(y!=v)return n.replaceRange(d,y,t.Pos(l,0),t.Pos(l,v.length),"+input"),p.stateAfter=null,!0;for(let e=0;e<d.sel.ranges.length;e++){let i=d.sel.ranges[e];if(i.head.line==l&&i.head.ch<v.length){let i=t.Pos(l,v.length);s.replaceOneSelection(d,e,new r.Range(i,i));break}}}}}),define("skylark-codemirror-base/input/input",["../display/operations","../display/scrolling","../line/pos","../line/utils_line","../model/changes","../util/browser","../util/dom","../util/misc","../util/operation_group","../util/feature_detection","./indent"],function(e,t,i,n,r,s,o,a,l,c,h){"use strict";let u=null;function d(e,s,o,h,d){let p=e.doc;e.display.shift=!1,h||(h=p.sel);let m=+new Date-200,g="paste"==d||e.state.pasteIncoming>m,v=c.splitLinesAuto(s),y=null;if(g&&h.ranges.length>1)if(u&&u.text.join("\n")==s){if(h.ranges.length%u.text.length==0){y=[];for(let e=0;e<u.text.length;e++)y.push(p.splitLines(u.text[e]))}}else v.length==h.ranges.length&&e.options.pasteLinesPerSelection&&(y=a.map(v,e=>[e]));let k=e.curOp.updateInput;for(let t=h.ranges.length-1;t>=0;t--){let c=h.ranges[t],f=c.from(),k=c.to();c.empty()&&(o&&o>0?f=i.Pos(f.line,f.ch-o):e.state.overwrite&&!g?k=i.Pos(k.line,Math.min(n.getLine(p,k.line).text.length,k.ch+a.lst(v).length)):g&&u&&u.lineWise&&u.text.join("\n")==s&&(f=k=i.Pos(f.line,0)));let b={from:f,to:k,text:y?y[t%y.length]:v,origin:d||(g?"paste":e.state.cutIncoming>m?"cut":"+input")};r.makeChange(e.doc,b),l.signalLater(e,"inputRead",e,b)}s&&!g&&f(e,s),t.ensureCursorVisible(e),e.curOp.updateInput<2&&(e.curOp.updateInput=k),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function f(e,t){if(!e.options.electricChars||!e.options.smartIndent)return;let i=e.doc.sel;for(let r=i.ranges.length-1;r>=0;r--){let s=i.ranges[r];if(s.head.ch>100||r&&i.ranges[r-1].head.line==s.head.line)continue;let o=e.getModeAt(s.head),a=!1;if(o.electricChars){for(let i=0;i<o.electricChars.length;i++)if(t.indexOf(o.electricChars.charAt(i))>-1){a=h.indentLine(e,s.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(n.getLine(e.doc,s.head.line).text.slice(0,s.head.ch))&&(a=h.indentLine(e,s.head.line,"smart"));a&&l.signalLater(e,"electricInput",e,s.head.line)}}function p(e,t,i,n){e.setAttribute("autocorrect",!!i),e.setAttribute("autocapitalize",!!n),e.setAttribute("spellcheck",!!t)}return{lastCopied:u,setLastCopied:function(e){u=e},applyTextInput:d,handlePaste:function(t,i){let n=t.clipboardData&&t.clipboardData.getData("Text");if(n)return t.preventDefault(),i.isReadOnly()||i.options.disableInput||e.runInOp(i,()=>d(i,n,0,null,"paste")),!0},triggerElectric:f,copyableRanges:function(e){let t=[],n=[];for(let r=0;r<e.doc.sel.ranges.length;r++){let s=e.doc.sel.ranges[r].head.line,o={anchor:i.Pos(s,0),head:i.Pos(s+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}},disableBrowserMagic:p,hiddenTextarea:function(){let e=o.elt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=o.elt("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");s.webkit?e.style.width="1000px":e.setAttribute("wrap","off");s.ios&&(e.style.border="1px solid black");return p(e),t}}}),define("skylark-codemirror-base/edit/methods",["./deleteNearSelection","./commands","../model/document_data","../util/dom","../util/event","../line/highlight","../input/indent","../input/input","./key_events","./mouse_events","../input/keymap","../input/movement","../display/operations","../line/pos","../measurement/position_measurement","../model/selection","../model/selection_updates","../display/scrolling","../line/spans","../display/update_display","../util/misc","../util/operation_group","../line/utils_line","../display/view_tracking","../display/highlight_worker","../display/line_numbers","../display/scrollbars"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v,y,k,b,x,w,_,C,S,A){"use strict";function M(e,t,i,n,r){let s=t,o=i,a=w.getLine(e,t.line);function l(n){let s;if(null==(s=r?u.moveVisually(e.cm,a,t,i):u.moveLogically(a,t,i))){if(n||!function(){let n=t.line+i;return!(n<e.first||n>=e.first+e.size)&&(t=new f.Pos(n,t.ch,t.sticky),a=w.getLine(e,n))}())return!1;t=u.endOfLine(r,e.cm,a,t.line,i)}else t=s;return!0}if("char"==n)l();else if("column"==n)l(!0);else if("word"==n||"group"==n){let r=null,s="group"==n,o=e.cm&&e.cm.getHelper(t,"wordChars");for(let e=!0;!(i<0)||l(!e);e=!1){let n=a.text.charAt(t.ch)||"\n",c=b.isWordChar(n,o)?"w":s&&"\n"==n?"n":!s||/\s/.test(n)?null:"p";if(!s||e||c||(c="s"),r&&r!=c){i<0&&(i=1,l(),t.sticky="after");break}if(c&&(r=c),i>0&&!l(!e))break}}let c=g.skipAtomic(e,t,s,o,!0);return f.equalCursorPos(s,c)&&(c.hitSide=!0),c}function T(e,t,i,n){let r,s,o=e.doc,a=t.left;if("page"==n){let n=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),s=Math.max(n-.5*p.textHeight(e.display),3);r=(i>0?t.bottom:t.top)+i*s}else"line"==n&&(r=i>0?t.bottom+3:t.top-3);for(;(s=p.coordsChar(e,a,r)).outside;){if(i<0?r<=0:r>=o.height){s.hitSide=!0;break}r+=5*i}return s}return function(u){let L=u.optionHandlers,$=u.helpers={};u.prototype={constructor:u,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){let i=this.options,n=i[e];i[e]==t&&"mode"!=e||(i[e]=t,L.hasOwnProperty(e)&&d.operation(this,L[e])(this,t,n),r.signal(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](h.getKeyMap(e))},removeKeyMap:function(e){let t=this.state.keyMaps;for(let i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:d.methodOp(function(e,t){let i=e.token?e:u.getMode(this.options,e);if(i.startState)throw new Error("Overlays may not be stateful.");b.insertSorted(this.state.overlays,{mode:i,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},e=>e.priority),this.state.modeGen++,_.regChange(this)}),removeOverlay:d.methodOp(function(e){let t=this.state.overlays;for(let i=0;i<t.length;++i){let n=t[i].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(i,1),this.state.modeGen++,void _.regChange(this)}}),indentLine:d.methodOp(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),w.isLine(this.doc,e)&&o.indentLine(this,e,t,i)}),indentSelection:d.methodOp(function(e){let t=this.doc.sel.ranges,i=-1;for(let n=0;n<t.length;n++){let r=t[n];if(r.empty())r.head.line>i&&(o.indentLine(this,r.head.line,e,!0),i=r.head.line,n==this.doc.sel.primIndex&&v.ensureCursorVisible(this));else{let s=r.from(),a=r.to(),l=Math.max(i,s.line);i=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(let t=l;t<i;++t)o.indentLine(this,t,e);let c=this.doc.sel.ranges;0==s.ch&&t.length==c.length&&c[n].from().ch>0&&g.replaceOneSelection(this.doc,n,new m.Range(s,c[n].to()),b.sel_dontScroll)}}}),getTokenAt:function(e,t){return s.takeToken(this,e,t)},getLineTokens:function(e,t){return s.takeToken(this,f.Pos(e),t,!0)},getTokenTypeAt:function(e){e=f.clipPos(this.doc,e);let t,i=s.getLineStyles(this,w.getLine(this.doc,e.line)),n=0,r=(i.length-1)/2,o=e.ch;if(0==o)t=i[2];else for(;;){let e=n+r>>1;if((e?i[2*e-1]:0)>=o)r=e;else{if(!(i[2*e+1]<o)){t=i[2*e+2];break}n=e+1}}let a=t?t.indexOf("overlay "):-1;return a<0?t:0==a?null:t.slice(0,a-1)},getModeAt:function(e){let t=this.doc.mode;return t.innerMode?u.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){let i=[];if(!$.hasOwnProperty(t))return i;let n=$[t],r=this.getModeAt(e);if("string"==typeof r[t])n[r[t]]&&i.push(n[r[t]]);else if(r[t])for(let e=0;e<r[t].length;e++){let s=n[r[t][e]];s&&i.push(s)}else r.helperType&&n[r.helperType]?i.push(n[r.helperType]):n[r.name]&&i.push(n[r.name]);for(let e=0;e<n._global.length;e++){let t=n._global[e];t.pred(r,this)&&-1==b.indexOf(i,t.val)&&i.push(t.val)}return i},getStateAfter:function(e,t){let i=this.doc;return e=f.clipLine(i,null==e?i.first+i.size-1:e),s.getContextBefore(this,e+1,t).state},cursorCoords:function(e,t){let i,n=this.doc.sel.primary();return i=null==e?n.head:"object"==typeof e?f.clipPos(this.doc,e):e?n.from():n.to(),p.cursorCoords(this,i,t||"page")},charCoords:function(e,t){return p.charCoords(this,f.clipPos(this.doc,e),t||"page")},coordsChar:function(e,t){return e=p.fromCoordSystem(this,e,t||"page"),p.coordsChar(this,e.left,e.top)},lineAtHeight:function(e,t){return e=p.fromCoordSystem(this,{top:e,left:0},t||"page").top,w.lineAtHeight(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,i){let n,r=!1;if("number"==typeof e){let t=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>t&&(e=t,r=!0),n=w.getLine(this.doc,e)}else n=e;return p.intoCoordSystem(this,n,{top:0,left:0},t||"page",i||r).top+(r?this.doc.height-y.heightAtLine(n):0)},defaultTextHeight:function(){return p.textHeight(this.display)},defaultCharWidth:function(){return p.charWidth(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,n,r){let s=this.display,o=(e=p.cursorCoords(this,f.clipPos(this.doc,e))).bottom,a=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),s.sizer.appendChild(t),"over"==n)o=e.top;else if("above"==n||"near"==n){let i=Math.max(s.wrapper.clientHeight,this.doc.height),r=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>i)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=i&&(o=e.bottom),a+t.offsetWidth>r&&(a=r-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="","right"==r?(a=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?a=0:"middle"==r&&(a=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=a+"px"),i&&v.scrollIntoView(this,{left:a,top:o,right:a+t.offsetWidth,bottom:o+t.offsetHeight})},triggerOnKeyDown:d.methodOp(l.onKeyDown),triggerOnKeyPress:d.methodOp(l.onKeyPress),triggerOnKeyUp:l.onKeyUp,triggerOnMouseDown:d.methodOp(c.onMouseDown),execCommand:function(e){if(t.commands.hasOwnProperty(e))return t.commands[e].call(null,this)},triggerElectric:d.methodOp(function(e){a.triggerElectric(this,e)}),findPosH:function(e,t,i,n){let r=1;t<0&&(r=-1,t=-t);let s=f.clipPos(this.doc,e);for(let e=0;e<t&&!(s=M(this.doc,s,r,i,n)).hitSide;++e);return s},moveH:d.methodOp(function(e,t){this.extendSelectionsBy(i=>this.display.shift||this.doc.extend||i.empty()?M(this.doc,i.head,e,t,this.options.rtlMoveVisually):e<0?i.from():i.to(),b.sel_move)}),deleteH:d.methodOp(function(t,i){let n=this.doc.sel,r=this.doc;n.somethingSelected()?r.replaceSelection("",null,"+delete"):e.deleteNearSelection(this,e=>{let n=M(r,e.head,t,i,!1);return t<0?{from:n,to:e.head}:{from:e.head,to:n}})}),findPosV:function(e,t,i,n){let r=1,s=n;t<0&&(r=-1,t=-t);let o=f.clipPos(this.doc,e);for(let e=0;e<t;++e){let e=p.cursorCoords(this,o,"div");if(null==s?s=e.left:e.left=s,(o=T(this,e,r,i)).hitSide)break}return o},moveV:d.methodOp(function(e,t){let i=this.doc,n=[],r=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(s=>{if(r)return e<0?s.from():s.to();let o=p.cursorCoords(this,s.head,"div");null!=s.goalColumn&&(o.left=s.goalColumn),n.push(o.left);let a=T(this,o,e,t);return"page"==t&&s==i.sel.primary()&&v.addToScrollTop(this,p.charCoords(this,a,"div").top-o.top),a},b.sel_move),n.length)for(let e=0;e<i.sel.ranges.length;e++)i.sel.ranges[e].goalColumn=n[e]}),findWordAt:function(e){let t=this.doc,i=w.getLine(t,e.line).text,n=e.ch,r=e.ch;if(i){let t=this.getHelper(e,"wordChars");"before"!=e.sticky&&r!=i.length||!n?++r:--n;let s=i.charAt(n),o=b.isWordChar(s,t)?e=>b.isWordChar(e,t):/\s/.test(s)?e=>/\s/.test(e):e=>!/\s/.test(e)&&!b.isWordChar(e);for(;n>0&&o(i.charAt(n-1));)--n;for(;r<i.length&&o(i.charAt(r));)++r}return new m.Range(f.Pos(e.line,n),f.Pos(e.line,r))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?n.addClass(this.display.cursorDiv,"CodeMirror-overwrite"):n.rmClass(this.display.cursorDiv,"CodeMirror-overwrite"),r.signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==n.activeElt()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:d.methodOp(function(e,t){v.scrollToCoords(this,e,t)}),getScrollInfo:function(){let e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-p.scrollGap(this)-this.display.barHeight,width:e.scrollWidth-p.scrollGap(this)-this.display.barWidth,clientHeight:p.displayHeight(this),clientWidth:p.displayWidth(this)}},scrollIntoView:d.methodOp(function(e,t){null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:f.Pos(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?v.scrollToRange(this,e):v.scrollToCoordsRange(this,e.from,e.to,e.margin)}),setSize:d.methodOp(function(e,t){let i=e=>"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e;null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&p.clearLineMeasurementCache(this);let n=this.display.viewFrom;this.doc.iter(n,this.display.viewTo,e=>{if(e.widgets)for(let t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){_.regLineChange(this,n,"widget");break}++n}),this.curOp.forceUpdate=!0,r.signal(this,"refresh",this)}),operation:function(e){return d.runInOp(this,e)},startOperation:function(){return d.startOperation(this)},endOperation:function(){return d.endOperation(this)},refresh:d.methodOp(function(){let e=this.display.cachedTextHeight;_.regChange(this),this.curOp.forceUpdate=!0,p.clearCaches(this),v.scrollToCoords(this,this.doc.scrollLeft,this.doc.scrollTop),k.updateGutterSpace(this),(null==e||Math.abs(e-p.textHeight(this.display))>.5)&&p.estimateLineHeights(this),r.signal(this,"refresh",this)}),swapDoc:d.methodOp(function(e){let t=this.doc;return t.cm=null,i.attachDoc(this,e),p.clearCaches(this),this.display.input.reset(),v.scrollToCoords(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,x.signalLater(this,"swapDoc",this,t),t}),phrase:function(e){let t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters},startWorker:function(e){return C.startWorker(this,e)},maybeUpdateLineNumberWidth:function(){return S.maybeUpdateLineNumberWidth(this)},measureForScrollbars:function(){return A.measureForScrollbars(this)},updateScrollbars:function(e){return A.updateScrollbars(this,e)}},r.eventMixin(u),u.registerHelper=function(e,t,i){$.hasOwnProperty(e)||($[e]=u[e]={_global:[]}),$[e][t]=i},u.registerGlobalHelper=function(e,t,i,n){u.registerHelper(e,t,n),$[e]._global.push({pred:i,val:n})}}}),define("skylark-codemirror-base/input/ContentEditableInput",["../display/operations","../display/selection","../display/view_tracking","./input","../line/pos","../line/utils_line","../measurement/position_measurement","../model/changes","../model/selection","../model/selection_updates","../util/bidi","../util/browser","../util/dom","../util/event","../util/misc"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p){"use strict";class m{constructor(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new p.Delayed,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}init(t){let i=this,r=i.cm,s=i.div=t.lineDiv;function o(e){if(f.signalDOMEvent(r,e))return;if(r.somethingSelected())n.setLastCopied({lineWise:!1,text:r.getSelections()}),"cut"==e.type&&r.replaceSelection("",null,"cut");else{if(!r.options.lineWiseCopyCut)return;{let t=n.copyableRanges(r);n.setLastCopied({lineWise:!0,text:t.text}),"cut"==e.type&&r.operation(()=>{r.setSelections(t.ranges,0,p.sel_dontScroll),r.replaceSelection("",null,"cut")})}}if(e.clipboardData){e.clipboardData.clearData();let t=n.lastCopied.text.join("\n");if(e.clipboardData.setData("Text",t),e.clipboardData.getData("Text")==t)return void e.preventDefault()}let t=n.hiddenTextarea(),o=t.firstChild;r.display.lineSpace.insertBefore(t,r.display.lineSpace.firstChild),o.value=n.lastCopied.text.join("\n");let a=document.activeElement;d.selectInput(o),setTimeout(()=>{r.display.lineSpace.removeChild(t),a.focus(),a==s&&i.showPrimarySelection()},50)}n.disableBrowserMagic(s,r.options.spellcheck,r.options.autocorrect,r.options.autocapitalize),f.on(s,"paste",t=>{f.signalDOMEvent(r,t)||n.handlePaste(t,r)||u.ie_version<=11&&setTimeout(e.operation(r,()=>this.updateFromDOM()),20)}),f.on(s,"compositionstart",e=>{this.composing={data:e.data,done:!1}}),f.on(s,"compositionupdate",e=>{this.composing||(this.composing={data:e.data,done:!1})}),f.on(s,"compositionend",e=>{this.composing&&(e.data!=this.composing.data&&this.readFromDOMSoon(),this.composing.done=!0)}),f.on(s,"touchstart",()=>i.forceCompositionEnd()),f.on(s,"input",()=>{this.composing||this.readFromDOMSoon()}),f.on(s,"copy",o),f.on(s,"cut",o)}prepareSelection(){let e=t.prepareSelection(this.cm,!1);return e.focus=this.cm.state.focused,e}showSelection(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))}getSelection(){return this.cm.display.wrapper.ownerDocument.getSelection()}showPrimarySelection(){let e=this.getSelection(),t=this.cm,i=t.doc.sel.primary(),n=i.from(),s=i.to();if(t.display.viewTo==t.display.viewFrom||n.line>=t.display.viewTo||s.line<t.display.viewFrom)return void e.removeAllRanges();let o=y(t,e.anchorNode,e.anchorOffset),a=y(t,e.focusNode,e.focusOffset);if(o&&!o.bad&&a&&!a.bad&&0==r.cmp(r.minPos(o,a),n)&&0==r.cmp(r.maxPos(o,a),s))return;let l=t.display.view,c=n.line>=t.display.viewFrom&&g(t,n)||{node:l[0].measure.map[2],offset:0},h=s.line<t.display.viewTo&&g(t,s);if(!h){let e=l[l.length-1].measure,t=e.maps?e.maps[e.maps.length-1]:e.map;h={node:t[t.length-1],offset:t[t.length-2]-t[t.length-3]}}if(!c||!h)return void e.removeAllRanges();let f,p=e.rangeCount&&e.getRangeAt(0);try{f=d.range(c.node,c.offset,h.offset,h.node)}catch(e){}f&&(!u.gecko&&t.state.focused?(e.collapse(c.node,c.offset),f.collapsed||(e.removeAllRanges(),e.addRange(f))):(e.removeAllRanges(),e.addRange(f)),p&&null==e.anchorNode?e.addRange(p):u.gecko&&this.startGracePeriod()),this.rememberSelection()}startGracePeriod(){clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(()=>{this.gracePeriod=!1,this.selectionChanged()&&this.cm.operation(()=>this.cm.curOp.selectionChanged=!0)},20)}showMultipleSelections(e){d.removeChildrenAndAdd(this.cm.display.cursorDiv,e.cursors),d.removeChildrenAndAdd(this.cm.display.selectionDiv,e.selection)}rememberSelection(){let e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset}selectionInEditor(){let e=this.getSelection();if(!e.rangeCount)return!1;let t=e.getRangeAt(0).commonAncestorContainer;return d.contains(this.div,t)}focus(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())}blur(){this.div.blur()}getField(){return this.div}supportsTouch(){return!0}receivedFocus(){let t=this;this.selectionInEditor()?this.pollSelection():e.runInOp(this.cm,()=>t.cm.curOp.selectionChanged=!0),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})}selectionChanged(){let e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset}pollSelection(){if(null!=this.readDOMTimeout||this.gracePeriod||!this.selectionChanged())return;let t=this.getSelection(),i=this.cm;if(u.android&&u.chrome&&this.cm.options.gutters.length&&function(e){for(let t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(this.composing)return;this.rememberSelection();let n=y(i,t.anchorNode,t.anchorOffset),r=y(i,t.focusNode,t.focusOffset);n&&r&&e.runInOp(i,()=>{c.setSelection(i.doc,l.simpleSelection(n,r),p.sel_dontScroll),(n.bad||r.bad)&&(i.curOp.selectionChanged=!0)})}pollContent(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);let e,t,i,n=this.cm,l=n.display,c=n.doc.sel.primary(),h=c.from(),u=c.to();if(0==h.ch&&h.line>n.firstLine()&&(h=r.Pos(h.line-1,s.getLine(n.doc,h.line-1).length)),u.ch==s.getLine(n.doc,u.line).text.length&&u.line<n.lastLine()&&(u=r.Pos(u.line+1,0)),h.line<l.viewFrom||u.line>l.viewTo-1)return!1;h.line==l.viewFrom||0==(e=o.findViewIndex(n,h.line))?(t=s.lineNo(l.view[0].line),i=l.view[0].node):(t=s.lineNo(l.view[e].line),i=l.view[e-1].node.nextSibling);let d,f,m=o.findViewIndex(n,u.line);if(m==l.view.length-1?(d=l.viewTo-1,f=l.lineDiv.lastChild):(d=s.lineNo(l.view[m+1].line)-1,f=l.view[m+1].node.previousSibling),!i)return!1;let g=n.doc.splitLines(function(e,t,i,n,o){let a="",l=!1,c=e.doc.lineSeparator(),h=!1;function u(){l&&(a+=c,h&&(a+=c),l=h=!1)}function d(e){e&&(u(),a+=e)}function f(t){if(1==t.nodeType){let a=t.getAttribute("cm-text");if(a)return void d(a);let p,m=t.getAttribute("cm-marker");if(m){let t=e.findMarks(r.Pos(n,0),r.Pos(o+1,0),(i=+m,e=>e.id==i));return void(t.length&&(p=t[0].find(0))&&d(s.getBetween(e.doc,p.from,p.to).join(c)))}if("false"==t.getAttribute("contenteditable"))return;let g=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(!/^br$/i.test(t.nodeName)&&0==t.textContent.length)return;g&&u();for(let e=0;e<t.childNodes.length;e++)f(t.childNodes[e]);/^(pre|p)$/i.test(t.nodeName)&&(h=!0),g&&(l=!0)}else 3==t.nodeType&&d(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var i}for(;f(t),t!=i;)t=t.nextSibling,h=!1;return a}(n,i,f,t,d)),v=s.getBetween(n.doc,r.Pos(t,0),r.Pos(d,s.getLine(n.doc,d).text.length));for(;g.length>1&&v.length>1;)if(p.lst(g)==p.lst(v))g.pop(),v.pop(),d--;else{if(g[0]!=v[0])break;g.shift(),v.shift(),t++}let y=0,k=0,b=g[0],x=v[0],w=Math.min(b.length,x.length);for(;y<w&&b.charCodeAt(y)==x.charCodeAt(y);)++y;let _=p.lst(g),C=p.lst(v),S=Math.min(_.length-(1==g.length?y:0),C.length-(1==v.length?y:0));for(;k<S&&_.charCodeAt(_.length-k-1)==C.charCodeAt(C.length-k-1);)++k;if(1==g.length&&1==v.length&&t==h.line)for(;y&&y>h.ch&&_.charCodeAt(_.length-k-1)==C.charCodeAt(C.length-k-1);)y--,k++;g[g.length-1]=_.slice(0,_.length-k).replace(/^\u200b+/,""),g[0]=g[0].slice(y).replace(/\u200b+$/,"");let A=r.Pos(t,y),M=r.Pos(d,v.length?p.lst(v).length-k:0);return g.length>1||g[0]||r.cmp(A,M)?(a.replaceRange(n.doc,g,A,M,"+input"),!0):void 0}ensurePolled(){this.forceCompositionEnd()}reset(){this.forceCompositionEnd()}forceCompositionEnd(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())}readFromDOMSoon(){null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(()=>{if(this.readDOMTimeout=null,this.composing){if(!this.composing.done)return;this.composing=null}this.updateFromDOM()},80))}updateFromDOM(){!this.cm.isReadOnly()&&this.pollContent()||e.runInOp(this.cm,()=>i.regChange(this.cm))}setUneditable(e){e.contentEditable="false"}onKeyPress(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||e.operation(this.cm,n.applyTextInput)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))}readOnlyChanged(e){this.div.contentEditable=String("nocursor"!=e)}onContextMenu(){}resetPosition(){}}function g(e,t){let i=o.findViewForLine(e,t.line);if(!i||i.hidden)return null;let n=s.getLine(e.doc,t.line),r=o.mapFromLineView(i,n,t.line),a=h.getOrder(n,e.doc.direction),l="left";if(a){let e=h.getBidiPartAt(a,t.ch);l=e%2?"right":"left"}let c=o.nodeAndOffsetInLineMap(r.map,t.ch,l);return c.offset="right"==c.collapse?c.end:c.start,c}function v(e,t){return t&&(e.bad=!0),e}function y(e,t,i){let n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[i]))return v(e.clipPos(r.Pos(e.display.viewTo-1)),!0);t=null,i=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(let r=0;r<e.display.view.length;r++){let s=e.display.view[r];if(s.node==n)return k(s,t,i)}}function k(e,t,i){let n=e.text.firstChild,o=!1;if(!t||!d.contains(n,t))return v(r.Pos(s.lineNo(e.line),0),!0);if(t==n&&(o=!0,t=n.childNodes[i],i=0,!t)){let t=e.rest?p.lst(e.rest):e.line;return v(r.Pos(s.lineNo(t),t.text.length),o)}let a=3==t.nodeType?t:null,l=t;for(a||1!=t.childNodes.length||3!=t.firstChild.nodeType||(a=t.firstChild,i&&(i=a.nodeValue.length));l.parentNode!=n;)l=l.parentNode;let c=e.measure,h=c.maps;function u(t,i,n){for(let o=-1;o<(h?h.length:0);o++){let a=o<0?c.map:h[o];for(let l=0;l<a.length;l+=3){let c=a[l+2];if(c==t||c==i){let i=s.lineNo(o<0?e.line:e.rest[o]),h=a[l]+n;return(n<0||c!=t)&&(h=a[l+(n?1:0)]),r.Pos(i,h)}}}}let f=u(a,l,i);if(f)return v(f,o);for(let e=l.nextSibling,t=a?a.nodeValue.length-i:0;e;e=e.nextSibling){if(f=u(e,e.firstChild,0))return v(r.Pos(f.line,f.ch-t),o);t+=e.textContent.length}for(let e=l.previousSibling,t=i;e;e=e.previousSibling){if(f=u(e,e.firstChild,-1))return v(r.Pos(f.line,f.ch+t),o);t+=e.textContent.length}}return m.prototype.needsContentAttribute=!0,m}),define("skylark-codemirror-base/input/TextareaInput",["../display/operations","../display/selection","./input","../measurement/position_measurement","../measurement/widgets","../model/selection","../model/selection_updates","../util/browser","../util/dom","../util/event","../util/feature_detection","../util/misc"],function(e,t,i,n,r,s,o,a,l,c,h,u){"use strict";class d{constructor(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new u.Delayed,this.hasSelection=!1,this.composing=null}init(e){let t=this,n=this.cm;this.createField(e);const s=this.textarea;function o(e){if(!c.signalDOMEvent(n,e)){if(n.somethingSelected())i.setLastCopied({lineWise:!1,text:n.getSelections()});else{if(!n.options.lineWiseCopyCut)return;{let r=i.copyableRanges(n);i.setLastCopied({lineWise:!0,text:r.text}),"cut"==e.type?n.setSelections(r.ranges,null,u.sel_dontScroll):(t.prevInput="",s.value=r.text.join("\n"),l.selectInput(s))}}"cut"==e.type&&(n.state.cutIncoming=+new Date)}}e.wrapper.insertBefore(this.wrapper,e.wrapper.firstChild),a.ios&&(s.style.width="0px"),c.on(s,"input",()=>{a.ie&&a.ie_version>=9&&this.hasSelection&&(this.hasSelection=null),t.poll()}),c.on(s,"paste",e=>{c.signalDOMEvent(n,e)||i.handlePaste(e,n)||(n.state.pasteIncoming=+new Date,t.fastPoll())}),c.on(s,"cut",o),c.on(s,"copy",o),c.on(e.scroller,"paste",i=>{if(r.eventInWidget(e,i)||o.signalDOMEvent(n,i))return;if(!s.dispatchEvent)return n.state.pasteIncoming=+new Date,void t.focus();const o=new Event("paste");o.clipboardData=i.clipboardData,s.dispatchEvent(o)}),c.on(e.lineSpace,"selectstart",t=>{r.eventInWidget(e,t)||c.e_preventDefault(t)}),c.on(s,"compositionstart",()=>{let e=n.getCursor("from");t.composing&&t.composing.range.clear(),t.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),c.on(s,"compositionend",()=>{t.composing&&(t.poll(),t.composing.range.clear(),t.composing=null)})}createField(e){this.wrapper=i.hiddenTextarea(),this.textarea=this.wrapper.firstChild}prepareSelection(){let e=this.cm,i=e.display,r=e.doc,s=t.prepareSelection(e);if(e.options.moveInputWithCursor){let t=n.cursorCoords(e,r.sel.primary().head,"div"),o=i.wrapper.getBoundingClientRect(),a=i.lineDiv.getBoundingClientRect();s.teTop=Math.max(0,Math.min(i.wrapper.clientHeight-10,t.top+a.top-o.top)),s.teLeft=Math.max(0,Math.min(i.wrapper.clientWidth-10,t.left+a.left-o.left))}return s}showSelection(e){let t=this.cm,i=t.display;l.removeChildrenAndAdd(i.cursorDiv,e.cursors),l.removeChildrenAndAdd(i.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")}reset(e){if(this.contextMenuPending||this.composing)return;let t=this.cm;if(t.somethingSelected()){this.prevInput="";let e=t.getSelection();this.textarea.value=e,t.state.focused&&l.selectInput(this.textarea),a.ie&&a.ie_version>=9&&(this.hasSelection=e)}else e||(this.prevInput=this.textarea.value="",a.ie&&a.ie_version>=9&&(this.hasSelection=null))}getField(){return this.textarea}supportsTouch(){return!1}focus(){if("nocursor"!=this.cm.options.readOnly&&(!a.mobile||l.activeElt()!=this.textarea))try{this.textarea.focus()}catch(e){}}blur(){this.textarea.blur()}resetPosition(){this.wrapper.style.top=this.wrapper.style.left=0}receivedFocus(){this.slowPoll()}slowPoll(){this.pollingFast||this.polling.set(this.cm.options.pollInterval,()=>{this.poll(),this.cm.state.focused&&this.slowPoll()})}fastPoll(){let e=!1,t=this;t.pollingFast=!0,t.polling.set(20,function i(){let n=t.poll();n||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,i))})}poll(){let t=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!t.state.focused||h.hasSelection(n)&&!r&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;let s=n.value;if(s==r&&!t.somethingSelected())return!1;if(a.ie&&a.ie_version>=9&&this.hasSelection===s||a.mac&&/[\uf700-\uf7ff]/.test(s))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){let e=s.charCodeAt(0);if(8203!=e||r||(r="​"),8666==e)return this.reset(),this.cm.execCommand("undo")}let o=0,l=Math.min(r.length,s.length);for(;o<l&&r.charCodeAt(o)==s.charCodeAt(o);)++o;return e.runInOp(t,()=>{i.applyTextInput(t,s.slice(o),r.length-o,null,this.composing?"*compose":null),s.length>1e3||s.indexOf("\n")>-1?n.value=this.prevInput="":this.prevInput=s,this.composing&&(this.composing.range.clear(),this.composing.range=t.markText(this.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0}ensurePolled(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)}onKeyPress(){a.ie&&a.ie_version>=9&&(this.hasSelection=null),this.fastPoll()}onContextMenu(t){let i=this,r=i.cm,l=r.display,h=i.textarea;i.contextMenuPending&&i.contextMenuPending();let d=n.posFromMouse(r,t),f=l.scroller.scrollTop;if(!d||a.presto)return;let p=r.options.resetSelectionOnContextMenu;p&&-1==r.doc.sel.contains(d)&&e.operation(r,o.setSelection)(r.doc,s.simpleSelection(d),u.sel_dontScroll);let m,g=h.style.cssText,v=i.wrapper.style.cssText,y=i.wrapper.offsetParent.getBoundingClientRect();function k(){if(null!=h.selectionStart){let e=r.somethingSelected(),t="​"+(e?h.value:"");h.value="⇚",h.value=t,i.prevInput=e?"":"​",h.selectionStart=1,h.selectionEnd=t.length,l.selForContextMenu=r.doc.sel}}function b(){if(i.contextMenuPending==b&&(i.contextMenuPending=!1,i.wrapper.style.cssText=v,h.style.cssText=g,a.ie&&a.ie_version<9&&l.scrollbars.setScrollTop(l.scroller.scrollTop=f),null!=h.selectionStart)){(!a.ie||a.ie&&a.ie_version<9)&&k();let t=0,n=()=>{l.selForContextMenu==r.doc.sel&&0==h.selectionStart&&h.selectionEnd>0&&"​"==i.prevInput?e.operation(r,o.selectAll)(r):t++<10?l.detectingSelectAll=setTimeout(n,500):(l.selForContextMenu=null,l.input.reset())};l.detectingSelectAll=setTimeout(n,200)}}if(i.wrapper.style.cssText="position: static",h.style.cssText=`position: absolute; width: 30px; height: 30px;\n      top: ${t.clientY-y.top-5}px; left: ${t.clientX-y.left-5}px;\n      z-index: 1000; background: ${a.ie?"rgba(255, 255, 255, .05)":"transparent"};\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);`,a.webkit&&(m=window.scrollY),l.input.focus(),a.webkit&&window.scrollTo(null,m),l.input.reset(),r.somethingSelected()||(h.value=i.prevInput=" "),i.contextMenuPending=b,l.selForContextMenu=r.doc.sel,clearTimeout(l.detectingSelectAll),a.ie&&a.ie_version>=9&&k(),a.captureRightClick){c.e_stop(t);let e=()=>{c.off(window,"mouseup",e),setTimeout(b,20)};c.on(window,"mouseup",e)}else setTimeout(b,50)}readOnlyChanged(e){e||this.reset(),this.textarea.disabled="nocursor"==e}setUneditable(){}}return d.prototype.needsContentAttribute=!1,d}),define("skylark-codemirror-base/edit/fromTextArea",["./CodeMirror","../util/dom","../util/event","../util/misc"],function(e,t,i,n){"use strict";return{fromTextArea:function(r,s){(s=s?n.copyObj(s):{}).value=r.value,!s.tabindex&&r.tabIndex&&(s.tabindex=r.tabIndex);!s.placeholder&&r.placeholder&&(s.placeholder=r.placeholder);if(null==s.autofocus){let e=t.activeElt();s.autofocus=e==r||null!=r.getAttribute("autofocus")&&e==document.body}function o(){r.value=l.getValue()}let a;if(r.form&&(i.on(r.form,"submit",o),!s.leaveSubmitMethodAlone)){let e=r.form;a=e.submit;try{let t=e.submit=(()=>{o(),e.submit=a,e.submit(),e.submit=t})}catch(e){}}s.finishInit=(e=>{e.save=o,e.getTextArea=(()=>r),e.toTextArea=(()=>{e.toTextArea=isNaN,o(),r.parentNode.removeChild(e.getWrapperElement()),r.style.display="",r.form&&(i.off(r.form,"submit",o),"function"==typeof r.form.submit&&(r.form.submit=a))})}),r.style.display="none";let l=e(e=>r.parentNode.insertBefore(e,r.nextSibling),s);return l}}}),define("skylark-codemirror-base/edit/legacy",["../display/scrollbars","../display/scroll_events","../input/keymap","../input/keynames","../line/line_data","../line/pos","../model/change_measurement","../model/Doc","../model/line_widget","../model/mark_text","../modes","../util/dom","../util/event","../util/feature_detection","../util/misc","../util/StringStream","./commands"],function(e,t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g){"use strict";return{addLegacyProps:function(v){v.off=d.off,v.on=d.on,v.wheelEventPixels=t.wheelEventPixels,v.Doc=a,v.splitLines=f.splitLinesAuto,v.countColumn=p.countColumn,v.findColumn=p.findColumn,v.isWordChar=p.isWordCharBasic,v.Pass=p.Pass,v.signal=d.signal,v.Line=r.Line,v.changeEnd=o.changeEnd,v.scrollbarModel=e.scrollbarModel,v.Pos=s.Pos,v.cmpPos=s.cmp,v.modes=h.modes,v.mimeModes=h.mimeModes,v.resolveMode=h.resolveMode,v.getMode=h.getMode,v.modeExtensions=h.modeExtensions,v.extendMode=h.extendMode,v.copyState=h.copyState,v.startState=h.startState,v.innerMode=h.innerMode,v.commands=g.commands,v.keyMap=i.keyMap,v.keyName=i.keyName,v.isModifierKey=i.isModifierKey,v.lookupKey=i.lookupKey,v.normalizeKeyMap=i.normalizeKeyMap,v.StringStream=m,v.SharedTextMarker=c.SharedTextMarker,v.TextMarker=c.TextMarker,v.LineWidget=l.LineWidget,v.e_preventDefault=d.e_preventDefault,v.e_stopPropagation=d.e_stopPropagation,v.e_stop=d.e_stop,v.addClass=u.addClass,v.contains=u.contains,v.rmClass=u.rmClass,v.keyNames=n.keyNames}}}),define("skylark-codemirror-base/codemirror",["skylark-langx/skylark","./edit/CodeMirror","./util/event","./util/misc","./edit/options","./edit/methods","./model/Doc","./input/ContentEditableInput","./input/TextareaInput","./modes","./edit/fromTextArea","./edit/legacy"],function(e,t,i,n,r,s,o,a,l,c,h,u){"use strict";r.defineOptions(t),s(t);let d="iter insert remove copy getEditor constructor".split(" ");for(let e in o.prototype)o.prototype.hasOwnProperty(e)&&n.indexOf(d,e)<0&&(t.prototype[e]=function(e){return function(){return e.apply(this.doc,arguments)}}(o.prototype[e]));return i.eventMixin(o),t.inputStyles={textarea:l,contenteditable:a},t.defineMode=function(e){t.defaults.mode||"null"==e||(t.defaults.mode=e),c.defineMode.apply(this,arguments)},t.defineMIME=c.defineMIME,t.defineMode("null",()=>({token:e=>e.skipToEnd()})),t.defineMIME("text/plain","null"),t.defineExtension=((e,i)=>{t.prototype[e]=i}),t.defineDocExtension=((e,t)=>{o.prototype[e]=t}),t.fromTextArea=h.fromTextArea,u.addLegacyProps(t),t.version="5.45.0",e.attach("intg.CodeMirror",t)}),define("skylark-codemirror-base/main",["./codemirror"],function(e){return e}),define("skylark-codemirror-base",["skylark-codemirror-base/main"],function(e){return e}),define("skylark-codemirror/CodeMirror",["skylark-codemirror-base"],function(e){"use strict";return e}),define("skylark-widgets-base/Addon",["skylark-langx/langx","skylark-langx/Evented","./base"],function(e,t,i){var n=t.inherit({_construct:function(t,i){this._widget=t,Object.defineProperty(this,"options",{value:e.mixin({},this.options,i,!0)}),this._init&&this._init()}});return n.register=function(e){var t=this.categoryName,i=this.addonName;t&&i&&(e.addons=e.addons||{},e.addons[t]=e.addons[t]||{},e.addons[t][i]=this)},i.Addon=n}),define("skylark-widgets-coder/Addon",["skylark-domx-styler","skylark-widgets-base/Addon"],function(e,t){return class extends t{_init(){this.coder=this._widget,this.options.pluginCssClass=this.options.pluginClass||"coder-plugin-"+this.constructor.addonName,this.options.pluginCssClass&&e.addClass(this._widget._elm,this.options.pluginCssClass)}}}),define("skylark-codemirror/mode/xml/xml",["../../CodeMirror"],function(e){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},i={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};e.defineMode("xml",function(n,r){var s,o,a=n.indentUnit,l={},c=r.htmlMode?t:i;for(var h in c)l[h]=c[h];for(var h in r)l[h]=r[h];function u(e,t){function i(i){return t.tokenize=i,i(e,t)}var n=e.next();return"<"==n?e.eat("!")?e.eat("[")?e.match("CDATA[")?i(f("atom","]]>")):null:e.match("--")?i(f("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),i(function e(t){return function(i,n){for(var r;null!=(r=i.next());){if("<"==r)return n.tokenize=e(t+1),n.tokenize(i,n);if(">"==r){if(1==t){n.tokenize=u;break}return n.tokenize=e(t-1),n.tokenize(i,n)}}return"meta"}}(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=f("meta","?>"),"meta"):(s=e.eat("/")?"closeTag":"openTag",t.tokenize=d,"tag bracket"):"&"==n?(e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"))?"atom":"error":(e.eatWhile(/[^&<]/),null)}function d(e,t){var i,n,r=e.next();if(">"==r||"/"==r&&e.eat(">"))return t.tokenize=u,s=">"==r?"endTag":"selfcloseTag","tag bracket";if("="==r)return s="equals",null;if("<"==r){t.tokenize=u,t.state=g,t.tagName=t.tagStart=null;var o=t.tokenize(e,t);return o?o+" tag error":"tag error"}return/[\'\"]/.test(r)?(t.tokenize=(i=r,(n=function(e,t){for(;!e.eol();)if(e.next()==i){t.tokenize=d;break}return"string"}).isInAttribute=!0,n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function f(e,t){return function(i,n){for(;!i.eol();){if(i.match(t)){n.tokenize=u;break}i.next()}return e}}function p(e){e.context&&(e.context=e.context.prev)}function m(e,t){for(var i;;){if(!e.context)return;if(i=e.context.tagName,!l.contextGrabbers.hasOwnProperty(i)||!l.contextGrabbers[i].hasOwnProperty(t))return;p(e)}}function g(e,t,i){return"openTag"==e?(i.tagStart=t.column(),v):"closeTag"==e?y:g}function v(e,t,i){return"word"==e?(i.tagName=t.current(),o="tag",x):l.allowMissingTagName&&"endTag"==e?(o="tag bracket",x(e,t,i)):(o="error",v)}function y(e,t,i){if("word"==e){var n=t.current();return i.context&&i.context.tagName!=n&&l.implicitlyClosed.hasOwnProperty(i.context.tagName)&&p(i),i.context&&i.context.tagName==n||!1===l.matchClosing?(o="tag",k):(o="tag error",b)}return l.allowMissingTagName&&"endTag"==e?(o="tag bracket",k(e,t,i)):(o="error",b)}function k(e,t,i){return"endTag"!=e?(o="error",k):(p(i),g)}function b(e,t,i){return o="error",k(e,t,i)}function x(e,t,i){if("word"==e)return o="attribute",w;if("endTag"==e||"selfcloseTag"==e){var n=i.tagName,r=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==e||l.autoSelfClosers.hasOwnProperty(n)?m(i,n):(m(i,n),i.context=new function(e,t,i){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=i,(l.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}(i,n,r==i.indented)),g}return o="error",x}function w(e,t,i){return"equals"==e?_:(l.allowMissing||(o="error"),x(e,t,i))}function _(e,t,i){return"string"==e?C:"word"==e&&l.allowUnquoted?(o="string",x):(o="error",x(e,t,i))}function C(e,t,i){return"string"==e?C:x(e,t,i)}return u.isInText=!0,{startState:function(e){var t={tokenize:u,state:g,indented:e||0,tagName:null,tagStart:null,context:null};return null!=e&&(t.baseIndent=e),t},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;s=null;var i=t.tokenize(e,t);return(i||s)&&"comment"!=i&&(o=null,t.state=t.state(s||i,e,t),o&&(i="error"==o?i+" error":o)),i},indent:function(t,i,n){var r=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+a;if(r&&r.noIndent)return e.Pass;if(t.tokenize!=d&&t.tokenize!=u)return n?n.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==l.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+a*(l.multilineTagIndentFactor||1);if(l.alignCDATA&&/<!\[CDATA\[/.test(i))return 0;var s=i&&/^<(\/)?([\w_:\.-]*)/.exec(i);if(s&&s[1])for(;r;){if(r.tagName==s[2]){r=r.prev;break}if(!l.implicitlyClosed.hasOwnProperty(r.tagName))break;r=r.prev}else if(s)for(;r;){var o=l.contextGrabbers[r.tagName];if(!o||!o.hasOwnProperty(s[2]))break;r=r.prev}for(;r&&r.prev&&!r.startOfLine;)r=r.prev;return r?r.indent+a:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:l.htmlMode?"html":"xml",helperType:l.htmlMode?"html":"xml",skipAttribute:function(e){e.state==_&&(e.state=x)}}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}),define("skylark-codemirror/mode/css/css",["../../CodeMirror"],function(e){"use strict";function t(e){for(var t={},i=0;i<e.length;++i)t[e[i].toLowerCase()]=!0;return t}e.defineMode("css",function(t,i){var n=i.inline;i.propertyKeywords||(i=e.resolveMode("text/css"));var r,s,o=t.indentUnit,a=i.tokenHooks,l=i.documentTypes||{},c=i.mediaTypes||{},h=i.mediaFeatures||{},u=i.mediaValueKeywords||{},d=i.propertyKeywords||{},f=i.nonStandardPropertyKeywords||{},p=i.fontProperties||{},m=i.counterDescriptors||{},g=i.colorKeywords||{},v=i.valueKeywords||{},y=i.allowNested,k=i.lineComment,b=!0===i.supportsAtComponent;function x(e,t){return r=t,e}function w(e){return function(t,i){for(var n,r=!1;null!=(n=t.next());){if(n==e&&!r){")"==e&&t.backUp(1);break}r=!r&&"\\"==n}return(n==e||!r&&")"!=e)&&(i.tokenize=null),x("string","string")}}function _(e,t){return e.next(),e.match(/\s*[\"\')]/,!1)?t.tokenize=null:t.tokenize=w(")"),x(null,"(")}function C(e,t,i){this.type=e,this.indent=t,this.prev=i}function S(e,t,i,n){return e.context=new C(i,t.indentation()+(!1===n?0:o),e.context),i}function A(e){return e.context.prev&&(e.context=e.context.prev),e.context.type}function M(e,t,i){return $[i.context.type](e,t,i)}function T(e,t,i,n){for(var r=n||1;r>0;r--)i.context=i.context.prev;return M(e,t,i)}function L(e){var t=e.current().toLowerCase();s=v.hasOwnProperty(t)?"atom":g.hasOwnProperty(t)?"keyword":"variable"}var $={top:function(e,t,i){if("{"==e)return S(i,t,"block");if("}"==e&&i.context.prev)return A(i);if(b&&/@component/i.test(e))return S(i,t,"atComponentBlock");if(/^@(-moz-)?document$/i.test(e))return S(i,t,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/i.test(e))return S(i,t,"atBlock");if(/^@(font-face|counter-style)/i.test(e))return i.stateArg=e,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(e))return"keyframes";if(e&&"@"==e.charAt(0))return S(i,t,"at");if("hash"==e)s="builtin";else if("word"==e)s="tag";else{if("variable-definition"==e)return"maybeprop";if("interpolation"==e)return S(i,t,"interpolation");if(":"==e)return"pseudo";if(y&&"("==e)return S(i,t,"parens")}return i.context.type},block:function(e,t,i){if("word"==e){var n=t.current().toLowerCase();return d.hasOwnProperty(n)?(s="property","maybeprop"):f.hasOwnProperty(n)?(s="string-2","maybeprop"):y?(s=t.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(s+=" error","maybeprop")}return"meta"==e?"block":y||"hash"!=e&&"qualifier"!=e?$.top(e,t,i):(s="error","block")},maybeprop:function(e,t,i){return":"==e?S(i,t,"prop"):M(e,t,i)},prop:function(e,t,i){if(";"==e)return A(i);if("{"==e&&y)return S(i,t,"propBlock");if("}"==e||"{"==e)return T(e,t,i);if("("==e)return S(i,t,"parens");if("hash"!=e||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(t.current())){if("word"==e)L(t);else if("interpolation"==e)return S(i,t,"interpolation")}else s+=" error";return"prop"},propBlock:function(e,t,i){return"}"==e?A(i):"word"==e?(s="property","maybeprop"):i.context.type},parens:function(e,t,i){return"{"==e||"}"==e?T(e,t,i):")"==e?A(i):"("==e?S(i,t,"parens"):"interpolation"==e?S(i,t,"interpolation"):("word"==e&&L(t),"parens")},pseudo:function(e,t,i){return"meta"==e?"pseudo":"word"==e?(s="variable-3",i.context.type):M(e,t,i)},documentTypes:function(e,t,i){return"word"==e&&l.hasOwnProperty(t.current())?(s="tag",i.context.type):$.atBlock(e,t,i)},atBlock:function(e,t,i){if("("==e)return S(i,t,"atBlock_parens");if("}"==e||";"==e)return T(e,t,i);if("{"==e)return A(i)&&S(i,t,y?"block":"top");if("interpolation"==e)return S(i,t,"interpolation");if("word"==e){var n=t.current().toLowerCase();s="only"==n||"not"==n||"and"==n||"or"==n?"keyword":c.hasOwnProperty(n)?"attribute":h.hasOwnProperty(n)?"property":u.hasOwnProperty(n)?"keyword":d.hasOwnProperty(n)?"property":f.hasOwnProperty(n)?"string-2":v.hasOwnProperty(n)?"atom":g.hasOwnProperty(n)?"keyword":"error"}return i.context.type},atComponentBlock:function(e,t,i){return"}"==e?T(e,t,i):"{"==e?A(i)&&S(i,t,y?"block":"top",!1):("word"==e&&(s="error"),i.context.type)},atBlock_parens:function(e,t,i){return")"==e?A(i):"{"==e||"}"==e?T(e,t,i,2):$.atBlock(e,t,i)},restricted_atBlock_before:function(e,t,i){return"{"==e?S(i,t,"restricted_atBlock"):"word"==e&&"@counter-style"==i.stateArg?(s="variable","restricted_atBlock_before"):M(e,t,i)},restricted_atBlock:function(e,t,i){return"}"==e?(i.stateArg=null,A(i)):"word"==e?(s="@font-face"==i.stateArg&&!p.hasOwnProperty(t.current().toLowerCase())||"@counter-style"==i.stateArg&&!m.hasOwnProperty(t.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},keyframes:function(e,t,i){return"word"==e?(s="variable","keyframes"):"{"==e?S(i,t,"top"):M(e,t,i)},at:function(e,t,i){return";"==e?A(i):"{"==e||"}"==e?T(e,t,i):("word"==e?s="tag":"hash"==e&&(s="builtin"),"at")},interpolation:function(e,t,i){return"}"==e?A(i):"{"==e||";"==e?T(e,t,i):("word"==e?s="variable":"variable"!=e&&"("!=e&&")"!=e&&(s="error"),"interpolation")}};return{startState:function(e){return{tokenize:null,state:n?"block":"top",stateArg:null,context:new C(n?"block":"top",e||0,null)}},token:function(e,t){if(!t.tokenize&&e.eatSpace())return null;var i=(t.tokenize||function(e,t){var i=e.next();if(a[i]){var n=a[i](e,t);if(!1!==n)return n}if("@"==i)return e.eatWhile(/[\w\\\-]/),x("def",e.current());if("="==i||("~"==i||"|"==i)&&e.eat("="))return x(null,"compare");if('"'==i||"'"==i)return t.tokenize=w(i),t.tokenize(e,t);if("#"==i)return e.eatWhile(/[\w\\\-]/),x("atom","hash");if("!"==i)return e.match(/^\s*\w*/),x("keyword","important");if(/\d/.test(i)||"."==i&&e.eat(/\d/))return e.eatWhile(/[\w.%]/),x("number","unit");if("-"!==i)return/[,+>*\/]/.test(i)?x(null,"select-op"):"."==i&&e.match(/^-?[_a-z][_a-z0-9-]*/i)?x("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(i)?x(null,i):e.match(/[\w-.]+(?=\()/)?(/^(url(-prefix)?|domain|regexp)$/.test(e.current().toLowerCase())&&(t.tokenize=_),x("variable callee","variable")):/[\w\\\-]/.test(i)?(e.eatWhile(/[\w\\\-]/),x("property","word")):x(null,null);if(/[\d.]/.test(e.peek()))return e.eatWhile(/[\w.%]/),x("number","unit");if(e.match(/^-[\w\\\-]*/))return e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?x("variable-2","variable-definition"):x("variable-2","variable");if(e.match(/^\w+-/))return x("meta","meta")})(e,t);return i&&"object"==typeof i&&(r=i[1],i=i[0]),s=i,"comment"!=r&&(t.state=$[t.state](r,e,t)),s},indent:function(e,t){var i=e.context,n=t&&t.charAt(0),r=i.indent;return"prop"!=i.type||"}"!=n&&")"!=n||(i=i.prev),i.prev&&("}"!=n||"block"!=i.type&&"top"!=i.type&&"interpolation"!=i.type&&"restricted_atBlock"!=i.type?(")"!=n||"parens"!=i.type&&"atBlock_parens"!=i.type)&&("{"!=n||"at"!=i.type&&"atBlock"!=i.type)||(r=Math.max(0,i.indent-o)):(i=i.prev,r=i.indent)),r},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:k,fold:"brace"}});var i=["domain","regexp","url","url-prefix"],n=t(i),r=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],s=t(r),o=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover"],a=t(o),l=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive"],c=t(l),h=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-overflow","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],u=t(h),d=["scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-3d-light-color","scrollbar-track-color","shape-inside","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","zoom"],f=t(d),p=t(["font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"]),m=t(["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"]),g=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],v=t(g),y=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],k=t(y),b=i.concat(r).concat(o).concat(l).concat(h).concat(d).concat(g).concat(y);function x(e,t){for(var i,n=!1;null!=(i=e.next());){if(n&&"/"==i){t.tokenize=null;break}n="*"==i}return["comment","comment"]}e.registerHelper("hintWords","css",b),e.defineMIME("text/css",{documentTypes:n,mediaTypes:s,mediaFeatures:a,mediaValueKeywords:c,propertyKeywords:u,nonStandardPropertyKeywords:f,fontProperties:p,counterDescriptors:m,colorKeywords:v,valueKeywords:k,tokenHooks:{"/":function(e,t){return!!e.eat("*")&&(t.tokenize=x,x(e,t))}},name:"css"}),e.defineMIME("text/x-scss",{mediaTypes:s,mediaFeatures:a,mediaValueKeywords:c,propertyKeywords:u,nonStandardPropertyKeywords:f,colorKeywords:v,valueKeywords:k,fontProperties:p,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=x,x(e,t)):["operator","operator"]},":":function(e){return!!e.match(/\s*\{/,!1)&&[null,null]},$:function(e){return e.match(/^[\w-]+/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(e){return!!e.eat("{")&&[null,"interpolation"]}},name:"css",helperType:"scss"}),e.defineMIME("text/x-less",{mediaTypes:s,mediaFeatures:a,mediaValueKeywords:c,propertyKeywords:u,nonStandardPropertyKeywords:f,colorKeywords:v,valueKeywords:k,fontProperties:p,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(e,t){return e.eat("/")?(e.skipToEnd(),["comment","comment"]):e.eat("*")?(t.tokenize=x,x(e,t)):["operator","operator"]},"@":function(e){return e.eat("{")?[null,"interpolation"]:!e.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,!1)&&(e.eatWhile(/[\w\\\-]/),e.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),e.defineMIME("text/x-gss",{documentTypes:n,mediaTypes:s,mediaFeatures:a,propertyKeywords:u,nonStandardPropertyKeywords:f,fontProperties:p,counterDescriptors:m,colorKeywords:v,valueKeywords:k,supportsAtComponent:!0,tokenHooks:{"/":function(e,t){return!!e.eat("*")&&(t.tokenize=x,x(e,t))}},name:"css",helperType:"gss"})}),define("skylark-codemirror/mode/javascript/javascript",["../../CodeMirror"],function(e){"use strict";e.defineMode("javascript",function(t,i){var n,r,s=t.indentUnit,o=i.statementIndent,a=i.jsonld,l=i.json||a,c=i.typescript,h=i.wordCharacters||/[\w$\xa1-\uffff]/,u=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),i=e("keyword b"),n=e("keyword c"),r=e("keyword d"),s=e("operator"),o={type:"atom",style:"atom"};return{if:e("if"),while:t,with:t,else:i,do:i,try:i,finally:i,return:r,break:r,continue:r,new:e("new"),delete:n,void:n,throw:n,debugger:e("debugger"),var:e("var"),const:e("var"),let:e("var"),function:e("function"),catch:e("catch"),for:e("for"),switch:e("switch"),case:e("case"),default:e("default"),in:s,typeof:s,instanceof:s,true:o,false:o,null:o,undefined:o,NaN:o,Infinity:o,this:e("this"),class:e("class"),super:e("atom"),yield:n,export:e("export"),import:e("import"),extends:n,await:n}}(),d=/[+\-*&%=<>!?|~^@]/,f=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function p(e,t,i){return n=e,r=i,t}function m(e,t){var i,n=e.next();if('"'==n||"'"==n)return t.tokenize=(i=n,function(e,t){var n,r=!1;if(a&&"@"==e.peek()&&e.match(f))return t.tokenize=m,p("jsonld-keyword","meta");for(;null!=(n=e.next())&&(n!=i||r);)r=!r&&"\\"==n;return r||(t.tokenize=m),p("string","string")}),t.tokenize(e,t);if("."==n&&e.match(/^\d+(?:[eE][+\-]?\d+)?/))return p("number","number");if("."==n&&e.match(".."))return p("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(n))return p(n);if("="==n&&e.eat(">"))return p("=>","operator");if("0"==n&&e.match(/^(?:x[\da-f]+|o[0-7]+|b[01]+)n?/i))return p("number","number");if(/\d/.test(n))return e.match(/^\d*(?:n|(?:\.\d*)?(?:[eE][+\-]?\d+)?)?/),p("number","number");if("/"==n)return e.eat("*")?(t.tokenize=g,g(e,t)):e.eat("/")?(e.skipToEnd(),p("comment","comment")):Ke(e,t,1)?(function(e){var t,i=!1,n=!1;for(;null!=(t=e.next());){if(!i){if("/"==t&&!n)return;"["==t?n=!0:n&&"]"==t&&(n=!1)}i=!i&&"\\"==t}}(e),e.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),p("regexp","string-2")):(e.eat("="),p("operator","operator",e.current()));if("`"==n)return t.tokenize=v,v(e,t);if("#"==n)return e.skipToEnd(),p("error","error");if(d.test(n))return">"==n&&t.lexical&&">"==t.lexical.type||(e.eat("=")?"!"!=n&&"="!=n||e.eat("="):/[<>*+\-]/.test(n)&&(e.eat(n),">"==n&&e.eat(n))),p("operator","operator",e.current());if(h.test(n)){e.eatWhile(h);var r=e.current();if("."!=t.lastType){if(u.propertyIsEnumerable(r)){var s=u[r];return p(s.type,s.style,r)}if("async"==r&&e.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,!1))return p("async","keyword",r)}return p("variable","variable",r)}}function g(e,t){for(var i,n=!1;i=e.next();){if("/"==i&&n){t.tokenize=m;break}n="*"==i}return p("comment","comment")}function v(e,t){for(var i,n=!1;null!=(i=e.next());){if(!n&&("`"==i||"$"==i&&e.eat("{"))){t.tokenize=m;break}n=!n&&"\\"==i}return p("quasi","string-2",e.current())}var y="([{}])";function k(e,t){t.fatArrowAt&&(t.fatArrowAt=null);var i=e.string.indexOf("=>",e.start);if(!(i<0)){if(c){var n=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(e.string.slice(e.start,i));n&&(i=n.index)}for(var r=0,s=!1,o=i-1;o>=0;--o){var a=e.string.charAt(o),l=y.indexOf(a);if(l>=0&&l<3){if(!r){++o;break}if(0==--r){"("==a&&(s=!0);break}}else if(l>=3&&l<6)++r;else if(h.test(a))s=!0;else{if(/["'\/]/.test(a))return;if(s&&!r){++o;break}}}s&&!r&&(t.fatArrowAt=o)}}var b={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0};function x(e,t,i,n,r,s){this.indented=e,this.column=t,this.type=i,this.prev=r,this.info=s,null!=n&&(this.align=n)}function w(e,t){for(var i=e.localVars;i;i=i.next)if(i.name==t)return!0;for(var n=e.context;n;n=n.prev)for(var i=n.vars;i;i=i.next)if(i.name==t)return!0}var _={state:null,column:null,marked:null,cc:null};function C(){for(var e=arguments.length-1;e>=0;e--)_.cc.push(arguments[e])}function S(){return C.apply(null,arguments),!0}function A(e,t){for(var i=t;i;i=i.next)if(i.name==e)return!0;return!1}function M(e){var t=_.state;if(_.marked="def",t.context)if("var"==t.lexical.info&&t.context&&t.context.block){var n=function e(t,i){if(i){if(i.block){var n=e(t,i.prev);return n?n==i.prev?i:new L(n,i.vars,!0):null}return A(t,i.vars)?i:new L(i.prev,new $(t,i.vars),!1)}return null}(e,t.context);if(null!=n)return void(t.context=n)}else if(!A(e,t.localVars))return void(t.localVars=new $(e,t.localVars));i.globalVars&&!A(e,t.globalVars)&&(t.globalVars=new $(e,t.globalVars))}function T(e){return"public"==e||"private"==e||"protected"==e||"abstract"==e||"readonly"==e}function L(e,t,i){this.prev=e,this.vars=t,this.block=i}function $(e,t){this.name=e,this.next=t}var E=new $("this",new $("arguments",null));function O(){_.state.context=new L(_.state.context,_.state.localVars,!1),_.state.localVars=E}function R(){_.state.context=new L(_.state.context,_.state.localVars,!0),_.state.localVars=null}function D(){_.state.localVars=_.state.context.vars,_.state.context=_.state.context.prev}function I(e,t){var i=function(){var i=_.state,n=i.indented;if("stat"==i.lexical.type)n=i.lexical.indented;else for(var r=i.lexical;r&&")"==r.type&&r.align;r=r.prev)n=r.indented;i.lexical=new x(n,_.stream.column(),e,null,i.lexical,t)};return i.lex=!0,i}function P(){var e=_.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function N(e){return function t(i){return i==e?S():";"==e||"}"==i||")"==i||"]"==i?C():S(t)}}function F(e,t){return"var"==e?S(I("vardef",t),ye,N(";"),P):"keyword a"==e?S(I("form"),B,F,P):"keyword b"==e?S(I("form"),F,P):"keyword d"==e?_.stream.match(/^\s*$/,!1)?S():S(I("stat"),q,N(";"),P):"debugger"==e?S(N(";")):"{"==e?S(I("}"),R,oe,P,D):";"==e?S():"if"==e?("else"==_.state.lexical.info&&_.state.cc[_.state.cc.length-1]==P&&_.state.cc.pop()(),S(I("form"),B,F,P,Ce)):"function"==e?S(Te):"for"==e?S(I("form"),Se,F,P):"class"==e||c&&"interface"==t?(_.marked="keyword",S(I("form","class"==e?e:t),Re,P)):"variable"==e?c&&"declare"==t?(_.marked="keyword",S(F)):c&&("module"==t||"enum"==t||"type"==t)&&_.stream.match(/^\s*\w/,!1)?(_.marked="keyword","enum"==t?S(Ve):"type"==t?S($e,N("operator"),he,N(";")):S(I("form"),ke,N("{"),I("}"),oe,P,P)):c&&"namespace"==t?(_.marked="keyword",S(I("form"),z,F,P)):c&&"abstract"==t?(_.marked="keyword",S(F)):S(I("stat"),J):"switch"==e?S(I("form"),B,N("{"),I("}","switch"),R,oe,P,P,D):"case"==e?S(z,N(":")):"default"==e?S(N(":")):"catch"==e?S(I("form"),O,H,F,P,D):"export"==e?S(I("stat"),Ne,P):"import"==e?S(I("stat"),He,P):"async"==e?S(F):"@"==t?S(z,F):C(I("stat"),z,N(";"),P)}function H(e){if("("==e)return S(Ee,N(")"))}function z(e,t){return j(e,t,!1)}function W(e,t){return j(e,t,!0)}function B(e){return"("!=e?C():S(I(")"),z,N(")"),P)}function j(e,t,i){if(_.state.fatArrowAt==_.stream.start){var n=i?X:Y;if("("==e)return S(O,I(")"),re(Ee,")"),P,N("=>"),n,D);if("variable"==e)return C(O,ke,N("=>"),n,D)}var r=i?U:V;return b.hasOwnProperty(e)?S(r):"function"==e?S(Te,r):"class"==e||c&&"interface"==t?(_.marked="keyword",S(I("form"),Oe,P)):"keyword c"==e||"async"==e?S(i?W:z):"("==e?S(I(")"),q,N(")"),P,r):"operator"==e||"spread"==e?S(i?W:z):"["==e?S(I("]"),qe,P,r):"{"==e?se(te,"}",null,r):"quasi"==e?C(K,r):"new"==e?S(function(e){return function(t){return"."==t?S(e?Z:Q):"variable"==t&&c?S(me,e?U:V):C(e?W:z)}}(i)):"import"==e?S(z):S()}function q(e){return e.match(/[;\}\)\],]/)?C():C(z)}function V(e,t){return","==e?S(z):U(e,t,!1)}function U(e,t,i){var n=0==i?V:U,r=0==i?z:W;return"=>"==e?S(O,i?X:Y,D):"operator"==e?/\+\+|--/.test(t)||c&&"!"==t?S(n):c&&"<"==t&&_.stream.match(/^([^>]|<.*?>)*>\s*\(/,!1)?S(I(">"),re(he,">"),P,n):"?"==t?S(z,N(":"),r):S(r):"quasi"==e?C(K,n):";"!=e?"("==e?se(W,")","call",n):"."==e?S(ee,n):"["==e?S(I("]"),q,N("]"),P,n):c&&"as"==t?(_.marked="keyword",S(he,n)):"regexp"==e?(_.state.lastType=_.marked="operator",_.stream.backUp(_.stream.pos-_.stream.start-1),S(r)):void 0:void 0}function K(e,t){return"quasi"!=e?C():"${"!=t.slice(t.length-2)?S(K):S(z,G)}function G(e){if("}"==e)return _.marked="string-2",_.state.tokenize=v,S(K)}function Y(e){return k(_.stream,_.state),C("{"==e?F:z)}function X(e){return k(_.stream,_.state),C("{"==e?F:W)}function Q(e,t){if("target"==t)return _.marked="keyword",S(V)}function Z(e,t){if("target"==t)return _.marked="keyword",S(U)}function J(e){return":"==e?S(P,F):C(V,N(";"),P)}function ee(e){if("variable"==e)return _.marked="property",S()}function te(e,t){if("async"==e)return _.marked="property",S(te);if("variable"==e||"keyword"==_.style){return _.marked="property","get"==t||"set"==t?S(ie):(c&&_.state.fatArrowAt==_.stream.start&&(i=_.stream.match(/^\s*:\s*/,!1))&&(_.state.fatArrowAt=_.stream.pos+i[0].length),S(ne));var i}else{if("number"==e||"string"==e)return _.marked=a?"property":_.style+" property",S(ne);if("jsonld-keyword"==e)return S(ne);if(c&&T(t))return _.marked="keyword",S(te);if("["==e)return S(z,ae,N("]"),ne);if("spread"==e)return S(W,ne);if("*"==t)return _.marked="keyword",S(te);if(":"==e)return C(ne)}}function ie(e){return"variable"!=e?C(ne):(_.marked="property",S(Te))}function ne(e){return":"==e?S(W):"("==e?C(Te):void 0}function re(e,t,i){function n(r,s){if(i?i.indexOf(r)>-1:","==r){var o=_.state.lexical;return"call"==o.info&&(o.pos=(o.pos||0)+1),S(function(i,n){return i==t||n==t?C():C(e)},n)}return r==t||s==t?S():i&&i.indexOf(";")>-1?C(e):S(N(t))}return function(i,r){return i==t||r==t?S():C(e,n)}}function se(e,t,i){for(var n=3;n<arguments.length;n++)_.cc.push(arguments[n]);return S(I(t,i),re(e,t),P)}function oe(e){return"}"==e?S():C(F,oe)}function ae(e,t){if(c){if(":"==e||"in"==t)return S(he);if("?"==t)return S(ae)}}function le(e){if(c&&":"==e)return _.stream.match(/^\s*\w+\s+is\b/,!1)?S(z,ce,he):S(he)}function ce(e,t){if("is"==t)return _.marked="keyword",S()}function he(e,t){return"keyof"==t||"typeof"==t||"infer"==t?(_.marked="keyword",S("typeof"==t?W:he)):"variable"==e||"void"==t?(_.marked="type",S(pe)):"|"==t||"&"==t?S(he):"string"==e||"number"==e||"atom"==e?S(pe):"["==e?S(I("]"),re(he,"]",","),P,pe):"{"==e?S(I("}"),re(de,"}",",;"),P,pe):"("==e?S(re(fe,")"),ue,pe):"<"==e?S(re(he,">"),he):void 0}function ue(e){if("=>"==e)return S(he)}function de(e,t){return"variable"==e||"keyword"==_.style?(_.marked="property",S(de)):"?"==t||"number"==e||"string"==e?S(de):":"==e?S(he):"["==e?S(N("variable"),ae,N("]"),de):"("==e?C(Le,de):void 0}function fe(e,t){return"variable"==e&&_.stream.match(/^\s*[?:]/,!1)||"?"==t?S(fe):":"==e?S(he):"spread"==e?S(fe):C(he)}function pe(e,t){return"<"==t?S(I(">"),re(he,">"),P,pe):"|"==t||"."==e||"&"==t?S(he):"["==e?S(he,N("]"),pe):"extends"==t||"implements"==t?(_.marked="keyword",S(he)):"?"==t?S(he,N(":"),he):void 0}function me(e,t){if("<"==t)return S(I(">"),re(he,">"),P,pe)}function ge(){return C(he,ve)}function ve(e,t){if("="==t)return S(he)}function ye(e,t){return"enum"==t?(_.marked="keyword",S(Ve)):C(ke,ae,we,_e)}function ke(e,t){return c&&T(t)?(_.marked="keyword",S(ke)):"variable"==e?(M(t),S()):"spread"==e?S(ke):"["==e?se(xe,"]"):"{"==e?se(be,"}"):void 0}function be(e,t){return"variable"!=e||_.stream.match(/^\s*:/,!1)?("variable"==e&&(_.marked="property"),"spread"==e?S(ke):"}"==e?C():"["==e?S(z,N("]"),N(":"),be):S(N(":"),ke,we)):(M(t),S(we))}function xe(){return C(ke,we)}function we(e,t){if("="==t)return S(W)}function _e(e){if(","==e)return S(ye)}function Ce(e,t){if("keyword b"==e&&"else"==t)return S(I("form","else"),F,P)}function Se(e,t){return"await"==t?S(Se):"("==e?S(I(")"),Ae,P):void 0}function Ae(e){return"var"==e?S(ye,Me):"variable"==e?S(Me):C(Me)}function Me(e,t){return")"==e?S():";"==e?S(Me):"in"==t||"of"==t?(_.marked="keyword",S(z,Me)):C(z,Me)}function Te(e,t){return"*"==t?(_.marked="keyword",S(Te)):"variable"==e?(M(t),S(Te)):"("==e?S(O,I(")"),re(Ee,")"),P,le,F,D):c&&"<"==t?S(I(">"),re(ge,">"),P,Te):void 0}function Le(e,t){return"*"==t?(_.marked="keyword",S(Le)):"variable"==e?(M(t),S(Le)):"("==e?S(O,I(")"),re(Ee,")"),P,le,D):c&&"<"==t?S(I(">"),re(ge,">"),P,Le):void 0}function $e(e,t){return"keyword"==e||"variable"==e?(_.marked="type",S($e)):"<"==t?S(I(">"),re(ge,">"),P):void 0}function Ee(e,t){return"@"==t&&S(z,Ee),"spread"==e?S(Ee):c&&T(t)?(_.marked="keyword",S(Ee)):c&&"this"==e?S(ae,we):C(ke,ae,we)}function Oe(e,t){return"variable"==e?Re(e,t):De(e,t)}function Re(e,t){if("variable"==e)return M(t),S(De)}function De(e,t){return"<"==t?S(I(">"),re(ge,">"),P,De):"extends"==t||"implements"==t||c&&","==e?("implements"==t&&(_.marked="keyword"),S(c?he:z,De)):"{"==e?S(I("}"),Ie,P):void 0}function Ie(e,t){return"async"==e||"variable"==e&&("static"==t||"get"==t||"set"==t||c&&T(t))&&_.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(_.marked="keyword",S(Ie)):"variable"==e||"keyword"==_.style?(_.marked="property",S(c?Pe:Te,Ie)):"number"==e||"string"==e?S(c?Pe:Te,Ie):"["==e?S(z,ae,N("]"),c?Pe:Te,Ie):"*"==t?(_.marked="keyword",S(Ie)):c&&"("==e?C(Le,Ie):";"==e||","==e?S(Ie):"}"==e?S():"@"==t?S(z,Ie):void 0}function Pe(e,t){if("?"==t)return S(Pe);if(":"==e)return S(he,we);if("="==t)return S(W);var i=_.state.lexical.prev,n=i&&"interface"==i.info;return C(n?Le:Te)}function Ne(e,t){return"*"==t?(_.marked="keyword",S(je,N(";"))):"default"==t?(_.marked="keyword",S(z,N(";"))):"{"==e?S(re(Fe,"}"),je,N(";")):C(F)}function Fe(e,t){return"as"==t?(_.marked="keyword",S(N("variable"))):"variable"==e?C(W,Fe):void 0}function He(e){return"string"==e?S():"("==e?C(z):C(ze,We,je)}function ze(e,t){return"{"==e?se(ze,"}"):("variable"==e&&M(t),"*"==t&&(_.marked="keyword"),S(Be))}function We(e){if(","==e)return S(ze,We)}function Be(e,t){if("as"==t)return _.marked="keyword",S(ze)}function je(e,t){if("from"==t)return _.marked="keyword",S(z)}function qe(e){return"]"==e?S():C(re(W,"]"))}function Ve(){return C(I("form"),ke,N("{"),I("}"),re(Ue,"}"),P,P)}function Ue(){return C(ke,we)}function Ke(e,t,i){return t.tokenize==m&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(t.lastType)||"quasi"==t.lastType&&/\{\s*$/.test(e.string.slice(0,e.pos-(i||0)))}return D.lex=!0,P.lex=!0,{startState:function(e){var t={tokenize:m,lastType:"sof",cc:[],lexical:new x((e||0)-s,0,"block",!1),localVars:i.localVars,context:i.localVars&&new L(null,null,!1),indented:e||0};return i.globalVars&&"object"==typeof i.globalVars&&(t.globalVars=i.globalVars),t},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation(),k(e,t)),t.tokenize!=g&&e.eatSpace())return null;var i=t.tokenize(e,t);return"comment"==n?i:(t.lastType="operator"!=n||"++"!=r&&"--"!=r?n:"incdec",function(e,t,i,n,r){var s=e.cc;_.state=e,_.stream=r,_.marked=null,_.cc=s,_.style=t,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);for(;;){var o=s.length?s.pop():l?z:F;if(o(i,n)){for(;s.length&&s[s.length-1].lex;)s.pop()();return _.marked?_.marked:"variable"==i&&w(e,n)?"variable-2":t}}}(t,i,n,r,e))},indent:function(t,n){if(t.tokenize==g)return e.Pass;if(t.tokenize!=m)return 0;var r,a=n&&n.charAt(0),l=t.lexical;if(!/^\s*else\b/.test(n))for(var c=t.cc.length-1;c>=0;--c){var h=t.cc[c];if(h==P)l=l.prev;else if(h!=Ce)break}for(;("stat"==l.type||"form"==l.type)&&("}"==a||(r=t.cc[t.cc.length-1])&&(r==V||r==U)&&!/^[,\.=+\-*:?[\(]/.test(n));)l=l.prev;o&&")"==l.type&&"stat"==l.prev.type&&(l=l.prev);var u=l.type,f=a==u;return"vardef"==u?l.indented+("operator"==t.lastType||","==t.lastType?l.info.length+1:0):"form"==u&&"{"==a?l.indented:"form"==u?l.indented+s:"stat"==u?l.indented+(function(e,t){return"operator"==e.lastType||","==e.lastType||d.test(t.charAt(0))||/[,.]/.test(t.charAt(0))}(t,n)?o||s:0):"switch"!=l.info||f||0==i.doubleIndentSwitch?l.align?l.column+(f?0:1):l.indented+(f?0:s):l.indented+(/^(?:case|default)\b/.test(n)?s:2*s)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:l?null:"/*",blockCommentEnd:l?null:"*/",blockCommentContinue:l?null:" * ",lineComment:l?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:l?"json":"javascript",jsonldMode:a,jsonMode:l,expressionAllowed:Ke,skipExpression:function(e){var t=e.cc[e.cc.length-1];t!=z&&t!=W||e.cc.pop()}}}),e.registerHelper("wordChars","javascript",/[\w$]/),e.defineMIME("text/javascript","javascript"),e.defineMIME("text/ecmascript","javascript"),e.defineMIME("application/javascript","javascript"),e.defineMIME("application/x-javascript","javascript"),e.defineMIME("application/ecmascript","javascript"),e.defineMIME("application/json",{name:"javascript",json:!0}),e.defineMIME("application/x-json",{name:"javascript",json:!0}),e.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),e.defineMIME("text/typescript",{name:"javascript",typescript:!0}),e.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),define("skylark-codemirror/mode/htmlmixed/htmlmixed",["../../CodeMirror","../xml/xml","../javascript/javascript","../css/css"],function(e){"use strict";var t={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};var i={};function n(e,t){var n=e.match(function(e){var t=i[e];return t||(i[e]=new RegExp("\\s+"+e+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*"))}(t));return n?/^\s*(.*?)\s*$/.exec(n[2])[1]:""}function r(e,t){return new RegExp((t?"^":"")+"</s*"+e+"s*>","i")}function s(e,t){for(var i in e)for(var n=t[i]||(t[i]=[]),r=e[i],s=r.length-1;s>=0;s--)n.unshift(r[s])}e.defineMode("htmlmixed",function(i,o){var a=e.getMode(i,{name:"xml",htmlMode:!0,multilineTagIndentFactor:o.multilineTagIndentFactor,multilineTagIndentPastTag:o.multilineTagIndentPastTag}),l={},c=o&&o.tags,h=o&&o.scriptTypes;if(s(t,l),c&&s(c,l),h)for(var u=h.length-1;u>=0;u--)l.script.unshift(["type",h[u].matches,h[u].mode]);function d(t,s){var o,c=a.token(t,s.htmlState),h=/\btag\b/.test(c);if(h&&!/[<>\s\/]/.test(t.current())&&(o=s.htmlState.tagName&&s.htmlState.tagName.toLowerCase())&&l.hasOwnProperty(o))s.inTag=o+" ";else if(s.inTag&&h&&/>$/.test(t.current())){var u=/^([\S]+) (.*)/.exec(s.inTag);s.inTag=null;var f=">"==t.current()&&function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(!r[0]||r[1].test(n(t,r[0])))return r[2]}}(l[u[1]],u[2]),p=e.getMode(i,f),m=r(u[1],!0),g=r(u[1],!1);s.token=function(e,t){return e.match(m,!1)?(t.token=d,t.localState=t.localMode=null,null):function(e,t,i){var n=e.current(),r=n.search(t);r>-1?e.backUp(n.length-r):n.match(/<\/?$/)&&(e.backUp(n.length),e.match(t,!1)||e.match(n));return i}(e,g,t.localMode.token(e,t.localState))},s.localMode=p,s.localState=e.startState(p,a.indent(s.htmlState,"",""))}else s.inTag&&(s.inTag+=t.current(),t.eol()&&(s.inTag+=" "));return c}return{startState:function(){var t=e.startState(a);return{token:d,inTag:null,localMode:null,localState:null,htmlState:t}},copyState:function(t){var i;return t.localState&&(i=e.copyState(t.localMode,t.localState)),{token:t.token,inTag:t.inTag,localMode:t.localMode,localState:i,htmlState:e.copyState(a,t.htmlState)}},token:function(e,t){return t.token(e,t)},indent:function(t,i,n){return!t.localMode||/^\s*<\//.test(i)?a.indent(t.htmlState,i,n):t.localMode.indent?t.localMode.indent(t.localState,i,n):e.Pass},innerMode:function(e){return{state:e.localState||e.htmlState,mode:e.localMode||a}}}},"xml","javascript","css"),e.defineMIME("text/html","htmlmixed")}),define("skylark-codemirror/mode/meta",["../CodeMirror"],function(e){"use strict";e.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-encrypted","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["asc","pgp","sig"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h","ino"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mimes:["application/vnd.coffeescript","text/coffeescript","text/x-coffeescript"],mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Esper",mime:"text/x-esper",mode:"sql"},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90","f95"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm","handlebars","hbs"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"text/jinja2",mode:"jinja2",ext:["j2","jinja","jinja2"]},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective-C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mimes:["text/x-php","application/x-httpd-php","application/x-httpd-php-open"],mode:"php",ext:["php","php3","php4","php5","php7","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mimes:["text/x-sh","application/x-sh"],mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"SML",mime:"text/x-sml",mode:"mllike",ext:["sml","sig","fun","smackspec"]},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx","tex"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v","sv","svh"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var t=0;t<e.modeInfo.length;t++){var i=e.modeInfo[t];i.mimes&&(i.mime=i.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.mime==t)return n;if(n.mimes)for(var r=0;r<n.mimes.length;r++)if(n.mimes[r]==t)return n}return/\+xml$/.test(t)?e.findModeByMIME("application/xml"):/\+json$/.test(t)?e.findModeByMIME("application/json"):void 0},e.findModeByExtension=function(t){for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.ext)for(var r=0;r<n.ext.length;r++)if(n.ext[r]==t)return n}},e.findModeByFileName=function(t){for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.file&&n.file.test(t))return n}var r=t.lastIndexOf("."),s=r>-1&&t.substring(r+1,t.length);if(s)return e.findModeByExtension(s)},e.findModeByName=function(t){t=t.toLowerCase();for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.name.toLowerCase()==t)return n;if(n.alias)for(var r=0;r<n.alias.length;r++)if(n.alias[r].toLowerCase()==t)return n}}}),define("skylark-codemirror/mode/markdown/markdown",["../../CodeMirror","../xml/xml","../meta"],function(e){e.defineMode("markdown",function(t,i){var n=e.getMode(t,"text/html"),r="null"==n.name;void 0===i.highlightFormatting&&(i.highlightFormatting=!1),void 0===i.maxBlockquoteDepth&&(i.maxBlockquoteDepth=0),void 0===i.taskLists&&(i.taskLists=!1),void 0===i.strikethrough&&(i.strikethrough=!1),void 0===i.emoji&&(i.emoji=!1),void 0===i.fencedCodeBlockHighlighting&&(i.fencedCodeBlockHighlighting=!0),void 0===i.xml&&(i.xml=!0),void 0===i.tokenTypeOverrides&&(i.tokenTypeOverrides={});var s={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"image",imageAltText:"image-alt-text",imageMarker:"image-marker",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough",emoji:"builtin"};for(var o in s)s.hasOwnProperty(o)&&i.tokenTypeOverrides[o]&&(s[o]=i.tokenTypeOverrides[o]);var a=/^([*\-_])(?:\s*\1){2,}\s*$/,l=/^(?:[*\-+]|^[0-9]+([.)]))\s+/,c=/^\[(x| )\](?=\s)/i,h=i.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,u=/^ *(?:\={1,}|-{1,})\s*$/,d=/^[^#!\[\]*_\\<>` "'(~:]+/,f=/^(~~~+|```+)[ \t]*([\w+#-]*)[^\n`]*$/,p=/^\s*\[[^\]]+?\]:.*$/,m=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E42\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDF3C-\uDF3E]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]/;function g(e,t,i){return t.f=t.inline=i,i(e,t)}function v(e,t,i){return t.f=t.block=i,i(e,t)}function y(t){if(t.linkTitle=!1,t.linkHref=!1,t.linkText=!1,t.em=!1,t.strong=!1,t.strikethrough=!1,t.quote=0,t.indentedCode=!1,t.f==b){var i=r;if(!i){var s=e.innerMode(n,t.htmlState);i="xml"==s.mode.name&&null===s.state.tagStart&&!s.state.context&&s.state.tokenize.isInText}i&&(t.f=C,t.block=k,t.htmlState=null)}return t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.prevLine=t.thisLine,t.thisLine={stream:null},null}function k(n,r){var o,d=n.column()===r.indentation,m=!(o=r.prevLine.stream)||!/\S/.test(o.string),v=r.indentedCode,y=r.prevLine.hr,k=!1!==r.list,b=(r.listStack[r.listStack.length-1]||0)+3;r.indentedCode=!1;var _=r.indentation;if(null===r.indentationDiff&&(r.indentationDiff=r.indentation,k)){for(r.em=!1,r.strong=!1,r.code=!1,r.strikethrough=!1,r.list=null;_<r.listStack[r.listStack.length-1];)r.listStack.pop(),r.listStack.length?r.indentation=r.listStack[r.listStack.length-1]:r.list=!1;!1!==r.list&&(r.indentationDiff=_-r.listStack[r.listStack.length-1])}var C=!(m||y||r.prevLine.header||k&&v||r.prevLine.fencedCodeEnd),S=(!1===r.list||y||m)&&r.indentation<=b&&n.match(a),A=null;if(r.indentationDiff>=4&&(v||r.prevLine.fencedCodeEnd||r.prevLine.header||m))return n.skipToEnd(),r.indentedCode=!0,s.code;if(n.eatSpace())return null;if(d&&r.indentation<=b&&(A=n.match(h))&&A[1].length<=6)return r.quote=0,r.header=A[1].length,r.thisLine.header=!0,i.highlightFormatting&&(r.formatting="header"),r.f=r.inline,w(r);if(r.indentation<=b&&n.eat(">"))return r.quote=d?1:r.quote+1,i.highlightFormatting&&(r.formatting="quote"),n.eatSpace(),w(r);if(!S&&!r.setext&&d&&r.indentation<=b&&(A=n.match(l))){var M=A[1]?"ol":"ul";return r.indentation=_+n.current().length,r.list=!0,r.quote=0,r.listStack.push(r.indentation),i.taskLists&&n.match(c,!1)&&(r.taskList=!0),r.f=r.inline,i.highlightFormatting&&(r.formatting=["list","list-"+M]),w(r)}return d&&r.indentation<=b&&(A=n.match(f,!0))?(r.quote=0,r.fencedEndRE=new RegExp(A[1]+"+ *$"),r.localMode=i.fencedCodeBlockHighlighting&&function(i){if(e.findModeByName){var n=e.findModeByName(i);n&&(i=n.mime||n.mimes[0])}var r=e.getMode(t,i);return"null"==r.name?null:r}(A[2]),r.localMode&&(r.localState=e.startState(r.localMode)),r.f=r.block=x,i.highlightFormatting&&(r.formatting="code-block"),r.code=-1,w(r)):r.setext||!(C&&k||r.quote||!1!==r.list||r.code||S||p.test(n.string))&&(A=n.lookAhead(1))&&(A=A.match(u))?(r.setext?(r.header=r.setext,r.setext=0,n.skipToEnd(),i.highlightFormatting&&(r.formatting="header")):(r.header="="==A[0].charAt(0)?1:2,r.setext=r.header),r.thisLine.header=!0,r.f=r.inline,w(r)):S?(n.skipToEnd(),r.hr=!0,r.thisLine.hr=!0,s.hr):"["===n.peek()?g(n,r,T):g(n,r,r.inline)}function b(t,i){var s=n.token(t,i.htmlState);if(!r){var o=e.innerMode(n,i.htmlState);("xml"==o.mode.name&&null===o.state.tagStart&&!o.state.context&&o.state.tokenize.isInText||i.md_inside&&t.current().indexOf(">")>-1)&&(i.f=C,i.block=k,i.htmlState=null)}return s}function x(e,t){var n,r=t.listStack[t.listStack.length-1]||0,o=t.indentation<r,a=r+3;return t.fencedEndRE&&t.indentation<=a&&(o||e.match(t.fencedEndRE))?(i.highlightFormatting&&(t.formatting="code-block"),o||(n=w(t)),t.localMode=t.localState=null,t.block=k,t.f=C,t.fencedEndRE=null,t.code=0,t.thisLine.fencedCodeEnd=!0,o?v(e,t,t.block):n):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),s.code)}function w(e){var t=[];if(e.formatting){t.push(s.formatting),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var n=0;n<e.formatting.length;n++)t.push(s.formatting+"-"+e.formatting[n]),"header"===e.formatting[n]&&t.push(s.formatting+"-"+e.formatting[n]+"-"+e.header),"quote"===e.formatting[n]&&(!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=e.quote?t.push(s.formatting+"-"+e.formatting[n]+"-"+e.quote):t.push("error"))}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref?t.push(s.linkHref,"url"):(e.strong&&t.push(s.strong),e.em&&t.push(s.em),e.strikethrough&&t.push(s.strikethrough),e.emoji&&t.push(s.emoji),e.linkText&&t.push(s.linkText),e.code&&t.push(s.code),e.image&&t.push(s.image),e.imageAltText&&t.push(s.imageAltText,"link"),e.imageMarker&&t.push(s.imageMarker)),e.header&&t.push(s.header,s.header+"-"+e.header),e.quote&&(t.push(s.quote),!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=e.quote?t.push(s.quote+"-"+e.quote):t.push(s.quote+"-"+i.maxBlockquoteDepth)),!1!==e.list){var r=(e.listStack.length-1)%3;r?1===r?t.push(s.list2):t.push(s.list3):t.push(s.list1)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function _(e,t){if(e.match(d,!0))return w(t)}function C(t,r){var o=r.text(t,r);if(void 0!==o)return o;if(r.list)return r.list=null,w(r);if(r.taskList){var a=" "===t.match(c,!0)[1];return a?r.taskOpen=!0:r.taskClosed=!0,i.highlightFormatting&&(r.formatting="task"),r.taskList=!1,w(r)}if(r.taskOpen=!1,r.taskClosed=!1,r.header&&t.match(/^#+$/,!0))return i.highlightFormatting&&(r.formatting="header"),w(r);var l=t.next();if(r.linkTitle){r.linkTitle=!1;var h=l;"("===l&&(h=")");var u="^\\s*(?:[^"+(h=(h+"").replace(/([.?*+^\[\]\\(){}|-])/g,"\\$1"))+"\\\\]+|\\\\\\\\|\\\\.)"+h;if(t.match(new RegExp(u),!0))return s.linkHref}if("`"===l){var d=r.formatting;i.highlightFormatting&&(r.formatting="code"),t.eatWhile("`");var f=t.current().length;if(0!=r.code||r.quote&&1!=f){if(f==r.code){var p=w(r);return r.code=0,p}return r.formatting=d,w(r)}return r.code=f,w(r)}if(r.code)return w(r);if("\\"===l&&(t.next(),i.highlightFormatting)){var g=w(r),y=s.formatting+"-escape";return g?g+" "+y:y}if("!"===l&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return r.imageMarker=!0,r.image=!0,i.highlightFormatting&&(r.formatting="image"),w(r);if("["===l&&r.imageMarker&&t.match(/[^\]]*\](\(.*?\)| ?\[.*?\])/,!1))return r.imageMarker=!1,r.imageAltText=!0,i.highlightFormatting&&(r.formatting="image"),w(r);if("]"===l&&r.imageAltText){i.highlightFormatting&&(r.formatting="image");var g=w(r);return r.imageAltText=!1,r.image=!1,r.inline=r.f=A,g}if("["===l&&!r.image)return r.linkText&&t.match(/^.*?\]/)?w(r):(r.linkText=!0,i.highlightFormatting&&(r.formatting="link"),w(r));if("]"===l&&r.linkText){i.highlightFormatting&&(r.formatting="link");var g=w(r);return r.linkText=!1,r.inline=r.f=t.match(/\(.*?\)| ?\[.*?\]/,!1)?A:C,g}if("<"===l&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){r.f=r.inline=S,i.highlightFormatting&&(r.formatting="link");var g=w(r);return g?g+=" ":g="",g+s.linkInline}if("<"===l&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){r.f=r.inline=S,i.highlightFormatting&&(r.formatting="link");var g=w(r);return g?g+=" ":g="",g+s.linkEmail}if(i.xml&&"<"===l&&t.match(/^(!--|\?|!\[CDATA\[|[a-z][a-z0-9-]*(?:\s+[a-z_:.\-]+(?:\s*=\s*[^>]+)?)*\s*(?:>|$))/i,!1)){var k=t.string.indexOf(">",t.pos);if(-1!=k){var x=t.string.substring(t.start,k);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(x)&&(r.md_inside=!0)}return t.backUp(1),r.htmlState=e.startState(n),v(t,r,b)}if(i.xml&&"<"===l&&t.match(/^\/\w*?>/))return r.md_inside=!1,"tag";if("*"===l||"_"===l){for(var _=1,M=1==t.pos?" ":t.string.charAt(t.pos-2);_<3&&t.eat(l);)_++;var T=t.peek()||" ",L=!/\s/.test(T)&&(!m.test(T)||/\s/.test(M)||m.test(M)),$=!/\s/.test(M)&&(!m.test(M)||/\s/.test(T)||m.test(T)),E=null,O=null;if(_%2&&(r.em||!L||"*"!==l&&$&&!m.test(M)?r.em!=l||!$||"*"!==l&&L&&!m.test(T)||(E=!1):E=!0),_>1&&(r.strong||!L||"*"!==l&&$&&!m.test(M)?r.strong!=l||!$||"*"!==l&&L&&!m.test(T)||(O=!1):O=!0),null!=O||null!=E){i.highlightFormatting&&(r.formatting=null==E?"strong":null==O?"em":"strong em"),!0===E&&(r.em=l),!0===O&&(r.strong=l);var p=w(r);return!1===E&&(r.em=!1),!1===O&&(r.strong=!1),p}}else if(" "===l&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return w(r);t.backUp(1)}if(i.strikethrough)if("~"===l&&t.eatWhile(l)){if(r.strikethrough){i.highlightFormatting&&(r.formatting="strikethrough");var p=w(r);return r.strikethrough=!1,p}if(t.match(/^[^\s]/,!1))return r.strikethrough=!0,i.highlightFormatting&&(r.formatting="strikethrough"),w(r)}else if(" "===l&&t.match(/^~~/,!0)){if(" "===t.peek())return w(r);t.backUp(2)}if(i.emoji&&":"===l&&t.match(/^(?:[a-z_\d+][a-z_\d+-]*|\-[a-z_\d+][a-z_\d+-]*):/)){r.emoji=!0,i.highlightFormatting&&(r.formatting="emoji");var R=w(r);return r.emoji=!1,R}return" "===l&&(t.match(/^ +$/,!1)?r.trailingSpace++:r.trailingSpace&&(r.trailingSpaceNewLine=!0)),w(r)}function S(e,t){var n=e.next();if(">"===n){t.f=t.inline=C,i.highlightFormatting&&(t.formatting="link");var r=w(t);return r?r+=" ":r="",r+s.linkInline}return e.match(/^[^>]+/,!0),s.linkInline}function A(e,t){if(e.eatSpace())return null;var n,r=e.next();return"("===r||"["===r?(t.f=t.inline=(n="("===r?")":"]",function(e,t){var r=e.next();if(r===n){t.f=t.inline=C,i.highlightFormatting&&(t.formatting="link-string");var s=w(t);return t.linkHref=!1,s}return e.match(M[n]),t.linkHref=!0,w(t)}),i.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,w(t)):"error"}var M={")":/^(?:[^\\\(\)]|\\.|\((?:[^\\\(\)]|\\.)*\))*?(?=\))/,"]":/^(?:[^\\\[\]]|\\.|\[(?:[^\\\[\]]|\\.)*\])*?(?=\])/};function T(e,t){return e.match(/^([^\]\\]|\\.)*\]:/,!1)?(t.f=L,e.next(),i.highlightFormatting&&(t.formatting="link"),t.linkText=!0,w(t)):g(e,t,C)}function L(e,t){if(e.match(/^\]:/,!0)){t.f=t.inline=$,i.highlightFormatting&&(t.formatting="link");var n=w(t);return t.linkText=!1,n}return e.match(/^([^\]\\]|\\.)+/,!0),s.linkText}function $(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=C,s.linkHref+" url")}var E={startState:function(){return{f:k,prevLine:{stream:null},thisLine:{stream:null},block:k,htmlState:null,indentation:0,inline:C,text:_,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,code:0,em:!1,strong:!1,header:0,setext:0,hr:!1,taskList:!1,list:!1,listStack:[],quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,emoji:!1,fencedEndRE:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t.thisLine,block:t.block,htmlState:t.htmlState&&e.copyState(n,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkText:t.linkText,linkTitle:t.linkTitle,linkHref:t.linkHref,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,emoji:t.emoji,header:t.header,setext:t.setext,hr:t.hr,taskList:t.taskList,list:t.list,listStack:t.listStack.slice(0),quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedEndRE:t.fencedEndRE}},token:function(e,t){if(t.formatting=!1,e!=t.thisLine.stream){if(t.header=0,t.hr=!1,e.match(/^\s*$/,!0))return y(t),null;if(t.prevLine=t.thisLine,t.thisLine={stream:e},t.taskList=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,!t.localState&&(t.f=t.block,t.f!=b)){var i=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length;if(t.indentation=i,t.indentationDiff=null,i>0)return null}}return t.f(e,t)},innerMode:function(e){return e.block==b?{state:e.htmlState,mode:n}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:E}},indent:function(t,i,r){return t.block==b&&n.indent?n.indent(t.htmlState,i,r):t.localState&&t.localMode.indent?t.localMode.indent(t.localState,i,r):e.Pass},blankLine:y,getType:w,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",closeBrackets:"()[]{}''\"\"``",fold:"markdown"};return E},"xml"),e.defineMIME("text/markdown","markdown"),e.defineMIME("text/x-markdown","markdown")}),define("skylark-codemirror/addon/comment/comment",["../../CodeMirror"],function(e){"use strict";var t={},i=/[^\s\u00a0]/,n=e.Pos;function r(e){var t=e.search(i);return-1==t?0:t}function s(e,t){var i=e.getMode();return!1!==i.useInnerComments&&i.innerMode?e.getModeAt(t):i}e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e||(e=t);for(var i=1/0,r=this.listSelections(),s=null,o=r.length-1;o>=0;o--){var a=r[o].from(),l=r[o].to();a.line>=i||(l.line>=i&&(l=n(i,0)),i=a.line,null==s?this.uncomment(a,l,e)?s="un":(this.lineComment(a,l,e),s="line"):"un"==s?this.uncomment(a,l,e):this.lineComment(a,l,e))}}),e.defineExtension("lineComment",function(e,o,a){a||(a=t);var l=this,c=s(l,e),h=l.getLine(e.line);if(null!=h&&(u=e,d=h,!/\bstring\b/.test(l.getTokenTypeAt(n(u.line,0)))||/^[\'\"\`]/.test(d))){var u,d,f=a.lineComment||c.lineComment;if(f){var p=Math.min(0!=o.ch||o.line==e.line?o.line+1:o.line,l.lastLine()+1),m=null==a.padding?" ":a.padding,g=a.commentBlankLines||e.line==o.line;l.operation(function(){if(a.indent){for(var t=null,s=e.line;s<p;++s){var o=l.getLine(s),c=o.slice(0,r(o));(null==t||t.length>c.length)&&(t=c)}for(var s=e.line;s<p;++s){var o=l.getLine(s),h=t.length;(g||i.test(o))&&(o.slice(0,h)!=t&&(h=r(o)),l.replaceRange(t+f+m,n(s,0),n(s,h)))}}else for(var s=e.line;s<p;++s)(g||i.test(l.getLine(s)))&&l.replaceRange(f+m,n(s,0))})}else(a.blockCommentStart||c.blockCommentStart)&&(a.fullLines=!0,l.blockComment(e,o,a))}}),e.defineExtension("blockComment",function(e,r,o){o||(o=t);var a=this,l=s(a,e),c=o.blockCommentStart||l.blockCommentStart,h=o.blockCommentEnd||l.blockCommentEnd;if(c&&h){if(!/\bcomment\b/.test(a.getTokenTypeAt(n(e.line,0)))){var u=Math.min(r.line,a.lastLine());u!=e.line&&0==r.ch&&i.test(a.getLine(u))&&--u;var d=null==o.padding?" ":o.padding;e.line>u||a.operation(function(){if(0!=o.fullLines){var t=i.test(a.getLine(u));a.replaceRange(d+h,n(u)),a.replaceRange(c+d,n(e.line,0));var s=o.blockCommentLead||l.blockCommentLead;if(null!=s)for(var f=e.line+1;f<=u;++f)(f!=u||t)&&a.replaceRange(s+d,n(f,0))}else a.replaceRange(h,r),a.replaceRange(c,e)})}}else(o.lineComment||l.lineComment)&&0!=o.fullLines&&a.lineComment(e,r,o)}),e.defineExtension("uncomment",function(e,r,o){o||(o=t);var a,l=this,c=s(l,e),h=Math.min(0!=r.ch||r.line==e.line?r.line:r.line-1,l.lastLine()),u=Math.min(e.line,h),d=o.lineComment||c.lineComment,f=[],p=null==o.padding?" ":o.padding;e:if(d){for(var m=u;m<=h;++m){var g=l.getLine(m),v=g.indexOf(d);if(v>-1&&!/comment/.test(l.getTokenTypeAt(n(m,v+1)))&&(v=-1),-1==v&&i.test(g))break e;if(v>-1&&i.test(g.slice(0,v)))break e;f.push(g)}if(l.operation(function(){for(var e=u;e<=h;++e){var t=f[e-u],i=t.indexOf(d),r=i+d.length;i<0||(t.slice(r,r+p.length)==p&&(r+=p.length),a=!0,l.replaceRange("",n(e,i),n(e,r)))}}),a)return!0}var y=o.blockCommentStart||c.blockCommentStart,k=o.blockCommentEnd||c.blockCommentEnd;if(!y||!k)return!1;var b=o.blockCommentLead||c.blockCommentLead,x=l.getLine(u),w=x.indexOf(y);if(-1==w)return!1;var _=h==u?x:l.getLine(h),C=_.indexOf(k,h==u?w+y.length:0),S=n(u,w+1),A=n(h,C+1);if(-1==C||!/comment/.test(l.getTokenTypeAt(S))||!/comment/.test(l.getTokenTypeAt(A))||l.getRange(S,A,"\n").indexOf(k)>-1)return!1;var M=x.lastIndexOf(y,e.ch),T=-1==M?-1:x.slice(0,e.ch).indexOf(k,M+y.length);if(-1!=M&&-1!=T&&T+k.length!=e.ch)return!1;T=_.indexOf(k,r.ch);var L=_.slice(r.ch).lastIndexOf(y,T-r.ch);return M=-1==T||-1==L?-1:r.ch+L,(-1==T||-1==M||M==r.ch)&&(l.operation(function(){l.replaceRange("",n(h,C-(p&&_.slice(C-p.length,C)==p?p.length:0)),n(h,C+k.length));var e=w+y.length;if(p&&x.slice(e,e+p.length)==p&&(e+=p.length),l.replaceRange("",n(u,w),n(u,e)),b)for(var t=u+1;t<=h;++t){var r=l.getLine(t),s=r.indexOf(b);if(-1!=s&&!i.test(r.slice(0,s))){var o=s+b.length;p&&r.slice(o,o+p.length)==p&&(o+=p.length),l.replaceRange("",n(t,s),n(t,o))}}}),!0)})}),define("skylark-codemirror/addon/selection/active-line",["../../CodeMirror"],function(e){"use strict";var t="CodeMirror-activeline",i="CodeMirror-activeline-background",n="CodeMirror-activeline-gutter";function r(e){for(var r=0;r<e.state.activeLines.length;r++)e.removeLineClass(e.state.activeLines[r],"wrap",t),e.removeLineClass(e.state.activeLines[r],"background",i),e.removeLineClass(e.state.activeLines[r],"gutter",n)}function s(e,s){for(var o=[],a=0;a<s.length;a++){var l=s[a],c=e.getOption("styleActiveLine");if("object"==typeof c&&c.nonEmpty?l.anchor.line==l.head.line:l.empty()){var h=e.getLineHandleVisualStart(l.head.line);o[o.length-1]!=h&&o.push(h)}}(function(e,t){if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return!1;return!0})(e.state.activeLines,o)||e.operation(function(){r(e);for(var s=0;s<o.length;s++)e.addLineClass(o[s],"wrap",t),e.addLineClass(o[s],"background",i),e.addLineClass(o[s],"gutter",n);e.state.activeLines=o})}function o(e,t){s(e,t.ranges)}e.defineOption("styleActiveLine",!1,function(t,i,n){var a=n!=e.Init&&n;i!=a&&(a&&(t.off("beforeSelectionChange",o),r(t),delete t.state.activeLines),i&&(t.state.activeLines=[],s(t,t.listSelections()),t.on("beforeSelectionChange",o)))})}),define("skylark-codemirror/addon/fold/foldcode",["../../CodeMirror"],function(e){"use strict";function t(t,i,r,s){if(r&&r.call){var o=r;r=null}else var o=n(t,r,"rangeFinder");"number"==typeof i&&(i=e.Pos(i,0));var a=n(t,r,"minFoldSize");function l(e){var n=o(t,i);if(!n||n.to.line-n.from.line<a)return null;for(var r=t.findMarksAt(n.from),l=0;l<r.length;++l)if(r[l].__isFold&&"fold"!==s){if(!e)return null;n.cleared=!0,r[l].clear()}return n}var c=l(!0);if(n(t,r,"scanUp"))for(;!c&&i.line>t.firstLine();)i=e.Pos(i.line-1,0),c=l(!1);if(c&&!c.cleared&&"unfold"!==s){var h=function(e,t){var i=n(e,t,"widget");if("string"==typeof i){var r=document.createTextNode(i);(i=document.createElement("span")).appendChild(r),i.className="CodeMirror-foldmarker"}else i&&(i=i.cloneNode(!0));return i}(t,r);e.on(h,"mousedown",function(t){u.clear(),e.e_preventDefault(t)});var u=t.markText(c.from,c.to,{replacedWith:h,clearOnEnter:n(t,r,"clearOnEnter"),__isFold:!0});u.on("clear",function(i,n){e.signal(t,"unfold",t,i,n)}),e.signal(t,"fold",t,c.from,c.to)}}e.newFoldFunction=function(e,i){return function(n,r){t(n,r,{rangeFinder:e,widget:i})}},e.defineExtension("foldCode",function(e,i,n){t(this,e,i,n)}),e.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),i=0;i<t.length;++i)if(t[i].__isFold)return!0}),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},e.commands.foldAll=function(t){t.operation(function(){for(var i=t.firstLine(),n=t.lastLine();i<=n;i++)t.foldCode(e.Pos(i,0),null,"fold")})},e.commands.unfoldAll=function(t){t.operation(function(){for(var i=t.firstLine(),n=t.lastLine();i<=n;i++)t.foldCode(e.Pos(i,0),null,"unfold")})},e.registerHelper("fold","combine",function(){var e=Array.prototype.slice.call(arguments,0);return function(t,i){for(var n=0;n<e.length;++n){var r=e[n](t,i);if(r)return r}}}),e.registerHelper("fold","auto",function(e,t){for(var i=e.getHelpers(t,"fold"),n=0;n<i.length;n++){var r=i[n](e,t);if(r)return r}});var i={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function n(e,t,n){if(t&&void 0!==t[n])return t[n];var r=e.options.foldOptions;return r&&void 0!==r[n]?r[n]:i[n]}e.defineOption("foldOptions",null),e.defineExtension("foldOption",function(e,t){return n(this,e,t)})}),define("skylark-codemirror/addon/fold/foldgutter",["../../CodeMirror","./foldcode"],function(e){"use strict";e.defineOption("foldGutter",!1,function(t,i,n){n&&n!=e.Init&&(t.clearGutter(t.state.foldGutter.options.gutter),t.state.foldGutter=null,t.off("gutterClick",o),t.off("change",a),t.off("viewportChange",l),t.off("fold",c),t.off("unfold",c),t.off("swapDoc",a)),i&&(t.state.foldGutter=new function(e){this.options=e,this.from=this.to=0}(function(e){!0===e&&(e={});null==e.gutter&&(e.gutter="CodeMirror-foldgutter");null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open");null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded");return e}(i)),s(t),t.on("gutterClick",o),t.on("change",a),t.on("viewportChange",l),t.on("fold",c),t.on("unfold",c),t.on("swapDoc",a))});var t=e.Pos;function i(e,i){for(var n=e.findMarks(t(i,0),t(i+1,0)),r=0;r<n.length;++r)if(n[r].__isFold&&n[r].find().from.line==i)return n[r]}function n(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function r(e,r,s){var o=e.state.foldGutter.options,a=r,l=e.foldOption(o,"minFoldSize"),c=e.foldOption(o,"rangeFinder");e.eachLine(r,s,function(r){var s=null;if(i(e,a))s=n(o.indicatorFolded);else{var h=t(a,0),u=c&&c(e,h);u&&u.to.line-u.from.line>=l&&(s=n(o.indicatorOpen))}e.setGutterMarker(r,o.gutter,s),++a})}function s(e){var t=e.getViewport(),i=e.state.foldGutter;i&&(e.operation(function(){r(e,t.from,t.to)}),i.from=t.from,i.to=t.to)}function o(e,n,r){var s=e.state.foldGutter;if(s){var o=s.options;if(r==o.gutter){var a=i(e,n);a?a.clear():e.foldCode(t(n,0),o.rangeFinder)}}}function a(e){var t=e.state.foldGutter;if(t){var i=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){s(e)},i.foldOnChangeTimeSpan||600)}}function l(e){var t=e.state.foldGutter;if(t){var i=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout(function(){var i=e.getViewport();t.from==t.to||i.from-t.to>20||t.from-i.to>20?s(e):e.operation(function(){i.from<t.from&&(r(e,i.from,t.from),t.from=i.from),i.to>t.to&&(r(e,t.to,i.to),t.to=i.to)})},i.updateViewportTimeSpan||400)}}function c(e,t){var i=e.state.foldGutter;if(i){var n=t.line;n>=i.from&&n<i.to&&r(e,n,n+1)}}}),define("skylark-codemirror/addon/fold/brace-fold",["../../CodeMirror"],function(e){"use strict";e.registerHelper("fold","brace",function(t,i){var n,r=i.line,s=t.getLine(r);function o(o){for(var a=i.ch,l=0;;){var c=a<=0?-1:s.lastIndexOf(o,a-1);if(-1!=c){if(1==l&&c<i.ch)break;if(n=t.getTokenTypeAt(e.Pos(r,c+1)),!/^(comment|string)/.test(n))return c+1;a=c-1}else{if(1==l)break;l=1,a=s.length}}}var a="{",l="}",c=o("{");if(null==c&&(a="[",l="]",c=o("[")),null!=c){var h,u,d=1,f=t.lastLine();e:for(var p=r;p<=f;++p)for(var m=t.getLine(p),g=p==r?c:0;;){var v=m.indexOf(a,g),y=m.indexOf(l,g);if(v<0&&(v=m.length),y<0&&(y=m.length),(g=Math.min(v,y))==m.length)break;if(t.getTokenTypeAt(e.Pos(p,g+1))==n)if(g==v)++d;else if(!--d){h=p,u=g;break e}++g}if(null!=h&&r!=h)return{from:e.Pos(r,c),to:e.Pos(h,u)}}}),e.registerHelper("fold","import",function(t,i){function n(i){if(i<t.firstLine()||i>t.lastLine())return null;var n=t.getTokenAt(e.Pos(i,1));if(/\S/.test(n.string)||(n=t.getTokenAt(e.Pos(i,n.end+1))),"keyword"!=n.type||"import"!=n.string)return null;for(var r=i,s=Math.min(t.lastLine(),i+10);r<=s;++r){var o=t.getLine(r),a=o.indexOf(";");if(-1!=a)return{startCh:n.end,end:e.Pos(r,a)}}}var r,s=i.line,o=n(s);if(!o||n(s-1)||(r=n(s-2))&&r.end.line==s-1)return null;for(var a=o.end;;){var l=n(a.line+1);if(null==l)break;a=l.end}return{from:t.clipPos(e.Pos(s,o.startCh+1)),to:a}}),e.registerHelper("fold","include",function(t,i){function n(i){if(i<t.firstLine()||i>t.lastLine())return null;var n=t.getTokenAt(e.Pos(i,1));return/\S/.test(n.string)||(n=t.getTokenAt(e.Pos(i,n.end+1))),"meta"==n.type&&"#include"==n.string.slice(0,8)?n.start+8:void 0}var r=i.line,s=n(r);if(null==s||null!=n(r-1))return null;for(var o=r;;){var a=n(o+1);if(null==a)break;++o}return{from:e.Pos(r,s+1),to:t.clipPos(e.Pos(o))}})}),define("skylark-codemirror/addon/fold/xml-fold",["../../CodeMirror"],function(e){"use strict";var t=e.Pos;function i(e,t){return e.line-t.line||e.ch-t.ch}var n="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r=new RegExp("<(/?)(["+n+"][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");function s(e,t,i,n){this.line=t,this.ch=i,this.cm=e,this.text=e.getLine(t),this.min=n?Math.max(n.from,e.firstLine()):e.firstLine(),this.max=n?Math.min(n.to-1,e.lastLine()):e.lastLine()}function o(e,i){var n=e.cm.getTokenTypeAt(t(e.line,i));return n&&/\btag\b/.test(n)}function a(e){if(!(e.line>=e.max))return e.ch=0,e.text=e.cm.getLine(++e.line),!0}function l(e){if(!(e.line<=e.min))return e.text=e.cm.getLine(--e.line),e.ch=e.text.length,!0}function c(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(a(e))continue;return}if(o(e,t+1)){var i=e.text.lastIndexOf("/",t),n=i>-1&&!/\S/.test(e.text.slice(i+1,t));return e.ch=t+1,n?"selfClose":"regular"}e.ch=t+1}}function h(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(l(e))continue;return}if(o(e,t+1)){r.lastIndex=t,e.ch=t;var i=r.exec(e.text);if(i&&i.index==t)return i}else e.ch=t}}function u(e){for(;;){r.lastIndex=e.ch;var t=r.exec(e.text);if(!t){if(a(e))continue;return}if(o(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}function d(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(l(e))continue;return}if(o(e,t+1)){var i=e.text.lastIndexOf("/",t),n=i>-1&&!/\S/.test(e.text.slice(i+1,t));return e.ch=t+1,n?"selfClose":"regular"}e.ch=t}}function f(e,i){for(var n=[];;){var r,s=u(e),o=e.line,a=e.ch-(s?s[0].length:0);if(!s||!(r=c(e)))return;if("selfClose"!=r)if(s[1]){for(var l=n.length-1;l>=0;--l)if(n[l]==s[2]){n.length=l;break}if(l<0&&(!i||i==s[2]))return{tag:s[2],from:t(o,a),to:t(e.line,e.ch)}}else n.push(s[2])}}function p(e,i){for(var n=[];;){var r=d(e);if(!r)return;if("selfClose"!=r){var s=e.line,o=e.ch,a=h(e);if(!a)return;if(a[1])n.push(a[2]);else{for(var l=n.length-1;l>=0;--l)if(n[l]==a[2]){n.length=l;break}if(l<0&&(!i||i==a[2]))return{tag:a[2],from:t(e.line,e.ch),to:t(s,o)}}}else h(e)}}e.registerHelper("fold","xml",function(e,n){for(var r=new s(e,n.line,0);;){var o=u(r);if(!o||r.line!=n.line)return;var a=c(r);if(!a)return;if(!o[1]&&"selfClose"!=a){var l=t(r.line,r.ch),h=f(r,o[2]);return h&&i(h.from,l)>0?{from:l,to:h.from}:null}}}),e.findMatchingTag=function(e,n,r){var o=new s(e,n.line,n.ch,r);if(-1!=o.text.indexOf(">")||-1!=o.text.indexOf("<")){var a=c(o),l=a&&t(o.line,o.ch),u=a&&h(o);if(a&&u&&!(i(o,n)>0)){var d={from:t(o.line,o.ch),to:l,tag:u[2]};return"selfClose"==a?{open:d,close:null,at:"open"}:u[1]?{open:p(o,u[2]),close:d,at:"close"}:(o=new s(e,l.line,l.ch,r),{open:d,close:f(o,u[2]),at:"open"})}}},e.findEnclosingTag=function(e,t,i,n){for(var r=new s(e,t.line,t.ch,i);;){var o=p(r,n);if(!o)break;var a=new s(e,t.line,t.ch,i),l=f(a,o.tag);if(l)return{open:o,close:l}}},e.scanForClosingTag=function(e,t,i,n){var r=new s(e,t.line,t.ch,n?{from:0,to:n}:null);return f(r,i)}}),define("skylark-codemirror/addon/fold/indent-fold",["../../CodeMirror"],function(e){"use strict";function t(t,i){var n=t.getLine(i),r=n.search(/\S/);return-1==r||/\bcomment\b/.test(t.getTokenTypeAt(e.Pos(i,r+1)))?-1:e.countColumn(n,null,t.getOption("tabSize"))}e.registerHelper("fold","indent",function(i,n){var r=t(i,n.line);if(!(r<0)){for(var s=null,o=n.line+1,a=i.lastLine();o<=a;++o){var l=t(i,o);if(-1==l);else{if(!(l>r))break;s=o}}return s?{from:e.Pos(n.line,i.getLine(n.line).length),to:e.Pos(s,i.getLine(s).length)}:void 0}})}),define("skylark-codemirror/addon/fold/markdown-fold",["../../CodeMirror"],function(e){"use strict";e.registerHelper("fold","markdown",function(t,i){var n=100;function r(i){var n=t.getTokenTypeAt(e.Pos(i,0));return n&&/\bheader\b/.test(n)}function s(e,t,i){var s=t&&t.match(/^#+/);return s&&r(e)?s[0].length:(s=i&&i.match(/^[=\-]+\s*$/))&&r(e+1)?"="==i[0]?1:2:n}var o=t.getLine(i.line),a=t.getLine(i.line+1),l=s(i.line,o,a);if(l!==n){for(var c=t.lastLine(),h=i.line,u=t.getLine(h+2);h<c&&!(s(h+1,a,u)<=l);)++h,a=u,u=t.getLine(h+2);return{from:e.Pos(i.line,o.length),to:e.Pos(h,t.getLine(h).length)}}})}),define("skylark-codemirror/addon/fold/comment-fold",["../../CodeMirror"],function(e){"use strict";e.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(t,i){var n=t.getModeAt(i),r=n.blockCommentStart,s=n.blockCommentEnd;if(r&&s){for(var o,a=i.line,l=t.getLine(a),c=i.ch,h=0;;){var u=c<=0?-1:l.lastIndexOf(r,c-1);if(-1!=u){if(1==h&&u<i.ch)return;if(/comment/.test(t.getTokenTypeAt(e.Pos(a,u+1)))&&(0==u||l.slice(u-s.length,u)==s||!/comment/.test(t.getTokenTypeAt(e.Pos(a,u))))){o=u+r.length;break}c=u-1}else{if(1==h)return;h=1,c=l.length}}var d,f,p=1,m=t.lastLine();e:for(var g=a;g<=m;++g)for(var v=t.getLine(g),y=g==a?o:0;;){var k=v.indexOf(r,y),b=v.indexOf(s,y);if(k<0&&(k=v.length),b<0&&(b=v.length),(y=Math.min(k,b))==v.length)break;if(y==k)++p;else if(!--p){d=g,f=y;break e}++y}if(null!=d&&(a!=d||f!=o))return{from:e.Pos(a,o),to:e.Pos(d,f)}}})}),define("skylark-codemirror/addon/edit/matchbrackets",["../../CodeMirror"],function(e){var t=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),i=e.Pos,n={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function r(e){return e&&e.bracketRegex||/[(){}[\]]/}function s(e,t,s){var a=e.getLineHandle(t.line),l=t.ch-1,c=s&&s.afterCursor;null==c&&(c=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className));var h=r(s),u=!c&&l>=0&&h.test(a.text.charAt(l))&&n[a.text.charAt(l)]||h.test(a.text.charAt(l+1))&&n[a.text.charAt(++l)];if(!u)return null;var d=">"==u.charAt(1)?1:-1;if(s&&s.strict&&d>0!=(l==t.ch))return null;var f=e.getTokenTypeAt(i(t.line,l+1)),p=o(e,i(t.line,l+(d>0?1:0)),d,f||null,s);return null==p?null:{from:i(t.line,l),to:p&&p.pos,match:p&&p.ch==u.charAt(0),forward:d>0}}function o(e,t,s,o,a){for(var l=a&&a.maxScanLineLength||1e4,c=a&&a.maxScanLines||1e3,h=[],u=r(a),d=s>0?Math.min(t.line+c,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-c),f=t.line;f!=d;f+=s){var p=e.getLine(f);if(p){var m=s>0?0:p.length-1,g=s>0?p.length:-1;if(!(p.length>l))for(f==t.line&&(m=t.ch-(s<0?1:0));m!=g;m+=s){var v=p.charAt(m);if(u.test(v)&&(void 0===o||e.getTokenTypeAt(i(f,m+1))==o)){var y=n[v];if(y&&">"==y.charAt(1)==s>0)h.push(v);else{if(!h.length)return{pos:i(f,m),ch:v};h.pop()}}}}}return f-s!=(s>0?e.lastLine():e.firstLine())&&null}function a(e,n,r){for(var o=e.state.matchBrackets.maxHighlightLineLength||1e3,a=[],l=e.listSelections(),c=0;c<l.length;c++){var h=l[c].empty()&&s(e,l[c].head,r);if(h&&e.getLine(h.from.line).length<=o){var u=h.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";a.push(e.markText(h.from,i(h.from.line,h.from.ch+1),{className:u})),h.to&&e.getLine(h.to.line).length<=o&&a.push(e.markText(h.to,i(h.to.line,h.to.ch+1),{className:u}))}}if(a.length){t&&e.state.focused&&e.focus();var d=function(){e.operation(function(){for(var e=0;e<a.length;e++)a[e].clear()})};if(!n)return d;setTimeout(d,800)}}function l(e){e.operation(function(){e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null),e.state.matchBrackets.currentlyHighlighted=a(e,!1,e.state.matchBrackets)})}e.defineOption("matchBrackets",!1,function(t,i,n){n&&n!=e.Init&&(t.off("cursorActivity",l),t.state.matchBrackets&&t.state.matchBrackets.currentlyHighlighted&&(t.state.matchBrackets.currentlyHighlighted(),t.state.matchBrackets.currentlyHighlighted=null)),i&&(t.state.matchBrackets="object"==typeof i?i:{},t.on("cursorActivity",l))}),e.defineExtension("matchBrackets",function(){a(this,!0)}),e.defineExtension("findMatchingBracket",function(e,t,i){return(i||"boolean"==typeof t)&&(i?(i.strict=t,t=i):t=t?{strict:!0}:null),s(this,e,t)}),e.defineExtension("scanForBracket",function(e,t,i,n){return o(this,e,t,i,n)})}),define("skylark-codemirror/addon/edit/closebrackets",["../../CodeMirror"],function(e){var t={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"},i=e.Pos;function n(e,i){return"pairs"==i&&"string"==typeof e?e:"object"==typeof e&&null!=e[i]?e[i]:t[i]}e.defineOption("autoCloseBrackets",!1,function(t,i,o){o&&o!=e.Init&&(t.removeKeyMap(r),t.state.closeBrackets=null),i&&(s(n(i,"pairs")),t.state.closeBrackets=i,t.addKeyMap(r))});var r={Backspace:function(t){var r=a(t);if(!r||t.getOption("disableInput"))return e.Pass;for(var s=n(r,"pairs"),o=t.listSelections(),c=0;c<o.length;c++){if(!o[c].empty())return e.Pass;var h=l(t,o[c].head);if(!h||s.indexOf(h)%2!=0)return e.Pass}for(var c=o.length-1;c>=0;c--){var u=o[c].head;t.replaceRange("",i(u.line,u.ch-1),i(u.line,u.ch+1),"+delete")}},Enter:function(t){var i=a(t),r=i&&n(i,"explode");if(!r||t.getOption("disableInput"))return e.Pass;for(var s=t.listSelections(),o=0;o<s.length;o++){if(!s[o].empty())return e.Pass;var c=l(t,s[o].head);if(!c||r.indexOf(c)%2!=0)return e.Pass}t.operation(function(){var e=t.lineSeparator()||"\n";t.replaceSelection(e+e,null),t.execCommand("goCharLeft"),s=t.listSelections();for(var i=0;i<s.length;i++){var n=s[i].head.line;t.indentLine(n,null,!0),t.indentLine(n+1,null,!0)}})}};function s(e){for(var t=0;t<e.length;t++){var i=e.charAt(t),n="'"+i+"'";r[n]||(r[n]=o(i))}}function o(t){return function(r){return function(t,r){var s=a(t);if(!s||t.getOption("disableInput"))return e.Pass;var o=n(s,"pairs"),l=o.indexOf(r);if(-1==l)return e.Pass;for(var h,u=n(s,"closeBefore"),d=n(s,"triples"),f=o.charAt(l+1)==r,p=t.listSelections(),m=l%2==0,g=0;g<p.length;g++){var v,y=p[g],k=y.head,b=t.getRange(k,i(k.line,k.ch+1));if(m&&!y.empty())v="surround";else if(!f&&m||b!=r)if(f&&k.ch>1&&d.indexOf(r)>=0&&t.getRange(i(k.line,k.ch-2),k)==r+r){if(k.ch>2&&/\bstring/.test(t.getTokenTypeAt(i(k.line,k.ch-2))))return e.Pass;v="addFour"}else if(f){var x=0==k.ch?" ":t.getRange(i(k.line,k.ch-1),k);if(e.isWordChar(b)||x==r||e.isWordChar(x))return e.Pass;v="both"}else{if(!m||!(0===b.length||/\s/.test(b)||u.indexOf(b)>-1))return e.Pass;v="both"}else v=f&&c(t,k)?"both":d.indexOf(r)>=0&&t.getRange(k,i(k.line,k.ch+3))==r+r+r?"skipThree":"skip";if(h){if(h!=v)return e.Pass}else h=v}var w=l%2?o.charAt(l-1):r,_=l%2?r:o.charAt(l+1);t.operation(function(){if("skip"==h)t.execCommand("goCharRight");else if("skipThree"==h)for(var n=0;n<3;n++)t.execCommand("goCharRight");else if("surround"==h){for(var r=t.getSelections(),n=0;n<r.length;n++)r[n]=w+r[n]+_;t.replaceSelections(r,"around"),r=t.listSelections().slice();for(var n=0;n<r.length;n++)r[n]=(s=r[n],void 0,o=e.cmpPos(s.anchor,s.head)>0,{anchor:new i(s.anchor.line,s.anchor.ch+(o?-1:1)),head:new i(s.head.line,s.head.ch+(o?1:-1))});t.setSelections(r)}else"both"==h?(t.replaceSelection(w+_,null),t.triggerElectric(w+_),t.execCommand("goCharLeft")):"addFour"==h&&(t.replaceSelection(w+w+w+w,"before"),t.execCommand("goCharRight"));var s,o})}(r,t)}}function a(e){var t=e.state.closeBrackets;if(!t||t.override)return t;var i=e.getModeAt(e.getCursor());return i.closeBrackets||t}function l(e,t){var n=e.getRange(i(t.line,t.ch-1),i(t.line,t.ch+1));return 2==n.length?n:null}function c(e,t){var n=e.getTokenAt(i(t.line,t.ch+1));return/\bstring/.test(n.type)&&n.start==t.ch&&(0==t.ch||!/\bstring/.test(e.getTokenTypeAt(t)))}s(t.pairs+"`")}),define("skylark-codemirror/addon/edit/trailingspace",["../../CodeMirror"],function(e){e.defineOption("showTrailingSpace",!1,function(t,i,n){n==e.Init&&(n=!1),n&&!i?t.removeOverlay("trailingspace"):!n&&i&&t.addOverlay({token:function(e){for(var t=e.string.length,i=t;i&&/\s/.test(e.string.charAt(i-1));--i);return i>e.pos?(e.pos=i,null):(e.pos=t,"trailingspace")},name:"trailingspace"})})}),define("skylark-codemirror/addon/search/searchcursor",["../../CodeMirror"],function(e){"use strict";var t,i,n=e.Pos;function r(e,t){for(var i=function(e){var t=e.flags;return null!=t?t:(e.ignoreCase?"i":"")+(e.global?"g":"")+(e.multiline?"m":"")}(e),n=i,r=0;r<t.length;r++)-1==n.indexOf(t.charAt(r))&&(n+=t.charAt(r));return i==n?e:new RegExp(e.source,n)}function s(e,t,i){t=r(t,"g");for(var s=i.line,o=i.ch,a=e.lastLine();s<=a;s++,o=0){t.lastIndex=o;var l=e.getLine(s),c=t.exec(l);if(c)return{from:n(s,c.index),to:n(s,c.index+c[0].length),match:c}}}function o(e,t){for(var i,n=0;;){t.lastIndex=n;var r=t.exec(e);if(!r)return i;if((n=(i=r).index+(i[0].length||1))==e.length)return i}}function a(e,t,i,n){if(e.length==t.length)return i;for(var r=0,s=i+Math.max(0,e.length-t.length);;){if(r==s)return r;var o=r+s>>1,a=n(e.slice(0,o)).length;if(a==i)return o;a>i?s=o:r=o+1}}function l(e,l,c,h){var u;this.atOccurrence=!1,this.doc=e,c=c?e.clipPos(c):n(0,0),this.pos={from:c,to:c},"object"==typeof h?u=h.caseFold:(u=h,h=null),"string"==typeof l?(null==u&&(u=!1),this.matches=function(r,s){return(r?function(e,r,s,o){if(!r.length)return null;var l=o?t:i,c=l(r).split(/\r|\n\r?/);e:for(var h=s.line,u=s.ch,d=e.firstLine()-1+c.length;h>=d;h--,u=-1){var f=e.getLine(h);u>-1&&(f=f.slice(0,u));var p=l(f);if(1==c.length){var m=p.lastIndexOf(c[0]);if(-1==m)continue e;return{from:n(h,a(f,p,m,l)),to:n(h,a(f,p,m+c[0].length,l))}}var g=c[c.length-1];if(p.slice(0,g.length)==g){for(var v=1,s=h-c.length+1;v<c.length-1;v++)if(l(e.getLine(s+v))!=c[v])continue e;var y=e.getLine(h+1-c.length),k=l(y);if(k.slice(k.length-c[0].length)==c[0])return{from:n(h+1-c.length,a(y,k,y.length-c[0].length,l)),to:n(h,a(f,p,g.length,l))}}}}:function(e,r,s,o){if(!r.length)return null;var l=o?t:i,c=l(r).split(/\r|\n\r?/);e:for(var h=s.line,u=s.ch,d=e.lastLine()+1-c.length;h<=d;h++,u=0){var f=e.getLine(h).slice(u),p=l(f);if(1==c.length){var m=p.indexOf(c[0]);if(-1==m)continue e;var s=a(f,p,m,l)+u;return{from:n(h,a(f,p,m,l)+u),to:n(h,a(f,p,m+c[0].length,l)+u)}}var g=p.length-c[0].length;if(p.slice(g)==c[0]){for(var v=1;v<c.length-1;v++)if(l(e.getLine(h+v))!=c[v])continue e;var y=e.getLine(h+c.length-1),k=l(y),b=c[c.length-1];if(k.slice(0,b.length)==b)return{from:n(h,a(f,p,g,l)+u),to:n(h+c.length-1,a(y,k,b.length,l))}}}})(e,l,s,u)}):(l=r(l,"gm"),h&&!1===h.multiline?this.matches=function(t,i){return(t?function(e,t,i){t=r(t,"g");for(var s=i.line,a=i.ch,l=e.firstLine();s>=l;s--,a=-1){var c=e.getLine(s);a>-1&&(c=c.slice(0,a));var h=o(c,t);if(h)return{from:n(s,h.index),to:n(s,h.index+h[0].length),match:h}}}:s)(e,l,i)}:this.matches=function(t,i){return(t?function(e,t,i){t=r(t,"gm");for(var s,a=1,l=i.line,c=e.firstLine();l>=c;){for(var h=0;h<a;h++){var u=e.getLine(l--);s=null==s?u.slice(0,i.ch):u+"\n"+s}a*=2;var d=o(s,t);if(d){var f=s.slice(0,d.index).split("\n"),p=d[0].split("\n"),m=l+f.length,g=f[f.length-1].length;return{from:n(m,g),to:n(m+p.length-1,1==p.length?g+p[0].length:p[p.length-1].length),match:d}}}}:function(e,t,i){if(!function(e){return/\\s|\\n|\n|\\W|\\D|\[\^/.test(e.source)}(t))return s(e,t,i);t=r(t,"gm");for(var o,a=1,l=i.line,c=e.lastLine();l<=c;){for(var h=0;h<a&&!(l>c);h++){var u=e.getLine(l++);o=null==o?u:o+"\n"+u}a*=2,t.lastIndex=i.ch;var d=t.exec(o);if(d){var f=o.slice(0,d.index).split("\n"),p=d[0].split("\n"),m=i.line+f.length-1,g=f[f.length-1].length;return{from:n(m,g),to:n(m+p.length-1,1==p.length?g+p[0].length:p[p.length-1].length),match:d}}}})(e,l,i)})}String.prototype.normalize?(t=function(e){return e.normalize("NFD").toLowerCase()},i=function(e){return e.normalize("NFD")}):(t=function(e){return e.toLowerCase()},i=function(e){return e}),l.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(t){for(var i=this.matches(t,this.doc.clipPos(t?this.pos.from:this.pos.to));i&&0==e.cmpPos(i.from,i.to);)t?i.from.ch?i.from=n(i.from.line,i.from.ch-1):i=i.from.line==this.doc.firstLine()?null:this.matches(t,this.doc.clipPos(n(i.from.line-1))):i.to.ch<this.doc.getLine(i.to.line).length?i.to=n(i.to.line,i.to.ch+1):i=i.to.line==this.doc.lastLine()?null:this.matches(t,n(i.to.line+1,0));if(i)return this.pos=i,this.atOccurrence=!0,this.pos.match||!0;var r=n(t?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:r,to:r},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(t,i){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,i),this.pos.to=n(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,t,i){return new l(this.doc,e,t,i)}),e.defineDocExtension("getSearchCursor",function(e,t,i){return new l(this,e,t,i)}),e.defineExtension("selectMatches",function(t,i){for(var n=[],r=this.getSearchCursor(t,this.getCursor("from"),i);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)n.push({anchor:r.from(),head:r.to()});n.length&&this.setSelections(n,0)})}),define("skylark-codemirror/addon/dialog/dialog",["../../CodeMirror"],function(e){function t(t,i,n){var r,s=t.getWrapperElement();return(r=s.appendChild(document.createElement("div"))).className=n?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof i?r.innerHTML=i:r.appendChild(i),e.addClass(s,"dialog-opened"),r}function i(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}e.defineExtension("openDialog",function(n,r,s){s||(s={}),i(this,null);var o=t(this,n,s.bottom),a=!1,l=this;function c(t){if("string"==typeof t)u.value=t;else{if(a)return;a=!0,e.rmClass(o.parentNode,"dialog-opened"),o.parentNode.removeChild(o),l.focus(),s.onClose&&s.onClose(o)}}var h,u=o.getElementsByTagName("input")[0];return u?(u.focus(),s.value&&(u.value=s.value,!1!==s.selectValueOnOpen&&u.select()),s.onInput&&e.on(u,"input",function(e){s.onInput(e,u.value,c)}),s.onKeyUp&&e.on(u,"keyup",function(e){s.onKeyUp(e,u.value,c)}),e.on(u,"keydown",function(t){s&&s.onKeyDown&&s.onKeyDown(t,u.value,c)||((27==t.keyCode||!1!==s.closeOnEnter&&13==t.keyCode)&&(u.blur(),e.e_stop(t),c()),13==t.keyCode&&r(u.value,t))}),!1!==s.closeOnBlur&&e.on(u,"blur",c)):(h=o.getElementsByTagName("button")[0])&&(e.on(h,"click",function(){c(),l.focus()}),!1!==s.closeOnBlur&&e.on(h,"blur",c),h.focus()),c}),e.defineExtension("openConfirm",function(n,r,s){i(this,null);var o=t(this,n,s&&s.bottom),a=o.getElementsByTagName("button"),l=!1,c=this,h=1;function u(){l||(l=!0,e.rmClass(o.parentNode,"dialog-opened"),o.parentNode.removeChild(o),c.focus())}a[0].focus();for(var d=0;d<a.length;++d){var f=a[d];!function(t){e.on(f,"click",function(i){e.e_preventDefault(i),u(),t&&t(c)})}(r[d]),e.on(f,"blur",function(){--h,setTimeout(function(){h<=0&&u()},200)}),e.on(f,"focus",function(){++h})}}),e.defineExtension("openNotification",function(n,r){i(this,c);var s,o=t(this,n,r&&r.bottom),a=!1,l=r&&void 0!==r.duration?r.duration:5e3;function c(){a||(a=!0,clearTimeout(s),e.rmClass(o.parentNode,"dialog-opened"),o.parentNode.removeChild(o))}return e.on(o,"click",function(t){e.e_preventDefault(t),c()}),l&&(s=setTimeout(c,l)),c})}),define("skylark-codemirror/addon/search/search",["../../CodeMirror","./searchcursor","../dialog/dialog"],function(e){"use strict";function t(e){return e.state.search||(e.state.search=new function(){this.posFrom=this.posTo=this.lastQuery=this.query=null,this.overlay=null})}function i(e){return"string"==typeof e&&e==e.toLowerCase()}function n(e,t,n){return e.getSearchCursor(t,n,{caseFold:i(t),multiline:!0})}function r(e,t,i,n,r){e.openDialog?e.openDialog(t,r,{value:n,selectValueOnOpen:!0}):r(prompt(i,n))}function s(e){return e.replace(/\\(.)/g,function(e,t){return"n"==t?"\n":"r"==t?"\r":t})}function o(e){var t=e.match(/^\/(.*)\/([a-z]*)$/);if(t)try{e=new RegExp(t[1],-1==t[2].indexOf("i")?"":"i")}catch(e){}else e=s(e);return("string"==typeof e?""==e:e.test(""))&&(e=/x^/),e}function a(e,t,n){t.queryText=n,t.query=o(n),e.removeOverlay(t.overlay,i(t.query)),t.overlay=function(e,t){"string"==typeof e?e=new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t?"gi":"g"):e.global||(e=new RegExp(e.source,e.ignoreCase?"gi":"g"));return{token:function(t){e.lastIndex=t.pos;var i=e.exec(t.string);if(i&&i.index==t.pos)return t.pos+=i[0].length||1,"searching";i?t.pos=i.index:t.skipToEnd()}}}(t.query,i(t.query)),e.addOverlay(t.overlay),e.showMatchesOnScrollbar&&(t.annotate&&(t.annotate.clear(),t.annotate=null),t.annotate=e.showMatchesOnScrollbar(t.query,i(t.query)))}function l(i,n,s,o){var l=t(i);if(l.query)return c(i,n);var d=i.getSelection()||l.lastQuery;if(d instanceof RegExp&&"x^"==d.source&&(d=null),s&&i.openDialog){var f=null,p=function(t,n){e.e_stop(n),t&&(t!=l.queryText&&(a(i,l,t),l.posFrom=l.posTo=i.getCursor()),f&&(f.style.opacity=1),c(i,n.shiftKey,function(e,t){var n;t.line<3&&document.querySelector&&(n=i.display.wrapper.querySelector(".CodeMirror-dialog"))&&n.getBoundingClientRect().bottom-4>i.cursorCoords(t,"window").top&&((f=n).style.opacity=.4)}))};!function(e,t,i,n,r){e.openDialog(t,n,{value:i,selectValueOnOpen:!0,closeOnEnter:!1,onClose:function(){h(e)},onKeyDown:r})}(i,u(i),d,p,function(n,r){var s=e.keyName(n),o=i.getOption("extraKeys"),l=o&&o[s]||e.keyMap[i.getOption("keyMap")][s];"findNext"==l||"findPrev"==l||"findPersistentNext"==l||"findPersistentPrev"==l?(e.e_stop(n),a(i,t(i),r),i.execCommand(l)):"find"!=l&&"findPersistent"!=l||(e.e_stop(n),p(r,n))}),o&&d&&(a(i,l,d),c(i,n))}else r(i,u(i),"Search for:",d,function(e){e&&!l.query&&i.operation(function(){a(i,l,e),l.posFrom=l.posTo=i.getCursor(),c(i,n)})})}function c(i,r,s){i.operation(function(){var o=t(i),a=n(i,o.query,r?o.posFrom:o.posTo);(a.find(r)||(a=n(i,o.query,r?e.Pos(i.lastLine()):e.Pos(i.firstLine(),0))).find(r))&&(i.setSelection(a.from(),a.to()),i.scrollIntoView({from:a.from(),to:a.to()},20),o.posFrom=a.from(),o.posTo=a.to(),s&&s(a.from(),a.to()))})}function h(e){e.operation(function(){var i=t(e);i.lastQuery=i.query,i.query&&(i.query=i.queryText=null,e.removeOverlay(i.overlay),i.annotate&&(i.annotate.clear(),i.annotate=null))})}function u(e){return'<span class="CodeMirror-search-label">'+e.phrase("Search:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+e.phrase("(Use /re/ syntax for regexp search)")+"</span>"}function d(e,t,i){e.operation(function(){for(var r=n(e,t);r.findNext();)if("string"!=typeof t){var s=e.getRange(r.from(),r.to()).match(t);r.replace(i.replace(/\$(\d)/g,function(e,t){return s[t]}))}else r.replace(i)})}function f(e,i){if(!e.getOption("readOnly")){var a=e.getSelection()||t(e).lastQuery,l='<span class="CodeMirror-search-label">'+(i?e.phrase("Replace all:"):e.phrase("Replace:"))+"</span>";r(e,l+function(e){return' <input type="text" style="width: 10em" class="CodeMirror-search-field"/> <span style="color: #888" class="CodeMirror-search-hint">'+e.phrase("(Use /re/ syntax for regexp search)")+"</span>"}(e),l,a,function(t){t&&(t=o(t),r(e,function(e){return'<span class="CodeMirror-search-label">'+e.phrase("With:")+'</span> <input type="text" style="width: 10em" class="CodeMirror-search-field"/>'}(e),e.phrase("Replace with:"),"",function(r){if(r=s(r),i)d(e,t,r);else{h(e);var o=n(e,t,e.getCursor("from")),a=function(){var i,s=o.from();!(i=o.findNext())&&(o=n(e,t),!(i=o.findNext())||s&&o.from().line==s.line&&o.from().ch==s.ch)||(e.setSelection(o.from(),o.to()),e.scrollIntoView({from:o.from(),to:o.to()}),function(e,t,i,n){e.openConfirm?e.openConfirm(t,n):confirm(i)&&n[0]()}(e,function(e){return'<span class="CodeMirror-search-label">'+e.phrase("Replace?")+"</span> <button>"+e.phrase("Yes")+"</button> <button>"+e.phrase("No")+"</button> <button>"+e.phrase("All")+"</button> <button>"+e.phrase("Stop")+"</button> "}(e),e.phrase("Replace?"),[function(){l(i)},a,function(){d(e,t,r)}]))},l=function(e){o.replace("string"==typeof t?r:r.replace(/\$(\d)/g,function(t,i){return e[i]})),a()};a()}}))})}}e.commands.find=function(e){h(e),l(e)},e.commands.findPersistent=function(e){h(e),l(e,!1,!0)},e.commands.findPersistentNext=function(e){l(e,!1,!0,!0)},e.commands.findPersistentPrev=function(e){l(e,!0,!0,!0)},e.commands.findNext=l,e.commands.findPrev=function(e){l(e,!0)},e.commands.clearSearch=h,e.commands.replace=f,e.commands.replaceAll=function(e){f(e,!0)}}),define("skylark-codemirror/addon/scroll/annotatescrollbar",["../../CodeMirror"],function(e){"use strict";function t(e,t){function i(e){clearTimeout(n.doRedraw),n.doRedraw=setTimeout(function(){n.redraw()},e)}this.cm=e,this.options=t,this.buttonHeight=t.scrollButtonHeight||e.getOption("scrollButtonHeight"),this.annotations=[],this.doRedraw=this.doUpdate=null,this.div=e.getWrapperElement().appendChild(document.createElement("div")),this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none",this.computeScale();var n=this;e.on("refresh",this.resizeHandler=function(){clearTimeout(n.doUpdate),n.doUpdate=setTimeout(function(){n.computeScale()&&i(20)},100)}),e.on("markerAdded",this.resizeHandler),e.on("markerCleared",this.resizeHandler),!1!==t.listenForChanges&&e.on("change",this.changeHandler=function(){i(250)})}e.defineExtension("annotateScrollbar",function(e){return"string"==typeof e&&(e={className:e}),new t(this,e)}),e.defineOption("scrollButtonHeight",0),t.prototype.computeScale=function(){var e=this.cm,t=(e.getWrapperElement().clientHeight-e.display.barHeight-2*this.buttonHeight)/e.getScrollerElement().scrollHeight;if(t!=this.hScale)return this.hScale=t,!0},t.prototype.update=function(e){this.annotations=e,this.redraw()},t.prototype.redraw=function(e){!1!==e&&this.computeScale();var t=this.cm,i=this.hScale,n=document.createDocumentFragment(),r=this.annotations,s=t.getOption("lineWrapping"),o=s&&1.5*t.defaultTextHeight(),a=null,l=null;function c(e,i){if(a!=e.line&&(a=e.line,l=t.getLineHandle(a)),l.widgets&&l.widgets.length||s&&l.height>o)return t.charCoords(e,"local")[i?"top":"bottom"];var n=t.heightAtLine(l,"local");return n+(i?0:l.height)}var h=t.lastLine();if(t.display.barWidth)for(var u,d=0;d<r.length;d++){var f=r[d];if(!(f.to.line>h)){for(var p=u||c(f.from,!0)*i,m=c(f.to,!1)*i;d<r.length-1&&!(r[d+1].to.line>h)&&!((u=c(r[d+1].from,!0)*i)>m+.9);)f=r[++d],m=c(f.to,!1)*i;if(m!=p){var g=Math.max(m-p,3),v=n.appendChild(document.createElement("div"));v.style.cssText="position: absolute; right: 0px; width: "+Math.max(t.display.barWidth-1,2)+"px; top: "+(p+this.buttonHeight)+"px; height: "+g+"px",v.className=this.options.className,f.id&&v.setAttribute("annotation-id",f.id)}}}this.div.textContent="",this.div.appendChild(n)},t.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler),this.cm.off("markerAdded",this.resizeHandler),this.cm.off("markerCleared",this.resizeHandler),this.changeHandler&&this.cm.off("change",this.changeHandler),this.div.parentNode.removeChild(this.div)}}),define("skylark-codemirror/addon/search/matchesonscrollbar",["../../CodeMirror","./searchcursor","../scroll/annotatescrollbar"],function(e){"use strict";function t(e,t,i,n){this.cm=e,this.options=n;var r={listenForChanges:!1};for(var s in n)r[s]=n[s];r.className||(r.className="CodeMirror-search-match"),this.annotation=e.annotateScrollbar(r),this.query=t,this.caseFold=i,this.gap={from:e.firstLine(),to:e.lastLine()+1},this.matches=[],this.update=null,this.findMatches(),this.annotation.update(this.matches);var o=this;e.on("change",this.changeHandler=function(e,t){o.onChange(t)})}e.defineExtension("showMatchesOnScrollbar",function(e,i,n){return"string"==typeof n&&(n={className:n}),n||(n={}),new t(this,e,i,n)});function i(e,t,i){return e<=t?e:Math.max(t,e+i)}t.prototype.findMatches=function(){if(this.gap){for(var t=0;t<this.matches.length;t++){var i=this.matches[t];if(i.from.line>=this.gap.to)break;i.to.line>=this.gap.from&&this.matches.splice(t--,1)}for(var n=this.cm.getSearchCursor(this.query,e.Pos(this.gap.from,0),this.caseFold),r=this.options&&this.options.maxMatches||1e3;n.findNext();){var i={from:n.from(),to:n.to()};if(i.from.line>=this.gap.to)break;if(this.matches.splice(t++,0,i),this.matches.length>r)break}this.gap=null}},t.prototype.onChange=function(t){var n=t.from.line,r=e.changeEnd(t).line,s=r-t.to.line;if(this.gap?(this.gap.from=Math.min(i(this.gap.from,n,s),t.from.line),this.gap.to=Math.max(i(this.gap.to,n,s),t.from.line)):this.gap={from:t.from.line,to:r+1},s)for(var o=0;o<this.matches.length;o++){var a=this.matches[o],l=i(a.from.line,n,s);l!=a.from.line&&(a.from=e.Pos(l,a.from.ch));var c=i(a.to.line,n,s);c!=a.to.line&&(a.to=e.Pos(c,a.to.ch))}clearTimeout(this.update);var h=this;this.update=setTimeout(function(){h.updateAfterChange()},250)},t.prototype.updateAfterChange=function(){this.findMatches(),this.annotation.update(this.matches)},t.prototype.clear=function(){this.cm.off("change",this.changeHandler),this.annotation.clear()}}),define("skylark-codemirror/addon/search/match-highlighter",["../../CodeMirror","./matchesonscrollbar"],function(e){"use strict";var t={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};function i(e){var t=e.state.matchHighlighter;(t.active||e.hasFocus())&&r(e,t)}function n(e){var t=e.state.matchHighlighter;t.active||(t.active=!0,r(e,t))}function r(e,t){clearTimeout(t.timeout),t.timeout=setTimeout(function(){a(e)},t.options.delay)}function s(e,t,i,n){var r=e.state.matchHighlighter;if(e.addOverlay(r.overlay=function(e,t,i){return{token:function(n){if(n.match(e)&&(!t||function(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}(n,t)))return i;n.next(),n.skipTo(e.charAt(0))||n.skipToEnd()}}}(t,i,n)),r.options.annotateScrollbar&&e.showMatchesOnScrollbar){var s=i?new RegExp("\\b"+t.replace(/[\\\[.+*?(){|^$]/g,"\\$&")+"\\b"):t;r.matchesonscroll=e.showMatchesOnScrollbar(s,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}}function o(e){var t=e.state.matchHighlighter;t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null,t.matchesonscroll&&(t.matchesonscroll.clear(),t.matchesonscroll=null))}function a(e){e.operation(function(){var t=e.state.matchHighlighter;if(o(e),e.somethingSelected()||!t.options.showToken){var i=e.getCursor("from"),n=e.getCursor("to");if(i.line==n.line&&(!t.options.wordsOnly||function(e,t,i){if(null!==e.getRange(t,i).match(/^\w+$/)){if(t.ch>0){var n={line:t.line,ch:t.ch-1},r=e.getRange(n,t);if(null===r.match(/\W/))return!1}if(i.ch<e.getLine(t.line).length){var n={line:i.line,ch:i.ch+1},r=e.getRange(i,n);if(null===r.match(/\W/))return!1}return!0}return!1}(e,i,n))){var r=e.getRange(i,n);t.options.trim&&(r=r.replace(/^\s+|\s+$/g,"")),r.length>=t.options.minChars&&s(e,r,!1,t.options.style)}}else{for(var a=!0===t.options.showToken?/[\w$]/:t.options.showToken,l=e.getCursor(),c=e.getLine(l.line),h=l.ch,u=h;h&&a.test(c.charAt(h-1));)--h;for(;u<c.length&&a.test(c.charAt(u));)++u;h<u&&s(e,c.slice(h,u),a,t.options.style)}})}e.defineOption("highlightSelectionMatches",!1,function(r,s,l){if(l&&l!=e.Init&&(o(r),clearTimeout(r.state.matchHighlighter.timeout),r.state.matchHighlighter=null,r.off("cursorActivity",i),r.off("focus",n)),s){var c=r.state.matchHighlighter=new function(e){for(var i in this.options={},t)this.options[i]=(e&&e.hasOwnProperty(i)?e:t)[i];this.overlay=this.timeout=null,this.matchesonscroll=null,this.active=!1}(s);r.hasFocus()?(c.active=!0,a(r)):r.on("focus",n),r.on("cursorActivity",i)}})}),define("skylark-codemirror/addon/hint/anyword-hint",["../../CodeMirror"],function(e){"use strict";var t=/[\w$]+/;e.registerHelper("hint","anyword",function(i,n){for(var r=n&&n.word||t,s=n&&n.range||500,o=i.getCursor(),a=i.getLine(o.line),l=o.ch,c=l;c&&r.test(a.charAt(c-1));)--c;for(var h=c!=l&&a.slice(c,l),u=n&&n.list||[],d={},f=new RegExp(r.source,"g"),p=-1;p<=1;p+=2)for(var m=o.line,g=Math.min(Math.max(m+p*s,i.firstLine()),i.lastLine())+p;m!=g;m+=p)for(var v,y=i.getLine(m);v=f.exec(y);)m==o.line&&v[0]===h||h&&0!=v[0].lastIndexOf(h,0)||Object.prototype.hasOwnProperty.call(d,v[0])||(d[v[0]]=!0,u.push(v[0]));return{list:u,from:e.Pos(o.line,c),to:e.Pos(o.line,l)}})}),define("skylark-codemirror/addon/hint/javascript-hint",["../../CodeMirror"],function(e){var t=e.Pos;function i(e,t){for(var i=0,n=e.length;i<n;++i)t(e[i])}function n(n,r,l,c){var h=n.getCursor(),u=l(n,h);if(!/\b(?:string|comment)\b/.test(u.type)){var d=e.innerMode(n.getMode(),u.state);if("json"!==d.mode.helperType){u.state=d.state,/^[\w$_]*$/.test(u.string)?u.end>h.ch&&(u.end=h.ch,u.string=u.string.slice(0,h.ch-u.start)):u={start:h.ch,end:h.ch,string:"",state:u.state,type:"."==u.string?"property":null};for(var f=u;"property"==f.type;){if("."!=(f=l(n,t(h.line,f.start))).string)return;if(f=l(n,t(h.line,f.start)),!p)var p=[];p.push(f)}return{list:function(e,t,n,r){var l=[],c=e.string,h=r&&r.globalScope||window;function u(e){0!=e.lastIndexOf(c,0)||function(e,t){if(!Array.prototype.indexOf){for(var i=e.length;i--;)if(e[i]===t)return!0;return!1}return-1!=e.indexOf(t)}(l,e)||l.push(e)}function d(e){"string"==typeof e?i(s,u):e instanceof Array?i(o,u):e instanceof Function&&i(a,u),function(e,t){if(Object.getOwnPropertyNames&&Object.getPrototypeOf)for(var i=e;i;i=Object.getPrototypeOf(i))Object.getOwnPropertyNames(i).forEach(t);else for(var n in e)t(n)}(e,u)}if(t&&t.length){var f,p=t.pop();for(p.type&&0===p.type.indexOf("variable")?(r&&r.additionalContext&&(f=r.additionalContext[p.string]),r&&!1===r.useGlobalScope||(f=f||h[p.string])):"string"==p.type?f="":"atom"==p.type?f=1:"function"==p.type&&(null==h.jQuery||"$"!=p.string&&"jQuery"!=p.string||"function"!=typeof h.jQuery?null!=h._&&"_"==p.string&&"function"==typeof h._&&(f=h._()):f=h.jQuery());null!=f&&t.length;)f=f[t.pop().string];null!=f&&d(f)}else{for(var m=e.state.localVars;m;m=m.next)u(m.name);for(var m=e.state.globalVars;m;m=m.next)u(m.name);r&&!1===r.useGlobalScope||d(h),i(n,u)}return l}(u,p,r,c),from:t(h.line,u.start),to:t(h.line,u.end)}}}}function r(e,t){var i=e.getTokenAt(t);return t.ch==i.start+1&&"."==i.string.charAt(0)?(i.end=i.start,i.string=".",i.type="property"):/^\.[\w$_]*$/.test(i.string)&&(i.type="property",i.start++,i.string=i.string.replace(/\./,"")),i}e.registerHelper("hint","javascript",function(e,t){return n(e,l,function(e,t){return e.getTokenAt(t)},t)}),e.registerHelper("hint","coffeescript",function(e,t){return n(e,c,r,t)});var s="charAt charCodeAt indexOf lastIndexOf substring substr slice trim trimLeft trimRight toUpperCase toLowerCase split concat match replace search".split(" "),o="length concat join splice push pop shift unshift slice reverse sort indexOf lastIndexOf every some filter forEach map reduce reduceRight ".split(" "),a="prototype apply call bind".split(" "),l="break case catch class const continue debugger default delete do else export extends false finally for function if in import instanceof new null return super switch this throw true try typeof var void while with yield".split(" "),c="and break catch class continue delete do else extends false finally for if in instanceof isnt new no not null of off on or return switch then throw true try typeof until void while with yes".split(" ")}),define("skylark-codemirror/addon/lint/javascript-lint",["../../CodeMirror"],function(e){"use strict";e.registerHelper("lint","javascript",function(t,i){if(!window.JSHINT)return window.console&&window.console.error("Error: window.JSHINT not defined, CodeMirror JavaScript linting cannot run."),[];i.indent||(i.indent=1);JSHINT(t,i,i.globals);var n=JSHINT.data().errors,r=[];n&&function(t,i){for(var n=0;n<t.length;n++){var r=t[n];if(r){if(r.line<=0){window.console&&window.console.warn("Cannot display JSHint error (invalid line "+r.line+")",r);continue}var s=r.character-1,o=s+1;if(r.evidence){var a=r.evidence.substring(s).search(/.\b/);a>-1&&(o+=a)}var l={message:r.reason,severity:r.code&&r.code.startsWith("W")?"warning":"error",from:e.Pos(r.line-1,s),to:e.Pos(r.line-1,o)};i.push(l)}}}(n,r);return r})}),define("skylark-codemirror/addon/lint/lint",["../../CodeMirror"],function(e){"use strict";var t="CodeMirror-lint-markers";function i(e){e.parentNode&&e.parentNode.removeChild(e)}function n(t,n,r){var s=function(t,i){var n=document.createElement("div");function r(t){if(!n.parentNode)return e.off(document,"mousemove",r);n.style.top=Math.max(0,t.clientY-n.offsetHeight-5)+"px",n.style.left=t.clientX+5+"px"}n.className="CodeMirror-lint-tooltip",n.appendChild(i.cloneNode(!0)),document.body.appendChild(n),e.on(document,"mousemove",r),r(t),null!=n.style.opacity&&(n.style.opacity=1);return n}(t,n);function o(){e.off(r,"mouseout",o),s&&(!function(e){if(!e.parentNode)return;null==e.style.opacity&&i(e);e.style.opacity=0,setTimeout(function(){i(e)},600)}(s),s=null)}var a=setInterval(function(){if(s)for(var e=r;;e=e.parentNode){if(e&&11==e.nodeType&&(e=e.host),e==document.body)return;if(!e){o();break}}if(!s)return clearInterval(a)},400);e.on(r,"mouseout",o)}function r(e,t,i){this.marked=[],this.options=t,this.timeout=null,this.hasGutter=i,this.onMouseOver=function(t){!function(e,t){var i=t.target||t.srcElement;if(!/\bCodeMirror-lint-mark-/.test(i.className))return;for(var r=i.getBoundingClientRect(),s=(r.left+r.right)/2,o=(r.top+r.bottom)/2,a=e.findMarksAt(e.coordsChar({left:s,top:o},"client")),c=[],h=0;h<a.length;++h){var u=a[h].__annotation;u&&c.push(u)}c.length&&function(e,t){for(var i=t.target||t.srcElement,r=document.createDocumentFragment(),s=0;s<e.length;s++){var o=e[s];r.appendChild(l(o))}n(t,r,i)}(c,t)}(e,t)},this.waitingFor=0}function s(e){var i=e.state.lint;i.hasGutter&&e.clearGutter(t);for(var n=0;n<i.marked.length;++n)i.marked[n].clear();i.marked.length=0}function o(t,i,r,s){var o=document.createElement("div"),a=o;return o.className="CodeMirror-lint-marker-"+i,r&&((a=o.appendChild(document.createElement("div"))).className="CodeMirror-lint-marker-multiple"),0!=s&&e.on(a,"mouseover",function(e){n(e,t,a)}),o}function a(e,t){return"error"==e?e:t}function l(e){var t=e.severity;t||(t="error");var i=document.createElement("div");return i.className="CodeMirror-lint-message-"+t,void 0!==e.messageHTML?i.innerHTML=e.messageHTML:i.appendChild(document.createTextNode(e.message)),i}function c(t){var i=t.state.lint,n=i.options,r=n.options||n,s=n.getAnnotations||t.getHelper(e.Pos(0,0),"lint");if(s)if(n.async||s.async)!function(t,i,n){var r=t.state.lint,s=++r.waitingFor;function o(){s=-1,t.off("change",o)}t.on("change",o),i(t.getValue(),function(i,n){t.off("change",o),r.waitingFor==s&&(n&&i instanceof e&&(i=n),t.operation(function(){h(t,i)}))},n,t)}(t,s,r);else{var o=s(t.getValue(),r,t);if(!o)return;o.then?o.then(function(e){t.operation(function(){h(t,e)})}):t.operation(function(){h(t,o)})}}function h(e,i){s(e);for(var n=e.state.lint,r=n.options,c=function(e){for(var t=[],i=0;i<e.length;++i){var n=e[i],r=n.from.line;(t[r]||(t[r]=[])).push(n)}return t}(i),h=0;h<c.length;++h){var u=c[h];if(u){for(var d=null,f=n.hasGutter&&document.createDocumentFragment(),p=0;p<u.length;++p){var m=u[p],g=m.severity;g||(g="error"),d=a(d,g),r.formatAnnotation&&(m=r.formatAnnotation(m)),n.hasGutter&&f.appendChild(l(m)),m.to&&n.marked.push(e.markText(m.from,m.to,{className:"CodeMirror-lint-mark-"+g,__annotation:m}))}n.hasGutter&&e.setGutterMarker(h,t,o(f,d,u.length>1,n.options.tooltips))}}r.onUpdateLinting&&r.onUpdateLinting(i,c,e)}function u(e){var t=e.state.lint;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(function(){c(e)},t.options.delay||500))}e.defineOption("lint",!1,function(i,n,o){if(o&&o!=e.Init&&(s(i),!1!==i.state.lint.options.lintOnChange&&i.off("change",u),e.off(i.getWrapperElement(),"mouseover",i.state.lint.onMouseOver),clearTimeout(i.state.lint.timeout),delete i.state.lint),n){for(var a=i.getOption("gutters"),l=!1,h=0;h<a.length;++h)a[h]==t&&(l=!0);var d=i.state.lint=new r(i,function(e,t){if(t instanceof Function)return{getAnnotations:t};t&&!0!==t||(t={});return t}(0,n),l);!1!==d.options.lintOnChange&&i.on("change",u),0!=d.options.tooltips&&"gutter"!=d.options.tooltips&&e.on(i.getWrapperElement(),"mouseover",d.onMouseOver),c(i)}}),e.defineExtension("performLint",function(){this.state.lint&&c(this)})}),define("skylark-codemirror/addon/tern/tern",["../../CodeMirror"],function(e){"use strict";e.TernServer=function(o){var c=this;this.options=o||{};var h=this.options.plugins||(this.options.plugins={});h.doc_comment||(h.doc_comment=!0),this.docs=Object.create(null),this.options.useWorker?this.server=new function(e){var t=e.worker=new Worker(e.options.workerScript);t.postMessage({type:"init",defs:e.options.defs,plugins:e.options.plugins,scripts:e.options.workerDeps});var i=0,n={};function s(e,r){r&&(e.id=++i,n[i]=r),t.postMessage(e)}t.onmessage=function(t){var i=t.data;"getFile"==i.type?r(e,i.name,function(e,t){s({type:"getFile",err:String(e),text:t,id:i.id})}):"debug"==i.type?window.console.log(i.message):i.id&&n[i.id]&&(n[i.id](i.err,i.body),delete n[i.id])},t.onerror=function(e){for(var t in n)n[t](e);n={}},this.addFile=function(e,t){s({type:"add",name:e,text:t})},this.delFile=function(e){s({type:"del",name:e})},this.request=function(e,t){s({type:"req",body:e},t)}}(this):this.server=new tern.Server({getFile:function(e,t){return r(c,e,t)},async:!0,defs:this.options.defs||[],plugins:h}),this.trackChange=function(e,t){!function(e,t,i){var r=s(e,t),o=e.cachedArgHints;o&&o.doc==t&&p(o.start,i.to)>=0&&(e.cachedArgHints=null);var l=r.changed;null==l&&(r.changed=l={from:i.from.line,to:i.from.line});var c=i.from.line+(i.text.length-1);i.from.line<l.to&&(l.to=l.to-(i.to.line-c));c>=l.to&&(l.to=c+1);l.from>i.from.line&&(l.from=i.from.line);t.lineCount()>n&&i.to-l.from>100&&setTimeout(function(){r.changed&&r.changed.to-r.changed.from>100&&a(e,r)},200)}(c,e,t)},this.cachedArgHints=null,this.activeArgHints=null,this.jumpStack=[],this.getHint=function(n,r){return function(n,r,s){n.request(r,{type:"completions",types:!0,docs:!0,urls:!0},function(o,a){if(o)return x(n,r,o);var c=[],h="",u=a.start,d=a.end;'["'==r.getRange(t(u.line,u.ch-2),u)&&'"]'!=r.getRange(d,t(d.line,d.ch+2))&&(h='"]');for(var f=0;f<a.completions.length;++f){var p=a.completions[f],m=l(p.type);a.guess&&(m+=" "+i+"guess"),c.push({text:p.name+h,displayText:p.displayName||p.name,className:m,data:p})}var g={from:u,to:d,list:c},v=null;e.on(g,"close",function(){b(v)}),e.on(g,"update",function(){b(v)}),e.on(g,"select",function(e,t){b(v);var r=n.options.completionTip?n.options.completionTip(e.data):e.data.doc;r&&((v=k(t.parentNode.getBoundingClientRect().right+window.pageXOffset,t.getBoundingClientRect().top+window.pageYOffset,r)).className+=" "+i+"hint-doc")}),s(g)})}(c,n,r)},this.getHint.async=!0},e.TernServer.prototype={addDoc:function(t,i){var n={doc:i,name:t,changed:null};return this.server.addFile(t,_(this,n)),e.on(i,"change",this.trackChange),this.docs[t]=n},delDoc:function(t){var i=o(this,t);i&&(e.off(i.doc,"change",this.trackChange),delete this.docs[i.name],this.server.delFile(i.name))},hideDoc:function(e){w(this);var t=o(this,e);t&&t.changed&&a(this,t)},complete:function(e){e.showHint({hint:this.getHint})},showType:function(e,t,i){c(this,e,t,"type",i)},showDocs:function(e,t,i){c(this,e,t,"documentation",i)},updateArgHints:function(i){!function(i,n){if(w(i),n.somethingSelected())return;var r=n.getTokenAt(n.getCursor()).state,s=e.innerMode(n.getMode(),r);if("javascript"!=s.mode.name)return;var o=s.state.lexical;if("call"!=o.info)return;for(var a,l=o.pos||0,c=n.getOption("tabSize"),u=n.getCursor().line,d=Math.max(0,u-9),f=!1;u>=d;--u){for(var m=n.getLine(u),g=0,v=0;;){var y=m.indexOf("\t",v);if(-1==y)break;g+=c-(y+g)%c-1,v=y+1}if(a=o.column-g,"("==m.charAt(a)){f=!0;break}}if(!f)return;var k=t(u,a),b=i.cachedArgHints;if(b&&b.doc==n.getDoc()&&0==p(k,b.start))return h(i,n,l);i.request(n,{type:"type",preferFunction:!0,end:k},function(e,t){!e&&t.type&&/^fn\(/.test(t.type)&&(i.cachedArgHints={start:k,type:function(e){var t=[],i=3;function n(t){for(var n=0,r=i;;){var s=e.charAt(i);if(t.test(s)&&!n)return e.slice(r,i);/[{\[\(]/.test(s)?++n:/[}\]\)]/.test(s)&&--n,++i}}if(")"!=e.charAt(i))for(;;){var r=e.slice(i).match(/^([^, \(\[\{]+): /);if(r&&(i+=r[0].length,r=r[1]),t.push({name:r,type:n(/[\),]/)}),")"==e.charAt(i))break;i+=2}var s=e.slice(i).match(/^\) -> (.*)$/);return{args:t,rettype:s&&s[1]}}(t.type),name:t.exprName||t.name||"fn",guess:t.guess,doc:n.getDoc()},h(i,n,l))})}(this,i)},jumpToDef:function(e){!function(e,i){function n(n){var r={type:"definition",variable:n||null},o=s(e,i.getDoc());e.server.request(f(e,o,r),function(n,r){if(n)return x(e,i,n);if(r.file||!r.url){if(r.file){var s,a=e.docs[r.file];if(a&&(s=function(e,i){for(var n=i.context.slice(0,i.contextOffset).split("\n"),r=i.start.line-(n.length-1),s=t(r,(1==n.length?i.start.ch:e.getLine(r).length)-n[0].length),o=e.getLine(r).slice(s.ch),a=r+1;a<e.lineCount()&&o.length<i.context.length;++a)o+="\n"+e.getLine(a);if(o.slice(0,i.context.length)==i.context)return i;var l,c=e.getSearchCursor(i.context,0,!1),h=1/0;for(;c.findNext();){var u=c.from(),d=1e4*Math.abs(u.line-s.line);d||(d=Math.abs(u.ch-s.ch)),d<h&&(l=u,h=d)}if(!l)return null;1==n.length?l.ch+=n[0].length:l=t(l.line+(n.length-1),n[n.length-1].length);if(i.start.line==i.end.line)var f=t(l.line,l.ch+(i.end.ch-i.start.ch));else var f=t(l.line+(i.end.line-i.start.line),i.end.ch);return{start:l,end:f}}(a.doc,r)))return e.jumpStack.push({file:o.name,start:i.getCursor("from"),end:i.getCursor("to")}),void u(e,o,a,s.start,s.end)}x(e,i,"Could not find a definition.")}else window.open(r.url)})}!function(e){var t=e.getCursor("end"),i=e.getTokenAt(t);return!(i.start<t.ch&&"comment"==i.type)&&/[\w)\]]/.test(e.getLine(t.line).slice(Math.max(t.ch-1,0),t.ch+1))}(i)?g(i,"Jump to variable",function(e){e&&n(e)}):n()}(this,e)},jumpBack:function(e){!function(e,t){var i=e.jumpStack.pop(),n=i&&e.docs[i.file];if(!n)return;u(e,s(e,t.getDoc()),n,i.start,i.end)}(this,e)},rename:function(e){!function(e,t){var i=t.getTokenAt(t.getCursor());if(!/\w/.test(i.string))return x(e,t,"Not at a variable");g(t,"New name for "+i.string,function(i){e.request(t,{type:"rename",newName:i,fullDocs:!0},function(i,n){if(i)return x(e,t,i);!function(e,t){for(var i=Object.create(null),n=0;n<t.length;++n){var r=t[n];(i[r.file]||(i[r.file]=[])).push(r)}for(var s in i){var o=e.docs[s],a=i[s];if(o){a.sort(function(e,t){return p(t.start,e.start)});for(var l="*rename"+ ++d,n=0;n<a.length;++n){var r=a[n];o.doc.replaceRange(r.text,r.start,r.end,l)}}}}(e,n.changes)})})}(this,e)},selectName:function(e){!function(e,t){var i=s(e,t.doc).name;e.request(t,{type:"refs"},function(n,r){if(n)return x(e,t,n);for(var s=[],o=0,a=t.getCursor(),l=0;l<r.refs.length;l++){var c=r.refs[l];c.file==i&&(s.push({anchor:c.start,head:c.end}),p(a,c.start)>=0&&p(a,c.end)<=0&&(o=s.length-1))}t.setSelections(s,o)})}(this,e)},request:function(e,t,i,n){var r=this,o=s(this,e.getDoc()),a=f(this,o,t,n),l=a.query&&this.options.queryOptions&&this.options.queryOptions[a.query.type];if(l)for(var c in l)a.query[c]=l[c];this.server.request(a,function(e,n){!e&&r.options.responseFilter&&(n=r.options.responseFilter(o,t,a,e,n)),i(e,n)})},destroy:function(){w(this),this.worker&&(this.worker.terminate(),this.worker=null)}};var t=e.Pos,i="CodeMirror-Tern-",n=250;function r(e,t,i){var n=e.docs[t];n?i(_(e,n)):e.options.getFile?e.options.getFile(t,i):i(null)}function s(e,t,i){for(var n in e.docs){var r=e.docs[n];if(r.doc==t)return r}if(!i)for(var s=0;;++s)if(n="[doc"+(s||"")+"]",!e.docs[n]){i=n;break}return e.addDoc(i,t)}function o(t,i){return"string"==typeof i?t.docs[i]:(i instanceof e&&(i=i.getDoc()),i instanceof e.Doc?s(t,i):void 0)}function a(e,t){e.server.request({files:[{type:"full",name:t.name,text:_(e,t)}]},function(e){e?window.console.error(e):t.changed=null})}function l(e){var t;return t="?"==e?"unknown":"number"==e||"string"==e||"bool"==e?e:/^fn\(/.test(e)?"fn":/^\[/.test(e)?"array":"object",i+"completion "+i+"completion-"+t}function c(e,t,i,n,r){e.request(t,n,function(i,n){if(i)return x(e,t,i);if(e.options.typeTip)var s=e.options.typeTip(n);else{var s=m("span",null,m("strong",null,n.type||"not found"));if(n.doc&&s.appendChild(document.createTextNode(" — "+n.doc)),n.url){s.appendChild(document.createTextNode(" "));var o=s.appendChild(m("a",null,"[docs]"));o.href=n.url,o.target="_blank"}}v(t,s,e),r&&r()},i)}function h(e,t,n){w(e);for(var r=e.cachedArgHints,s=r.type,o=m("span",r.guess?i+"fhint-guess":null,m("span",i+"fname",r.name),"("),a=0;a<s.args.length;++a){a&&o.appendChild(document.createTextNode(", "));var l=s.args[a];o.appendChild(m("span",i+"farg"+(a==n?" "+i+"farg-current":""),l.name||"?")),"?"!=l.type&&(o.appendChild(document.createTextNode(": ")),o.appendChild(m("span",i+"type",l.type)))}o.appendChild(document.createTextNode(s.rettype?") -> ":")")),s.rettype&&o.appendChild(m("span",i+"type",s.rettype));var c=t.cursorCoords(null,"page"),h=e.activeArgHints=k(c.right+1,c.bottom,o);setTimeout(function(){h.clear=y(t,function(){e.activeArgHints==h&&w(e)})},20)}function u(e,t,i,n,r){i.doc.setSelection(n,r),t!=i&&e.options.switchToDoc&&(w(e),e.options.switchToDoc(i.name,i.doc))}var d=0;function f(i,r,s,o){var a=[],l=0,c=!s.fullDocs;c||delete s.fullDocs,"string"==typeof s&&(s={type:s}),s.lineCharPositions=!0,null==s.end&&(s.end=o||r.doc.getCursor("end"),r.doc.somethingSelected()&&(s.start=r.doc.getCursor("start")));var h=s.start||s.end;if(r.changed)if(r.doc.lineCount()>n&&!1!==c&&r.changed.to-r.changed.from<100&&r.changed.from<=h.line&&r.changed.to>s.end.line){a.push(function(i,n,r){for(var s,o=i.doc,a=null,l=null,c=n.line-1,h=Math.max(0,c-50);c>=h;--c){var u=o.getLine(c),d=u.search(/\bfunction\b/);if(!(d<0)){var f=e.countColumn(u,null,4);null!=a&&a<=f||(a=f,l=c)}}null==l&&(l=h);var p=Math.min(o.lastLine(),r.line+20);if(null==a||a==e.countColumn(o.getLine(n.line),null,4))s=p;else for(s=r.line+1;s<p;++s){var f=e.countColumn(o.getLine(s),null,4);if(f<=a)break}var m=t(l,0);return{type:"part",name:i.name,offsetLines:m.line,text:o.getRange(m,t(s,r.line==s?null:0))}}(r,h,s.end)),s.file="#0";var l=a[0].offsetLines;null!=s.start&&(s.start=t(s.start.line- -l,s.start.ch)),s.end=t(s.end.line-l,s.end.ch)}else a.push({type:"full",name:r.name,text:_(i,r)}),s.file=r.name,r.changed=null;else s.file=r.name;for(var u in i.docs){var d=i.docs[u];d.changed&&d!=r&&(a.push({type:"full",name:d.name,text:_(i,d)}),d.changed=null)}return{query:s,files:a}}var p=e.cmpPos;function m(e,t){var i=document.createElement(e);t&&(i.className=t);for(var n=2;n<arguments.length;++n){var r=arguments[n];"string"==typeof r&&(r=document.createTextNode(r)),i.appendChild(r)}return i}function g(e,t,i){e.openDialog?e.openDialog(t+": <input type=text>",i):i(prompt(t,""))}function v(t,i,n){t.state.ternTooltip&&b(t.state.ternTooltip);var r=t.cursorCoords(),s=t.state.ternTooltip=k(r.right+1,r.bottom,i);function o(){var e;t.state.ternTooltip=null,s.parentNode&&((e=s).style.opacity="0",setTimeout(function(){b(e)},1100)),c()}var a=!1,l=!1;e.on(s,"mousemove",function(){a=!0}),e.on(s,"mouseout",function(t){var i=t.relatedTarget||t.toElement;i&&e.contains(s,i)||(l?o():a=!1)}),setTimeout(function(){l=!0,a||o()},n.options.hintDelay?n.options.hintDelay:1700);var c=y(t,o)}function y(e,t){return e.on("cursorActivity",t),e.on("blur",t),e.on("scroll",t),e.on("setDoc",t),function(){e.off("cursorActivity",t),e.off("blur",t),e.off("scroll",t),e.off("setDoc",t)}}function k(e,t,n){var r=m("div",i+"tooltip",n);return r.style.left=e+"px",r.style.top=t+"px",document.body.appendChild(r),r}function b(e){var t=e&&e.parentNode;t&&t.removeChild(e)}function x(e,t,i){e.options.showError?e.options.showError(t,i):v(t,String(i),e)}function w(e){e.activeArgHints&&(e.activeArgHints.clear&&e.activeArgHints.clear(),b(e.activeArgHints),e.activeArgHints=null)}function _(e,t){var i=t.doc.getValue();return e.options.fileFilter&&(i=e.options.fileFilter(i,t.name,t.doc)),i}}),define("skylark-widgets-coder/addons/edit/codemirror",["skylark-langx/langx","skylark-domx-data","skylark-codemirror/CodeMirror","../../Addon","../../util","../../Coder","skylark-codemirror/mode/xml/xml","skylark-codemirror/mode/css/css","skylark-codemirror/mode/javascript/javascript","skylark-codemirror/mode/htmlmixed/htmlmixed","skylark-codemirror/mode/markdown/markdown","skylark-codemirror/addon/comment/comment","skylark-codemirror/addon/selection/active-line","skylark-codemirror/addon/fold/foldcode","skylark-codemirror/addon/fold/foldgutter","skylark-codemirror/addon/fold/brace-fold","skylark-codemirror/addon/fold/xml-fold","skylark-codemirror/addon/fold/indent-fold","skylark-codemirror/addon/fold/markdown-fold","skylark-codemirror/addon/fold/comment-fold","skylark-codemirror/addon/edit/matchbrackets","skylark-codemirror/addon/edit/closebrackets","skylark-codemirror/addon/edit/trailingspace","skylark-codemirror/addon/search/searchcursor","skylark-codemirror/addon/search/search","skylark-codemirror/addon/search/match-highlighter","skylark-codemirror/addon/dialog/dialog","skylark-codemirror/addon/hint/anyword-hint","skylark-codemirror/addon/hint/javascript-hint","skylark-codemirror/addon/lint/javascript-lint","skylark-codemirror/addon/lint/lint","skylark-codemirror/addon/tern/tern"],function(e,t,i,n,r,s){"use strict";class o extends n{get options(){return{highlightLine:!0,lineNumbers:!0,lineWrapping:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],pluginCssClass:"coder-plugin-codemirror"}}_init(){super._init();var e,n=this.coder,s=this.options;this.editor={};var o={html:"htmlmixed"},s=this.options,a=n.$container.querySelectorAll(".coder-editor");for(e=0;e<a.length;e++){let n=a[e].querySelector("textarea"),l=t.data(n,"coder-type"),c=t.data(n,"coder-file");this.editor[l]=i.fromTextArea(n,s),this.editor[l].setOption("mode",r.getMode(l,c,o))}n.on("change",this.change.bind(this),1)}editorChange(e){return()=>{var t=this.editor[e.type];e.content=t.getValue(),this.coder.emit("change",e)}}change(e,t){var i=e.data,n=this.editor[i.type];i.cmEditor||(n.setValue(i.content),i.cmEditor=n,n.on("change",this.editorChange(i)))}static get categoryName(){return"edit"}static get addonName(){return"codemirror"}}return o.register(s),o}),define("skylark-ace/lib/regexp",["require","exports","module"],function(require,exports,module){var e,t={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},i=void 0===t.exec.call(/()??/,"")[1],n=(e=/^/g,t.test.call(e,""),!e.lastIndex);n&&i||(RegExp.prototype.exec=function(e){var r,s,o,a=t.exec.apply(this,arguments);if("string"==typeof e&&a){if(!i&&a.length>1&&function(e,t,i){if(Array.prototype.indexOf)return e.indexOf(t,i);for(var n=i||0;n<e.length;n++)if(e[n]===t)return n;return-1}(a,"")>-1&&(s=RegExp(this.source,t.replace.call(((o=this).global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.extended?"x":"")+(o.sticky?"y":""),"g","")),t.replace.call(e.slice(a.index),s,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(a[e]=void 0)})),this._xregexp&&this._xregexp.captureNames)for(var l=1;l<a.length;l++)(r=this._xregexp.captureNames[l-1])&&(a[r]=a[l]);!n&&this.global&&!a[0].length&&this.lastIndex>a.index&&this.lastIndex--}return a},n||(RegExp.prototype.test=function(e){var i=t.exec.call(this,e);return i&&this.global&&!i[0].length&&this.lastIndex>i.index&&this.lastIndex--,!!i}))}),define("skylark-ace/lib/es5-shim",["require","exports","module"],function(require,exports,module){function e(){}Function.prototype.bind||(Function.prototype.bind=function(t){var i=this;if("function"!=typeof i)throw new TypeError("Function.prototype.bind called on incompatible "+i);var n=c.call(arguments,1),r=function(){if(this instanceof r){var e=i.apply(this,n.concat(c.call(arguments)));return Object(e)===e?e:this}return i.apply(t,n.concat(c.call(arguments)))};return i.prototype&&(e.prototype=i.prototype,r.prototype=new e,e.prototype=null),r});var t,i,n,r,s,o=Function.prototype.call,a=Array.prototype,l=Object.prototype,c=a.slice,h=o.bind(l.toString),u=o.bind(l.hasOwnProperty);if((s=u(l,"__defineGetter__"))&&(t=o.bind(l.__defineGetter__),i=o.bind(l.__defineSetter__),n=o.bind(l.__lookupGetter__),r=o.bind(l.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t,i=[];if(i.splice.apply(i,e(20)),i.splice.apply(i,e(26)),t=i.length,i.splice(5,0,"XXX"),i.length,t+1==i.length)return!0}()){var d=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?d.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(c.call(arguments,2))):[]}}else Array.prototype.splice=function(e,t){var i=this.length;e>0?e>i&&(e=i):void 0==e?e=0:e<0&&(e=Math.max(i+e,0)),e+t<i||(t=i-e);var n=this.slice(e,e+t),r=c.call(arguments,2),s=r.length;if(e===i)s&&this.push.apply(this,r);else{var o=Math.min(t,i-e),a=e+o,l=a+s-o,h=i-a,u=i-o;if(l<a)for(var d=0;d<h;++d)this[l+d]=this[a+d];else if(l>a)for(d=h;d--;)this[l+d]=this[a+d];if(s&&e===u)this.length=u,this.push.apply(this,r);else for(this.length=u+s,d=0;d<s;++d)this[e+d]=r[d]}return n};Array.isArray||(Array.isArray=function(e){return"[object Array]"==h(e)});var f,p,m=Object("a"),g="a"!=m[0]||!(0 in m);if(Array.prototype.forEach||(Array.prototype.forEach=function(e){var t=L(this),i=g&&"[object String]"==h(this)?this.split(""):t,n=arguments[1],r=-1,s=i.length>>>0;if("[object Function]"!=h(e))throw new TypeError;for(;++r<s;)r in i&&e.call(n,i[r],r,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=L(this),i=g&&"[object String]"==h(this)?this.split(""):t,n=i.length>>>0,r=Array(n),s=arguments[1];if("[object Function]"!=h(e))throw new TypeError(e+" is not a function");for(var o=0;o<n;o++)o in i&&(r[o]=e.call(s,i[o],o,t));return r}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,i=L(this),n=g&&"[object String]"==h(this)?this.split(""):i,r=n.length>>>0,s=[],o=arguments[1];if("[object Function]"!=h(e))throw new TypeError(e+" is not a function");for(var a=0;a<r;a++)a in n&&(t=n[a],e.call(o,t,a,i)&&s.push(t));return s}),Array.prototype.every||(Array.prototype.every=function(e){var t=L(this),i=g&&"[object String]"==h(this)?this.split(""):t,n=i.length>>>0,r=arguments[1];if("[object Function]"!=h(e))throw new TypeError(e+" is not a function");for(var s=0;s<n;s++)if(s in i&&!e.call(r,i[s],s,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=L(this),i=g&&"[object String]"==h(this)?this.split(""):t,n=i.length>>>0,r=arguments[1];if("[object Function]"!=h(e))throw new TypeError(e+" is not a function");for(var s=0;s<n;s++)if(s in i&&e.call(r,i[s],s,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=L(this),i=g&&"[object String]"==h(this)?this.split(""):t,n=i.length>>>0;if("[object Function]"!=h(e))throw new TypeError(e+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var r,s=0;if(arguments.length>=2)r=arguments[1];else for(;;){if(s in i){r=i[s++];break}if(++s>=n)throw new TypeError("reduce of empty array with no initial value")}for(;s<n;s++)s in i&&(r=e.call(void 0,r,i[s],s,t));return r}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=L(this),i=g&&"[object String]"==h(this)?this.split(""):t,n=i.length>>>0;if("[object Function]"!=h(e))throw new TypeError(e+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var r,s=n-1;if(arguments.length>=2)r=arguments[1];else for(;;){if(s in i){r=i[s--];break}if(--s<0)throw new TypeError("reduceRight of empty array with no initial value")}do{s in this&&(r=e.call(void 0,r,i[s],s,t))}while(s--);return r}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var t=g&&"[object String]"==h(this)?this.split(""):L(this),i=t.length>>>0;if(!i)return-1;var n=0;for(arguments.length>1&&(n=T(arguments[1])),n=n>=0?n:Math.max(0,i+n);n<i;n++)if(n in t&&t[n]===e)return n;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var t=g&&"[object String]"==h(this)?this.split(""):L(this),i=t.length>>>0;if(!i)return-1;var n=i-1;for(arguments.length>1&&(n=Math.min(n,T(arguments[1]))),n=n>=0?n:i-Math.abs(n);n>=0;n--)if(n in t&&e===t[n])return n;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:l)}),!Object.getOwnPropertyDescriptor){Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+e);if(u(e,t)){var i;if(i={enumerable:!0,configurable:!0},s){var o=e.__proto__;e.__proto__=l;var a=n(e,t),c=r(e,t);if(e.__proto__=o,a||c)return a&&(i.get=a),c&&(i.set=c),i}return i.value=e[t],i}}}(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),Object.create)||(f=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var e={};for(var t in e)e[t]=null;return e.constructor=e.hasOwnProperty=e.propertyIsEnumerable=e.isPrototypeOf=e.toLocaleString=e.toString=e.valueOf=e.__proto__=null,e},Object.create=function(e,t){var i;if(null===e)i=f();else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var n=function(){};n.prototype=e,(i=new n).__proto__=e}return void 0!==t&&Object.defineProperties(i,t),i});function v(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(e){}}if(Object.defineProperty){var y=v({}),k="undefined"==typeof document||v(document.createElement("div"));if(!y||!k)var b=Object.defineProperty}if(!Object.defineProperty||b){Object.defineProperty=function(e,o,a){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.defineProperty called on non-object: "+e);if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Property description must be an object: "+a);if(b)try{return b.call(Object,e,o,a)}catch(e){}if(u(a,"value"))if(s&&(n(e,o)||r(e,o))){var c=e.__proto__;e.__proto__=l,delete e[o],e[o]=a.value,e.__proto__=c}else e[o]=a.value;else{if(!s)throw new TypeError("getters & setters can not be defined on this javascript engine");u(a,"get")&&t(e,o,a.get),u(a,"set")&&i(e,o,a.set)}return e}}Object.defineProperties||(Object.defineProperties=function(e,t){for(var i in t)u(t,i)&&Object.defineProperty(e,i,t[i]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(e){Object.freeze=(p=Object.freeze,function(e){return"function"==typeof e?e:p(e)})}if(Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(e){return!1}),Object.isFrozen||(Object.isFrozen=function(e){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)===e)throw new TypeError;for(var t="";u(e,t);)t+="?";e[t]=!0;var i=u(e,t);return delete e[t],i}),!Object.keys){var x=!0,w=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_=w.length;for(var C in{toString:null})x=!1;Object.keys=function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var t=[];for(var i in e)u(e,i)&&t.push(i);if(x)for(var n=0,r=_;n<r;n++){var s=w[n];u(e,s)&&t.push(s)}return t}}Date.now||(Date.now=function(){return(new Date).getTime()});var S="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||S.trim()){S="["+S+"]";var A=new RegExp("^"+S+S+"*"),M=new RegExp(S+S+"*$");String.prototype.trim=function(){return String(this).replace(A,"").replace(M,"")}}function T(e){return(e=+e)!=e?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}var L=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),define("skylark-ace/lib/fixoldbrowsers",["require","exports","module","./regexp","./es5-shim"],function(require,exports,module){require("./regexp"),require("./es5-shim"),"undefined"==typeof Element||Element.prototype.remove||Object.defineProperty(Element.prototype,"remove",{enumerable:!1,writable:!0,configurable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})}),define("skylark-ace/lib/useragent",["require","exports","module"],function(require,exports,module){if(exports.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},exports.getOS=function(){return exports.isMac?exports.OS.MAC:exports.isLinux?exports.OS.LINUX:exports.OS.WINDOWS},"object"==typeof navigator){var e=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),t=navigator.userAgent;exports.isWin="win"==e,exports.isMac="mac"==e,exports.isLinux="linux"==e,exports.isIE="Microsoft Internet Explorer"==navigator.appName||navigator.appName.indexOf("MSAppHost")>=0?parseFloat((t.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((t.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),exports.isOldIE=exports.isIE&&exports.isIE<9,exports.isGecko=exports.isMozilla=t.match(/ Gecko\/\d+/),exports.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),exports.isWebKit=parseFloat(t.split("WebKit/")[1])||void 0,exports.isChrome=parseFloat(t.split(" Chrome/")[1])||void 0,exports.isEdge=parseFloat(t.split(" Edge/")[1])||void 0,exports.isAIR=t.indexOf("AdobeAIR")>=0,exports.isIPad=t.indexOf("iPad")>=0,exports.isAndroid=t.indexOf("Android")>=0,exports.isChromeOS=t.indexOf(" CrOS ")>=0,exports.isIOS=/iPad|iPhone|iPod/.test(t)&&!window.MSStream,exports.isIOS&&(exports.isMac=!0),exports.isMobile=exports.isIPad||exports.isAndroid}}),define("skylark-ace/lib/dom",["require","exports","module","./useragent"],function(require,exports,module){var e=require("./useragent");if(exports.buildDom=function e(t,i,n){if("string"==typeof t&&t){var r=document.createTextNode(t);return i&&i.appendChild(r),r}if(!Array.isArray(t))return t;if("string"!=typeof t[0]||!t[0]){for(var s=[],o=0;o<t.length;o++){var a=e(t[o],i,n);a&&s.push(a)}return s}var l=document.createElement(t[0]),c=t[1],h=1;c&&"object"==typeof c&&!Array.isArray(c)&&(h=2);for(var o=h;o<t.length;o++)e(t[o],l,n);return 2==h&&Object.keys(c).forEach(function(e){var t=c[e];"class"===e?l.className=Array.isArray(t)?t.join(" "):t:"function"==typeof t||"value"==e?l[e]=t:"ref"===e?n&&(n[t]=l):null!=t&&l.setAttribute(e,t)}),i&&i.appendChild(l),l},exports.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},exports.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||"http://www.w3.org/1999/xhtml",e):document.createElement(e)},exports.removeChildren=function(e){e.innerHTML=""},exports.createTextNode=function(e,t){var i=t?t.ownerDocument:document;return i.createTextNode(e)},exports.createFragment=function(e){var t=e?e.ownerDocument:document;return t.createDocumentFragment()},exports.hasCssClass=function(e,t){var i=(e.className+"").split(/\s+/g);return-1!==i.indexOf(t)},exports.addCssClass=function(e,t){exports.hasCssClass(e,t)||(e.className+=" "+t)},exports.removeCssClass=function(e,t){for(var i=e.className.split(/\s+/g);;){var n=i.indexOf(t);if(-1==n)break;i.splice(n,1)}e.className=i.join(" ")},exports.toggleCssClass=function(e,t){for(var i=e.className.split(/\s+/g),n=!0;;){var r=i.indexOf(t);if(-1==r)break;n=!1,i.splice(r,1)}return n&&i.push(t),e.className=i.join(" "),n},exports.setCssClass=function(e,t,i){i?exports.addCssClass(e,t):exports.removeCssClass(e,t)},exports.hasCssString=function(e,t){var i,n=0;if(t=t||document,i=t.querySelectorAll("style"))for(;n<i.length;)if(i[n++].id===e)return!0},exports.importCssString=function(e,t,i){var n=i;i&&i.getRootNode&&(n=i.getRootNode())&&n!=i||(n=document);var r=n.ownerDocument||n;if(t&&exports.hasCssString(t,n))return null;t&&(e+="\n/*# sourceURL=ace/css/"+t+" */");var s=exports.createElement("style");s.appendChild(r.createTextNode(e)),t&&(s.id=t),n==r&&(n=exports.getDocumentHead(r)),n.insertBefore(s,n.firstChild)},exports.importCssStylsheet=function(e,t){exports.buildDom(["link",{rel:"stylesheet",href:e}],exports.getDocumentHead(t))},exports.scrollbarWidth=function(e){var t=exports.createElement("ace_inner");t.style.width="100%",t.style.minWidth="0px",t.style.height="200px",t.style.display="block";var i=exports.createElement("ace_outer"),n=i.style;n.position="absolute",n.left="-10000px",n.overflow="hidden",n.width="200px",n.minWidth="0px",n.height="150px",n.display="block",i.appendChild(t);var r=e.documentElement;r.appendChild(i);var s=t.offsetWidth;n.overflow="scroll";var o=t.offsetWidth;return s==o&&(o=i.clientWidth),r.removeChild(i),s-o},"undefined"==typeof document&&(exports.importCssString=function(){}),exports.computedStyle=function(e,t){return window.getComputedStyle(e,"")||{}},exports.setStyle=function(e,t,i){e[t]!==i&&(e[t]=i)},exports.HAS_CSS_ANIMATION=!1,exports.HAS_CSS_TRANSFORMS=!1,exports.HI_DPI=!e.isWin||"undefined"!=typeof window&&window.devicePixelRatio>=1.5,"undefined"!=typeof document){var t=document.createElement("div");exports.HI_DPI&&void 0!==t.style.transform&&(exports.HAS_CSS_TRANSFORMS=!0),e.isEdge||void 0===t.style.animationName||(exports.HAS_CSS_ANIMATION=!0),t=null}exports.HAS_CSS_TRANSFORMS?exports.translate=function(e,t,i){e.style.transform="translate("+Math.round(t)+"px, "+Math.round(i)+"px)"}:exports.translate=function(e,t,i){e.style.top=Math.round(i)+"px",e.style.left=Math.round(t)+"px"}}),define("skylark-ace/lib/oop",["require","exports","module"],function(require,exports,module){exports.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(e,t){for(var i in t)e[i]=t[i];return e},exports.implement=function(e,t){exports.mixin(e,t)}}),define("skylark-ace/lib/keys",["require","exports","module","./oop"],function(require,exports,module){var e=require("./oop"),t=function(){var t,i,n={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*"}};for(i in n.FUNCTION_KEYS)t=n.FUNCTION_KEYS[i].toLowerCase(),n[t]=parseInt(i,10);for(i in n.PRINTABLE_KEYS)t=n.PRINTABLE_KEYS[i].toLowerCase(),n[t]=parseInt(i,10);return e.mixin(n,n.MODIFIER_KEYS),e.mixin(n,n.PRINTABLE_KEYS),e.mixin(n,n.FUNCTION_KEYS),n.enter=n.return,n.escape=n.esc,n.del=n.delete,n[173]="-",function(){for(var e=["cmd","ctrl","alt","shift"],t=Math.pow(2,e.length);t--;)n.KEY_MODS[t]=e.filter(function(e){return t&n.KEY_MODS[e]}).join("-")+"-"}(),n.KEY_MODS[0]="",n.KEY_MODS[-1]="input-",n}();e.mixin(exports,t),exports.keyCodeToString=function(e){var i=t[e];return"string"!=typeof i&&(i=String.fromCharCode(e)),i.toLowerCase()}}),define("skylark-ace/lib/event",["require","exports","module","./keys","./useragent"],function(require,exports,module){var e=require("./keys"),t=require("./useragent"),i=null,n=0;exports.addListener=function(e,t,i){if(e.addEventListener)return e.addEventListener(t,i,!1);if(e.attachEvent){var n=function(){i.call(e,window.event)};i._wrapper=n,e.attachEvent("on"+t,n)}},exports.removeListener=function(e,t,i){if(e.removeEventListener)return e.removeEventListener(t,i,!1);e.detachEvent&&e.detachEvent("on"+t,i._wrapper||i)},exports.stopEvent=function(e){return exports.stopPropagation(e),exports.preventDefault(e),!1},exports.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},exports.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},exports.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||t.isMac&&e.ctrlKey&&!e.altKey&&!e.shiftKey?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},exports.capture=function(e,t,i){function n(e){t&&t(e),i&&i(e),exports.removeListener(document,"mousemove",t,!0),exports.removeListener(document,"mouseup",n,!0),exports.removeListener(document,"dragstart",n,!0)}return exports.addListener(document,"mousemove",t,!0),exports.addListener(document,"mouseup",n,!0),exports.addListener(document,"dragstart",n,!0),n},exports.addTouchMoveListener=function(e,t){var i,n;exports.addListener(e,"touchstart",function(e){var t=e.touches,r=t[0];i=r.clientX,n=r.clientY}),exports.addListener(e,"touchmove",function(e){var r=e.touches;if(!(r.length>1)){var s=r[0];e.wheelX=i-s.clientX,e.wheelY=n-s.clientY,i=s.clientX,n=s.clientY,t(e)}})},exports.addMouseWheelListener=function(e,t){"onmousewheel"in e?exports.addListener(e,"mousewheel",function(e){void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/8,e.wheelY=-e.wheelDeltaY/8):(e.wheelX=0,e.wheelY=-e.wheelDelta/8),t(e)}):"onwheel"in e?exports.addListener(e,"wheel",function(e){switch(e.deltaMode){case e.DOM_DELTA_PIXEL:e.wheelX=.35*e.deltaX||0,e.wheelY=.35*e.deltaY||0;break;case e.DOM_DELTA_LINE:case e.DOM_DELTA_PAGE:e.wheelX=5*(e.deltaX||0),e.wheelY=5*(e.deltaY||0)}t(e)}):exports.addListener(e,"DOMMouseScroll",function(e){e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),t(e)})},exports.addMultiMouseDownListener=function(e,i,n,r){var s,o,a,l=0,c={2:"dblclick",3:"tripleclick",4:"quadclick"};function h(e){if(0!==exports.getButton(e)?l=0:e.detail>1?++l>4&&(l=1):l=1,t.isIE){var h=Math.abs(e.clientX-s)>5||Math.abs(e.clientY-o)>5;a&&!h||(l=1),a&&clearTimeout(a),a=setTimeout(function(){a=null},i[l-1]||600),1==l&&(s=e.clientX,o=e.clientY)}if(e._clicks=l,n[r]("mousedown",e),l>4)l=0;else if(l>1)return n[r](c[l],e)}function u(e){l=2,a&&clearTimeout(a),a=setTimeout(function(){a=null},i[l-1]||600),n[r]("mousedown",e),n[r](c[l],e)}Array.isArray(e)||(e=[e]),e.forEach(function(e){exports.addListener(e,"mousedown",h),t.isOldIE&&exports.addListener(e,"dblclick",u)})};var r=!t.isMac||!t.isOpera||"KeyboardEvent"in window?function(e){return 0|(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0)}:function(e){return 0|(e.metaKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.ctrlKey?8:0)};function s(s,o,a){var l=r(o);if(!t.isMac&&i){if(o.getModifierState&&(o.getModifierState("OS")||o.getModifierState("Win"))&&(l|=8),i.altGr){if(3==(3&l))return;i.altGr=0}if(18===a||17===a){var c="location"in o?o.location:o.keyLocation;if(17===a&&1===c)1==i[a]&&(n=o.timeStamp);else if(18===a&&3===l&&2===c){var h=o.timeStamp-n;h<50&&(i.altGr=!0)}}}if(a in e.MODIFIER_KEYS&&(a=-1),8&l&&a>=91&&a<=93&&(a=-1),!l&&13===a){var c="location"in o?o.location:o.keyLocation;if(3===c&&(s(o,l,-a),o.defaultPrevented))return}if(t.isChromeOS&&8&l){if(s(o,l,a),o.defaultPrevented)return;l&=-9}return!!(l||a in e.FUNCTION_KEYS||a in e.PRINTABLE_KEYS)&&s(o,l,a)}function o(){i=Object.create(null)}if(exports.getModifierString=function(t){return e.KEY_MODS[r(t)]},exports.addCommandKeyListener=function(e,n){var r=exports.addListener;if(t.isOldGecko||t.isOpera&&!("KeyboardEvent"in window)){var a=null;r(e,"keydown",function(e){a=e.keyCode}),r(e,"keypress",function(e){return s(n,e,a)})}else{var l=null;r(e,"keydown",function(e){i[e.keyCode]=(i[e.keyCode]||0)+1;var t=s(n,e,e.keyCode);return l=e.defaultPrevented,t}),r(e,"keypress",function(e){l&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(exports.stopEvent(e),l=null)}),r(e,"keyup",function(e){i[e.keyCode]=null}),i||(o(),r(window,"focus",o))}},"object"==typeof window&&window.postMessage&&!t.isOldIE){var a=1;exports.nextTick=function(e,t){t=t||window;var i="zero-timeout-message-"+a++,n=function(r){r.data==i&&(exports.stopPropagation(r),exports.removeListener(t,"message",n),e())};exports.addListener(t,"message",n),t.postMessage(i,"*")}}exports.$idleBlocked=!1,exports.onIdle=function(e,t){return setTimeout(function t(){exports.$idleBlocked?setTimeout(t,100):e()},t)},exports.$idleBlockId=null,exports.blockIdle=function(e){exports.$idleBlockId&&clearTimeout(exports.$idleBlockId),exports.$idleBlocked=!0,exports.$idleBlockId=setTimeout(function(){exports.$idleBlocked=!1},e||100)},exports.nextFrame="object"==typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame),exports.nextFrame?exports.nextFrame=exports.nextFrame.bind(window):exports.nextFrame=function(e){setTimeout(e,17)}}),define("skylark-ace/range",["require","exports","module"],function(require,exports,module){var e=function(e,t,i,n){this.start={row:e,column:t},this.end={row:i,column:n}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,i=e.end,n=e.start;return 1==(t=this.compare(i.row,i.column))?1==(t=this.compare(n.row,n.column))?2:0==t?1:0:-1==t?-2:-1==(t=this.compare(n.row,n.column))?-1:1==t?42:0},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)&&(!this.isEnd(e,t)&&!this.isStart(e,t))},this.insideStart=function(e,t){return 0==this.compare(e,t)&&!this.isEnd(e,t)},this.insideEnd=function(e,t){return 0==this.compare(e,t)&&!this.isStart(e,t)},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(t,i){if(this.end.row>i)var n={row:i+1,column:0};else if(this.end.row<t)var n={row:t,column:0};if(this.start.row>i)var r={row:i+1,column:0};else if(this.start.row<t)var r={row:t,column:0};return e.fromPoints(r||this.start,n||this.end)},this.extend=function(t,i){var n=this.compare(t,i);if(0==n)return this;if(-1==n)var r={row:t,column:i};else var s={row:t,column:i};return e.fromPoints(r||this.start,s||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return e.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new e(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new e(this.start.row,0,this.end.row,0)},this.toScreenRange=function(t){var i=t.documentToScreenPosition(this.start),n=t.documentToScreenPosition(this.end);return new e(i.row,i.column,n.row,n.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(e.prototype),e.fromPoints=function(t,i){return new e(t.row,t.column,i.row,i.column)},e.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},e.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},exports.Range=e}),define("skylark-ace/lib/lang",["require","exports","module"],function(require,exports,module){exports.last=function(e){return e[e.length-1]},exports.stringReverse=function(e){return e.split("").reverse().join("")},exports.stringRepeat=function(e,t){for(var i="";t>0;)1&t&&(i+=e),(t>>=1)&&(e+=e);return i};var e=/^\s\s*/,t=/\s\s*$/;exports.stringTrimLeft=function(t){return t.replace(e,"")},exports.stringTrimRight=function(e){return e.replace(t,"")},exports.copyObject=function(e){var t={};for(var i in e)t[i]=e[i];return t},exports.copyArray=function(e){for(var t=[],i=0,n=e.length;i<n;i++)e[i]&&"object"==typeof e[i]?t[i]=this.copyObject(e[i]):t[i]=e[i];return t},exports.deepCopy=function e(t){if("object"!=typeof t||!t)return t;var i;if(Array.isArray(t)){i=[];for(var n=0;n<t.length;n++)i[n]=e(t[n]);return i}if("[object Object]"!==Object.prototype.toString.call(t))return t;for(var n in i={},t)i[n]=e(t[n]);return i},exports.arrayToMap=function(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=1;return t},exports.createMap=function(e){var t=Object.create(null);for(var i in e)t[i]=e[i];return t},exports.arrayRemove=function(e,t){for(var i=0;i<=e.length;i++)t===e[i]&&e.splice(i,1)},exports.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},exports.escapeHTML=function(e){return(""+e).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(e,t){var i=[];return e.replace(t,function(e){i.push({offset:arguments[arguments.length-2],length:e.length})}),i},exports.deferredCall=function(e){var t=null,i=function(){t=null,e()},n=function(e){return n.cancel(),t=setTimeout(i,e||0),n};return n.schedule=n,n.call=function(){return this.cancel(),e(),n},n.cancel=function(){return clearTimeout(t),t=null,n},n.isPending=function(){return t},n},exports.delayedCall=function(e,t){var i=null,n=function(){i=null,e()},r=function(e){null==i&&(i=setTimeout(n,e||t))};return r.delay=function(e){i&&clearTimeout(i),i=setTimeout(n,e||t)},r.schedule=r,r.call=function(){this.cancel(),e()},r.cancel=function(){i&&clearTimeout(i),i=null},r.isPending=function(){return i},r}}),define("skylark-ace/keyboard/textinput",["require","exports","module","../lib/event","../lib/useragent","../lib/dom","../lib/lang","../lib/keys"],function(require,exports,module){var e=require("../lib/event"),t=require("../lib/useragent"),i=require("../lib/dom"),n=require("../lib/lang"),r=t.isChrome<18,s=t.isIE,o=t.isChrome>63,a=require("../lib/keys"),l=a.KEY_MODS,c=t.isIOS,h=c?/\s/:/\n/;exports.TextInput=function(u,d){var f=i.createElement("textarea");f.className="ace_text-input",f.setAttribute("wrap","off"),f.setAttribute("autocorrect","off"),f.setAttribute("autocapitalize","off"),f.setAttribute("spellcheck",!1),f.style.opacity="0",u.insertBefore(f,u.firstChild);var p=!1,m=!1,g=!1,v=!1,y="";t.isMobile||(f.style.fontSize="1px");var k=!1,b=!1,x="",w=0,_=0;try{var C=document.activeElement===f}catch(e){}e.addListener(f,"blur",function(e){b||(d.onBlur(e),C=!1)}),e.addListener(f,"focus",function(e){if(!b){if(C=!0,t.isEdge)try{if(!document.hasFocus())return}catch(e){}d.onFocus(e),t.isEdge?setTimeout(S):S()}}),this.$focusScroll=!1,this.focus=function(){if(y||o||"browser"==this.$focusScroll)return f.focus({preventScroll:!0});var e=f.style.top;f.style.position="fixed",f.style.top="0px";try{var t=0!=f.getBoundingClientRect().top}catch(e){return}var i=[];if(t)for(var n=f.parentElement;n&&1==n.nodeType;)i.push(n),n.setAttribute("ace_nocontext",!0),n=!n.parentElement&&n.getRootNode?n.getRootNode().host:n.parentElement;f.focus({preventScroll:!0}),t&&i.forEach(function(e){e.removeAttribute("ace_nocontext")}),setTimeout(function(){f.style.position="","0px"==f.style.top&&(f.style.top=e)},0)},this.blur=function(){f.blur()},this.isFocused=function(){return C},d.on("beforeEndOperation",function(){d.curOp&&"insertstring"==d.curOp.command.name||(g&&(x=f.value="",P()),S())});var S=c?function(e){if(C&&(!p||e)&&!v){e||(e="");var t="\n ab"+e+"cde fg\n";t!=f.value&&(f.value=x=t);var i=4+(e.length||(d.selection.isEmpty()?0:1));4==w&&_==i||f.setSelectionRange(4,i),w=4,_=i}}:function(){if(!g&&!v&&(C||M)){g=!0;var e=d.selection,t=e.getRange(),i=e.cursor.row,n=t.start.column,r=t.end.column,s=d.session.getLine(i);if(t.start.row!=i){var o=d.session.getLine(i-1);n=t.start.row<i-1?0:n,r+=o.length+1,s=o+"\n"+s}else if(t.end.row!=i){var a=d.session.getLine(i+1);r=t.end.row>i+1?a.length:r,r+=s.length+1,s=s+"\n"+a}s.length>400&&(n<400&&r<400?s=s.slice(0,400):(s="\n",n=0,r=1));var l=s+"\n\n";if(l!=x&&(f.value=x=l,w=_=l.length),M&&(w=f.selectionStart,_=f.selectionEnd),_!=r||w!=n||f.selectionEnd!=_)try{f.setSelectionRange(n,r),w=n,_=r}catch(e){}g=!1}};C&&d.onFocus();var A=null;this.setInputHandler=function(e){A=e},this.getInputHandler=function(){return A};var M=!1,T=function(e,t){if(M&&(M=!1),m)return S(),e&&d.onPaste(e),m=!1,"";for(var i=f.selectionStart,n=f.selectionEnd,r=w,s=x.length-_,o=e,a=e.length-i,l=e.length-n,c=0;r>0&&x[c]==e[c];)c++,r--;for(o=o.slice(c),c=1;s>0&&x.length-c>w-1&&x[x.length-c]==e[e.length-c];)c++,s--;return a-=c-1,l-=c-1,o=o.slice(0,o.length-c+1),t||a!=o.length||r||s||l?(v=!0,o&&!r&&!s&&!a&&!l||k?d.onTextInput(o):d.onTextInput(o,{extendLeft:r,extendRight:s,restoreStart:a,restoreEnd:l}),v=!1,x=e,w=i,_=n,o):""},L=function(e){if(g)return I();var t=f.value,i=T(t,!0);(t.length>500||h.test(i))&&S()},$=function(e,t,i){var n=e.clipboardData||window.clipboardData;if(n&&!r){var o=s||i?"Text":"text/plain";try{return t?!1!==n.setData(o,t):n.getData(o)}catch(e){if(!i)return $(e,t,!0)}}},E=function(t,i){var n=d.getCopyText();if(!n)return e.preventDefault(t);$(t,n)?(c&&(S(n),p=n,setTimeout(function(){p=!1},10)),i?d.onCut():d.onCopy(),e.preventDefault(t)):(p=!0,f.value=n,f.select(),setTimeout(function(){p=!1,S(),i?d.onCut():d.onCopy()}))},O=function(e){E(e,!0)},R=function(e){E(e,!1)},D=function(i){var n=$(i);"string"==typeof n?(n&&d.onPaste(n,i),t.isIE&&setTimeout(S),e.preventDefault(i)):(f.value="",m=!0)};e.addCommandKeyListener(f,d.onCommandKey.bind(d)),e.addListener(f,"select",function(e){g||(p?p=!1:function(e){return 0===e.selectionStart&&e.selectionEnd>=x.length&&e.value===x&&x&&e.selectionEnd!==_}(f)&&(d.selectAll(),S()))}),e.addListener(f,"input",L),e.addListener(f,"cut",O),e.addListener(f,"copy",R),e.addListener(f,"paste",D),"oncut"in f&&"oncopy"in f&&"onpaste"in f||e.addListener(u,"keydown",function(e){if((!t.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:R(e);break;case 86:D(e);break;case 88:O(e)}});var I=function(){if(g&&d.onCompositionUpdate&&!d.$readOnly){if(k)return N();if(g.useTextareaForIME)d.onCompositionUpdate(f.value);else{var e=f.value;T(e),g.markerRange&&(g.context&&(g.markerRange.start.column=g.selectionStart=g.context.compositionStartOffset),g.markerRange.end.column=g.markerRange.start.column+_-g.selectionStart)}}},P=function(e){d.onCompositionEnd&&!d.$readOnly&&(g=!1,d.onCompositionEnd(),d.off("mousedown",N),e&&L())};function N(){b=!0,f.blur(),f.focus(),b=!1}var F,H=n.delayedCall(I,50).schedule.bind(null,null);function z(){clearTimeout(F),F=setTimeout(function(){y&&(f.style.cssText=y,y=""),null==d.renderer.$keepTextAreaAtCursor&&(d.renderer.$keepTextAreaAtCursor=!0,d.renderer.$moveTextAreaToCursor())},0)}e.addListener(f,"compositionstart",function(e){if(g||!d.onCompositionStart||d.$readOnly)return;if(g={},k)return;setTimeout(I,0),d.on("mousedown",N);var t=d.getSelectionRange();t.end.row=t.start.row,t.end.column=t.start.column,g.markerRange=t,g.selectionStart=w,d.onCompositionStart(g),g.useTextareaForIME?(f.value="",x="",w=0,_=0):(f.msGetInputContext&&(g.context=f.msGetInputContext()),f.getInputContext&&(g.context=f.getInputContext()))}),e.addListener(f,"compositionupdate",I),e.addListener(f,"keyup",function(e){27==e.keyCode&&f.value.length<f.selectionStart&&(g||(x=f.value),w=_=-1,S());H()}),e.addListener(f,"keydown",H),e.addListener(f,"compositionend",P),this.getElement=function(){return f},this.setCommandMode=function(e){k=e,f.readOnly=!1},this.setReadOnly=function(e){k||(f.readOnly=e)},this.setCopyWithEmptySelection=function(e){e},this.onContextMenu=function(e){M=!0,S(),d._emit("nativecontextmenu",{target:d,domEvent:e}),this.moveToMouse(e,!0)},this.moveToMouse=function(n,r){y||(y=f.style.cssText),f.style.cssText=(r?"z-index:100000;":"")+(t.isIE?"opacity:0.1;":"")+"text-indent: -"+(w+_)*d.renderer.characterWidth*.5+"px;";var s=d.container.getBoundingClientRect(),o=i.computedStyle(d.container),a=s.top+(parseInt(o.borderTopWidth)||0),l=s.left+(parseInt(s.borderLeftWidth)||0),c=s.bottom-a-f.clientHeight-2,h=function(e){f.style.left=e.clientX-l-2+"px",f.style.top=Math.min(e.clientY-a-2,c)+"px"};h(n),"mousedown"==n.type&&(d.renderer.$keepTextAreaAtCursor&&(d.renderer.$keepTextAreaAtCursor=null),clearTimeout(F),t.isWin&&e.capture(d.container,h,z))},this.onContextMenuClose=z;var W=function(e){d.textInput.onContextMenu(e),z()};e.addListener(f,"mouseup",W),e.addListener(f,"mousedown",function(e){e.preventDefault(),z()}),e.addListener(d.renderer.scroller,"contextmenu",W),e.addListener(f,"contextmenu",W),c&&function(e,t,i){var n=null,r=!1;i.addEventListener("keydown",function(e){n&&clearTimeout(n),r=!0},!0),i.addEventListener("keyup",function(e){n=setTimeout(function(){r=!1},100)},!0);var s=function(e){if(document.activeElement===i&&!r&&!g&&!p){var n=i.selectionStart,s=i.selectionEnd,o=null,c=0;console.log(n,s),0==n?o=a.up:1==n?o=a.home:s>_&&"\n"==x[s]?o=a.end:n<w&&" "==x[n-1]?(o=a.left,c=l.option):n<w||n==w&&_!=w&&n==s?o=a.left:s>_&&x.slice(0,s).split("\n").length>2?o=a.down:s>_&&" "==x[s-1]?(o=a.right,c=l.option):(s>_||s==_&&_!=w&&n==s)&&(o=a.right),n!==s&&(c|=l.shift),o&&(t.onCommandKey(null,c,o),w=n,_=s,S(""))}};document.addEventListener("selectionchange",s),t.on("destroy",function(){document.removeEventListener("selectionchange",s)})}(0,d,f)}}),define("skylark-ace/mouse/default_handlers",["require","exports","module","../lib/useragent"],function(require,exports,module){var e=require("../lib/useragent");function t(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e)),t.setDefaultHandler("touchmove",this.onTouchMove.bind(e));["select","startSelect","selectEnd","selectAllEnd","selectByWordsEnd","selectByLinesEnd","dragWait","dragWaitEnd","focusWait"].forEach(function(t){e[t]=this[t]},this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function i(e,t){if(e.start.row==e.end.row)var i=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)var i=2*t.row-e.start.row-e.end.row;else var i=t.column-4;return i<0?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}(function(){this.onMouseDown=function(t){var i=t.inSelection(),n=t.getDocumentPosition();this.mousedownEvent=t;var r=this.editor,s=t.getButton();if(0!==s){var o=r.getSelectionRange(),a=o.isEmpty();return(a||1==s)&&r.selection.moveToPosition(n),void(2==s&&(r.textInput.onContextMenu(t.domEvent),e.isMozilla||t.preventDefault()))}return this.mousedownEvent.time=Date.now(),!i||r.isFocused()||(r.focus(),!this.$focusTimeout||this.$clickSelection||r.inMultiSelectMode)?(this.captureMouse(t),this.startSelect(n,t.domEvent._clicks>1),t.preventDefault()):(this.setState("focusWait"),void this.captureMouse(t))},this.startSelect=function(e,t){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y);var i=this.editor;this.mousedownEvent&&(this.mousedownEvent.getShiftKey()?i.selection.selectToPosition(e):t||i.selection.moveToPosition(e),t||this.select(),i.renderer.scroller.setCapture&&i.renderer.scroller.setCapture(),i.setStyle("ace_selecting"),this.setState("select"))},this.select=function(){var e,t=this.editor,n=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var r=this.$clickSelection.comparePoint(n);if(-1==r)e=this.$clickSelection.end;else if(1==r)e=this.$clickSelection.start;else{var s=i(this.$clickSelection,n);n=s.cursor,e=s.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(n),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,n=this.editor,r=n.renderer.screenToTextCoordinates(this.x,this.y),s=n.selection[e](r.row,r.column);if(this.$clickSelection){var o=this.$clickSelection.comparePoint(s.start),a=this.$clickSelection.comparePoint(s.end);if(-1==o&&a<=0)t=this.$clickSelection.end,s.end.row==r.row&&s.end.column==r.column||(r=s.start);else if(1==a&&o>=0)t=this.$clickSelection.start,s.start.row==r.row&&s.start.column==r.column||(r=s.end);else if(-1==o&&1==a)r=s.end,t=s.start;else{var l=i(this.$clickSelection,r);r=l.cursor,t=l.anchor}n.selection.setSelectionAnchor(t.row,t.column)}n.selection.selectToPosition(r),n.renderer.scrollCursorIntoView()},this.selectEnd=this.selectAllEnd=this.selectByWordsEnd=this.selectByLinesEnd=function(){this.$clickSelection=null,this.editor.unsetStyle("ace_selecting"),this.editor.renderer.scroller.releaseCapture&&this.editor.renderer.scroller.releaseCapture()},this.focusWait=function(){var e,t,i,n,r=(e=this.mousedownEvent.x,t=this.mousedownEvent.y,i=this.x,n=this.y,Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))),s=Date.now();(r>0||s-this.mousedownEvent.time>this.$focusTimeout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),i=this.editor,n=i.session,r=n.getBracketRange(t);r?(r.isEmpty()&&(r.start.column--,r.end.column++),this.setState("select")):(r=i.selection.getWordRange(t.row,t.column),this.setState("selectByWords")),this.$clickSelection=r,this.select()},this.onTripleClick=function(e){var t=e.getDocumentPosition(),i=this.editor;this.setState("selectByLines");var n=i.getSelectionRange();n.isMultiLine()&&n.contains(t.row,t.column)?(this.$clickSelection=i.selection.getLineRange(n.start.row),this.$clickSelection.end=i.selection.getLineRange(n.end.row).end):this.$clickSelection=i.selection.getLineRange(t.row),this.select()},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("selectAll")},this.onMouseWheel=function(e){if(!e.getAccelKey()){e.getShiftKey()&&e.wheelY&&!e.wheelX&&(e.wheelX=e.wheelY,e.wheelY=0);var t=this.editor;this.$lastScroll||(this.$lastScroll={t:0,vx:0,vy:0,allowed:0});var i=this.$lastScroll,n=e.domEvent.timeStamp,r=n-i.t,s=r?e.wheelX/r:i.vx,o=r?e.wheelY/r:i.vy;r<550&&(s=(s+i.vx)/2,o=(o+i.vy)/2);var a=Math.abs(s/o),l=!1;if(a>=1&&t.renderer.isScrollableBy(e.wheelX*e.speed,0)&&(l=!0),a<=1&&t.renderer.isScrollableBy(0,e.wheelY*e.speed)&&(l=!0),l)i.allowed=n;else if(n-i.allowed<550){var c=Math.abs(s)<=1.5*Math.abs(i.vx)&&Math.abs(o)<=1.5*Math.abs(i.vy);c?(l=!0,i.allowed=n):i.allowed=0}return i.t=n,i.vx=s,i.vy=o,l?(t.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}},this.onTouchMove=function(e){this.editor._emit("mousewheel",e)}}).call(t.prototype),exports.DefaultHandlers=t}),define("skylark-ace/tooltip",["require","exports","module","./lib/oop","./lib/dom"],function(require,exports,module){require("./lib/oop");var e=require("./lib/dom");function t(e){this.isOpen=!1,this.$element=null,this.$parentNode=e}(function(){this.$init=function(){return this.$element=e.createElement("div"),this.$element.className="ace_tooltip",this.$element.style.display="none",this.$parentNode.appendChild(this.$element),this.$element},this.getElement=function(){return this.$element||this.$init()},this.setText=function(e){this.getElement().textContent=e},this.setHtml=function(e){this.getElement().innerHTML=e},this.setPosition=function(e,t){this.getElement().style.left=e+"px",this.getElement().style.top=t+"px"},this.setClassName=function(t){e.addCssClass(this.getElement(),t)},this.show=function(e,t,i){null!=e&&this.setText(e),null!=t&&null!=i&&this.setPosition(t,i),this.isOpen||(this.getElement().style.display="block",this.isOpen=!0)},this.hide=function(){this.isOpen&&(this.getElement().style.display="none",this.isOpen=!1)},this.getHeight=function(){return this.getElement().offsetHeight},this.getWidth=function(){return this.getElement().offsetWidth},this.destroy=function(){this.isOpen=!1,this.$element&&this.$element.parentNode&&this.$element.parentNode.removeChild(this.$element)}}).call(t.prototype),exports.Tooltip=t}),define("skylark-ace/mouse/default_gutter_handler",["require","exports","module","../lib/dom","../lib/oop","../lib/event","../tooltip"],function(require,exports,module){var e=require("../lib/dom"),t=require("../lib/oop"),i=require("../lib/event"),n=require("../tooltip").Tooltip;function r(e){n.call(this,e)}t.inherits(r,n),function(){this.setPosition=function(e,t){var i=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,s=this.getWidth(),o=this.getHeight();t+=15,(e+=15)+s>i&&(e-=e+s-i),t+o>r&&(t-=20+o),n.prototype.setPosition.call(this,e,t)}}.call(r.prototype),exports.GutterHandler=function(t){var n,s,o,a=t.editor,l=a.renderer.$gutterLayer,c=new r(a.container);function h(){n&&(n=clearTimeout(n)),o&&(c.hide(),o=null,a._signal("hideGutterTooltip",c),a.removeEventListener("mousewheel",h))}function u(e){c.setPosition(e.x,e.y)}t.editor.setDefaultHandler("guttermousedown",function(e){if(a.isFocused()&&0==e.getButton()){var i=l.getRegion(e);if("foldWidgets"!=i){var n=e.getDocumentPosition().row,r=a.session.selection;if(e.getShiftKey())r.selectTo(n,0);else{if(2==e.domEvent.detail)return a.selectAll(),e.preventDefault();t.$clickSelection=a.selection.getLineRange(n)}return t.setState("selectByLines"),t.captureMouse(e),e.preventDefault()}}}),t.editor.setDefaultHandler("guttermousemove",function(i){var r=i.domEvent.target||i.domEvent.srcElement;if(e.hasCssClass(r,"ace_fold-widget"))return h();o&&t.$tooltipFollowsMouse&&u(i),s=i,n||(n=setTimeout(function(){n=null,s&&!t.isMousePressed?function(){var e=s.getDocumentPosition().row,i=l.$annotations[e];if(!i)return h();var n=a.session.getLength();if(e==n){var r=a.renderer.pixelToScreenCoordinates(0,s.y).row,d=s.$pos;if(r>a.session.documentToScreenRow(d.row,d.column))return h()}if(o==i)return;if(o=i.text.join("<br/>"),c.setHtml(o),c.show(),a._signal("showGutterTooltip",c),a.on("mousewheel",h),t.$tooltipFollowsMouse)u(s);else{var f=s.domEvent.target,p=f.getBoundingClientRect(),m=c.getElement().style;m.left=p.right+"px",m.top=p.bottom+"px"}}():h()},50))}),i.addListener(a.renderer.$gutter,"mouseout",function(e){s=null,o&&!n&&(n=setTimeout(function(){n=null,h()},50))}),a.on("changeSession",h)}}),define("skylark-ace/mouse/mouse_event",["require","exports","module","../lib/event","../lib/useragent"],function(require,exports,module){var e=require("../lib/event"),t=require("../lib/useragent"),i=exports.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){e.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){e.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY),this.$pos)},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor,t=e.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var i=this.getDocumentPosition();this.$inSelection=t.contains(i.row,i.column)}return this.$inSelection},this.getButton=function(){return e.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=t.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(i.prototype)}),define("skylark-ace/mouse/dragdrop_handler",["require","exports","module","../lib/dom","../lib/event","../lib/useragent"],function(require,exports,module){var e=require("../lib/dom"),t=require("../lib/event"),i=require("../lib/useragent"),n=200,r=200,s=5;function o(o){var l=o.editor,c=e.createElement("img");c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",i.isOpera&&(c.style.cssText="width:1px;height:1px;position:fixed;top:0;left:0;z-index:2147483647;opacity:0;");["dragWait","dragWaitEnd","startDrag","dragReadyEnd","onMouseDrag"].forEach(function(e){o[e]=this[e]},this),l.addEventListener("mousedown",this.onMouseDown.bind(o));var h,u,d,f,p,m,g,v,y,k,b,x=l.container,w=0;function _(){var e=m;(function(e,t){var i=Date.now(),n=!t||e.row!=t.row,o=!t||e.column!=t.column;if(!k||n||o)l.moveCursorToPosition(e),k=i,b={x:u,y:d};else{var c=a(b.x,b.y,u,d);c>s?k=null:i-k>=r&&(l.renderer.scrollCursorIntoView(),k=null)}})(m=l.renderer.screenToTextCoordinates(u,d),e),function(e,t){var i=Date.now(),r=l.renderer.layerConfig.lineHeight,s=l.renderer.layerConfig.characterWidth,o=l.renderer.scroller.getBoundingClientRect(),a={x:{left:u-o.left,right:o.right-u},y:{top:d-o.top,bottom:o.bottom-d}},c=Math.min(a.x.left,a.x.right),h=Math.min(a.y.top,a.y.bottom),f={row:e.row,column:e.column};c/s<=2&&(f.column+=a.x.left<a.x.right?-3:2);h/r<=1&&(f.row+=a.y.top<a.y.bottom?-1:1);var p=e.row!=f.row,m=e.column!=f.column,g=!t||e.row!=t.row;p||m&&!g?y?i-y>=n&&l.renderer.scrollCursorIntoView(f):y=i:y=null}(m,e)}function C(){p=l.selection.toOrientedRange(),h=l.session.addMarker(p,"ace_selection",l.getSelectionStyle()),l.clearSelection(),l.isFocused()&&l.renderer.$cursorLayer.setBlinking(!1),clearInterval(f),_(),f=setInterval(_,20),w=0,t.addListener(document,"mousemove",M)}function S(){clearInterval(f),l.session.removeMarker(h),h=null,l.selection.fromOrientedRange(p),l.isFocused()&&!v&&l.renderer.$cursorLayer.setBlinking(!l.getReadOnly()),p=null,m=null,w=0,y=null,k=null,t.removeListener(document,"mousemove",M)}this.onDragStart=function(e){if(this.cancelDrag||!x.draggable){var t=this;return setTimeout(function(){t.startSelect(),t.captureMouse(e)},0),e.preventDefault()}p=l.getSelectionRange();var n=e.dataTransfer;n.effectAllowed=l.getReadOnly()?"copy":"copyMove",i.isOpera&&(l.container.appendChild(c),c.scrollTop=0),n.setDragImage&&n.setDragImage(c,0,0),i.isOpera&&l.container.removeChild(c),n.clearData(),n.setData("Text",l.session.getTextRange()),v=!0,this.setState("drag")},this.onDragEnd=function(e){if(x.draggable=!1,v=!1,this.setState(null),!l.getReadOnly()){var t=e.dataTransfer.dropEffect;g||"move"!=t||l.session.remove(l.getSelectionRange()),l.renderer.$cursorLayer.setBlinking(!0)}this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle("")},this.onDragEnter=function(e){if(!l.getReadOnly()&&T(e.dataTransfer))return u=e.clientX,d=e.clientY,h||C(),w++,e.dataTransfer.dropEffect=g=L(e),t.preventDefault(e)},this.onDragOver=function(e){if(!l.getReadOnly()&&T(e.dataTransfer))return u=e.clientX,d=e.clientY,h||(C(),w++),null!==A&&(A=null),e.dataTransfer.dropEffect=g=L(e),t.preventDefault(e)},this.onDragLeave=function(e){if(--w<=0&&h)return S(),g=null,t.preventDefault(e)},this.onDrop=function(e){if(m){var i=e.dataTransfer;if(v)switch(g){case"move":p=p.contains(m.row,m.column)?{start:m,end:m}:l.moveText(p,m);break;case"copy":p=l.moveText(p,m,!0)}else{var n=i.getData("Text");p={start:m,end:l.session.insert(m,n)},l.focus(),g=null}return S(),t.preventDefault(e)}},t.addListener(x,"dragstart",this.onDragStart.bind(o)),t.addListener(x,"dragend",this.onDragEnd.bind(o)),t.addListener(x,"dragenter",this.onDragEnter.bind(o)),t.addListener(x,"dragover",this.onDragOver.bind(o)),t.addListener(x,"dragleave",this.onDragLeave.bind(o)),t.addListener(x,"drop",this.onDrop.bind(o));var A=null;function M(){null==A&&(A=setTimeout(function(){null!=A&&h&&S()},20))}function T(e){var t=e.types;return!t||Array.prototype.some.call(t,function(e){return"text/plain"==e||"Text"==e})}function L(e){var t=["copy","copymove","all","uninitialized"],n=i.isMac?e.altKey:e.ctrlKey,r="uninitialized";try{r=e.dataTransfer.effectAllowed.toLowerCase()}catch(e){}var s="none";return n&&t.indexOf(r)>=0?s="copy":["move","copymove","linkmove","all","uninitialized"].indexOf(r)>=0?s="move":t.indexOf(r)>=0&&(s="copy"),s}}function a(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}(function(){this.dragWait=function(){var e=Date.now()-this.mousedownEvent.time;e>this.editor.getDragDelay()&&this.startDrag()},this.dragWaitEnd=function(){var e=this.editor.container;e.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()),this.selectEnd()},this.dragReadyEnd=function(e){this.editor.renderer.$cursorLayer.setBlinking(!this.editor.getReadOnly()),this.editor.unsetStyle("ace_dragging"),this.editor.renderer.setCursorStyle(""),this.dragWaitEnd()},this.startDrag=function(){this.cancelDrag=!1;var e=this.editor,t=e.container;t.draggable=!0,e.renderer.$cursorLayer.setBlinking(!1),e.setStyle("ace_dragging");var n=i.isWin?"default":"move";e.renderer.setCursorStyle(n),this.setState("dragReady")},this.onMouseDrag=function(e){var t=this.editor.container;if(i.isIE&&"dragReady"==this.state){var n=a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);n>3&&t.dragDrop()}if("dragWait"===this.state){var n=a(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y);n>0&&(t.draggable=!1,this.startSelect(this.mousedownEvent.getDocumentPosition()))}},this.onMouseDown=function(e){if(this.$dragEnabled){this.mousedownEvent=e;var t=this.editor,n=e.inSelection(),r=e.getButton(),s=e.domEvent.detail||1;if(1===s&&0===r&&n){if(e.editor.inMultiSelectMode&&(e.getAccelKey()||e.getShiftKey()))return;this.mousedownEvent.time=Date.now();var o=e.domEvent.target||e.domEvent.srcElement;if("unselectable"in o&&(o.unselectable="on"),t.getDragDelay()){if(i.isWebKit){this.cancelDrag=!0;var a=t.container;a.draggable=!0}this.setState("dragWait")}else this.startDrag();this.captureMouse(e,this.onMouseDrag.bind(this)),e.defaultPrevented=!0}}}}).call(o.prototype),exports.DragdropHandler=o}),define("skylark-ace/lib/net",["require","exports","module","./dom"],function(require,exports,module){var e=require("./dom");exports.get=function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){4===i.readyState&&t(i.responseText)},i.send(null)},exports.loadScript=function(t,i){var n=e.getDocumentHead(),r=document.createElement("script");r.src=t,n.appendChild(r),r.onload=r.onreadystatechange=function(e,t){!t&&r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(r=r.onload=r.onreadystatechange=null,t||i())}},exports.qualifyURL=function(e){var t=document.createElement("a");return t.href=e,t.href}}),define("skylark-ace/lib/event_emitter",["require","exports","module"],function(require,exports,module){var e={},t=function(){this.propagationStopped=!0},i=function(){this.defaultPrevented=!0};e._emit=e._dispatchEvent=function(e,n){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var r=this._eventRegistry[e]||[],s=this._defaultHandlers[e];if(r.length||s){"object"==typeof n&&n||(n={}),n.type||(n.type=e),n.stopPropagation||(n.stopPropagation=t),n.preventDefault||(n.preventDefault=i),r=r.slice();for(var o=0;o<r.length&&(r[o](n,this),!n.propagationStopped);o++);return s&&!n.defaultPrevented?s(n,this):void 0}},e._signal=function(e,t){var i=(this._eventRegistry||{})[e];if(i){i=i.slice();for(var n=0;n<i.length;n++)i[n](t,this)}},e.once=function(e,t){var i=this;if(this.addEventListener(e,function n(){i.removeEventListener(e,n),t.apply(null,arguments)}),!t)return new Promise(function(e){t=e})},e.setDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i||(i=this._defaultHandlers={_disabled_:{}}),i[e]){var n=i[e],r=i._disabled_[e];r||(i._disabled_[e]=r=[]),r.push(n);var s=r.indexOf(t);-1!=s&&r.splice(s,1)}i[e]=t},e.removeDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i){var n=i._disabled_[e];if(i[e]==t)n&&this.setDefaultHandler(e,n.pop());else if(n){var r=n.indexOf(t);-1!=r&&n.splice(r,1)}}},e.on=e.addEventListener=function(e,t,i){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];return n||(n=this._eventRegistry[e]=[]),-1==n.indexOf(t)&&n[i?"unshift":"push"](t),t},e.off=e.removeListener=e.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},e.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},exports.EventEmitter=e}),define("skylark-ace/lib/app_config",["require","exports","module","./oop","./event_emitter"],function(require,exports,module){"no use strict";var e=require("./oop"),t=require("./event_emitter").EventEmitter,i={setOptions:function(e){Object.keys(e).forEach(function(t){this.setOption(t,e[t])},this)},getOptions:function(e){var t={};if(e)Array.isArray(e)||(t=e,e=Object.keys(t));else{var i=this.$options;e=Object.keys(i).filter(function(e){return!i[e].hidden})}return e.forEach(function(e){t[e]=this.getOption(e)},this),t},setOption:function(e,t){if(this["$"+e]!==t){var i=this.$options[e];if(!i)return n('misspelled option "'+e+'"');if(i.forwardTo)return this[i.forwardTo]&&this[i.forwardTo].setOption(e,t);i.handlesSet||(this["$"+e]=t),i&&i.set&&i.set.call(this,t)}},getOption:function(e){var t=this.$options[e];return t?t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]:n('misspelled option "'+e+'"')}};function n(e){"undefined"!=typeof console&&console.warn&&console.warn.apply(console,arguments)}function r(e,t){var i=new Error(e);i.data=t,"object"==typeof console&&console.error&&console.error(i),setTimeout(function(){throw i})}var s=function(){this.$defaultOptions={}};(function(){e.implement(this,t),this.defineOptions=function(t,n,r){return t.$options||(this.$defaultOptions[n]=t.$options={}),Object.keys(r).forEach(function(e){var i=r[e];"string"==typeof i&&(i={forwardTo:i}),i.name||(i.name=e),t.$options[i.name]=i,"initialValue"in i&&(t["$"+i.name]=i.initialValue)}),e.implement(t,i),this},this.resetOptions=function(e){Object.keys(e.$options).forEach(function(t){var i=e.$options[t];"value"in i&&e.setOption(t,i.value)})},this.setDefaultValue=function(e,t,i){var n=this.$defaultOptions[e]||(this.$defaultOptions[e]={});n[t]&&(n.forwardTo?this.setDefaultValue(n.forwardTo,t,i):n[t].value=i)},this.setDefaultValues=function(e,t){Object.keys(t).forEach(function(i){this.setDefaultValue(e,i,t[i])},this)},this.warn=n,this.reportError=r}).call(s.prototype),exports.AppConfig=s}),define("skylark-ace/config",["require","exports","module","./lib/lang","./lib/oop","./lib/net","./lib/app_config"],function(require,exports,module){"no use strict";var e=require("./lib/lang"),t=(require("./lib/oop"),require("./lib/net")),i=require("./lib/app_config").AppConfig;module.exports=exports=new i;var n=function(){return this||"undefined"!=typeof window&&window}(),r={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{},loadWorkerFromBlob:!0};exports.get=function(e){if(!r.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return r[e]},exports.set=function(e,t){if(!r.hasOwnProperty(e))throw new Error("Unknown config key: "+e);r[e]=t},exports.all=function(){return e.copyObject(r)},exports.$modes={},exports.moduleUrl=function(e,t){if(r.$moduleUrls[e])return r.$moduleUrls[e];var i=e.split("/"),n="snippets"==(t=t||i[i.length-2]||"")?"/":"-",s=i[i.length-1];if("worker"==t&&"-"==n){var o=new RegExp("^"+t+"[\\-_]|[\\-_]"+t+"$","g");s=s.replace(o,"")}(!s||s==t)&&i.length>1&&(s=i[i.length-2]);var a=r[t+"Path"];return null==a?a=r.basePath:"/"==n&&(t=n=""),a&&"/"!=a.slice(-1)&&(a+="/"),a+t+n+s+this.get("suffix")},exports.setModuleUrl=function(e,t){return r.$moduleUrls[e]=t},exports.$loading={},exports.loadModule=function(e,i){var module,n;Array.isArray(e)&&(n=e[0],e=e[1]);try{module=require(e)}catch(e){}if(module&&!exports.$loading[e])return i&&i(module);if(exports.$loading[e]||(exports.$loading[e]=[]),exports.$loading[e].push(i),!(exports.$loading[e].length>1)){var r=function(){require([e],function(module){exports._emit("load.module",{name:e,module:module});var t=exports.$loading[e];exports.$loading[e]=null,t.forEach(function(e){e&&e(module)})})};if(!exports.get("packaged"))return r();t.loadScript(exports.moduleUrl(e,n),r),s()}};var s=function(){r.basePath||r.workerPath||r.modePath||r.themePath||Object.keys(r.$moduleUrls).length||(console.error("Unable to infer path to ace from script src,","use ace.config.set('basePath', 'path') to enable dynamic loading of modes and themes","or with webpack use ace/webpack-resolver"),s=function(){})};exports.init=function(e){if(!n||!n.document)return;r.packaged=e||require.packaged||module.packaged||n.define&&define.packaged;for(var t={},i="",s=document.currentScript||document._currentScript,o=(s&&s.ownerDocument||document).getElementsByTagName("script"),a=0;a<o.length;a++){var l=o[a],c=l.src||l.getAttribute("src");if(c){for(var h=l.attributes,u=0,d=h.length;u<d;u++){var f=h[u];0===f.name.indexOf("data-ace-")&&(t[(m=f.name.replace(/^data-ace-/,""),m.replace(/-(.)/g,function(e,t){return t.toUpperCase()}))]=f.value)}var p=c.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);p&&(i=p[1])}}var m;i&&(t.base=t.base||i,t.packaged=!0);for(var g in t.basePath=t.base,t.workerPath=t.workerPath||t.base,t.modePath=t.modePath||t.base,t.themePath=t.themePath||t.base,delete t.base,t)void 0!==t[g]&&exports.set(g,t[g])}}),define("skylark-ace/mouse/mouse_handler",["require","exports","module","../lib/event","../lib/useragent","./default_handlers","./default_gutter_handler","./mouse_event","./dragdrop_handler","../config"],function(require,exports,module){var e=require("../lib/event"),t=require("../lib/useragent"),i=require("./default_handlers").DefaultHandlers,n=require("./default_gutter_handler").GutterHandler,r=require("./mouse_event").MouseEvent,s=require("./dragdrop_handler").DragdropHandler,o=require("../config"),a=function(r){var o=this;this.editor=r,new i(this),new n(this),new s(this);var a=function(e){var t=!document.hasFocus||!document.hasFocus()||!r.isFocused()&&document.activeElement==(r.textInput&&r.textInput.getElement());t&&window.focus(),r.focus()},l=r.renderer.getMouseEventTarget();e.addListener(l,"click",this.onMouseEvent.bind(this,"click")),e.addListener(l,"mousemove",this.onMouseMove.bind(this,"mousemove")),e.addMultiMouseDownListener([l,r.renderer.scrollBarV&&r.renderer.scrollBarV.inner,r.renderer.scrollBarH&&r.renderer.scrollBarH.inner,r.textInput&&r.textInput.getElement()].filter(Boolean),[400,300,250],this,"onMouseEvent"),e.addMouseWheelListener(r.container,this.onMouseWheel.bind(this,"mousewheel")),e.addTouchMoveListener(r.container,this.onTouchMove.bind(this,"touchmove"));var c=r.renderer.$gutter;e.addListener(c,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),e.addListener(c,"click",this.onMouseEvent.bind(this,"gutterclick")),e.addListener(c,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),e.addListener(c,"mousemove",this.onMouseEvent.bind(this,"guttermousemove")),e.addListener(l,"mousedown",a),e.addListener(c,"mousedown",a),t.isIE&&r.renderer.scrollBarV&&(e.addListener(r.renderer.scrollBarV.element,"mousedown",a),e.addListener(r.renderer.scrollBarH.element,"mousedown",a)),r.on("mousemove",function(e){if(!o.state&&!o.$dragDelay&&o.$dragEnabled){var t=r.renderer.screenToTextCoordinates(e.x,e.y),i=r.session.selection.getRange(),n=r.renderer;!i.isEmpty()&&i.insideStart(t.row,t.column)?n.setCursorStyle("default"):n.setCursorStyle("")}})};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new r(t,this.editor))},this.onMouseMove=function(e,t){var i=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;i&&i.length&&this.editor._emit(e,new r(t,this.editor))},this.onMouseWheel=function(e,t){var i=new r(t,this.editor);i.speed=2*this.$scrollSpeed,i.wheelX=t.wheelX,i.wheelY=t.wheelY,this.editor._emit(e,i)},this.onTouchMove=function(e,t){var i=new r(t,this.editor);i.speed=1,i.wheelX=t.wheelX,i.wheelY=t.wheelY,this.editor._emit(e,i)},this.setState=function(e){this.state=e},this.captureMouse=function(i,n){this.x=i.x,this.y=i.y,this.isMousePressed=!0;var s=this.editor,o=this.editor.renderer;o.$keepTextAreaAtCursor&&(o.$keepTextAreaAtCursor=null);var a=this,l=function(e){if(e){if(t.isWebKit&&!e.which&&a.releaseMouse)return a.releaseMouse();a.x=e.clientX,a.y=e.clientY,n&&n(e),a.mouseEvent=new r(e,a.editor),a.$mouseMoved=!0}},c=function(e){s.off("beforeEndOperation",u),clearInterval(d),h(),a[a.state+"End"]&&a[a.state+"End"](e),a.state="",null==o.$keepTextAreaAtCursor&&(o.$keepTextAreaAtCursor=!0,o.$moveTextAreaToCursor()),a.isMousePressed=!1,a.$onCaptureMouseMove=a.releaseMouse=null,e&&a.onMouseEvent("mouseup",e),s.endOperation()},h=function(){a[a.state]&&a[a.state](),a.$mouseMoved=!1};if(t.isOldIE&&"dblclick"==i.domEvent.type)return setTimeout(function(){c(i)});var u=function(e){a.releaseMouse&&s.curOp.command.name&&s.curOp.selectionChanged&&(a[a.state+"End"]&&a[a.state+"End"](),a.state="",a.releaseMouse())};s.on("beforeEndOperation",u),s.startOperation({command:{name:"mouse"}}),a.$onCaptureMouseMove=l,a.releaseMouse=e.capture(this.editor.container,l,c);var d=setInterval(h,20)},this.releaseMouse=null,this.cancelContextMenu=function(){var t=function(i){i&&i.domEvent&&"contextmenu"!=i.domEvent.type||(this.editor.off("nativecontextmenu",t),i&&i.domEvent&&e.stopEvent(i.domEvent))}.bind(this);setTimeout(t,10),this.editor.on("nativecontextmenu",t)}}).call(a.prototype),o.defineOptions(a.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:t.isMac?150:0},dragEnabled:{initialValue:!0},focusTimeout:{initialValue:0},tooltipFollowsMouse:{initialValue:!0}}),exports.MouseHandler=a}),define("skylark-ace/mouse/fold_handler",["require","exports","module","../lib/dom"],function(require,exports,module){var e=require("../lib/dom");exports.FoldHandler=function(t){t.on("click",function(i){var n=i.getDocumentPosition(),r=t.session,s=r.getFoldAt(n.row,n.column,1);s&&(i.getAccelKey()?r.removeFold(s):r.expandFold(s),i.stop());var o=i.domEvent&&i.domEvent.target;o&&e.hasCssClass(o,"ace_inline_button")&&e.hasCssClass(o,"ace_toggle_wrap")&&(r.setOption("wrap",!0),t.renderer.scrollCursorIntoView())}),t.on("gutterclick",function(e){var i=t.renderer.$gutterLayer.getRegion(e);if("foldWidgets"==i){var n=e.getDocumentPosition().row,r=t.session;r.foldWidgets&&r.foldWidgets[n]&&t.session.onFoldWidgetClick(n,e),t.isFocused()||t.focus(),e.stop()}}),t.on("gutterdblclick",function(e){var i=t.renderer.$gutterLayer.getRegion(e);if("foldWidgets"==i){var n=e.getDocumentPosition().row,r=t.session,s=r.getParentFoldRangeData(n,!0),o=s.range||s.firstRange;if(o){n=o.start.row;var a=r.getFoldAt(n,r.getLine(n).length,1);a?r.removeFold(a):(r.addFold("...",o),t.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}e.stop()}})}}),define("skylark-ace/keyboard/keybinding",["require","exports","module","../lib/keys","../lib/event"],function(require,exports,module){var e=require("../lib/keys"),t=require("../lib/event"),i=function(e){this.$editor=e,this.$data={editor:e},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0)},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){"function"!=typeof e||e.handleKeyboard||(e.handleKeyboard=e);var i=this.$handlers.indexOf(e);-1!=i&&this.$handlers.splice(i,1),void 0==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==i&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1!=t&&(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.getStatusText=function(){var e=this.$data,t=e.editor;return this.$handlers.map(function(i){return i.getStatusText&&i.getStatusText(t,e)||""}).filter(Boolean).join(" ")},this.$callKeyboardHandlers=function(e,i,n,r){for(var s,o=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&!((s=this.$handlers[l].handleKeyboard(this.$data,e,i,n,r))&&s.command&&((o="null"==s.command||a.exec(s.command,this.$editor,s.args,r))&&r&&-1!=e&&1!=s.passEvent&&1!=s.command.passEvent&&t.stopEvent(r),o)););return o||-1!=e||(s={command:"insertstring"},o=a.exec("insertstring",this.$editor,i)),o&&this.$editor._signal&&this.$editor._signal("keyboardActivity",s),o},this.onCommandKey=function(t,i,n){var r=e.keyCodeToString(n);this.$callKeyboardHandlers(i,r,n,t)},this.onTextInput=function(e){this.$callKeyboardHandlers(-1,e)}}).call(i.prototype),exports.KeyBinding=i}),define("skylark-ace/lib/bidiutil",["require","exports","module"],function(require,exports,module){var e=0,t=0,i=!1,n=!1,r=!1,s=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],o=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],a=1,l=0,c=1,h=2,u=3,d=4,f=5,p=6,m=7,g=8,v=9,y=10,k=11,b=12,x=13,w=14,_=15,C=16,S=17,A=18,M=[A,A,A,A,A,A,A,A,A,p,f,p,g,f,A,A,A,A,A,A,A,A,A,A,A,A,A,A,f,f,f,p,g,d,d,k,k,k,d,d,d,d,d,y,v,y,v,v,h,h,h,h,h,h,h,h,h,h,v,d,d,d,d,d,d,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,d,d,d,d,d,d,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,l,d,d,d,d,A,A,A,A,A,A,f,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,v,d,k,k,k,k,d,d,d,d,l,d,d,A,d,d,k,k,h,h,d,l,d,d,d,h,l,d,d,d,d,d],T=[g,g,g,g,g,g,g,g,g,g,g,A,A,A,l,c,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,g,f,x,w,_,C,S,v,k,k,k,k,k,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,v,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,g];function L(i,r,s){if(!(t<i))if(1!=i||e!=a||n)for(var o,l,c,h,u=s.length,d=0;d<u;){if(r[d]>=i){for(o=d+1;o<u&&r[o]>=i;)o++;for(l=d,c=o-1;l<c;l++,c--)h=s[l],s[l]=s[c],s[c]=h;d=o}d++}else s.reverse()}function $(t,s,o,a){var M,T,L,$,E=s[a];switch(E){case l:case c:i=!1;case d:case u:return E;case h:return i?u:h;case m:return i=!0,!0,c;case g:return d;case v:return a<1||a+1>=s.length||(M=o[a-1])!=h&&M!=u||(T=s[a+1])!=h&&T!=u?d:(i&&(T=u),T==M?T:d);case y:return(M=a>0?o[a-1]:f)==h&&a+1<s.length&&s[a+1]==h?h:d;case k:if(a>0&&o[a-1]==h)return h;if(i)return d;for($=a+1,L=s.length;$<L&&s[$]==k;)$++;return $<L&&s[$]==h?h:d;case b:for(L=s.length,$=a+1;$<L&&s[$]==b;)$++;if($<L){var O=t[a],R=O>=1425&&O<=2303||64286==O;if(M=s[$],R&&(M==c||M==m))return c}return a<1||(M=s[a-1])==f?d:o[a-1];case f:return i=!1,n=!0,e;case p:return r=!0,d;case x:case w:case C:case S:case _:i=!1;case A:return d}}function E(e){var t=e.charCodeAt(0),i=t>>8;return 0==i?t>191?l:M[t]:5==i?/[\u0591-\u05f4]/.test(e)?c:l:6==i?/[\u0610-\u061a\u064b-\u065f\u06d6-\u06e4\u06e7-\u06ed]/.test(e)?b:/[\u0660-\u0669\u066b-\u066c]/.test(e)?u:1642==t?k:/[\u06f0-\u06f9]/.test(e)?h:m:32==i&&t<=8287?T[255&t]:254==i&&t>=65136?m:d}exports.L=l,exports.R=c,exports.EN=h,exports.ON_R=3,exports.AN=4,exports.R_H=5,exports.B=6,exports.RLE=7,exports.DOT="·",exports.doBidiReorder=function(l,h,v){if(l.length<2)return{};var y=l.split(""),k=new Array(y.length),b=new Array(y.length),w=[];e=v?a:0,function(a,l,c,h){var u=e?o:s,d=null,m=null,v=null,y=0,k=null,b=-1,x=null,w=null,_=[];if(!h)for(x=0,h=[];x<c;x++)h[x]=E(a[x]);for(t=e,i=!1,!1,n=!1,r=!1,w=0;w<c;w++){if(d=y,_[w]=m=$(a,h,_,w),y=u[d][m],k=240&y,y&=15,l[w]=v=u[y][5],k>0)if(16==k){for(x=b;x<w;x++)l[x]=1;b=-1}else b=-1;if(u[y][6])-1==b&&(b=w);else if(b>-1){for(x=b;x<w;x++)l[x]=v;b=-1}h[w]==f&&(l[w]=0),t|=v}if(r)for(x=0;x<c;x++)if(h[x]==p){l[x]=e;for(var C=x-1;C>=0&&h[C]==g;C--)l[C]=e}}(y,w,y.length,h);for(var _=0;_<k.length;k[_]=_,_++);L(2,w,k),L(1,w,k);for(var _=0;_<k.length-1;_++)h[_]===u?w[_]=exports.AN:w[_]===c&&(h[_]>m&&h[_]<x||h[_]===d||h[_]===A)?w[_]=exports.ON_R:_>0&&"ل"===y[_-1]&&/\u0622|\u0623|\u0625|\u0627/.test(y[_])&&(w[_-1]=w[_]=exports.R_H,_++);y[y.length-1]===exports.DOT&&(w[y.length-1]=exports.B),"‫"===y[0]&&(w[0]=exports.RLE);for(var _=0;_<k.length;_++)b[_]=w[k[_]];return{logicalFromVisual:k,bidiLevels:b}},exports.hasBidiCharacters=function(e,t){for(var i=!1,n=0;n<e.length;n++)t[n]=E(e.charAt(n)),i||t[n]!=c&&t[n]!=m&&t[n]!=u||(i=!0);return i},exports.getVisualFromLogicalIdx=function(e,t){for(var i=0;i<t.logicalFromVisual.length;i++)if(t.logicalFromVisual[i]==e)return i;return 0}}),define("skylark-ace/bidihandler",["require","exports","module","./lib/bidiutil","./lib/lang"],function(require,exports,module){var e=require("./lib/bidiutil"),t=require("./lib/lang"),i=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\u202B]/,n=function(t){this.session=t,this.bidiMap={},this.currentRow=null,this.bidiUtil=e,this.charWidths=[],this.EOL="¬",this.showInvisibles=!0,this.isRtlDir=!1,this.$isRtl=!1,this.line="",this.wrapIndent=0,this.EOF="¶",this.RLE="‫",this.contentWidth=0,this.fontMetrics=null,this.rtlLineOffset=0,this.wrapOffset=0,this.isMoveLeftOperation=!1,this.seenBidi=i.test(t.getValue())};(function(){this.isBidiRow=function(e,t,i){return!!this.seenBidi&&(e!==this.currentRow&&(this.currentRow=e,this.updateRowLine(t,i),this.updateBidiMap()),this.bidiMap.bidiLevels)},this.onChange=function(e){this.seenBidi?this.currentRow=null:"insert"==e.action&&i.test(e.lines.join("\n"))&&(this.seenBidi=!0,this.currentRow=null)},this.getDocumentRow=function(){var e=0,t=this.session.$screenRowCache;if(t.length){var i=this.session.$getRowCacheIndex(t,this.currentRow);i>=0&&(e=this.session.$docRowCache[i])}return e},this.getSplitIndex=function(){var e=0,t=this.session.$screenRowCache;if(t.length)for(var i,n=this.session.$getRowCacheIndex(t,this.currentRow);this.currentRow-e>0&&(i=this.session.$getRowCacheIndex(t,this.currentRow-e-1))===n;)n=i,e++;else e=this.currentRow;return e},this.updateRowLine=function(i,n){void 0===i&&(i=this.getDocumentRow());var r=i===this.session.getLength()-1,s=r?this.EOF:this.EOL;if(this.wrapIndent=0,this.line=this.session.getLine(i),this.isRtlDir=this.$isRtl||this.line.charAt(0)===this.RLE,this.session.$useWrapMode){var o=this.session.$wrapData[i];o&&(void 0===n&&(n=this.getSplitIndex()),n>0&&o.length?(this.wrapIndent=o.indent,this.wrapOffset=this.wrapIndent*this.charWidths[e.L],this.line=n<o.length?this.line.substring(o[n-1],o[n]):this.line.substring(o[o.length-1])):this.line=this.line.substring(0,o[n])),n==o.length&&(this.line+=this.showInvisibles?s:e.DOT)}else this.line+=this.showInvisibles?s:e.DOT;var a,l=this.session,c=0;this.line=this.line.replace(/\t|[\u1100-\u2029, \u202F-\uFFE6]/g,function(i,n){return"\t"===i||l.isFullWidth(i.charCodeAt(0))?(a="\t"===i?l.getScreenTabSize(n+c):2,c+=a-1,t.stringRepeat(e.DOT,a)):i}),this.isRtlDir&&(this.fontMetrics.$main.textContent=this.line.charAt(this.line.length-1)==e.DOT?this.line.substr(0,this.line.length-1):this.line,this.rtlLineOffset=this.contentWidth-this.fontMetrics.$main.getBoundingClientRect().width)},this.updateBidiMap=function(){var t=[];e.hasBidiCharacters(this.line,t)||this.isRtlDir?this.bidiMap=e.doBidiReorder(this.line,t,this.isRtlDir):this.bidiMap={}},this.markAsDirty=function(){this.currentRow=null},this.updateCharacterWidths=function(t){if(this.characterWidth!==t.$characterSize.width){this.fontMetrics=t;var i=this.characterWidth=t.$characterSize.width,n=t.$measureCharWidth("ה");this.charWidths[e.L]=this.charWidths[e.EN]=this.charWidths[e.ON_R]=i,this.charWidths[e.R]=this.charWidths[e.AN]=n,this.charWidths[e.R_H]=.45*n,this.charWidths[e.B]=this.charWidths[e.RLE]=0,this.currentRow=null}},this.setShowInvisibles=function(e){this.showInvisibles=e,this.currentRow=null},this.setEolChar=function(e){this.EOL=e},this.setContentWidth=function(e){this.contentWidth=e},this.isRtlLine=function(e){return!!this.$isRtl||(void 0!=e?this.session.getLine(e).charAt(0)==this.RLE:this.isRtlDir)},this.setRtlDirection=function(e,t){for(var i=e.getCursorPosition(),n=e.selection.getSelectionAnchor().row;n<=i.row;n++)t||e.session.getLine(n).charAt(0)!==e.session.$bidiHandler.RLE?t&&e.session.getLine(n).charAt(0)!==e.session.$bidiHandler.RLE&&e.session.doc.insert({column:0,row:n},e.session.$bidiHandler.RLE):e.session.doc.removeInLine(n,0,1)},this.getPosLeft=function(t){t-=this.wrapIndent;var i=this.line.charAt(0)===this.RLE?1:0,n=t>i?this.session.getOverwrite()?t:t-1:i,r=e.getVisualFromLogicalIdx(n,this.bidiMap),s=this.bidiMap.bidiLevels,o=0;!this.session.getOverwrite()&&t<=i&&s[r]%2!=0&&r++;for(var a=0;a<r;a++)o+=this.charWidths[s[a]];return!this.session.getOverwrite()&&t>i&&s[r]%2==0&&(o+=this.charWidths[s[r]]),this.wrapIndent&&(o+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset),this.isRtlDir&&(o+=this.rtlLineOffset),o},this.getSelections=function(e,t){var i,n=this.bidiMap,r=n.bidiLevels,s=[],o=0,a=Math.min(e,t)-this.wrapIndent,l=Math.max(e,t)-this.wrapIndent,c=!1,h=!1,u=0;this.wrapIndent&&(o+=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);for(var d,f=0;f<r.length;f++)d=n.logicalFromVisual[f],i=r[f],(c=d>=a&&d<l)&&!h?u=o:!c&&h&&s.push({left:u,width:o-u}),o+=this.charWidths[i],h=c;if(c&&f===r.length&&s.push({left:u,width:o-u}),this.isRtlDir)for(var p=0;p<s.length;p++)s[p].left+=this.rtlLineOffset;return s},this.offsetToCol=function(e){this.isRtlDir&&(e-=this.rtlLineOffset);var t=0,e=Math.max(e,0),i=0,n=0,r=this.bidiMap.bidiLevels,s=this.charWidths[r[n]];for(this.wrapIndent&&(e-=this.isRtlDir?-1*this.wrapOffset:this.wrapOffset);e>i+s/2;){if(i+=s,n===r.length-1){s=0;break}s=this.charWidths[r[++n]]}return n>0&&r[n-1]%2!=0&&r[n]%2==0?(e<i&&n--,t=this.bidiMap.logicalFromVisual[n]):n>0&&r[n-1]%2==0&&r[n]%2!=0?t=1+(e>i?this.bidiMap.logicalFromVisual[n]:this.bidiMap.logicalFromVisual[n-1]):this.isRtlDir&&n===r.length-1&&0===s&&r[n-1]%2==0||!this.isRtlDir&&0===n&&r[n]%2!=0?t=1+this.bidiMap.logicalFromVisual[n]:(n>0&&r[n-1]%2!=0&&0!==s&&n--,t=this.bidiMap.logicalFromVisual[n]),0===t&&this.isRtlDir&&t++,t+this.wrapIndent}}).call(n.prototype),exports.BidiHandler=n}),define("skylark-ace/selection",["require","exports","module","./lib/oop","./lib/lang","./lib/event_emitter","./range"],function(require,exports,module){var e=require("./lib/oop"),t=require("./lib/lang"),i=require("./lib/event_emitter").EventEmitter,n=require("./range").Range,r=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.cursor=this.lead=this.doc.createAnchor(0,0),this.anchor=this.doc.createAnchor(0,0),this.$silent=!1;var t=this;this.cursor.on("change",function(e){t.$cursorChanged=!0,t.$silent||t._emit("changeCursor"),t.$isEmpty||t.$silent||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)}),this.anchor.on("change",function(){t.$anchorChanged=!0,t.$isEmpty||t.$silent||t._emit("changeSelection")})};(function(){e.implement(this,i),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return!this.$isEmpty&&this.anchor.row!=this.cursor.row},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.$isEmpty=!1,this.anchor.setPosition(e,t)},this.getAnchor=this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.$isEmpty?n.fromPoints(t,t):this.isBackwards()?n.fromPoints(t,e):n.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){this.$setSelection(0,0,Number.MAX_VALUE,Number.MAX_VALUE)},this.setRange=this.setSelectionRange=function(e,t){var i=t?e.end:e.start,n=t?e.start:e.end;this.$setSelection(i.row,i.column,n.row,n.column)},this.$setSelection=function(e,t,i,r){var s=this.$isEmpty,o=this.inMultiSelectMode;this.$silent=!0,this.$cursorChanged=this.$anchorChanged=!1,this.anchor.setPosition(e,t),this.cursor.setPosition(i,r),this.$isEmpty=!n.comparePoints(this.anchor,this.cursor),this.$silent=!1,this.$cursorChanged&&this._emit("changeCursor"),(this.$cursorChanged||this.$anchorChanged||s!=this.$isEmpty||o)&&this._emit("changeSelection")},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection(function(){this.moveCursorTo(e,t)})},this.selectToPosition=function(e){this.$moveSelection(function(){this.moveCursorToPosition(e)})},this.moveTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.moveToPosition=function(e){this.clearSelection(),this.moveCursorToPosition(e)},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if(void 0===t){var i=e||this.lead;e=i.row,t=i.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var i,r="number"==typeof e?e:this.lead.row,s=this.session.getFoldLine(r);return s?(r=s.start.row,i=s.end.row):i=r,!0===t?new n(r,0,i,this.session.getLine(i).length):new n(r,0,i+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.wouldMoveIntoSoftTab=function(e,t,i){var n=e.column,r=e.column+t;return i<0&&(n=e.column-t,r=e.column),this.session.isTabStop(e)&&this.doc.getLine(e.row).slice(n,r).split(" ").length-1==t},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0===t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var i=this.session.getTabSize();this.wouldMoveIntoSoftTab(t,i,-1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,-i):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var i=this.session.getTabSize(),t=this.lead;this.wouldMoveIntoSoftTab(t,i,1)&&!this.session.getNavigateWithinSoftTabs()?this.moveCursorBy(0,i):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,i=this.session.documentToScreenRow(e,t),n=this.session.screenToDocumentPosition(i,0),r=this.session.getDisplayLine(e,null,n.row,n.column),s=r.match(/^\s*/);s[0].length==t||this.session.$useEmacsStyleLineStart||(n.column+=s[0].length),this.moveCursorToPosition(n)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var i=this.session.getLine(t.row);if(t.column==i.length){var n=i.search(/\s+$/);n>0&&(t.column=n)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e=this.lead.row,t=this.lead.column,i=this.doc.getLine(e),n=i.substring(t);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var r=this.session.getFoldAt(e,t,1);if(r)this.moveCursorTo(r.end.row,r.end.column);else{if(this.session.nonTokenRe.exec(n)&&(t+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,n=i.substring(t)),t>=i.length)return this.moveCursorTo(e,i.length),this.moveCursorRight(),void(e<this.doc.getLength()-1&&this.moveCursorWordRight());this.session.tokenRe.exec(n)&&(t+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(e,t)}},this.moveCursorLongWordLeft=function(){var e,i=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(i,n,-1))this.moveCursorTo(e.start.row,e.start.column);else{var r=this.session.getFoldStringAt(i,n,-1);null==r&&(r=this.doc.getLine(i).substring(0,n));var s=t.stringReverse(r);if(this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,this.session.nonTokenRe.exec(s)&&(n-=this.session.nonTokenRe.lastIndex,s=s.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),n<=0)return this.moveCursorTo(i,0),this.moveCursorLeft(),void(i>0&&this.moveCursorWordLeft());this.session.tokenRe.exec(s)&&(n-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),this.moveCursorTo(i,n)}},this.$shortWordEndIndex=function(e){var t,i=0,n=/\s/,r=this.session.tokenRe;if(r.lastIndex=0,this.session.tokenRe.exec(e))i=this.session.tokenRe.lastIndex;else{for(;(t=e[i])&&n.test(t);)i++;if(i<1)for(r.lastIndex=0;(t=e[i])&&!r.test(t);)if(r.lastIndex=0,i++,n.test(t)){if(i>2){i--;break}for(;(t=e[i])&&n.test(t);)i++;if(i>2)break}}return r.lastIndex=0,i},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,i=this.doc.getLine(e),n=i.substring(t),r=this.session.getFoldAt(e,t,1);if(r)return this.moveCursorTo(r.end.row,r.end.column);if(t==i.length){var s=this.doc.getLength();do{e++,n=this.doc.getLine(e)}while(e<s&&/^\s*$/.test(n));/^\s+/.test(n)||(n=""),t=0}var o=this.$shortWordEndIndex(n);this.moveCursorTo(e,t+o)},this.moveCursorShortWordLeft=function(){var e,i=this.lead.row,n=this.lead.column;if(e=this.session.getFoldAt(i,n,-1))return this.moveCursorTo(e.start.row,e.start.column);var r=this.session.getLine(i).substring(0,n);if(0===n){do{i--,r=this.doc.getLine(i)}while(i>0&&/^\s*$/.test(r));n=r.length,/\s+$/.test(r)||(r="")}var s=t.stringReverse(r),o=this.$shortWordEndIndex(s);return this.moveCursorTo(i,n-o)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var i,n=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===t&&(0!==e&&(this.session.$bidiHandler.isBidiRow(n.row,this.lead.row)?(i=this.session.$bidiHandler.getPosLeft(n.column),n.column=Math.round(i/this.session.$bidiHandler.charWidths[0])):i=n.column*this.session.$bidiHandler.charWidths[0]),this.$desiredColumn?n.column=this.$desiredColumn:this.$desiredColumn=n.column);var r=this.session.screenToDocumentPosition(n.row+e,n.column,i);0!==e&&0===t&&r.row===this.lead.row&&r.column===this.lead.column&&this.session.lineWidgets&&this.session.lineWidgets[r.row]&&(r.row>0||e>0)&&r.row++,this.moveCursorTo(r.row,r.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,i){var n=this.session.getFoldAt(e,t,1);n&&(e=n.start.row,t=n.start.column),this.$keepDesiredColumnOnChange=!0;var r=this.session.getLine(e);/[\uDC00-\uDFFF]/.test(r.charAt(t))&&r.charAt(t-1)&&(this.lead.row==e&&this.lead.column==t+1?t-=1:t+=1),this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,i||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,i){var n=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(n.row,n.column,i)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e},this.getRangeOfMovements=function(e){var t=this.getCursor();try{e(this);var i=this.getCursor();return n.fromPoints(t,i)}catch(e){return n.fromPoints(t,t)}finally{this.moveCursorToPosition(t)}},this.toJSON=function(){if(this.rangeCount)var e=this.ranges.map(function(e){var t=e.clone();return t.isBackwards=e.cursor==e.start,t});else{var e=this.getRange();e.isBackwards=this.isBackwards()}return e},this.fromJSON=function(e){if(void 0==e.start){if(this.rangeList){this.toSingleRange(e[0]);for(var t=e.length;t--;){var i=n.fromPoints(e[t].start,e[t].end);e[t].isBackwards&&(i.cursor=i.start),this.addRange(i,!0)}return}e=e[0]}this.rangeList&&this.toSingleRange(e),this.setSelectionRange(e,e.isBackwards)},this.isEqual=function(e){if((e.length||this.rangeCount)&&e.length!=this.rangeCount)return!1;if(!e.length||!this.ranges)return this.getRange().isEqual(e);for(var t=this.ranges.length;t--;)if(!this.ranges[t].isEqual(e[t]))return!1;return!0}}).call(r.prototype),exports.Selection=r}),define("skylark-ace/tokenizer",["require","exports","module","./config"],function(require,exports,module){var e=require("./config"),t=2e3,i=function(e){for(var t in this.states=e,this.regExps={},this.matchMappings={},this.states){for(var i=this.states[t],n=[],r=0,s=this.matchMappings[t]={defaultToken:"text"},o="g",a=[],l=0;l<i.length;l++){var c=i[l];if(c.defaultToken&&(s.defaultToken=c.defaultToken),c.caseInsensitive&&(o="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var h=c.regex,u=new RegExp("(?:("+h+")|(.))").exec("a").length-2;Array.isArray(c.token)?1==c.token.length||1==u?c.token=c.token[0]:u-1!=c.token.length?(this.reportError("number of classes and regexp groups doesn't match",{rule:c,groupCount:u-1}),c.token=c.token[0]):(c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens):"function"!=typeof c.token||c.onMatch||(c.onMatch=u>1?this.$applyToken:c.token),u>1&&(/\\\d/.test(c.regex)?h=c.regex.replace(/\\([0-9]+)/g,function(e,t){return"\\"+(parseInt(t,10)+r+1)}):(u=1,h=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),s[r]=l,r+=u,n.push(h),c.onMatch||(c.onMatch=null)}}n.length||(s[0]=0,n.push("$")),a.forEach(function(e){e.splitRegex=this.createSplitterRegexp(e.regex,o)},this),this.regExps[t]=new RegExp("("+n.join(")|(")+")|($)",o)}};(function(){this.$setMaxTokenCount=function(e){t=0|e},this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),i=this.token.apply(this,t);if("string"==typeof i)return[{type:i,value:e}];for(var n=[],r=0,s=i.length;r<s;r++)t[r]&&(n[n.length]={type:i[r],value:t[r]});return n},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var i=[],n=this.tokenArray,r=0,s=n.length;r<s;r++)t[r+1]&&(i[i.length]={type:n[r],value:t[r+1]});return i},this.removeCapturingGroups=function(e){var t=e.replace(/\\.|\[(?:\\.|[^\\\]])*|\(\?[:=!]|(\()/g,function(e,t){return t?"(?:":e});return t},this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var i=0,n=!1,r={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(e,t,s,o,a,l){return n?n="]"!=a:a?n=!0:o?(i==r.stack&&(r.end=l+1,r.stack=-1),i--):s&&(i++,1!=s.length&&(r.stack=i,r.start=l)),e}),null!=r.end&&/^\)*$/.test(e.substr(r.end))&&(e=e.substring(0,r.start)+e.substr(r.end))}return"^"!=e.charAt(0)&&(e="^"+e),"$"!=e.charAt(e.length-1)&&(e+="$"),new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,i){if(i&&"string"!=typeof i){var n=i.slice(0);"#tmp"===(i=n[0])&&(n.shift(),i=n.shift())}else var n=[];var r=i||"start",s=this.states[r];s||(r="start",s=this.states[r]);var o=this.matchMappings[r],a=this.regExps[r];a.lastIndex=0;for(var l,c=[],h=0,u=0,d={type:null,value:""};l=a.exec(e);){var f=o.defaultToken,p=null,m=l[0],g=a.lastIndex;if(g-m.length>h){var v=e.substring(h,g-m.length);d.type==f?d.value+=v:(d.type&&c.push(d),d={type:f,value:v})}for(var y=0;y<l.length-2;y++)if(void 0!==l[y+1]){p=s[o[y]],f=p.onMatch?p.onMatch(m,r,n,e):p.token,p.next&&(r="string"==typeof p.next?p.next:p.next(r,n),(s=this.states[r])||(this.reportError("state doesn't exist",r),r="start",s=this.states[r]),o=this.matchMappings[r],h=g,(a=this.regExps[r]).lastIndex=g),p.consumeLineEnd&&(h=g);break}if(m)if("string"==typeof f)p&&!1===p.merge||d.type!==f?(d.type&&c.push(d),d={type:f,value:m}):d.value+=m;else if(f){d.type&&c.push(d),d={type:null,value:""};for(var y=0;y<f.length;y++)c.push(f[y])}if(h==e.length)break;if(h=g,u++>t){for(u>2*e.length&&this.reportError("infinite loop with in ace tokenizer",{startState:i,line:e});h<e.length;)d.type&&c.push(d),d={value:e.substring(h,h+=2e3),type:"overflow"};r="start",n=[];break}}return d.type&&c.push(d),n.length>1&&n[0]!==r&&n.unshift("#tmp",r),{tokens:c,state:n.length?n:r}},this.reportError=e.reportError}).call(i.prototype),exports.Tokenizer=i}),define("skylark-ace/mode/text_highlight_rules",["require","exports","module","../lib/lang"],function(require,exports,module){var e=require("../lib/lang"),t=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){if(t)for(var i in e){for(var n=e[i],r=0;r<n.length;r++){var s=n[r];(s.next||s.onMatch)&&("string"==typeof s.next&&0!==s.next.indexOf(t)&&(s.next=t+s.next),s.nextState&&0!==s.nextState.indexOf(t)&&(s.nextState=t+s.nextState))}this.$rules[t+i]=n}else for(var i in e)this.$rules[i]=e[i]},this.getRules=function(){return this.$rules},this.embedRules=function(t,i,n,r,s){var o="function"==typeof t?(new t).getRules():t;if(r)for(var a=0;a<r.length;a++)r[a]=i+r[a];else for(var l in r=[],o)r.push(i+l);if(this.addRules(o,i),n)for(var c=Array.prototype[s?"push":"unshift"],a=0;a<r.length;a++)c.apply(this.$rules[r[a]],e.deepCopy(n));this.$embeds||(this.$embeds=[]),this.$embeds.push(i)},this.getEmbeds=function(){return this.$embeds};var t=function(e,t){return("start"!=e||t.length)&&t.unshift(this.nextState,e),this.nextState},i=function(e,t){return t.shift(),t.shift()||"start"};this.normalizeRules=function(){var e=0,n=this.$rules;Object.keys(n).forEach(function r(s){var o=n[s];o.processed=!0;for(var a=0;a<o.length;a++){var l=o[a],c=null;Array.isArray(l)&&(c=l,l={}),!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var h=l.next||l.push;if(h&&Array.isArray(h)){var u=l.stateName;u||("string"!=typeof(u=l.token)&&(u=u[0]||""),n[u]&&(u+=e++)),n[u]=h,l.next=u,r(u)}else"pop"==h&&(l.next=i);if(l.push&&(l.nextState=l.next||l.push,l.next=t,delete l.push),l.rules)for(var d in l.rules)n[d]?n[d].push&&n[d].push.apply(n[d],l.rules[d]):n[d]=l.rules[d];var f="string"==typeof l?l:l.include;if(f&&(c=Array.isArray(f)?f.map(function(e){return n[e]}):n[f]),c){var p=[a,1].concat(c);l.noEscape&&(p=p.filter(function(e){return!e.next})),o.splice.apply(o,p),a--}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}},this)},this.createKeywordMapper=function(e,t,i,n){var r=Object.create(null);return Object.keys(e).forEach(function(t){var s=e[t];i&&(s=s.toLowerCase());for(var o=s.split(n||"|"),a=o.length;a--;)r[o[a]]=t}),Object.getPrototypeOf(r)&&(r.__proto__=null),this.$keywordList=Object.keys(r),e=null,i?function(e){return r[e.toLowerCase()]||t}:function(e){return r[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(t.prototype),exports.TextHighlightRules=t}),define("skylark-ace/mode/behaviour",["require","exports","module"],function(require,exports,module){var e=function(){this.$behaviours={}};(function(){this.add=function(e,t,i){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=i},this.addBehaviours=function(e){for(var t in e)for(var i in e[t])this.add(t,i,e[t][i])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var i=(new e).getBehaviours(t);else var i=e.getBehaviours(t);this.addBehaviours(i)},this.getBehaviours=function(e){if(e){for(var t={},i=0;i<e.length;i++)this.$behaviours[e[i]]&&(t[e[i]]=this.$behaviours[e[i]]);return t}return this.$behaviours}}).call(e.prototype),exports.Behaviour=e}),define("skylark-ace/token_iterator",["require","exports","module","./range"],function(require,exports,module){var e=require("./range").Range,t=function(e,t,i){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var n=e.getTokenAt(t,i);this.$tokenIndex=n?n.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){var e;for(this.$tokenIndex+=1;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,i=e[t].start;if(void 0!==i)return i;for(i=0;t>0;)i+=e[t-=1].value.length;return i},this.getCurrentTokenPosition=function(){return{row:this.$row,column:this.getCurrentTokenColumn()}},this.getCurrentTokenRange=function(){var t=this.$rowTokens[this.$tokenIndex],i=this.getCurrentTokenColumn();return new e(this.$row,i,this.$row,i+t.value.length)}}).call(t.prototype),exports.TokenIterator=t}),define("skylark-ace/mode/behaviour/cstyle",["require","exports","module","../../lib/oop","../behaviour","../../token_iterator","../../lib/lang"],function(require,exports,module){var e,t=require("../../lib/oop"),i=require("../behaviour").Behaviour,n=require("../../token_iterator").TokenIterator,r=require("../../lib/lang"),s=["text","paren.rparen","punctuation.operator"],o=["text","paren.rparen","punctuation.operator","comment"],a={},l={'"':'"',"'":"'"},c=function(t){var i=-1;if(t.multiSelect&&(i=t.selection.index,a.rangeCount!=t.multiSelect.rangeCount&&(a={rangeCount:t.multiSelect.rangeCount})),a[i])return e=a[i];e=a[i]={autoInsertedBrackets:0,autoInsertedRow:-1,autoInsertedLineEnd:"",maybeInsertedBrackets:0,maybeInsertedRow:-1,maybeInsertedLineStart:"",maybeInsertedLineEnd:""}},h=function(e,t,i,n){var r=e.end.row-e.start.row;return{text:i+t+n,selection:[0,e.start.column+1,r,e.end.column+(r?0:1)]}},u=function(t){this.add("braces","insertion",function(i,n,s,o,a){var l=s.getCursorPosition(),d=o.doc.getLine(l.row);if("{"==a){c(s);var f=s.getSelectionRange(),p=o.doc.getTextRange(f);if(""!==p&&"{"!==p&&s.getWrapBehavioursEnabled())return h(f,p,"{","}");if(u.isSaneInsertion(s,o))return/[\]\}\)]/.test(d[l.column])||s.inMultiSelectMode||t&&t.braces?(u.recordAutoInsert(s,o,"}"),{text:"{}",selection:[1,1]}):(u.recordMaybeInsert(s,o,"{"),{text:"{",selection:[1,1]})}else if("}"==a){c(s);var m=d.substring(l.column,l.column+1);if("}"==m){var g=o.$findOpeningBracket("}",{column:l.column+1,row:l.row});if(null!==g&&u.isAutoInsertedClosing(l,d,a))return u.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}else{if("\n"==a||"\r\n"==a){c(s);var v="";u.isMaybeInsertedClosing(l,d)&&(v=r.stringRepeat("}",e.maybeInsertedBrackets),u.clearMaybeInsertedClosing());var m=d.substring(l.column,l.column+1);if("}"===m){var y=o.findMatchingBracket({row:l.row,column:l.column+1},"}");if(!y)return null;var k=this.$getIndent(o.getLine(y.row))}else{if(!v)return void u.clearMaybeInsertedClosing();var k=this.$getIndent(d)}var b=k+o.getTabString();return{text:"\n"+b+"\n"+k+v,selection:[1,b.length,1,b.length]}}u.clearMaybeInsertedClosing()}}),this.add("braces","deletion",function(t,i,n,r,s){var o=r.doc.getTextRange(s);if(!s.isMultiLine()&&"{"==o){c(n);var a=r.doc.getLine(s.start.row),l=a.substring(s.end.column,s.end.column+1);if("}"==l)return s.end.column++,s;e.maybeInsertedBrackets--}}),this.add("parens","insertion",function(e,t,i,n,r){if("("==r){c(i);var s=i.getSelectionRange(),o=n.doc.getTextRange(s);if(""!==o&&i.getWrapBehavioursEnabled())return h(s,o,"(",")");if(u.isSaneInsertion(i,n))return u.recordAutoInsert(i,n,")"),{text:"()",selection:[1,1]}}else if(")"==r){c(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),d=l.substring(a.column,a.column+1);if(")"==d){var f=n.$findOpeningBracket(")",{column:a.column+1,row:a.row});if(null!==f&&u.isAutoInsertedClosing(a,l,r))return u.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("parens","deletion",function(e,t,i,n,r){var s=n.doc.getTextRange(r);if(!r.isMultiLine()&&"("==s){c(i);var o=n.doc.getLine(r.start.row),a=o.substring(r.start.column+1,r.start.column+2);if(")"==a)return r.end.column++,r}}),this.add("brackets","insertion",function(e,t,i,n,r){if("["==r){c(i);var s=i.getSelectionRange(),o=n.doc.getTextRange(s);if(""!==o&&i.getWrapBehavioursEnabled())return h(s,o,"[","]");if(u.isSaneInsertion(i,n))return u.recordAutoInsert(i,n,"]"),{text:"[]",selection:[1,1]}}else if("]"==r){c(i);var a=i.getCursorPosition(),l=n.doc.getLine(a.row),d=l.substring(a.column,a.column+1);if("]"==d){var f=n.$findOpeningBracket("]",{column:a.column+1,row:a.row});if(null!==f&&u.isAutoInsertedClosing(a,l,r))return u.popAutoInsertedClosing(),{text:"",selection:[1,1]}}}}),this.add("brackets","deletion",function(e,t,i,n,r){var s=n.doc.getTextRange(r);if(!r.isMultiLine()&&"["==s){c(i);var o=n.doc.getLine(r.start.row),a=o.substring(r.start.column+1,r.start.column+2);if("]"==a)return r.end.column++,r}}),this.add("string_dquotes","insertion",function(e,t,i,n,r){var s=n.$mode.$quotes||l;if(1==r.length&&s[r]){if(this.lineCommentStart&&-1!=this.lineCommentStart.indexOf(r))return;c(i);var o=r,a=i.getSelectionRange(),u=n.doc.getTextRange(a);if(!(""===u||1==u.length&&s[u])&&i.getWrapBehavioursEnabled())return h(a,u,o,o);if(!u){var d=i.getCursorPosition(),f=n.doc.getLine(d.row),p=f.substring(d.column-1,d.column),m=f.substring(d.column,d.column+1),g=n.getTokenAt(d.row,d.column),v=n.getTokenAt(d.row,d.column+1);if("\\"==p&&g&&/escape/.test(g.type))return null;var y,k=g&&/string|escape/.test(g.type),b=!v||/string|escape/.test(v.type);if(m==o)(y=k!==b)&&/string\.end/.test(v.type)&&(y=!1);else{if(k&&!b)return null;if(k&&b)return null;var x=n.$mode.tokenRe;x.lastIndex=0;var w=x.test(p);x.lastIndex=0;var _=x.test(p);if(w||_)return null;if(m&&!/[\s;,.})\]\\]/.test(m))return null;y=!0}return{text:y?o+o:"",selection:[1,1]}}}}),this.add("string_dquotes","deletion",function(e,t,i,n,r){var s=n.$mode.$quotes||l,o=n.doc.getTextRange(r);if(!r.isMultiLine()&&s.hasOwnProperty(o)){c(i);var a=n.doc.getLine(r.start.row),h=a.substring(r.start.column+1,r.start.column+2);if(h==o)return r.end.column++,r}})};u.isSaneInsertion=function(e,t){var i=e.getCursorPosition(),r=new n(t,i.row,i.column);if(!this.$matchTokenType(r.getCurrentToken()||"text",s)){var a=new n(t,i.row,i.column+1);if(!this.$matchTokenType(a.getCurrentToken()||"text",s))return!1}return r.stepForward(),r.getCurrentTokenRow()!==i.row||this.$matchTokenType(r.getCurrentToken()||"text",o)},u.$matchTokenType=function(e,t){return t.indexOf(e.type||e)>-1},u.recordAutoInsert=function(t,i,n){var r=t.getCursorPosition(),s=i.doc.getLine(r.row);this.isAutoInsertedClosing(r,s,e.autoInsertedLineEnd[0])||(e.autoInsertedBrackets=0),e.autoInsertedRow=r.row,e.autoInsertedLineEnd=n+s.substr(r.column),e.autoInsertedBrackets++},u.recordMaybeInsert=function(t,i,n){var r=t.getCursorPosition(),s=i.doc.getLine(r.row);this.isMaybeInsertedClosing(r,s)||(e.maybeInsertedBrackets=0),e.maybeInsertedRow=r.row,e.maybeInsertedLineStart=s.substr(0,r.column)+n,e.maybeInsertedLineEnd=s.substr(r.column),e.maybeInsertedBrackets++},u.isAutoInsertedClosing=function(t,i,n){return e.autoInsertedBrackets>0&&t.row===e.autoInsertedRow&&n===e.autoInsertedLineEnd[0]&&i.substr(t.column)===e.autoInsertedLineEnd},u.isMaybeInsertedClosing=function(t,i){return e.maybeInsertedBrackets>0&&t.row===e.maybeInsertedRow&&i.substr(t.column)===e.maybeInsertedLineEnd&&i.substr(0,t.column)==e.maybeInsertedLineStart},u.popAutoInsertedClosing=function(){e.autoInsertedLineEnd=e.autoInsertedLineEnd.substr(1),e.autoInsertedBrackets--},u.clearMaybeInsertedClosing=function(){e&&(e.maybeInsertedBrackets=0,e.maybeInsertedRow=-1)},t.inherits(u,i),exports.CstyleBehaviour=u}),define("skylark-ace/unicode",["require","exports","module"],function(require,exports,module){for(var e=[48,9,8,25,5,0,2,25,48,0,11,0,5,0,6,22,2,30,2,457,5,11,15,4,8,0,2,0,18,116,2,1,3,3,9,0,2,2,2,0,2,19,2,82,2,138,2,4,3,155,12,37,3,0,8,38,10,44,2,0,2,1,2,1,2,0,9,26,6,2,30,10,7,61,2,9,5,101,2,7,3,9,2,18,3,0,17,58,3,100,15,53,5,0,6,45,211,57,3,18,2,5,3,11,3,9,2,1,7,6,2,2,2,7,3,1,3,21,2,6,2,0,4,3,3,8,3,1,3,3,9,0,5,1,2,4,3,11,16,2,2,5,5,1,3,21,2,6,2,1,2,1,2,1,3,0,2,4,5,1,3,2,4,0,8,3,2,0,8,15,12,2,2,8,2,2,2,21,2,6,2,1,2,4,3,9,2,2,2,2,3,0,16,3,3,9,18,2,2,7,3,1,3,21,2,6,2,1,2,4,3,8,3,1,3,2,9,1,5,1,2,4,3,9,2,0,17,1,2,5,4,2,2,3,4,1,2,0,2,1,4,1,4,2,4,11,5,4,4,2,2,3,3,0,7,0,15,9,18,2,2,7,2,2,2,22,2,9,2,4,4,7,2,2,2,3,8,1,2,1,7,3,3,9,19,1,2,7,2,2,2,22,2,9,2,4,3,8,2,2,2,3,8,1,8,0,2,3,3,9,19,1,2,7,2,2,2,22,2,15,4,7,2,2,2,3,10,0,9,3,3,9,11,5,3,1,2,17,4,23,2,8,2,0,3,6,4,0,5,5,2,0,2,7,19,1,14,57,6,14,2,9,40,1,2,0,3,1,2,0,3,0,7,3,2,6,2,2,2,0,2,0,3,1,2,12,2,2,3,4,2,0,2,5,3,9,3,1,35,0,24,1,7,9,12,0,2,0,2,0,5,9,2,35,5,19,2,5,5,7,2,35,10,0,58,73,7,77,3,37,11,42,2,0,4,328,2,3,3,6,2,0,2,3,3,40,2,3,3,32,2,3,3,6,2,0,2,3,3,14,2,56,2,3,3,66,5,0,33,15,17,84,13,619,3,16,2,25,6,74,22,12,2,6,12,20,12,19,13,12,2,2,2,1,13,51,3,29,4,0,5,1,3,9,34,2,3,9,7,87,9,42,6,69,11,28,4,11,5,11,11,39,3,4,12,43,5,25,7,10,38,27,5,62,2,28,3,10,7,9,14,0,89,75,5,9,18,8,13,42,4,11,71,55,9,9,4,48,83,2,2,30,14,230,23,280,3,5,3,37,3,5,3,7,2,0,2,0,2,0,2,30,3,52,2,6,2,0,4,2,2,6,4,3,3,5,5,12,6,2,2,6,67,1,20,0,29,0,14,0,17,4,60,12,5,0,4,11,18,0,5,0,3,9,2,0,4,4,7,0,2,0,2,0,2,3,2,10,3,3,6,4,5,0,53,1,2684,46,2,46,2,132,7,6,15,37,11,53,10,0,17,22,10,6,2,6,2,6,2,6,2,6,2,6,2,6,2,6,2,31,48,0,470,1,36,5,2,4,6,1,5,85,3,1,3,2,2,89,2,3,6,40,4,93,18,23,57,15,513,6581,75,20939,53,1164,68,45,3,268,4,27,21,31,3,13,13,1,2,24,9,69,11,1,38,8,3,102,3,1,111,44,25,51,13,68,12,9,7,23,4,0,5,45,3,35,13,28,4,64,15,10,39,54,10,13,3,9,7,22,4,1,5,66,25,2,227,42,2,1,3,9,7,11171,13,22,5,48,8453,301,3,61,3,105,39,6,13,4,6,11,2,12,2,4,2,0,2,1,2,1,2,107,34,362,19,63,3,53,41,11,5,15,17,6,13,1,25,2,33,4,2,134,20,9,8,25,5,0,2,25,12,88,4,5,3,5,3,5,3,2],t=0,i=[],n=0;n<e.length;n+=2)i.push(t+=e[n]),e[n+1]&&i.push(45,t+=e[n+1]);exports.wordChars=String.fromCharCode.apply(null,i)}),define("skylark-ace/mode/text",["require","exports","module","../config","../tokenizer","./text_highlight_rules","./behaviour/cstyle","../unicode","../lib/lang","../token_iterator","../range"],function(require,exports,module){var e=require("../config"),t=require("../tokenizer").Tokenizer,i=require("./text_highlight_rules").TextHighlightRules,n=require("./behaviour/cstyle").CstyleBehaviour,r=require("../unicode"),s=require("../lib/lang"),o=require("../token_iterator").TokenIterator,a=require("../range").Range,l=function(){this.HighlightRules=i};(function(){this.$defaultBehaviour=new n,this.tokenRe=new RegExp("^["+r.wordChars+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+r.wordChars+"\\$_]|\\s])+","g"),this.getTokenizer=function(){return this.$tokenizer||(this.$highlightRules=this.$highlightRules||new this.HighlightRules(this.$highlightRuleConfig),this.$tokenizer=new t(this.$highlightRules.getRules())),this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,i,n){var r=t.doc,o=!0,a=!0,l=1/0,c=t.getTabSize(),h=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))var u=this.lineCommentStart.map(s.escapeRegExp).join("|"),d=this.lineCommentStart[0];else var u=s.escapeRegExp(this.lineCommentStart),d=this.lineCommentStart;u=new RegExp("^(\\s*)(?:"+u+") ?"),h=t.getUseSoftTabs();var f=function(e,t){var i=e.match(u);if(i){var n=i[1].length,s=i[0].length;v(e,n,s)||" "!=i[0][s-1]||s--,r.removeInLine(t,n,s)}},p=d+" ",m=function(e,t){o&&!/\S/.test(e)||(v(e,l,l)?r.insertInLine({row:t,column:l},p):r.insertInLine({row:t,column:l},d))},g=function(e,t){return u.test(e)},v=function(e,t,i){for(var n=0;t--&&" "==e.charAt(t);)n++;if(n%c!=0)return!1;for(var n=0;" "==e.charAt(i++);)n++;return c>2?n%c!=c-1:n%c==0}}else{if(!this.blockComment)return!1;var d=this.blockComment.start,y=this.blockComment.end,u=new RegExp("^(\\s*)(?:"+s.escapeRegExp(d)+")"),k=new RegExp("(?:"+s.escapeRegExp(y)+")\\s*$"),m=function(e,t){g(e,t)||o&&!/\S/.test(e)||(r.insertInLine({row:t,column:e.length},y),r.insertInLine({row:t,column:l},d))},f=function(e,t){var i;(i=e.match(k))&&r.removeInLine(t,e.length-i[0].length,e.length),(i=e.match(u))&&r.removeInLine(t,i[1].length,i[0].length)},g=function(e,i){if(u.test(e))return!0;for(var n=t.getTokens(i),r=0;r<n.length;r++)if("comment"===n[r].type)return!0}}function b(e){for(var t=i;t<=n;t++)e(r.getLine(t),t)}var x=1/0;b(function(e,t){var i=e.search(/\S/);-1!==i?(i<l&&(l=i),a&&!g(e,t)&&(a=!1)):x>e.length&&(x=e.length)}),l==1/0&&(l=x,o=!1,a=!1),h&&l%c!=0&&(l=Math.floor(l/c)*c),b(a?f:m)},this.toggleBlockComment=function(e,t,i,n){var r=this.blockComment;if(r){!r.start&&r[0]&&(r=r[0]);var s,l,c=new o(t,n.row,n.column),h=c.getCurrentToken(),u=(t.selection,t.selection.toOrientedRange());if(h&&/comment/.test(h.type)){for(var d,f;h&&/comment/.test(h.type);){var p=h.value.indexOf(r.start);if(-1!=p){var m=c.getCurrentTokenRow(),g=c.getCurrentTokenColumn()+p;d=new a(m,g,m,g+r.start.length);break}h=c.stepBackward()}for(var c=new o(t,n.row,n.column),h=c.getCurrentToken();h&&/comment/.test(h.type);){var p=h.value.indexOf(r.end);if(-1!=p){var m=c.getCurrentTokenRow(),g=c.getCurrentTokenColumn()+p;f=new a(m,g,m,g+r.end.length);break}h=c.stepForward()}f&&t.remove(f),d&&(t.remove(d),s=d.start.row,l=-r.start.length)}else l=r.start.length,s=i.start.row,t.insert(i.end,r.end),t.insert(i.start,r.start);u.start.row==s&&(u.start.column+=l),u.end.row==s&&(u.end.column+=l),t.selection.fromOrientedRange(u)}},this.getNextLineIndent=function(e,t,i){return this.$getIndent(t)},this.checkOutdent=function(e,t,i){return!1},this.autoOutdent=function(e,t,i){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(t){for(var i in this.$embeds=[],this.$modes={},t)if(t[i]){var n=t[i],r=n.prototype.$id,s=e.$modes[r];s||(e.$modes[r]=s=new n),e.$modes[i]||(e.$modes[i]=s),this.$embeds.push(i),this.$modes[i]=s}for(var o=["toggleBlockComment","toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction","getCompletions"],i=0;i<o.length;i++)!function(e){var t=o[i],n=e[t];e[o[i]]=function(){return this.$delegator(t,arguments,n)}}(this)},this.$delegator=function(e,t,i){var n=t[0]||"start";if("string"!=typeof n){if(Array.isArray(n[2])){var r=n[2][n[2].length-1],s=this.$modes[r];if(s)return s[e].apply(s,[n[1]].concat([].slice.call(t,1)))}n=n[0]||"start"}for(var o=0;o<this.$embeds.length;o++)if(this.$modes[this.$embeds[o]]){var a=n.split(this.$embeds[o]);if(!a[0]&&a[1]){t[0]=a[1];var s=this.$modes[this.$embeds[o]];return s[e].apply(s,t)}}var l=i.apply(this,t);return i?l:void 0},this.transformAction=function(e,t,i,n,r){if(this.$behaviour){var s=this.$behaviour.getBehaviours();for(var o in s)if(s[o][t]){var a=s[o][t].apply(this,arguments);if(a)return a}}},this.getKeywords=function(e){if(!this.completionKeywords){var t=this.$tokenizer.rules,i=[];for(var n in t)for(var r=t[n],s=0,o=r.length;s<o;s++)if("string"==typeof r[s].token)/keyword|support|storage/.test(r[s].token)&&i.push(r[s].regex);else if("object"==typeof r[s].token)for(var a=0,l=r[s].token.length;a<l;a++)if(/keyword|support|storage/.test(r[s].token[a])){var n=r[s].regex.match(/\(.+?\)/g)[a];i.push(n.substr(1,n.length-2))}this.completionKeywords=i}return e?i.concat(this.$keywordList||[]):this.$keywordList},this.$createKeywordList=function(){return this.$highlightRules||this.getTokenizer(),this.$keywordList=this.$highlightRules.$keywordList||[]},this.getCompletions=function(e,t,i,n){var r=this.$keywordList||this.$createKeywordList();return r.map(function(e){return{name:e,value:e,score:0,meta:"keyword"}})},this.$id="ace/mode/text"}).call(l.prototype),exports.Mode=l}),define("skylark-ace/apply_delta",["require","exports","module"],function(require,exports,module){exports.applyDelta=function(e,t,i){var n=t.start.row,r=t.start.column,s=e[n]||"";switch(t.action){case"insert":var o=t.lines;if(1===o.length)e[n]=s.substring(0,r)+t.lines[0]+s.substring(r);else{var a=[n,1].concat(t.lines);e.splice.apply(e,a),e[n]=s.substring(0,r)+e[n],e[n+t.lines.length-1]+=s.substring(r)}break;case"remove":var l=t.end.column,c=t.end.row;n===c?e[n]=s.substring(0,r)+s.substring(l):e.splice(n,c-n+1,s.substring(0,r)+e[c].substring(l))}}}),define("skylark-ace/anchor",["require","exports","module","./lib/oop","./lib/event_emitter"],function(require,exports,module){var e=require("./lib/oop"),t=require("./lib/event_emitter").EventEmitter,i=exports.Anchor=function(e,t,i){this.$onChange=this.onChange.bind(this),this.attach(e),void 0===i?this.setPosition(t.row,t.column):this.setPosition(t,i)};(function(){function i(e,t,i){var n=i?e.column<=t.column:e.column<t.column;return e.row<t.row||e.row==t.row&&n}e.implement(this,t),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(e){if(!(e.start.row==e.end.row&&e.start.row!=this.row||e.start.row>this.row)){var t=function(e,t,n){var r="insert"==e.action,s=(r?1:-1)*(e.end.row-e.start.row),o=(r?1:-1)*(e.end.column-e.start.column),a=e.start,l=r?a:e.end;if(i(t,a,n))return{row:t.row,column:t.column};if(i(l,t,!n))return{row:t.row+s,column:t.column+(t.row==l.row?o:0)};return{row:a.row,column:a.column}}(e,{row:this.row,column:this.column},this.$insertRight);this.setPosition(t.row,t.column,!0)}},this.setPosition=function(e,t,i){var n;if(n=i?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=n.row||this.column!=n.column){var r={row:this.row,column:this.column};this.row=n.row,this.column=n.column,this._signal("change",{old:r,value:n})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(e){this.document=e||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var i={};return e>=this.document.getLength()?(i.row=Math.max(0,this.document.getLength()-1),i.column=this.document.getLine(i.row).length):e<0?(i.row=0,i.column=0):(i.row=e,i.column=Math.min(this.document.getLine(i.row).length,Math.max(0,t))),t<0&&(i.column=0),i}}).call(i.prototype)}),define("skylark-ace/document",["require","exports","module","./lib/oop","./apply_delta","./lib/event_emitter","./range","./anchor"],function(require,exports,module){var e=require("./lib/oop"),t=require("./apply_delta").applyDelta,i=require("./lib/event_emitter").EventEmitter,n=require("./range").Range,r=require("./anchor").Anchor,s=function(e){this.$lines=[""],0===e.length?this.$lines=[""]:Array.isArray(e)?this.insertMergedLines({row:0,column:0},e):this.insert({row:0,column:0},e)};(function(){e.implement(this,i),this.setValue=function(e){var t=this.getLength()-1;this.remove(new n(0,0,t,this.getLine(t).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new r(this,e,t)},0==="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine||"\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){return this.getLinesForRange(e).join(this.getNewLineCharacter())},this.getLinesForRange=function(e){var t;if(e.start.row===e.end.row)t=[this.getLine(e.start.row).substring(e.start.column,e.end.column)];else{(t=this.getLines(e.start.row,e.end.row))[0]=(t[0]||"").substring(e.start.column);var i=t.length-1;e.end.row-e.start.row==i&&(t[i]=t[i].substring(0,e.end.column))}return t},this.insertLines=function(e,t){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(e,t)},this.removeLines=function(e,t){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(e,t)},this.insertNewLine=function(e){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(e,["",""])},this.insert=function(e,t){return this.getLength()<=1&&this.$detectNewLine(t),this.insertMergedLines(e,this.$split(t))},this.insertInLine=function(e,t){var i=this.clippedPos(e.row,e.column),n=this.pos(e.row,e.column+t.length);return this.applyDelta({start:i,end:n,action:"insert",lines:[t]},!0),this.clonePos(n)},this.clippedPos=function(e,t){var i=this.getLength();void 0===e?e=i:e<0?e=0:e>=i&&(e=i-1,t=void 0);var n=this.getLine(e);return void 0==t&&(t=n.length),t=Math.min(Math.max(t,0),n.length),{row:e,column:t}},this.clonePos=function(e){return{row:e.row,column:e.column}},this.pos=function(e,t){return{row:e,column:t}},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):(e.row=Math.max(0,e.row),e.column=Math.min(Math.max(e.column,0),this.getLine(e.row).length)),e},this.insertFullLines=function(e,t){var i=0;(e=Math.min(Math.max(e,0),this.getLength()))<this.getLength()?(t=t.concat([""]),i=0):(t=[""].concat(t),e--,i=this.$lines[e].length),this.insertMergedLines({row:e,column:i},t)},this.insertMergedLines=function(e,t){var i=this.clippedPos(e.row,e.column),n={row:i.row+t.length-1,column:(1==t.length?i.column:0)+t[t.length-1].length};return this.applyDelta({start:i,end:n,action:"insert",lines:t}),this.clonePos(n)},this.remove=function(e){var t=this.clippedPos(e.start.row,e.start.column),i=this.clippedPos(e.end.row,e.end.column);return this.applyDelta({start:t,end:i,action:"remove",lines:this.getLinesForRange({start:t,end:i})}),this.clonePos(t)},this.removeInLine=function(e,t,i){var n=this.clippedPos(e,t),r=this.clippedPos(e,i);return this.applyDelta({start:n,end:r,action:"remove",lines:this.getLinesForRange({start:n,end:r})},!0),this.clonePos(n)},this.removeFullLines=function(e,t){e=Math.min(Math.max(0,e),this.getLength()-1);var i=(t=Math.min(Math.max(0,t),this.getLength()-1))==this.getLength()-1&&e>0,r=t<this.getLength()-1,s=i?e-1:e,o=i?this.getLine(s).length:0,a=r?t+1:t,l=r?0:this.getLine(a).length,c=new n(s,o,a,l),h=this.$lines.slice(e,t+1);return this.applyDelta({start:c.start,end:c.end,action:"remove",lines:this.getLinesForRange(c)}),h},this.removeNewLine=function(e){e<this.getLength()-1&&e>=0&&this.applyDelta({start:this.pos(e,this.getLine(e).length),end:this.pos(e+1,0),action:"remove",lines:["",""]})},this.replace=function(e,t){return e instanceof n||(e=n.fromPoints(e.start,e.end)),0===t.length&&e.isEmpty()?e.start:t==this.getTextRange(e)?e.end:(this.remove(e),t?this.insert(e.start,t):e.start)},this.applyDeltas=function(e){for(var t=0;t<e.length;t++)this.applyDelta(e[t])},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--)this.revertDelta(e[t])},this.applyDelta=function(e,i){var r="insert"==e.action;(r?e.lines.length<=1&&!e.lines[0]:!n.comparePoints(e.start,e.end))||(r&&e.lines.length>2e4?this.$splitAndapplyLargeDelta(e,2e4):(t(this.$lines,e,i),this._signal("change",e)))},this.$splitAndapplyLargeDelta=function(e,t){for(var i=e.lines,n=i.length-t+1,r=e.start.row,s=e.start.column,o=0,a=0;o<n;o=a){a+=t-1;var l=i.slice(o,a);l.push(""),this.applyDelta({start:this.pos(r+o,s),end:this.pos(r+a,s=0),action:e.action,lines:l},!0)}e.lines=i.slice(o),e.start.row=r+o,e.start.column=s,this.applyDelta(e,!0)},this.revertDelta=function(e){this.applyDelta({start:this.clonePos(e.start),end:this.clonePos(e.end),action:"insert"==e.action?"remove":"insert",lines:e.lines.slice()})},this.indexToPosition=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,r=t||0,s=i.length;r<s;r++)if((e-=i[r].length+n)<0)return{row:r,column:e+i[r].length+n};return{row:s-1,column:e+i[s-1].length+n}},this.positionToIndex=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,r=0,s=Math.min(e.row,i.length),o=t||0;o<s;++o)r+=i[o].length+n;return r+e.column}}).call(s.prototype),exports.Document=s}),define("skylark-ace/background_tokenizer",["require","exports","module","./lib/oop","./lib/event_emitter"],function(require,exports,module){var e=require("./lib/oop"),t=require("./lib/event_emitter").EventEmitter,i=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var i=this;this.$worker=function(){if(i.running){for(var e=new Date,t=i.currentLine,n=-1,r=i.doc,s=t;i.lines[t];)t++;var o=r.getLength(),a=0;for(i.running=!1;t<o;){i.$tokenizeRow(t),n=t;do{t++}while(i.lines[t]);if(++a%5==0&&new Date-e>20){i.running=setTimeout(i.$worker,20);break}}i.currentLine=t,-1==n&&(n=t),s<=n&&i.fireUpdateEvent(s,n)}}};(function(){e.implement(this,t),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var i={first:e,last:t};this._signal("update",{data:i})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.scheduleStart=function(){this.running||(this.running=setTimeout(this.$worker,700))},this.$updateOnChange=function(e){var t=e.start.row,i=e.end.row-t;if(0===i)this.lines[t]=null;else if("remove"==e.action)this.lines.splice(t,i+1,null),this.states.splice(t,i+1,null);else{var n=Array(i+1);n.unshift(t,1),this.lines.splice.apply(this.lines,n),this.states.splice.apply(this.states,n)}this.currentLine=Math.min(t,this.currentLine,this.doc.getLength()),this.stop()},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),i=this.states[e-1],n=this.tokenizer.getLineTokens(t,i,e);return this.states[e]+""!=n.state+""?(this.states[e]=n.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=n.tokens}}).call(i.prototype),exports.BackgroundTokenizer=i}),define("skylark-ace/search_highlight",["require","exports","module","./lib/lang","./lib/oop","./range"],function(require,exports,module){var e=require("./lib/lang"),t=(require("./lib/oop"),require("./range").Range),i=function(e,t,i){this.setRegexp(e),this.clazz=t,this.type=i||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(i,n,r,s){if(this.regExp)for(var o=s.firstRow,a=s.lastRow,l=o;l<=a;l++){var c=this.cache[l];null==c&&((c=e.getMatchOffsets(r.getLine(l),this.regExp)).length>this.MAX_RANGES&&(c=c.slice(0,this.MAX_RANGES)),c=c.map(function(e){return new t(l,e.offset,l,e.offset+e.length)}),this.cache[l]=c.length?c:"");for(var h=c.length;h--;)n.drawSingleLineMarker(i,c[h].toScreenRange(r),this.clazz,s)}}}).call(i.prototype),exports.SearchHighlight=i}),define("skylark-ace/edit_session/fold_line",["require","exports","module","../range"],function(require,exports,module){var e=require("../range").Range;function t(t,i){this.foldData=t,Array.isArray(i)?this.folds=i:i=this.folds=[i];var n=i[i.length-1];this.range=new e(i[0].start.row,i[0].start.column,n.end.row,n.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach(function(e){e.setFoldLine(this)},this)}(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach(function(t){t.start.row+=e,t.end.row+=e})},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw new Error("Can't add a fold to this FoldLine as it has no connection");this.folds.push(e),this.folds.sort(function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)}),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw new Error("Trying to add fold to FoldRow that doesn't have a matching row");this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,i){var n,r,s=0,o=this.folds,a=!0;null==t&&(t=this.end.row,i=this.end.column);for(var l=0;l<o.length;l++){if(n=o[l],-1==(r=n.range.compareStart(t,i)))return void e(null,t,i,s,a);if(!e(null,n.start.row,n.start.column,s,a)&&e(n.placeholder,n.start.row,n.start.column,s)||0===r)return;a=!n.sameRow,s=n.end.column}e(null,t,i,s,a)},this.getNextFoldTo=function(e,t){for(var i,n,r=0;r<this.folds.length;r++){if(i=this.folds[r],-1==(n=i.range.compareEnd(e,t)))return{fold:i,kind:"after"};if(0===n)return{fold:i,kind:"inside"}}return null},this.addRemoveChars=function(e,t,i){var n,r,s=this.getNextFoldTo(e,t);if(s)if(n=s.fold,"inside"==s.kind&&n.start.column!=t&&n.start.row!=e)window.console&&window.console.log(e,t,n);else if(n.start.row==e){var o=(r=this.folds).indexOf(n);for(0===o&&(this.start.column+=i);o<r.length;o++){if((n=r[o]).start.column+=i,!n.sameRow)return;n.end.column+=i}this.end.column+=i}},this.split=function(e,i){var n=this.getNextFoldTo(e,i);if(!n||"inside"==n.kind)return null;var r=n.fold,s=this.folds,o=this.foldData,a=s.indexOf(r),l=s[a-1];this.end.row=l.end.row,this.end.column=l.end.column,s=s.splice(a,s.length-a);var c=new t(o,s);return o.splice(o.indexOf(this)+1,0,c),c},this.merge=function(e){for(var t=e.folds,i=0;i<t.length;i++)this.addFold(t[i]);var n=this.foldData;n.splice(n.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach(function(t){e.push("  "+t.toString())}),e.push("]"),e.join("\n")},this.idxToPosition=function(e){for(var t=0,i=0;i<this.folds.length;i++){var n=this.folds[i];if((e-=n.start.column-t)<0)return{row:n.start.row,column:n.start.column+e};if((e-=n.placeholder.length)<0)return n.start;t=n.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(t.prototype),exports.FoldLine=t}),define("skylark-ace/range_list",["require","exports","module","./range"],function(require,exports,module){var e=require("./range").Range,t=e.comparePoints,i=function(){this.ranges=[]};(function(){this.comparePoints=t,this.pointIndex=function(e,i,n){for(var r=this.ranges,s=n||0;s<r.length;s++){var o=r[s],a=t(e,o.end);if(!(a>0)){var l=t(e,o.start);return 0===a?i&&0!==l?-s-2:s:l>0||0===l&&!i?s:-s-1}}return-s-1},this.add=function(e){var t=!e.isEmpty(),i=this.pointIndex(e.start,t);i<0&&(i=-i-1);var n=this.pointIndex(e.end,t,i);return n<0?n=-n-1:n++,this.ranges.splice(i,n-i,e)},this.addList=function(e){for(var t=[],i=e.length;i--;)t.push.apply(t,this.add(e[i]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges.splice(t,1)},this.merge=function(){for(var e,i=[],n=this.ranges,r=(n=n.sort(function(e,i){return t(e.start,i.start)}))[0],s=1;s<n.length;s++){e=r,r=n[s];var o=t(e.end,r.start);o<0||(0!=o||e.isEmpty()||r.isEmpty())&&(t(e.end,r.end)<0&&(e.end.row=r.end.row,e.end.column=r.end.column),n.splice(s,1),i.push(r),r=e,s--)}return this.ranges=n,i},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);if(t>=0)return this.ranges[t]},this.clipRows=function(e,t){var i=this.ranges;if(i[0].start.row>t||i[i.length-1].start.row<e)return[];var n=this.pointIndex({row:e,column:0});n<0&&(n=-n-1);var r=this.pointIndex({row:t,column:0},n);r<0&&(r=-r-1);for(var s=[],o=n;o<r;o++)s.push(i[o]);return s},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){for(var t=e.start,i=e.end,n=t.row,r=i.row,s=this.ranges,o=0,a=s.length;o<a;o++){var l=s[o];if(l.end.row>=n)break}if("insert"==e.action)for(var c=r-n,h=-t.column+i.column;o<a;o++){var l=s[o];if(l.start.row>n)break;if(l.start.row==n&&l.start.column>=t.column&&(l.start.column==t.column&&this.$insertRight||(l.start.column+=h,l.start.row+=c)),l.end.row==n&&l.end.column>=t.column){if(l.end.column==t.column&&this.$insertRight)continue;l.end.column==t.column&&h>0&&o<a-1&&l.end.column>l.start.column&&l.end.column==s[o+1].start.column&&(l.end.column-=h),l.end.column+=h,l.end.row+=c}}else for(var c=n-r,h=t.column-i.column;o<a;o++){var l=s[o];if(l.start.row>r)break;l.end.row<r&&(n<l.end.row||n==l.end.row&&t.column<l.end.column)?(l.end.row=n,l.end.column=t.column):l.end.row==r?l.end.column<=i.column?(c||l.end.column>t.column)&&(l.end.column=t.column,l.end.row=t.row):(l.end.column+=h,l.end.row+=c):l.end.row>r&&(l.end.row+=c),l.start.row<r&&(n<l.start.row||n==l.start.row&&t.column<l.start.column)?(l.start.row=n,l.start.column=t.column):l.start.row==r?l.start.column<=i.column?(c||l.start.column>t.column)&&(l.start.column=t.column,l.start.row=t.row):(l.start.column+=h,l.start.row+=c):l.start.row>r&&(l.start.row+=c)}if(0!=c&&o<a)for(;o<a;o++){var l=s[o];l.start.row+=c,l.end.row+=c}}}).call(i.prototype),exports.RangeList=i}),define("skylark-ace/edit_session/fold",["require","exports","module","../range","../range_list","../lib/oop"],function(require,exports,module){require("../range").Range;var e=require("../range_list").RangeList,t=require("../lib/oop"),i=exports.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};function n(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function r(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}t.inherits(i,e),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach(function(t){t.setFoldLine(e)})},this.clone=function(){var e=this.range.clone(),t=new i(e,this.placeholder);return this.subFolds.forEach(function(e){t.subFolds.push(e.clone())}),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){if(!this.range.containsRange(e))throw new Error("A fold can't intersect already existing fold"+e.range+this.range);var t,i;t=e,i=this.start,n(t.start,i),n(t.end,i);for(var r=e.start.row,s=e.start.column,o=0,a=-1;o<this.subFolds.length&&1==(a=this.subFolds[o].range.compare(r,s));o++);var l=this.subFolds[o];if(0==a)return l.addSubFold(e);for(var r=e.range.end.row,s=e.range.end.column,c=o,a=-1;c<this.subFolds.length&&1==(a=this.subFolds[c].range.compare(r,s));c++);this.subFolds[c];if(0==a)throw new Error("A fold can't intersect already existing fold"+e.range+this.range);this.subFolds.splice(o,c-o,e);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return function(e,t){r(e.start,t),r(e.end,t)}(e,this.start)}}.call(i.prototype)}),define("skylark-ace/edit_session/folding",["require","exports","module","../range","./fold_line","./fold","../token_iterator"],function(require,exports,module){var e=require("../range").Range,t=require("./fold_line").FoldLine,i=require("./fold").Fold,n=require("../token_iterator").TokenIterator;exports.Folding=function(){this.getFoldAt=function(e,t,i){var n=this.getFoldLine(e);if(!n)return null;for(var r=n.folds,s=0;s<r.length;s++){var o=r[s];if(o.range.contains(e,t)){if(1==i&&o.range.isEnd(e,t))continue;if(-1==i&&o.range.isStart(e,t))continue;return o}}},this.getFoldsInRange=function(e){var t=e.start,i=e.end,n=this.$foldData,r=[];t.column+=1,i.column-=1;for(var s=0;s<n.length;s++){var o=n[s].range.compareRange(e);if(2!=o){if(-2==o)break;for(var a=n[s].folds,l=0;l<a.length;l++){var c=a[l];if(-2==(o=c.range.compareRange(e)))break;if(2!=o){if(42==o)break;r.push(c)}}}}return t.column-=1,i.column+=1,r},this.getFoldsInRangeList=function(e){if(Array.isArray(e)){var t=[];e.forEach(function(e){t=t.concat(this.getFoldsInRange(e))},this)}else var t=this.getFoldsInRange(e);return t},this.getAllFolds=function(){for(var e=[],t=this.$foldData,i=0;i<t.length;i++)for(var n=0;n<t[i].folds.length;n++)e.push(t[i].folds[n]);return e},this.getFoldStringAt=function(e,t,i,n){if(!(n=n||this.getFoldLine(e)))return null;for(var r,s,o={end:{column:0}},a=0;a<n.folds.length;a++){var l=(s=n.folds[a]).range.compareEnd(e,t);if(-1==l){r=this.getLine(s.start.row).substring(o.end.column,s.start.column);break}if(0===l)return null;o=s}return r||(r=this.getLine(s.start.row).substring(o.end.column)),-1==i?r.substring(0,t-o.end.column):1==i?r.substring(t-o.end.column):r},this.getFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0);n<i.length;n++){var r=i[n];if(r.start.row<=e&&r.end.row>=e)return r;if(r.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0);n<i.length;n++){var r=i[n];if(r.end.row>=e)return r}return null},this.getFoldedRowCount=function(e,t){for(var i=this.$foldData,n=t-e+1,r=0;r<i.length;r++){var s=i[r],o=s.end.row,a=s.start.row;if(o>=t){a<t&&(a>=e?n-=t-a:n=0);break}o>=e&&(n-=a>=e?o-a:o-e+1)}return n},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort(function(e,t){return e.start.row-t.start.row}),e},this.addFold=function(e,n){var r,s=this.$foldData,o=!1;e instanceof i?r=e:(r=new i(n,e)).collapseChildren=n.collapseChildren,this.$clipRangeToDocument(r.range);var a=r.start.row,l=r.start.column,c=r.end.row,h=r.end.column;if(!(a<c||a==c&&l<=h-2))throw new Error("The range has to be at least 2 characters width");var u=this.getFoldAt(a,l,1),d=this.getFoldAt(c,h,-1);if(u&&d==u)return u.addSubFold(r);u&&!u.range.isStart(a,l)&&this.removeFold(u),d&&!d.range.isEnd(c,h)&&this.removeFold(d);var f=this.getFoldsInRange(r.range);f.length>0&&(this.removeFolds(f),f.forEach(function(e){r.addSubFold(e)}));for(var p=0;p<s.length;p++){var m=s[p];if(c==m.start.row){m.addFold(r),o=!0;break}if(a==m.end.row){if(m.addFold(r),o=!0,!r.sameRow){var g=s[p+1];if(g&&g.start.row==c){m.merge(g);break}}break}if(c<=m.start.row)break}return o||(m=this.$addFoldLine(new t(this.$foldData,r))),this.$useWrapMode?this.$updateWrapData(m.start.row,m.start.row):this.$updateRowLengthCache(m.start.row,m.start.row),this.$modified=!0,this._signal("changeFold",{data:r,action:"add"}),r},this.addFolds=function(e){e.forEach(function(e){this.addFold(e)},this)},this.removeFold=function(e){var t=e.foldLine,i=t.start.row,n=t.end.row,r=this.$foldData,s=t.folds;if(1==s.length)r.splice(r.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))s.pop(),t.end.row=s[s.length-1].end.row,t.end.column=s[s.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))s.shift(),t.start.row=s[0].start.row,t.start.column=s[0].start.column;else if(e.sameRow)s.splice(s.indexOf(e),1);else{var o=t.split(e.start.row,e.start.column);(s=o.folds).shift(),o.start.row=s[0].start.row,o.start.column=s[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(i,n):this.$updateRowLengthCache(i,n)),this.$modified=!0,this._signal("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);t.forEach(function(e){this.removeFold(e)},this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach(function(t){e.restoreRange(t),this.addFold(t)},this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach(function(e){this.expandFold(e)},this)},this.unfold=function(t,i){var n,r;if(null==t?(n=new e(0,0,this.getLength(),0),i=!0):n="number"==typeof t?new e(t,0,t,this.getLine(t).length):"row"in t?e.fromPoints(t,t):t,r=this.getFoldsInRangeList(n),i)this.removeFolds(r);else for(var s=r;s.length;)this.expandFolds(s),s=this.getFoldsInRangeList(n);if(r.length)return r},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var i=this.getFoldLine(e,t);return i?i.end.row:e},this.getRowFoldStart=function(e,t){var i=this.getFoldLine(e,t);return i?i.start.row:e},this.getFoldDisplayLine=function(e,t,i,n,r){null==n&&(n=e.start.row),null==r&&(r=0),null==t&&(t=e.end.row),null==i&&(i=this.getLine(t).length);var s=this.doc,o="";return e.walk(function(e,t,i,a){if(!(t<n)){if(t==n){if(i<r)return;a=Math.max(r,a)}o+=null!=e?e:s.getLine(t).substring(a,i)}},t,i),o},this.getDisplayLine=function(e,t,i,n){var r,s=this.getFoldLine(e);return s?this.getFoldDisplayLine(s,e,t,i,n):(r=this.doc.getLine(e)).substring(n||0,t||r.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map(function(i){var n=i.folds.map(function(e){return e.clone()});return new t(e,n)})},this.toggleFold=function(e){var t,i,n=this.selection,r=n.getRange();if(r.isEmpty()){var s=r.start;if(t=this.getFoldAt(s.row,s.column))return void this.expandFold(t);(i=this.findMatchingBracket(s))?1==r.comparePoint(i)?r.end=i:(r.start=i,r.start.column++,r.end.column--):(i=this.findMatchingBracket({row:s.row,column:s.column+1}))?(1==r.comparePoint(i)?r.end=i:r.start=i,r.start.column++):r=this.getCommentFoldRange(s.row,s.column)||r}else{var o=this.getFoldsInRange(r);if(e&&o.length)return void this.expandFolds(o);1==o.length&&(t=o[0])}if(t||(t=this.getFoldAt(r.start.row,r.start.column)),t&&t.range.toString()==r.toString())this.expandFold(t);else{var a="...";if(!r.isMultiLine()){if((a=this.getTextRange(r)).length<4)return;a=a.trim().substring(0,2)+".."}this.addFold(a,r)}},this.getCommentFoldRange=function(t,i,r){var s=new n(this,t,i),o=s.getCurrentToken(),a=o.type;if(o&&/^comment|string/.test(a)){"comment"==(a=a.match(/comment|string/)[0])&&(a+="|doc-start");var l=new RegExp(a),c=new e;if(1!=r){do{o=s.stepBackward()}while(o&&l.test(o.type));s.stepForward()}if(c.start.row=s.getCurrentTokenRow(),c.start.column=s.getCurrentTokenColumn()+2,s=new n(this,t,i),-1!=r){var h=-1;do{if(o=s.stepForward(),-1==h){var u=this.getState(s.$row);l.test(u)||(h=s.$row)}else if(s.$row>h)break}while(o&&l.test(o.type));o=s.stepBackward()}else o=s.getCurrentToken();return c.end.row=s.getCurrentTokenRow(),c.end.column=s.getCurrentTokenColumn()+o.value.length-2,c}},this.foldAll=function(e,t,i){void 0==i&&(i=1e5);var n=this.foldWidgets;if(n){t=t||this.getLength();for(var r=e=e||0;r<t;r++)if(null==n[r]&&(n[r]=this.getFoldWidget(r)),"start"==n[r]){var s=this.getFoldWidgetRange(r);if(s&&s.isMultiLine()&&s.end.row<=t&&s.start.row>=e){r=s.end.row;try{var o=this.addFold("...",s);o&&(o.collapseChildren=i)}catch(e){}}}}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){this.$foldMode!=e&&(this.$foldMode=e,this.off("change",this.$updateFoldWidgets),this.off("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets),this._signal("changeAnnotation"),e&&"manual"!=this.$foldStyle?(this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.$tokenizerUpdateFoldWidgets=this.tokenizerUpdateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets),this.on("tokenizerUpdate",this.$tokenizerUpdateFoldWidgets)):this.foldWidgets=null)},this.getParentFoldRangeData=function(e,t){var i=this.foldWidgets;if(!i||t&&i[e])return{};for(var n,r=e-1;r>=0;){var s=i[r];if(null==s&&(s=i[r]=this.getFoldWidget(r)),"start"==s){var o=this.getFoldWidgetRange(r);if(n||(n=o),o&&o.end.row>=e)break}r--}return{range:-1!==r&&o,firstRange:n}},this.onFoldWidgetClick=function(e,t){var i={children:(t=t.domEvent).shiftKey,all:t.ctrlKey||t.metaKey,siblings:t.altKey},n=this.$toggleFoldWidget(e,i);if(!n){var r=t.target||t.srcElement;r&&/ace_fold-widget/.test(r.className)&&(r.className+=" ace_invalid")}},this.$toggleFoldWidget=function(e,t){if(this.getFoldWidget){var i=this.getFoldWidget(e),n=this.getLine(e),r="end"===i?-1:1,s=this.getFoldAt(e,-1===r?0:n.length,r);if(s)return t.children||t.all?this.removeFold(s):this.expandFold(s),s;var o=this.getFoldWidgetRange(e,!0);if(o&&!o.isMultiLine()&&(s=this.getFoldAt(o.start.row,o.start.column,1))&&o.isEqual(s.range))return this.removeFold(s),s;if(t.siblings){var a=this.getParentFoldRangeData(e);if(a.range)var l=a.range.start.row+1,c=a.range.end.row;this.foldAll(l,c,t.all?1e4:0)}else t.children?(c=o?o.end.row:this.getLength(),this.foldAll(e+1,c,t.all?1e4:0)):o&&(t.all&&(o.collapseChildren=1e4),this.addFold("...",o));return o}},this.toggleFoldWidget=function(e){var t=this.selection.getCursor().row;t=this.getRowFoldStart(t);var i=this.$toggleFoldWidget(t,{});if(!i){var n=this.getParentFoldRangeData(t,!0);if(i=n.range||n.firstRange){t=i.start.row;var r=this.getFoldAt(t,this.getLine(t).length,1);r?this.removeFold(r):this.addFold("...",i)}}},this.updateFoldWidgets=function(e){var t=e.start.row,i=e.end.row-t;if(0===i)this.foldWidgets[t]=null;else if("remove"==e.action)this.foldWidgets.splice(t,i+1,null);else{var n=Array(i+1);n.unshift(t,1),this.foldWidgets.splice.apply(this.foldWidgets,n)}},this.tokenizerUpdateFoldWidgets=function(e){var t=e.data;t.first!=t.last&&this.foldWidgets.length>t.first&&this.foldWidgets.splice(t.first,this.foldWidgets.length)}}}),define("skylark-ace/edit_session/bracket_match",["require","exports","module","../token_iterator","../range"],function(require,exports,module){var e=require("../token_iterator").TokenIterator,t=require("../range").Range;exports.BracketMatch=function(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var i=t||this.getLine(e.row).charAt(e.column-1);if(""==i)return null;var n=i.match(/([\(\[\{])|([\)\]\}])/);return n?n[1]?this.$findClosingBracket(n[1],e):this.$findOpeningBracket(n[2],e):null},this.getBracketRange=function(e){var i,n=this.getLine(e.row),r=!0,s=n.charAt(e.column-1),o=s&&s.match(/([\(\[\{])|([\)\]\}])/);if(o||(s=n.charAt(e.column),e={row:e.row,column:e.column+1},o=s&&s.match(/([\(\[\{])|([\)\]\}])/),r=!1),!o)return null;if(o[1]){var a=this.$findClosingBracket(o[1],e);if(!a)return null;i=t.fromPoints(e,a),r||(i.end.column++,i.start.column--),i.cursor=i.end}else{var a=this.$findOpeningBracket(o[2],e);if(!a)return null;i=t.fromPoints(a,e),r||(i.start.column++,i.end.column--),i.cursor=i.start}return i},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{","<":">",">":"<"},this.$findOpeningBracket=function(t,i,n){var r=this.$brackets[t],s=1,o=new e(this,i.row,i.column),a=o.getCurrentToken();if(a||(a=o.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren").replace(/\b(?:end)\b/,"(?:start|begin|end)")+")+"));for(var l=i.column-o.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var h=c.charAt(l);if(h==r){if(0==(s-=1))return{row:o.getCurrentTokenRow(),column:l+o.getCurrentTokenColumn()}}else h==t&&(s+=1);l-=1}do{a=o.stepBackward()}while(a&&!n.test(a.type));if(null==a)break;c=a.value,l=c.length-1}return null}},this.$findClosingBracket=function(t,i,n){var r=this.$brackets[t],s=1,o=new e(this,i.row,i.column),a=o.getCurrentToken();if(a||(a=o.stepForward()),a){n||(n=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren").replace(/\b(?:start|begin)\b/,"(?:start|begin|end)")+")+"));for(var l=i.column-o.getCurrentTokenColumn();;){for(var c=a.value,h=c.length;l<h;){var u=c.charAt(l);if(u==r){if(0==(s-=1))return{row:o.getCurrentTokenRow(),column:l+o.getCurrentTokenColumn()}}else u==t&&(s+=1);l+=1}do{a=o.stepForward()}while(a&&!n.test(a.type));if(null==a)break;l=0}return null}}}}),define("skylark-ace/edit_session",["require","exports","module","./lib/oop","./lib/lang","./bidihandler","./config","./lib/event_emitter","./selection","./mode/text","./range","./document","./background_tokenizer","./search_highlight","./edit_session/folding","./edit_session/bracket_match"],function(require,exports,module){var e=require("./lib/oop"),t=require("./lib/lang"),i=require("./bidihandler").BidiHandler,n=require("./config"),r=require("./lib/event_emitter").EventEmitter,s=require("./selection").Selection,o=require("./mode/text").Mode,a=require("./range").Range,l=require("./document").Document,c=require("./background_tokenizer").BackgroundTokenizer,h=require("./search_highlight").SearchHighlight,u=function(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.id="session"+ ++u.$uid,this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new l(e)),this.setDocument(e),this.selection=new s(this),this.$bidiHandler=new i(this),n.resetOptions(this),this.setMode(t),n._signal("session",this)};u.$uid=0,function(){e.implement(this,r),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>i&&(this.$docRowCache.splice(i,t),this.$screenRowCache.splice(i,t))},this.$getRowCacheIndex=function(e,t){for(var i=0,n=e.length-1;i<=n;){var r=i+n>>1,s=e[r];if(t>s)i=r+1;else{if(!(t<s))return r;n=r-1}}return i-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){this.$modified=!0,this.$bidiHandler.onChange(e),this.$resetRowCache(e.start.row);var t=this.$updateInternalDataOnChange(e);!this.$fromUndo&&this.$undoManager&&(t&&t.length&&(this.$undoManager.add({action:"removeFolds",folds:t},this.mergeUndoDeltas),this.mergeUndoDeltas=!0),this.$undoManager.add(e,this.mergeUndoDeltas),this.mergeUndoDeltas=!0,this.$informUndoManager.schedule()),this.bgTokenizer&&this.bgTokenizer.$updateOnChange(e),this._signal("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveTo(0,0),this.$resetRowCache(0),this.setUndoManager(this.$undoManager),this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var i,n=this.bgTokenizer.getTokens(e),r=0;if(null==t){var s=n.length-1;r=this.getLine(e).length}else for(var s=0;s<n.length&&!((r+=n[s].value.length)>=t);s++);return(i=n[s])?(i.index=s,i.start=r-i.value.length,i):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$informUndoManager&&this.$informUndoManager.cancel(),e){var i=this;e.addSession(this),this.$syncInformUndoManager=function(){i.$informUndoManager.cancel(),i.mergeUndoDeltas=!1},this.$informUndoManager=t.delayedCall(this.$syncInformUndoManager)}else this.$syncInformUndoManager=function(){}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){},add:function(){},addSelection:function(){},startNewGroup:function(){},addSession:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?t.stringRepeat(" ",this.getTabSize()):"\t"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs&&!this.$mode.$indentWithTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},this.setNavigateWithinSoftTabs=function(e){this.setOption("navigateWithinSoftTabs",e)},this.getNavigateWithinSoftTabs=function(){return this.$navigateWithinSoftTabs},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._signal("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._signal("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._signal("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._signal("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._signal("changeBreakpoint",{})},this.addMarker=function(e,t,i,n){var r=this.$markerId++,s={range:e,type:i||"line",renderer:"function"==typeof i?i:null,clazz:t,inFront:!!n,id:r};return n?(this.$frontMarkers[r]=s,this._signal("changeFrontMarker")):(this.$backMarkers[r]=s,this._signal("changeBackMarker")),r},this.addDynamicMarker=function(e,t){if(e.update){var i=this.$markerId++;return e.id=i,e.inFront=!!t,t?(this.$frontMarkers[i]=e,this._signal("changeFrontMarker")):(this.$backMarkers[i]=e,this._signal("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];if(t){var i=t.inFront?this.$frontMarkers:this.$backMarkers;delete i[e],this._signal(t.inFront?"changeFrontMarker":"changeBackMarker")}},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new h(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,i,n){"number"!=typeof t&&(i=t,t=e),i||(i="ace_step");var r=new a(e,0,t,1/0);return r.id=this.addMarker(r,i,"fullLine",n),r},this.setAnnotations=function(e){this.$annotations=e,this._signal("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);this.$autoNewLine=t?t[1]:"\n"},this.getWordRange=function(e,t){var i=this.getLine(e),n=!1;if(t>0&&(n=!!i.charAt(t-1).match(this.tokenRe)),n||(n=!!i.charAt(t).match(this.tokenRe)),n)var r=this.tokenRe;else if(/^\s+$/.test(i.slice(t-1,t+1)))var r=/\s/;else var r=this.nonTokenRe;var s=t;if(s>0){do{s--}while(s>=0&&i.charAt(s).match(r));s++}for(var o=t;o<i.length&&i.charAt(o).match(r);)o++;return new a(e,s,e,o)},this.getAWordRange=function(e,t){for(var i=this.getWordRange(e,t),n=this.getLine(i.end.row);n.charAt(i.end.column).match(/[ \t]/);)i.end.column+=1;return i},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._signal("tokenizerUpdate",e)},this.$modes=n.$modes,this.$mode=null,this.$modeId=null,this.setMode=function(e,t){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var i=e,r=i.path}else r=e||"ace/mode/text";if(this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new o),this.$modes[r]&&!i)return this.$onChangeMode(this.$modes[r]),void(t&&t());this.$modeId=r,n.loadModule(["mode",r],function(e){if(this.$modeId!==r)return t&&t();this.$modes[r]&&!i?this.$onChangeMode(this.$modes[r]):e&&e.Mode&&(e=new e.Mode(i),i||(this.$modes[r]=e,e.$id=r),this.$onChangeMode(e)),t&&t()}.bind(this)),this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)},this.$onChangeMode=function(e,t){if(t||(this.$modeId=e.$id),this.$mode!==e){this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=e.getTokenizer();if(void 0!==i.addEventListener){var n=this.onReloadTokenizer.bind(this);i.addEventListener("update",n)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(i);else{this.bgTokenizer=new c(i);var r=this;this.bgTokenizer.addEventListener("update",function(e){r._signal("tokenizerUpdate",e)})}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(e.attachToSession&&e.attachToSession(this),this.$options.wrapMethod.set.call(this,this.$wrapMethod),this.$setFolding(e.foldingRules),this.bgTokenizer.start(0),this._emit("changeMode"))}},this.$stopWorker=function(){this.$worker&&(this.$worker.terminate(),this.$worker=null)},this.$startWorker=function(){try{this.$worker=this.$mode.createWorker(this)}catch(e){n.warn("Could not load worker",e),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.lineWidgets?Math.max(this.getLineWidgetMaxWidth(),this.screenWidth):this.screenWidth},this.getLineWidgetMaxWidth=function(){if(null!=this.lineWidgetsWidth)return this.lineWidgetsWidth;var e=0;return this.lineWidgets.forEach(function(t){t&&t.screenWidth>e&&(e=t.screenWidth)}),this.lineWidgetWidth=e},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),i=this.$rowLengthCache,n=0,r=0,s=this.$foldData[r],o=s?s.start.row:1/0,a=t.length,l=0;l<a;l++){if(l>o){if((l=s.end.row+1)>=a)break;s=this.$foldData[r++],o=s?s.start.row:1/0}null==i[l]&&(i[l]=this.$getStringScreenWidth(t[l])[0]),i[l]>n&&(n=i[l])}this.screenWidth=n}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.removeFullLines=function(e,t){return this.doc.removeFullLines(e,t)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=e.length-1;-1!=i;i--){var n=e[i];"insert"==n.action||"remove"==n.action?this.doc.revertDelta(n):n.folds&&this.addFolds(n.folds)}!t&&this.$undoSelect&&(e.selectionBefore?this.selection.fromJSON(e.selectionBefore):this.selection.setRange(this.$getUndoSelection(e,!0))),this.$fromUndo=!1}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=0;i<e.length;i++){var n=e[i];"insert"!=n.action&&"remove"!=n.action||this.doc.applyDelta(n)}!t&&this.$undoSelect&&(e.selectionAfter?this.selection.fromJSON(e.selectionAfter):this.selection.setRange(this.$getUndoSelection(e,!1))),this.$fromUndo=!1}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t){function i(e){return t?"insert"!==e.action:"insert"===e.action}for(var n,r,s=0;s<e.length;s++){var o=e[s];o.start&&(n?i(o)?(r=o.start,-1==n.compare(r.row,r.column)&&n.setStart(r),r=o.end,1==n.compare(r.row,r.column)&&n.setEnd(r),!0):(r=o.start,-1==n.compare(r.row,r.column)&&(n=a.fromPoints(o.start,o.start)),!1):i(o)?(n=a.fromPoints(o.start,o.end),!0):(n=a.fromPoints(o.start,o.start),!1))}return n},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,i){var n=this.getTextRange(e),r=this.getFoldsInRange(e),s=a.fromPoints(t,t);if(!i){this.remove(e);var o=e.start.row-e.end.row,l=o?-e.end.column:e.start.column-e.end.column;l&&(s.start.row==e.end.row&&s.start.column>e.end.column&&(s.start.column+=l),s.end.row==e.end.row&&s.end.column>e.end.column&&(s.end.column+=l)),o&&s.start.row>=e.end.row&&(s.start.row+=o,s.end.row+=o)}if(s.end=this.insert(s.start,n),r.length){var c=e.start,h=s.start,o=h.row-c.row,l=h.column-c.column;this.addFolds(r.map(function(e){return(e=e.clone()).start.row==c.row&&(e.start.column+=l),e.end.row==c.row&&(e.end.column+=l),e.start.row+=o,e.end.row+=o,e}))}return s},this.indentRows=function(e,t,i){i=i.replace(/\t/g,this.getTabString());for(var n=e;n<=t;n++)this.doc.insertInLine({row:n,column:0},i)},this.outdentRows=function(e){for(var t=e.collapseRows(),i=new a(0,0,0,0),n=this.getTabSize(),r=t.start.row;r<=t.end.row;++r){var s=this.getLine(r);i.start.row=r,i.end.row=r;for(var o=0;o<n&&" "==s.charAt(o);++o);o<n&&"\t"==s.charAt(o)?(i.start.column=o,i.end.column=o+1):(i.start.column=0,i.end.column=o),this.remove(i)}},this.$moveLines=function(e,t,i){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),i<0){var n=this.getRowFoldStart(e+i);if(n<0)return 0;var r=n-e}else if(i>0){var n=this.getRowFoldEnd(t+i);if(n>this.doc.getLength()-1)return 0;var r=n-t}else{e=this.$clipRowToDocument(e);var r=(t=this.$clipRowToDocument(t))-e+1}var s=new a(e,0,t,Number.MAX_VALUE),o=this.getFoldsInRange(s).map(function(e){return(e=e.clone()).start.row+=r,e.end.row+=r,e}),l=0==i?this.doc.getLines(e,t):this.doc.removeFullLines(e,t);return this.doc.insertFullLines(e+r,l),o.length&&this.addFolds(o),r},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return t<0?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),e<0)e=0,t=0;else{var i=this.doc.getLength();e>=i?(e=i-1,t=this.doc.getLine(i-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=Array(t),this.$updateWrapData(0,t-1)}this._signal("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){this.$wrapLimitRange.min===e&&this.$wrapLimitRange.max===t||(this.$wrapLimitRange={min:e,max:t},this.$modified=!0,this.$bidiHandler.markAsDirty(),this.$useWrapMode&&this._signal("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var i=this.$wrapLimitRange;i.max<0&&(i={min:t,max:t});var n=this.$constrainWrapLimit(e,i.min,i.max);return n!=this.$wrapLimit&&n>1&&(this.$wrapLimit=n,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._signal("changeWrapLimit")),!0)},this.$constrainWrapLimit=function(e,t,i){return t&&(e=Math.max(t,e)),i&&(e=Math.min(i,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t=this.$useWrapMode,i=e.action,n=e.start,r=e.end,s=n.row,o=r.row,a=o-s,l=null;if(this.$updating=!0,0!=a)if("remove"===i){this[t?"$wrapData":"$rowLengthCache"].splice(s,a);var c=this.$foldData;l=this.getFoldsInRange(e),this.removeFolds(l);var h=this.getFoldLine(r.row),u=0;if(h){h.addRemoveChars(r.row,r.column,n.column-r.column),h.shiftRow(-a);var d=this.getFoldLine(s);d&&d!==h&&(d.merge(h),h=d),u=c.indexOf(h)+1}for(;u<c.length;u++){var h=c[u];h.start.row>=r.row&&h.shiftRow(-a)}o=s}else{var f=Array(a);f.unshift(s,0);var p=t?this.$wrapData:this.$rowLengthCache;p.splice.apply(p,f);var c=this.$foldData,h=this.getFoldLine(s),u=0;if(h){var m=h.range.compareInside(n.row,n.column);0==m?(h=h.split(n.row,n.column))&&(h.shiftRow(a),h.addRemoveChars(o,0,r.column-n.column)):-1==m&&(h.addRemoveChars(s,0,r.column-n.column),h.shiftRow(a)),u=c.indexOf(h)+1}for(;u<c.length;u++){var h=c[u];h.start.row>=s&&h.shiftRow(a)}}else{a=Math.abs(e.start.column-e.end.column),"remove"===i&&(l=this.getFoldsInRange(e),this.removeFolds(l),a=-a);var h=this.getFoldLine(s);h&&h.addRemoveChars(s,n.column,a)}return t&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,t?this.$updateWrapData(s,o):this.$updateRowLengthCache(s,o),l},this.$updateRowLengthCache=function(e,t,i){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(e,t){var n,r,o=this.doc.getAllLines(),a=this.getTabSize(),l=this.$wrapData,c=this.$wrapLimit,h=e;for(t=Math.min(t,o.length-1);h<=t;)(r=this.getFoldLine(h,r))?(n=[],r.walk(function(e,t,r,a){var l;if(null!=e){(l=this.$getDisplayTokens(e,n.length))[0]=i;for(var c=1;c<l.length;c++)l[c]=s}else l=this.$getDisplayTokens(o[t].substring(a,r),n.length);n=n.concat(l)}.bind(this),r.end.row,o[r.end.row].length+1),l[r.start.row]=this.$computeWrapSplits(n,c,a),h=r.end.row+1):(n=this.$getDisplayTokens(o[h]),l[h]=this.$computeWrapSplits(n,c,a),h++)};var i=3,s=4,l=10,u=11,d=12;function f(e){return!(e<4352)&&(e>=4352&&e<=4447||e>=4515&&e<=4519||e>=4602&&e<=4607||e>=9001&&e<=9002||e>=11904&&e<=11929||e>=11931&&e<=12019||e>=12032&&e<=12245||e>=12272&&e<=12283||e>=12288&&e<=12350||e>=12353&&e<=12438||e>=12441&&e<=12543||e>=12549&&e<=12589||e>=12593&&e<=12686||e>=12688&&e<=12730||e>=12736&&e<=12771||e>=12784&&e<=12830||e>=12832&&e<=12871||e>=12880&&e<=13054||e>=13056&&e<=19903||e>=19968&&e<=42124||e>=42128&&e<=42182||e>=43360&&e<=43388||e>=44032&&e<=55203||e>=55216&&e<=55238||e>=55243&&e<=55291||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65106||e>=65108&&e<=65126||e>=65128&&e<=65131||e>=65281&&e<=65376||e>=65504&&e<=65510)}this.$computeWrapSplits=function(e,t,n){if(0==e.length)return[];var r=[],o=e.length,a=0,c=0,h=this.$wrapAsCode,f=this.$indentedSoftWrap,p=t<=Math.max(2*n,8)||!1===f?0:Math.floor(t/2);function m(t){for(var i=t-a,s=a;s<t;s++){var o=e[s];12!==o&&2!==o||(i-=1)}r.length||(g=function(){var t=0;if(0===p)return t;if(f)for(var i=0;i<e.length;i++){var r=e[i];if(r==l)t+=1;else{if(r!=u){if(r==d)continue;break}t+=n}}h&&!1!==f&&(t+=n);return Math.min(t,p)}(),r.indent=g),c+=i,r.push(c),a=t}for(var g=0;o-a>t-g;){var v=a+t-g;if(e[v-1]>=l&&e[v]>=l)m(v);else if(e[v]!=i&&e[v]!=s){for(var y=Math.max(v-(t-(t>>2)),a-1);v>y&&e[v]<i;)v--;if(h){for(;v>y&&e[v]<i;)v--;for(;v>y&&9==e[v];)v--}else for(;v>y&&e[v]<l;)v--;v>y?m(++v):(2==e[v=a+t]&&v--,m(v-g))}else{for(;v!=a-1&&e[v]!=i;v--);if(v>a){m(v);continue}for(v=a+t;v<e.length&&e[v]==s;v++);if(v==e.length)break;m(v)}}return r},this.$getDisplayTokens=function(e,t){var i,n=[];t=t||0;for(var r=0;r<e.length;r++){var s=e.charCodeAt(r);if(9==s){i=this.getScreenTabSize(n.length+t),n.push(u);for(var o=1;o<i;o++)n.push(d)}else 32==s?n.push(l):s>39&&s<48||s>57&&s<64?n.push(9):s>=4352&&f(s)?n.push(1,2):n.push(1)}return n},this.$getStringScreenWidth=function(e,t,i){if(0==t)return[0,0];var n,r;for(null==t&&(t=1/0),i=i||0,r=0;r<e.length&&(9==(n=e.charCodeAt(r))?i+=this.getScreenTabSize(i):n>=4352&&f(n)?i+=2:i+=1,!(i>t));r++);return[i,r]},this.lineWidgets=null,this.getRowLength=function(e){if(this.lineWidgets)var t=this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0;else t=0;return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.getRowLineCount=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getRowWrapIndent=function(e){if(this.$useWrapMode){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE),i=this.$wrapData[t.row];return i.length&&i[0]<t.column?i.indent:0}return 0},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var i=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(i)},this.getDocumentLastRowColumnPosition=function(e,t){var i=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(i,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-e%this.$tabSize},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t,i){if(e<0)return{row:0,column:0};var n,r,s=0,o=0,a=0,l=0,c=this.$screenRowCache,h=this.$getRowCacheIndex(c,e),u=c.length;if(u&&h>=0)var a=c[h],s=this.$docRowCache[h],d=e>c[u-1];else var d=!u;for(var f=this.getLength()-1,p=this.getNextFoldLine(s),m=p?p.start.row:1/0;a<=e&&(l=this.getRowLength(s),!(a+l>e||s>=f));)a+=l,++s>m&&(s=p.end.row+1,p=this.getNextFoldLine(s,p),m=p?p.start.row:1/0),d&&(this.$docRowCache.push(s),this.$screenRowCache.push(a));if(p&&p.start.row<=s)n=this.getFoldDisplayLine(p),s=p.start.row;else{if(a+l<=e||s>f)return{row:f,column:this.getLine(f).length};n=this.getLine(s),p=null}var g=0,v=Math.floor(e-a);if(this.$useWrapMode){var y=this.$wrapData[s];y&&(r=y[v],v>0&&y.length&&(g=y.indent,o=y[v-1]||y[y.length-1],n=n.substring(o)))}return void 0!==i&&this.$bidiHandler.isBidiRow(a+v,s,v)&&(t=this.$bidiHandler.offsetToCol(i)),o+=this.$getStringScreenWidth(n,t-g)[1],this.$useWrapMode&&o>=r&&(o=r-1),p?p.idxToPosition(o):{row:s,column:o}},this.documentToScreenPosition=function(e,t){if(void 0===t)var i=this.$clipPositionToDocument(e.row,e.column);else i=this.$clipPositionToDocument(e,t);e=i.row,t=i.column;var n=0,r=null,s=null;(s=this.getFoldAt(e,t,1))&&(e=s.start.row,t=s.start.column);var o,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),h=l.length;if(h&&c>=0)var a=l[c],n=this.$screenRowCache[c],u=e>l[h-1];else var u=!h;for(var d=this.getNextFoldLine(a),f=d?d.start.row:1/0;a<e;){if(a>=f){if((o=d.end.row+1)>e)break;d=this.getNextFoldLine(o,d),f=d?d.start.row:1/0}else o=a+1;n+=this.getRowLength(a),a=o,u&&(this.$docRowCache.push(a),this.$screenRowCache.push(n))}var p="";d&&a>=f?(p=this.getFoldDisplayLine(d,e,t),r=d.start.row):(p=this.getLine(e).substring(0,t),r=e);var m=0;if(this.$useWrapMode){var g=this.$wrapData[r];if(g){for(var v=0;p.length>=g[v];)n++,v++;p=p.substring(g[v-1]||0,p.length),m=v>0?g.indent:0}}return{row:n,column:m+this.$getStringScreenWidth(p)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var i=this.$wrapData.length,n=0,r=0,t=this.$foldData[r++],s=t?t.start.row:1/0;n<i;){var o=this.$wrapData[n];e+=o?o.length+1:1,++n>s&&(n=t.end.row+1,t=this.$foldData[r++],s=t?t.start.row:1/0)}else{e=this.getLength();for(var a=this.$foldData,r=0;r<a.length;r++)t=a[r],e-=t.end.row-t.start.row}return this.lineWidgets&&(e+=this.$getWidgetScreenLength()),e},this.$setFontMetrics=function(e){this.$enableVarChar&&(this.$getStringScreenWidth=function(t,i,n){if(0===i)return[0,0];var r,s;for(i||(i=1/0),n=n||0,s=0;s<t.length&&(r=t.charAt(s),!((n+="\t"===r?this.getScreenTabSize(n):e.getCharacterWidth(r))>i));s++);return[n,s]})},this.destroy=function(){this.bgTokenizer&&(this.bgTokenizer.setDocument(null),this.bgTokenizer=null),this.$stopWorker()},this.isFullWidth=f}.call(u.prototype),require("./edit_session/folding").Folding.call(u.prototype),require("./edit_session/bracket_match").BracketMatch.call(u.prototype),n.defineOptions(u.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e)if(this.$wrap=e,e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1)},get:function(){return this.getUseWrapMode()?-1==this.$wrap?"printMargin":this.getWrapLimitRange().min?this.$wrap:"free":"off"},handlesSet:!0},wrapMethod:{set:function(e){(e="auto"==e?"text"!=this.$mode.type:"text"!=e)!=this.$wrapAsCode&&(this.$wrapAsCode=e,this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0)))},initialValue:"auto"},indentedSoftWrap:{set:function(){this.$useWrapMode&&(this.$useWrapMode=!1,this.setUseWrapMode(!0))},initialValue:!0},firstLineNumber:{set:function(){this._signal("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){e=parseInt(e),isNaN(e)||this.$tabSize===e||(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._signal("changeTabSize"))},initialValue:4,handlesSet:!0},navigateWithinSoftTabs:{initialValue:!1},foldStyle:{set:function(e){this.setFoldStyle(e)},handlesSet:!0},overwrite:{set:function(e){this._signal("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0},mode:{set:function(e){this.setMode(e)},get:function(){return this.$modeId},handlesSet:!0}}),exports.EditSession=u}),define("skylark-ace/search",["require","exports","module","./lib/lang","./lib/oop","./range"],function(require,exports,module){var e=require("./lib/lang"),t=require("./lib/oop"),i=require("./range").Range,n=function(){this.$options={}};(function(){this.set=function(e){return t.mixin(this.$options,e),this},this.getOptions=function(){return e.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$options,n=this.$matchIterator(e,t);if(!n)return!1;var r=null;return n.forEach(function(e,n,s,o){return r=new i(e,n,s,o),!(n==o&&t.start&&t.start.start&&0!=t.skipCurrent&&r.isEqual(t.start))||(r=null,!1)}),r},this.findAll=function(t){var n=this.$options;if(!n.needle)return[];this.$assembleRegExp(n);var r=n.range,s=r?t.getLines(r.start.row,r.end.row):t.doc.getAllLines(),o=[],a=n.re;if(n.$isMultiLine){var l,c=a.length,h=s.length-c;e:for(var u=a.offset||0;u<=h;u++){for(var d=0;d<c;d++)if(-1==s[u+d].search(a[d]))continue e;var f=s[u],p=s[u+c-1],m=f.length-f.match(a[0])[0].length,g=p.match(a[c-1])[0].length;l&&l.end.row===u&&l.end.column>m||(o.push(l=new i(u,m,u+c-1,g)),c>2&&(u=u+c-2))}}else for(var v=0;v<s.length;v++)for(var y=e.getMatchOffsets(s[v],a),d=0;d<y.length;d++){var k=y[d];o.push(new i(v,k.offset,v,k.offset+k.length))}if(r){for(var b=r.start.column,x=r.start.column,v=0,d=o.length-1;v<d&&o[v].start.column<b&&o[v].start.row==r.start.row;)v++;for(;v<d&&o[d].end.column>x&&o[d].end.row==r.end.row;)d--;for(o=o.slice(v,d+1),v=0,d=o.length;v<d;v++)o[v].start.row+=r.start.row,o[v].end.row+=r.start.row}return o},this.replace=function(e,t){var i=this.$options,n=this.$assembleRegExp(i);if(i.$isMultiLine)return t;if(n){var r=n.exec(e);if(!r||r[0].length!=e.length)return null;if(t=e.replace(n,t),i.preserveCase){t=t.split("");for(var s=Math.min(e.length,e.length);s--;){var o=e[s];o&&o.toLowerCase()!=o?t[s]=t[s].toUpperCase():t[s]=t[s].toLowerCase()}t=t.join("")}return t}},this.$assembleRegExp=function(t,i){if(t.needle instanceof RegExp)return t.re=t.needle;var n=t.needle;if(!t.needle)return t.re=!1;t.regExp||(n=e.escapeRegExp(n)),t.wholeWord&&(n=function(e,t){function i(e){return/\w/.test(e)||t.regExp?"\\b":""}return i(e[0])+e+i(e[e.length-1])}(n,t));var r=t.caseSensitive?"gm":"gmi";if(t.$isMultiLine=!i&&/[\n\r]/.test(n),t.$isMultiLine)return t.re=this.$assembleMultilineRegExp(n,r);try{var s=new RegExp(n,r)}catch(e){s=!1}return t.re=s},this.$assembleMultilineRegExp=function(e,t){for(var i=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),n=[],r=0;r<i.length;r++)try{n.push(new RegExp(i[r],t))}catch(e){return!1}return n},this.$matchIterator=function(e,t){var i=this.$assembleRegExp(t);if(!i)return!1;var n=1==t.backwards,r=0!=t.skipCurrent,s=t.range,o=t.start;o||(o=s?s[n?"end":"start"]:e.selection.getRange()),o.start&&(o=o[r!=n?"end":"start"]);var a=s?s.start.row:0,l=s?s.end.row:e.getLength()-1;if(n)var c=function(e){var i=o.row;if(!u(i,o.column,e)){for(i--;i>=a;i--)if(u(i,Number.MAX_VALUE,e))return;if(0!=t.wrap)for(i=l,a=o.row;i>=a;i--)if(u(i,Number.MAX_VALUE,e))return}};else var c=function(e){var i=o.row;if(!u(i,o.column,e)){for(i+=1;i<=l;i++)if(u(i,0,e))return;if(0!=t.wrap)for(i=a,l=o.row;i<=l;i++)if(u(i,0,e))return}};if(t.$isMultiLine)var h=i.length,u=function(t,r,s){var o=n?t-h+1:t;if(!(o<0)){var a=e.getLine(o),l=a.search(i[0]);if(!(!n&&l<r||-1===l)){for(var c=1;c<h;c++)if(-1==(a=e.getLine(o+c)).search(i[c]))return;var u=a.match(i[h-1])[0].length;if(!(n&&u>r))return!!s(o,l,o+h-1,u)||void 0}}};else if(n)var u=function(t,n,r){var s,o=e.getLine(t),a=[],l=0;for(i.lastIndex=0;s=i.exec(o);){var c=s[0].length;if(l=s.index,!c){if(l>=o.length)break;i.lastIndex=l+=1}if(s.index+c>n)break;a.push(s.index,c)}for(var h=a.length-1;h>=0;h-=2){var u=a[h-1],c=a[h];if(r(t,u,t,u+c))return!0}};else var u=function(t,n,r){var s,o,a=e.getLine(t);for(i.lastIndex=n;o=i.exec(a);){var l=o[0].length;if(s=o.index,r(t,s,t,s+l))return!0;if(!l&&(i.lastIndex=s+=1,s>=a.length))return!1}};return{forEach:c}}}).call(n.prototype),exports.Search=n}),define("skylark-ace/keyboard/hash_handler",["require","exports","module","../lib/keys","../lib/useragent"],function(require,exports,module){var e=require("../lib/keys"),t=require("../lib/useragent"),i=e.KEY_MODS;function n(e,i){this.platform=i||(t.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(e),this.$singleCommand=!0}function r(e,t){n.call(this,e,t),this.$singleCommand=!1}r.prototype=n.prototype,function(){function t(e){return"object"==typeof e&&e.bindKey&&e.bindKey.position||(e.isDefault?-100:0)}this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e,t){var i=e&&("string"==typeof e?e:e.name);e=this.commands[i],t||delete this.commands[i];var n=this.commandKeyBinding;for(var r in n){var s=n[r];if(s==e)delete n[r];else if(Array.isArray(s)){var o=s.indexOf(e);-1!=o&&(s.splice(o,1),1==s.length&&(n[r]=s[0]))}}},this.bindKey=function(e,t,n){if("object"==typeof e&&e&&(void 0==n&&(n=e.position),e=e[this.platform]),e)return"function"==typeof t?this.addCommand({exec:t,bindKey:e,name:t.name||e}):void e.split("|").forEach(function(e){var r="";if(-1!=e.indexOf(" ")){var s=e.split(/\s+/);e=s.pop(),s.forEach(function(e){var t=this.parseKeys(e),n=i[t.hashId]+t.key;r+=(r?" ":"")+n,this._addCommandToBinding(r,"chainKeys")},this),r+=" "}var o=this.parseKeys(e),a=i[o.hashId]+o.key;this._addCommandToBinding(r+a,t,n)},this)},this._addCommandToBinding=function(e,i,n){var r,s=this.commandKeyBinding;if(i)if(!s[e]||this.$singleCommand)s[e]=i;else{Array.isArray(s[e])?-1!=(r=s[e].indexOf(i))&&s[e].splice(r,1):s[e]=[s[e]],"number"!=typeof n&&(n=t(i));var o=s[e];for(r=0;r<o.length;r++){var a=o[r],l=t(a);if(l>n)break}o.splice(r,0,i)}else delete s[e]},this.addCommands=function(e){e&&Object.keys(e).forEach(function(t){var i=e[t];if(i){if("string"==typeof i)return this.bindKey(i,t);"function"==typeof i&&(i={exec:i}),"object"==typeof i&&(i.name||(i.name=t),this.addCommand(i))}},this)},this.removeCommands=function(e){Object.keys(e).forEach(function(t){this.removeCommand(e[t])},this)},this.bindKeys=function(e){Object.keys(e).forEach(function(t){this.bindKey(t,e[t])},this)},this._buildKeyHash=function(e){this.bindKey(e.bindKey,e)},this.parseKeys=function(t){var i=t.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(e){return e}),n=i.pop(),r=e[n];if(e.FUNCTION_KEYS[r])n=e.FUNCTION_KEYS[r].toLowerCase();else{if(!i.length)return{key:n,hashId:-1};if(1==i.length&&"shift"==i[0])return{key:n.toUpperCase(),hashId:-1}}for(var s=0,o=i.length;o--;){var a=e.KEY_MODS[i[o]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+i[o]+" in "+t),!1;s|=a}return{key:n,hashId:s}},this.findKeyCommand=function(e,t){var n=i[e]+t;return this.commandKeyBinding[n]},this.handleKeyboard=function(e,t,n,r){if(!(r<0)){var s=i[t]+n,o=this.commandKeyBinding[s];return e.$keyChain&&(e.$keyChain+=" "+s,o=this.commandKeyBinding[e.$keyChain]||o),!o||"chainKeys"!=o&&"chainKeys"!=o[o.length-1]?(e.$keyChain&&(t&&4!=t||1!=n.length?(-1==t||r>0)&&(e.$keyChain=""):e.$keyChain=e.$keyChain.slice(0,-s.length-1)),{command:o}):(e.$keyChain=e.$keyChain||s,{command:"null"})}},this.getStatusText=function(e,t){return t.$keyChain||""}}.call(n.prototype),exports.HashHandler=n,exports.MultiHashHandler=r}),define("skylark-ace/commands/command_manager",["require","exports","module","../lib/oop","../keyboard/hash_handler","../lib/event_emitter"],function(require,exports,module){var e=require("../lib/oop"),t=require("../keyboard/hash_handler").MultiHashHandler,i=require("../lib/event_emitter").EventEmitter,n=function(e,i){t.call(this,i,e),this.byName=this.commands,this.setDefaultHandler("exec",function(e){return e.command.exec(e.editor,e.args||{})})};e.inherits(n,t),function(){e.implement(this,i),this.exec=function(e,t,i){if(Array.isArray(e)){for(var n=e.length;n--;)if(this.exec(e[n],t,i))return!0;return!1}if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;if(0!=this.$checkCommandState&&e.isAvailable&&!e.isAvailable(t))return!1;var r={editor:t,command:e,args:i};return r.returnValue=this._emit("exec",r),this._signal("afterExec",r),!1!==r.returnValue},this.toggleRecording=function(e){if(!this.$inReplay)return e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0)},this.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach(function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])},this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map(function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e})}}.call(n.prototype),exports.CommandManager=n}),define("skylark-ace/commands/default_commands",["require","exports","module","../lib/lang","../config","../range"],function(require,exports,module){var e=require("../lib/lang"),t=require("../config"),i=require("../range").Range;function n(e,t){return{win:e,mac:t}}exports.commands=[{name:"showSettingsMenu",bindKey:n("Ctrl-,","Command-,"),exec:function(e){t.loadModule("ace/ext/settings_menu",function(module){module.init(e),e.showSettingsMenu()})},readOnly:!0},{name:"goToNextError",bindKey:n("Alt-E","F4"),exec:function(e){t.loadModule("./ext/error_marker",function(module){module.showErrorMarker(e,1)})},scrollIntoView:"animate",readOnly:!0},{name:"goToPreviousError",bindKey:n("Alt-Shift-E","Shift-F4"),exec:function(e){t.loadModule("./ext/error_marker",function(module){module.showErrorMarker(e,-1)})},scrollIntoView:"animate",readOnly:!0},{name:"selectall",bindKey:n("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",bindKey:n(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:n("Ctrl-L","Command-L"),exec:function(e,t){"number"!=typeof t&&(t=parseInt(prompt("Enter line number:"),10)),isNaN(t)||e.gotoLine(t)},readOnly:!0},{name:"fold",bindKey:n("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"unfold",bindKey:n("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleFoldWidget",bindKey:n("F2","F2"),exec:function(e){e.session.toggleFoldWidget()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"toggleParentFoldWidget",bindKey:n("Alt-F2","Alt-F2"),exec:function(e){e.session.toggleFoldWidget(!0)},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"foldall",bindKey:n(null,"Ctrl-Command-Option-0"),exec:function(e){e.session.foldAll()},scrollIntoView:"center",readOnly:!0},{name:"foldOther",bindKey:n("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll(),e.session.unfold(e.selection.getAllRanges())},scrollIntoView:"center",readOnly:!0},{name:"unfoldall",bindKey:n("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},scrollIntoView:"center",readOnly:!0},{name:"findnext",bindKey:n("Ctrl-K","Command-G"),exec:function(e){e.findNext()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"findprevious",bindKey:n("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},multiSelectAction:"forEach",scrollIntoView:"center",readOnly:!0},{name:"selectOrFindNext",bindKey:n("Alt-K","Ctrl-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findNext()},readOnly:!0},{name:"selectOrFindPrevious",bindKey:n("Alt-Shift-K","Ctrl-Shift-G"),exec:function(e){e.selection.isEmpty()?e.selection.selectWord():e.findPrevious()},readOnly:!0},{name:"find",bindKey:n("Ctrl-F","Command-F"),exec:function(e){t.loadModule("ace/ext/searchbox",function(t){t.Search(e)})},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:n("Ctrl-Shift-Home","Command-Shift-Home|Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotostart",bindKey:n("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectup",bindKey:n("Shift-Up","Shift-Up|Ctrl-Shift-P"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golineup",bindKey:n("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttoend",bindKey:n("Ctrl-Shift-End","Command-Shift-End|Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"gotoend",bindKey:n("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0,scrollIntoView:"animate",aceCommandGroup:"fileJump"},{name:"selectdown",bindKey:n("Shift-Down","Shift-Down|Ctrl-Shift-N"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"golinedown",bindKey:n("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordleft",bindKey:n("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordleft",bindKey:n("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolinestart",bindKey:n("Alt-Shift-Left","Command-Shift-Left|Ctrl-Shift-A"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolinestart",bindKey:n("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectleft",bindKey:n("Shift-Left","Shift-Left|Ctrl-Shift-B"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoleft",bindKey:n("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectwordright",bindKey:n("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotowordright",bindKey:n("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selecttolineend",bindKey:n("Alt-Shift-Right","Command-Shift-Right|Shift-End|Ctrl-Shift-E"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotolineend",bindKey:n("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectright",bindKey:n("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"gotoright",bindKey:n("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:n(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:n("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:n(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:n("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:n("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"togglerecording",bindKey:n("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",bindKey:n("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",bindKey:n("Ctrl-P","Ctrl-P"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"selecttomatching",bindKey:n("Ctrl-Shift-P","Ctrl-Shift-P"),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"expandToMatching",bindKey:n("Ctrl-Shift-M","Ctrl-Shift-M"),exec:function(e){e.jumpToMatching(!0,!0)},multiSelectAction:"forEach",scrollIntoView:"animate",readOnly:!0},{name:"passKeysToBrowser",bindKey:n(null,null),exec:function(){},passEvent:!0,readOnly:!0},{name:"copy",exec:function(e){},readOnly:!0},{name:"cut",exec:function(e){var t=e.$copyWithEmptySelection&&e.selection.isEmpty(),i=t?e.selection.getLineRange():e.selection.getRange();e._emit("cut",i),i.isEmpty()||e.session.remove(i),e.clearSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"paste",exec:function(e,t){e.$handlePaste(t)},scrollIntoView:"cursor"},{name:"removeline",bindKey:n("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},scrollIntoView:"cursor",multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:n("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"sortlines",bindKey:n("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},scrollIntoView:"selection",multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:n("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"toggleBlockComment",bindKey:n("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"modifyNumberUp",bindKey:n("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:n("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},scrollIntoView:"cursor",multiSelectAction:"forEach"},{name:"replace",bindKey:n("Ctrl-H","Command-Option-F"),exec:function(e){t.loadModule("ace/ext/searchbox",function(t){t.Search(e,!0)})}},{name:"undo",bindKey:n("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",bindKey:n("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",bindKey:n("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()},scrollIntoView:"cursor"},{name:"movelinesup",bindKey:n("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()},scrollIntoView:"cursor"},{name:"copylinesdown",bindKey:n("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()},scrollIntoView:"cursor"},{name:"movelinesdown",bindKey:n("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()},scrollIntoView:"cursor"},{name:"del",bindKey:n("Delete","Delete|Ctrl-D|Shift-Delete"),exec:function(e){e.remove("right")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"backspace",bindKey:n("Shift-Backspace|Backspace","Ctrl-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"cut_or_delete",bindKey:n("Shift-Delete",null),exec:function(e){if(!e.selection.isEmpty())return!1;e.remove("left")},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestart",bindKey:n("Alt-Backspace","Command-Backspace"),exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineend",bindKey:n("Alt-Delete","Ctrl-K|Command-Delete"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolinestarthard",bindKey:n("Ctrl-Shift-Backspace",null),exec:function(e){var t=e.selection.getRange();t.start.column=0,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removetolineendhard",bindKey:n("Ctrl-Shift-Delete",null),exec:function(e){var t=e.selection.getRange();t.end.column=Number.MAX_VALUE,e.session.remove(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordleft",bindKey:n("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"removewordright",bindKey:n("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"outdent",bindKey:n("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"indent",bindKey:n("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach",scrollIntoView:"selectionPart"},{name:"blockoutdent",bindKey:n("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"blockindent",bindKey:n("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine",scrollIntoView:"selectionPart"},{name:"insertstring",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"inserttext",exec:function(t,i){t.insert(e.stringRepeat(i.text||"",i.times||1))},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"splitline",bindKey:n(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"transposeletters",bindKey:n("Alt-Shift-X","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)},scrollIntoView:"cursor"},{name:"touppercase",bindKey:n("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"tolowercase",bindKey:n("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach",scrollIntoView:"cursor"},{name:"expandtoline",bindKey:n("Ctrl-Shift-L","Command-Shift-L"),exec:function(e){var t=e.selection.getRange();t.start.column=t.end.column=0,t.end.row++,e.selection.setRange(t,!1)},multiSelectAction:"forEach",scrollIntoView:"cursor",readOnly:!0},{name:"joinlines",bindKey:n(null,null),exec:function(t){for(var n=t.selection.isBackwards(),r=n?t.selection.getSelectionLead():t.selection.getSelectionAnchor(),s=n?t.selection.getSelectionAnchor():t.selection.getSelectionLead(),o=t.session.doc.getLine(r.row).length,a=t.session.doc.getTextRange(t.selection.getRange()),l=a.replace(/\n\s*/," ").length,c=t.session.doc.getLine(r.row),h=r.row+1;h<=s.row+1;h++){var u=e.stringTrimLeft(e.stringTrimRight(t.session.doc.getLine(h)));0!==u.length&&(u=" "+u),c+=u}s.row+1<t.session.doc.getLength()-1&&(c+=t.session.doc.getNewLineCharacter()),t.clearSelection(),t.session.doc.replace(new i(r.row,0,s.row+2,0),c),l>0?(t.selection.moveCursorTo(r.row,r.column),t.selection.selectTo(r.row,r.column+l)):(o=t.session.doc.getLine(r.row).length>o?o+1:o,t.selection.moveCursorTo(r.row,o))},multiSelectAction:"forEach",readOnly:!0},{name:"invertSelection",bindKey:n(null,null),exec:function(e){var t=e.session.doc.getLength()-1,n=e.session.doc.getLine(t).length,r=e.selection.rangeList.ranges,s=[];r.length<1&&(r=[e.selection.getRange()]);for(var o=0;o<r.length;o++)o==r.length-1&&(r[o].end.row===t&&r[o].end.column===n||s.push(new i(r[o].end.row,r[o].end.column,t,n))),0===o?0===r[o].start.row&&0===r[o].start.column||s.push(new i(0,0,r[o].start.row,r[o].start.column)):s.push(new i(r[o-1].end.row,r[o-1].end.column,r[o].start.row,r[o].start.column));e.exitMultiSelectMode(),e.clearSelection();for(var o=0;o<s.length;o++)e.selection.addRange(s[o],!1)},readOnly:!0,scrollIntoView:"none"}]}),define("skylark-ace/clipboard",["require","exports","module"],function(require,exports,module){module.exports={lineMode:!1}}),define("skylark-ace/editor",["require","exports","module","./lib/fixoldbrowsers","./lib/oop","./lib/dom","./lib/lang","./lib/useragent","./keyboard/textinput","./mouse/mouse_handler","./mouse/fold_handler","./keyboard/keybinding","./edit_session","./search","./range","./lib/event_emitter","./commands/command_manager","./commands/default_commands","./config","./token_iterator","./clipboard"],function(require,exports,module){require("./lib/fixoldbrowsers");var e=require("./lib/oop"),t=require("./lib/dom"),i=require("./lib/lang"),n=require("./lib/useragent"),r=require("./keyboard/textinput").TextInput,s=require("./mouse/mouse_handler").MouseHandler,o=require("./mouse/fold_handler").FoldHandler,a=require("./keyboard/keybinding").KeyBinding,l=require("./edit_session").EditSession,c=require("./search").Search,h=require("./range").Range,u=require("./lib/event_emitter").EventEmitter,d=require("./commands/command_manager").CommandManager,f=require("./commands/default_commands").commands,p=require("./config"),m=require("./token_iterator").TokenIterator,g=require("./clipboard"),v=function(e,t,h){var u=e.getContainerElement();this.container=u,this.renderer=e,this.id="editor"+ ++v.$uid,this.commands=new d(n.isMac?"mac":"win",f),"object"==typeof document&&(this.textInput=new r(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.$mouseHandler=new s(this),new o(this)),this.keyBinding=new a(this),this.$search=(new c).set({wrap:!0}),this.$historyTracker=this.$historyTracker.bind(this),this.commands.on("exec",this.$historyTracker),this.$initOperationListeners(),this._$emitInputEvent=i.delayedCall(function(){this._signal("input",{}),this.session&&this.session.bgTokenizer&&this.session.bgTokenizer.scheduleStart()}.bind(this)),this.on("change",function(e,t){t._$emitInputEvent.schedule(31)}),this.setSession(t||h&&h.session||new l("")),p.resetOptions(this),h&&this.setOptions(h),p._signal("editor",this)};v.$uid=0,function(){e.implement(this,u),this.$initOperationListeners=function(){this.commands.on("exec",this.startOperation.bind(this),!0),this.commands.on("afterExec",this.endOperation.bind(this),!0),this.$opResetTimer=i.delayedCall(this.endOperation.bind(this,!0)),this.on("change",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.docChanged=!0}.bind(this),!0),this.on("changeSelection",function(){this.curOp||(this.startOperation(),this.curOp.selectionBefore=this.$lastSel),this.curOp.selectionChanged=!0}.bind(this),!0)},this.curOp=null,this.prevOp={},this.startOperation=function(e){if(this.curOp){if(!e||this.curOp.command)return;this.prevOp=this.curOp}e||(this.previousCommand=null,e={}),this.$opResetTimer.schedule(),this.curOp=this.session.curOp={command:e.command||{},args:e.args,scrollTop:this.renderer.scrollTop},this.curOp.selectionBefore=this.selection.toJSON()},this.endOperation=function(e){if(this.curOp){if(e&&!1===e.returnValue)return this.curOp=null;if(1==e&&this.curOp.command&&"mouse"==this.curOp.command.name)return;if(this._signal("beforeEndOperation"),!this.curOp)return;var t=this.curOp.command,i=t&&t.scrollIntoView;if(i){switch(i){case"center-animate":i="animate";case"center":this.renderer.scrollCursorIntoView(null,.5);break;case"animate":case"cursor":this.renderer.scrollCursorIntoView();break;case"selectionPart":var n=this.selection.getRange(),r=this.renderer.layerConfig;(n.start.row>=r.lastRow||n.end.row<=r.firstRow)&&this.renderer.scrollSelectionIntoView(this.selection.anchor,this.selection.lead)}"animate"==i&&this.renderer.animateScrolling(this.curOp.scrollTop)}var s=this.selection.toJSON();this.curOp.selectionAfter=s,this.$lastSel=this.selection.toJSON(),this.session.getUndoManager().addSelection(s),this.prevOp=this.curOp,this.curOp=null}},this.$mergeableCommands=["backspace","del","insertstring"],this.$historyTracker=function(e){if(this.$mergeUndoDeltas){var t=this.prevOp,i=this.$mergeableCommands,n=t.command&&e.command.name==t.command.name;if("insertstring"==e.command.name){var r=e.args;void 0===this.mergeNextCommand&&(this.mergeNextCommand=!0),n=n&&this.mergeNextCommand&&(!/\s/.test(r)||/\s/.test(t.args)),this.mergeNextCommand=!0}else n=n&&-1!==i.indexOf(e.command.name);"always"!=this.$mergeUndoDeltas&&Date.now()-this.sequenceStartTime>2e3&&(n=!1),n?this.session.mergeUndoDeltas=!0:-1!==i.indexOf(e.command.name)&&(this.sequenceStartTime=Date.now())}},this.setKeyboardHandler=function(e,t){if(e&&"string"==typeof e&&"ace"!=e){this.$keybindingId=e;var i=this;p.loadModule(["keybinding",e],function(module){i.$keybindingId==e&&i.keyBinding.setKeyboardHandler(module&&module.handler),t&&t()})}else this.$keybindingId=null,this.keyBinding.setKeyboardHandler(e),t&&t()},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){this.curOp&&this.endOperation(),this.curOp={};var t=this.session;if(t){this.session.off("change",this.$onDocumentChange),this.session.off("changeMode",this.$onChangeMode),this.session.off("tokenizerUpdate",this.$onTokenizerUpdate),this.session.off("changeTabSize",this.$onChangeTabSize),this.session.off("changeWrapLimit",this.$onChangeWrapLimit),this.session.off("changeWrapMode",this.$onChangeWrapMode),this.session.off("changeFold",this.$onChangeFold),this.session.off("changeFrontMarker",this.$onChangeFrontMarker),this.session.off("changeBackMarker",this.$onChangeBackMarker),this.session.off("changeBreakpoint",this.$onChangeBreakpoint),this.session.off("changeAnnotation",this.$onChangeAnnotation),this.session.off("changeOverwrite",this.$onCursorChange),this.session.off("changeScrollTop",this.$onScrollTopChange),this.session.off("changeScrollLeft",this.$onScrollLeftChange);var i=this.session.getSelection();i.off("changeCursor",this.$onCursorChange),i.off("changeSelection",this.$onSelectionChange)}this.session=e,e?(this.$onDocumentChange=this.onDocumentChange.bind(this),e.on("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.on("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.on("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.on("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.on("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.on("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.on("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.on("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.on("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.on("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.on("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.on("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.on("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.on("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.on("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.on("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.onCursorChange(),this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull()):(this.selection=null,this.renderer.setSession(e)),this._signal("changeSession",{session:e,oldSession:t}),this.curOp=null,t&&t._signal("changeEditor",{oldEditor:this}),e&&e._signal("changeEditor",{editor:this}),e&&e.bgTokenizer&&e.bgTokenizer.scheduleStart()}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e,t){this.renderer.setTheme(e,t)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||t.computedStyle(this.container).fontSize},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout(function(){e.$highlightPending=!1;var t=e.session;if(t&&t.bgTokenizer){var i=t.findMatchingBracket(e.getCursorPosition());if(i)var n=new h(i.row,i.column,i.row,i.column+1);else if(t.$mode.getMatching)var n=t.$mode.getMatching(e.session);n&&(t.$bracketHighlight=t.addMarker(n,"ace_bracket","text"))}},50)}},this.$highlightTags=function(){if(!this.$highlightTagPending){var e=this;this.$highlightTagPending=!0,setTimeout(function(){e.$highlightTagPending=!1;var t=e.session;if(t&&t.bgTokenizer){var i=e.getCursorPosition(),n=new m(e.session,i.row,i.column),r=n.getCurrentToken();if(!r||!/\b(?:tag-open|tag-name)/.test(r.type))return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);if(-1==r.type.indexOf("tag-open")||(r=n.stepForward())){var s=r.value,o=0,a=n.stepBackward();if("<"==a.value)do{a=r,(r=n.stepForward())&&r.value===s&&-1!==r.type.indexOf("tag-name")&&("<"===a.value?o++:"</"===a.value&&o--)}while(r&&o>=0);else{do{r=a,a=n.stepBackward(),r&&r.value===s&&-1!==r.type.indexOf("tag-name")&&("<"===a.value?o++:"</"===a.value&&o--)}while(a&&o<=0);n.stepForward()}if(!r)return t.removeMarker(t.$tagHighlight),void(t.$tagHighlight=null);var l=n.getCurrentTokenRow(),c=n.getCurrentTokenColumn(),u=new h(l,c,l,c+r.value.length),d=t.$backMarkers[t.$tagHighlight];t.$tagHighlight&&void 0!=d&&0!==u.compareRange(d.range)&&(t.removeMarker(t.$tagHighlight),t.$tagHighlight=null),t.$tagHighlight||(t.$tagHighlight=t.addMarker(u,"ace_bracket","text"))}}},50)}},this.focus=function(){var e=this;setTimeout(function(){e.isFocused()||e.textInput.focus()}),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(e){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus",e))},this.onBlur=function(e){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur",e))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t=this.session.$useWrapMode,i=e.start.row==e.end.row?e.end.row:1/0;this.renderer.updateLines(e.start.row,i,t),this._signal("change",e),this.$cursorChange(),this.$updateHighlightActiveLine()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$highlightBrackets(),this.$highlightTags(),this.$updateHighlightActiveLine(),this._signal("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition()),this.renderer.theme&&this.renderer.theme.$selectionColorConflict&&!this.selection.isEmpty()&&(e=!1),!this.renderer.$maxLines||1!==this.session.getLength()||this.renderer.$minLines>1||(e=!1)),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var i=new h(e.row,e.column,e.row,1/0);i.id=t.addMarker(i,"ace_active-line","screenLine"),t.$highlightLineMarker=i}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._signal("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var i=this.selection.getRange(),n=this.getSelectionStyle();t.$selectionMarker=t.addMarker(i,"ace_selection",n)}var r=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(r),this._signal("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var i=t.start.column,n=t.end.column,r=e.getLine(t.start.row),s=r.substring(i,n);if(!(s.length>5e3)&&/[\w\d]/.test(s)){var o=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:s}),a=r.substring(i-1,n+1);if(o.test(a))return o}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getSelectedText=function(){return this.session.getTextRange(this.getSelectionRange())},this.getCopyText=function(){var e=this.getSelectedText(),t=this.session.doc.getNewLineCharacter(),i=!1;if(!e&&this.$copyWithEmptySelection){i=!0;for(var n=this.selection.getAllRanges(),r=0;r<n.length;r++){var s=n[r];r&&n[r-1].start.row==s.start.row||(e+=this.session.getLine(s.start.row)+t)}}var o={text:e};return this._signal("copy",o),g.lineMode=i?o.text:"",o.text},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e,t){var i={text:e,event:t};this.commands.exec("paste",this,i)},this.$handlePaste=function(e){"string"==typeof e&&(e={text:e}),this._signal("paste",e);var t=e.text,i=t==g.lineMode,n=this.session;if(!this.inMultiSelectMode||this.inVirtualSelectionMode)i?n.insert({row:this.selection.lead.row,column:0},t):this.insert(t);else if(i)this.selection.rangeList.ranges.forEach(function(e){n.insert({row:e.start.row,column:0},t)});else{var r=t.split(/\r\n|\r|\n/),s=this.selection.rangeList.ranges;if(r.length>s.length||r.length<2||!r[1])return this.commands.exec("insertstring",this,t);for(var o=s.length;o--;){var a=s[o];a.isEmpty()||n.remove(a),n.insert(a.start,r[o])}}},this.execCommand=function(e,t){return this.commands.exec(e,this,t)},this.insert=function(e,t){var i=this.session,n=i.getMode(),r=this.getCursorPosition();if(this.getBehavioursEnabled()&&!t){var s=n.transformAction(i.getState(r.row),"insertion",this,i,e);s&&(e!==s.text&&(this.inVirtualSelectionMode||(this.session.mergeUndoDeltas=!1,this.mergeNextCommand=!1)),e=s.text)}if("\t"==e&&(e=this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()&&-1==e.indexOf("\n")){var o=new h.fromPoints(r,r);o.end.column+=e.length,this.session.remove(o)}}else{var o=this.getSelectionRange();r=this.session.remove(o),this.clearSelection()}if("\n"==e||"\r\n"==e){var a=i.getLine(r.row);if(r.column>a.search(/\S|$/)){var l=a.substr(r.column).search(/\S|$/);i.doc.removeInLine(r.row,r.column,r.column+l)}}this.clearSelection();var c=r.column,u=i.getState(r.row),a=i.getLine(r.row),d=n.checkOutdent(u,a,e);i.insert(r,e);if(s&&s.selection&&(2==s.selection.length?this.selection.setSelectionRange(new h(r.row,c+s.selection[0],r.row,c+s.selection[1])):this.selection.setSelectionRange(new h(r.row+s.selection[0],s.selection[1],r.row+s.selection[2],s.selection[3]))),i.getDocument().isNewLine(e)){var f=n.getNextLineIndent(u,a.slice(0,r.column),i.getTabString());i.insert({row:r.row+1,column:0},f)}d&&n.autoOutdent(u,i,r.row)},this.onTextInput=function(e,t){if(!t)return this.keyBinding.onTextInput(e);this.startOperation({command:{name:"insertstring"}});var i=this.applyComposition.bind(this,e,t);this.selection.rangeCount?this.forEachSelection(i):i(),this.endOperation()},this.applyComposition=function(e,t){if(t.extendLeft||t.extendRight){var i=this.selection.getRange();i.start.column-=t.extendLeft,i.end.column+=t.extendRight,this.selection.setRange(i),e||i.isEmpty()||this.remove()}if(!e&&this.selection.isEmpty()||this.insert(e,!0),t.restoreStart||t.restoreEnd){var i=this.selection.getRange();i.start.column-=t.restoreStart,i.end.column-=t.restoreEnd,this.selection.setRange(i)}},this.onCommandKey=function(e,t,i){this.keyBinding.onCommandKey(e,t,i)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var i=this.session,n=i.getState(t.start.row),r=i.getMode().transformAction(n,"deletion",this,i,t);if(0===t.end.column){var s=i.getTextRange(t);if("\n"==s[s.length-1]){var o=i.getLine(t.end.row);/^\s+$/.test(o)&&(t.end.column=o.length)}}r&&(t=r)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.selection.isEmpty()&&this.selection.selectLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var i,n,r=this.session.getLine(e.row);t<r.length?(i=r.charAt(t)+r.charAt(t-1),n=new h(e.row,t-1,e.row,t+1)):(i=r.charAt(t-1)+r.charAt(t-2),n=new h(e.row,t-2,e.row,t)),this.session.replace(n,i),this.session.selection.moveToPosition(n.end)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row)){if(t.start.column<t.end.column){var n=e.getTextRange(t);if(!/^\s+$/.test(n)){var r=this.$getSelectedRows();return void e.indentRows(r.first,r.last,"\t")}}var s=e.getLine(t.start.row),o=t.start,a=e.getTabSize(),l=e.documentToScreenColumn(o.row,o.column);if(this.session.getUseSoftTabs())var c=a-l%a,h=i.stringRepeat(" ",c);else{for(var c=l%a;" "==s[t.start.column-1]&&c;)t.start.column--,c--;this.selection.setSelectionRange(t),h="\t"}return this.insert(h)}var r=this.$getSelectedRows();e.indentRows(r.first,r.last,"\t")},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"\t")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){for(var e=this.$getSelectedRows(),t=this.session,i=[],n=e.first;n<=e.last;n++)i.push(t.getLine(n));i.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0});for(var r=new h(0,0,0,0),n=e.first;n<=e.last;n++){var s=t.getLine(n);r.start.row=n,r.end.row=n,r.end.column=s.length,t.replace(r,i[n-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),i=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,i,e)},this.getNumberAt=function(e,t){var i=/[\-]?[0-9]+(?:\.[0-9]+)?/g;i.lastIndex=0;for(var n=this.session.getLine(e);i.lastIndex<t;){var r=i.exec(n);if(r.index<=t&&r.index+r[0].length>=t){var s={value:r[0],start:r.index,end:r.index+r[0].length};return s}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,i=this.selection.getCursor().column,n=new h(t,i-1,t,i),r=this.session.getTextRange(n);if(!isNaN(parseFloat(r))&&isFinite(r)){var s=this.getNumberAt(t,i);if(s){var o=s.value.indexOf(".")>=0?s.start+s.value.indexOf(".")+1:s.end,a=s.start+s.value.length-o,l=parseFloat(s.value);l*=Math.pow(10,a),o!==s.end&&i<o?e*=Math.pow(10,s.end-i-1):e*=Math.pow(10,s.end-i),l+=e;var c=(l/=Math.pow(10,a)).toFixed(a),u=new h(t,s.start,t,s.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(s.start+1,i+c.length-s.value.length))}}else this.toggleWord()},this.$toggleWordPairs=[["first","last"],["true","false"],["yes","no"],["width","height"],["top","bottom"],["right","left"],["on","off"],["x","y"],["get","set"],["max","min"],["horizontal","vertical"],["show","hide"],["add","remove"],["up","down"],["before","after"],["even","odd"],["inside","outside"],["next","previous"],["increase","decrease"],["attach","detach"],["&&","||"],["==","!="]],this.toggleWord=function(){var e=this.selection.getCursor().row,t=this.selection.getCursor().column;this.selection.selectWord();var n=this.getSelectedText(),r=this.selection.getWordRange().start.column,s=n.replace(/([a-z]+|[A-Z]+)(?=[A-Z_]|$)/g,"$1 ").split(/\s/),o=t-r-1;o<0&&(o=0);var a=0,l=0,c=this;n.match(/[A-Za-z0-9_]+/)&&s.forEach(function(t,i){l=a+t.length,o>=a&&o<=l&&(n=t,c.selection.clearSelection(),c.moveCursorTo(e,a+r),c.selection.selectTo(e,l+r)),a=l});for(var h,u=this.$toggleWordPairs,d=0;d<u.length;d++)for(var f=u[d],p=0;p<=1;p++){var m=+!p,g=n.match(new RegExp("^\\s?_?("+i.escapeRegExp(f[p])+")\\s?$","i"));if(g){var v=n.match(new RegExp("([_]|^|\\s)("+i.escapeRegExp(g[1])+")($|\\s)","g"));v&&(h=n.replace(new RegExp(i.escapeRegExp(f[p]),"i"),function(e){var t=f[m];return e.toUpperCase()==e?t=t.toUpperCase():e.charAt(0).toUpperCase()==e.charAt(0)&&(t=t.substr(0,0)+f[m].charAt(0).toUpperCase()+t.substr(1)),t}),this.insert(h),h="")}}},this.removeLines=function(){var e=this.$getSelectedRows();this.session.removeFullLines(e.first,e.last),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,i=e.getRange(),n=e.isBackwards();if(i.isEmpty()){var r=i.start.row;t.duplicateLines(r,r)}else{var s=n?i.start:i.end,o=t.insert(s,t.getTextRange(i),!1);i.start=s,i.end=o,e.setSelectionRange(i,n)}},this.moveLinesDown=function(){this.$moveLines(1,!1)},this.moveLinesUp=function(){this.$moveLines(-1,!1)},this.moveText=function(e,t,i){return this.session.moveText(e,t,i)},this.copyLinesUp=function(){this.$moveLines(-1,!0)},this.copyLinesDown=function(){this.$moveLines(1,!0)},this.$moveLines=function(e,t){var i,n,r=this.selection;if(!r.inMultiSelectMode||this.inVirtualSelectionMode){var s=r.toOrientedRange();i=this.$getSelectedRows(s),n=this.session.$moveLines(i.first,i.last,t?0:e),t&&-1==e&&(n=0),s.moveBy(n,0),r.fromOrientedRange(s)}else{var o=r.rangeList.ranges;r.rangeList.detach(this.session),this.inVirtualSelectionMode=!0;for(var a=0,l=0,c=o.length,h=0;h<c;h++){var u=h;o[h].moveBy(a,0);for(var d=(i=this.$getSelectedRows(o[h])).first,f=i.last;++h<c;){l&&o[h].moveBy(l,0);var p=this.$getSelectedRows(o[h]);if(t&&p.first!=f)break;if(!t&&p.first>f+1)break;f=p.last}for(h--,a=this.session.$moveLines(d,f,t?0:e),t&&-1==e&&(u=h+1);u<=h;)o[u].moveBy(a,0),u++;t||(a=0),l+=a}r.fromOrientedRange(r.ranges[0]),r.rangeList.attach(this.session),this.inVirtualSelectionMode=!1}},this.$getSelectedRows=function(e){return e=(e||this.getSelectionRange()).collapseRows(),{first:this.session.getRowFoldStart(e.start.row),last:this.session.getRowFoldEnd(e.end.row)}},this.onCompositionStart=function(e){this.renderer.showComposition(e)},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var i=this.renderer,n=this.renderer.layerConfig,r=e*Math.floor(n.height/n.lineHeight);!0===t?this.selection.$moveSelection(function(){this.moveCursorBy(r,0)}):!1===t&&(this.selection.moveCursorBy(r,0),this.selection.clearSelection());var s=i.scrollTop;i.scrollBy(0,r*n.lineHeight),null!=t&&i.scrollCursorIntoView(null,.5),i.animateScrolling(s)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,i,n){this.renderer.scrollToLine(e,t,i,n)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.selection.selectAll()},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e,t){var i=this.getCursorPosition(),n=new m(this.session,i.row,i.column),r=n.getCurrentToken(),s=r||n.stepForward();if(s){var o,a,l=!1,c={},u=i.column-s.start,d={")":"(","(":"(","]":"[","[":"[","{":"{","}":"{"};do{if(s.value.match(/[{}()\[\]]/g)){for(;u<s.value.length&&!l;u++)if(d[s.value[u]])switch(a=d[s.value[u]]+"."+s.type.replace("rparen","lparen"),isNaN(c[a])&&(c[a]=0),s.value[u]){case"(":case"[":case"{":c[a]++;break;case")":case"]":case"}":c[a]--,-1===c[a]&&(o="bracket",l=!0)}}else-1!==s.type.indexOf("tag-name")&&(isNaN(c[s.value])&&(c[s.value]=0),"<"===r.value?c[s.value]++:"</"===r.value&&c[s.value]--,-1===c[s.value]&&(o="tag",l=!0));l||(r=s,s=n.stepForward(),u=0)}while(s&&!l);if(o){var f,p;if("bracket"===o)(f=this.session.getBracketRange(i))||(f=new h(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+u-1,n.getCurrentTokenRow(),n.getCurrentTokenColumn()+u-1),p=f.start,(t||p.row===i.row&&Math.abs(p.column-i.column)<2)&&(f=this.session.getBracketRange(p)));else if("tag"===o){if(!s||-1===s.type.indexOf("tag-name"))return;var g=s.value;if(0===(f=new h(n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2,n.getCurrentTokenRow(),n.getCurrentTokenColumn()-2)).compare(i.row,i.column)){l=!1;do{s=r,(r=n.stepBackward())&&(-1!==r.type.indexOf("tag-close")&&f.setEnd(n.getCurrentTokenRow(),n.getCurrentTokenColumn()+1),s.value===g&&-1!==s.type.indexOf("tag-name")&&("<"===r.value?c[g]++:"</"===r.value&&c[g]--,0===c[g]&&(l=!0)))}while(r&&!l)}s&&s.type.indexOf("tag-name")&&(p=f.start).row==i.row&&Math.abs(p.column-i.column)<2&&(p=f.end)}(p=f&&f.cursor||p)&&(e?f&&t?this.selection.setRange(f):f&&f.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(p.row,p.column):this.selection.moveTo(p.row,p.column))}}},this.gotoLine=function(e,t,i){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,i)},this.navigateTo=function(e,t){this.selection.moveTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(-e||-1,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),this.selection.moveCursorBy(e||1,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){this.selection.moveCursorFileEnd(),this.clearSelection()},this.navigateFileStart=function(){this.selection.moveCursorFileStart(),this.clearSelection()},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var i=this.$search.find(this.session),n=0;return i?(this.$tryReplace(i,e)&&(n=1),this.selection.setSelectionRange(i),this.renderer.scrollSelectionIntoView(i.start,i.end),n):n},this.replaceAll=function(e,t){t&&this.$search.set(t);var i=this.$search.findAll(this.session),n=0;if(!i.length)return n;var r=this.getSelectionRange();this.selection.moveTo(0,0);for(var s=i.length-1;s>=0;--s)this.$tryReplace(i[s],e)&&n++;return this.selection.setSelectionRange(r),n},this.$tryReplace=function(e,t){var i=this.session.getTextRange(e);return null!==(t=this.$search.replace(i,t))?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(t,i,n){i||(i={}),"string"==typeof t||t instanceof RegExp?i.needle=t:"object"==typeof t&&e.mixin(i,t);var r=this.selection.getRange();null==i.needle&&((t=this.session.getTextRange(r)||this.$search.$options.needle)||(r=this.session.getWordRange(r.start.row,r.start.column),t=this.session.getTextRange(r)),this.$search.set({needle:t})),this.$search.set(i),i.start||this.$search.set({start:r});var s=this.$search.find(this.session);return i.preventScroll?s:s?(this.revealRange(s,n),s):(i.backwards?r.start=r.end:r.end=r.start,void this.selection.setRange(r))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.session.unfold(e),this.selection.setSelectionRange(e);var i=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),!1!==t&&this.renderer.animateScrolling(i)},this.undo=function(){this.session.getUndoManager().undo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.session.getUndoManager().redo(this.session),this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._signal("destroy",this),this.session&&this.session.destroy()},this.setAutoScrollEditorIntoView=function(e){if(e){var t,i=this,n=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var r=this.$scrollAnchor;r.style.cssText="position:absolute",this.container.insertBefore(r,this.container.firstChild);var s=this.on("changeSelection",function(){n=!0}),o=this.renderer.on("beforeRender",function(){n&&(t=i.renderer.container.getBoundingClientRect())}),a=this.renderer.on("afterRender",function(){if(n&&t&&(i.isFocused()||i.searchBox&&i.searchBox.isFocused())){var e=i.renderer,s=e.$cursorLayer.$pixelPos,o=e.layerConfig,a=s.top-o.offset;null!=(n=s.top>=0&&a+t.top<0||!(s.top<o.height&&s.top+t.top+o.lineHeight>window.innerHeight)&&null)&&(r.style.top=a+"px",r.style.left=s.left+"px",r.style.height=o.lineHeight+"px",r.scrollIntoView(n)),n=t=null}});this.setAutoScrollEditorIntoView=function(e){e||(delete this.setAutoScrollEditorIntoView,this.off("changeSelection",s),this.renderer.off("afterRender",a),this.renderer.off("beforeRender",o))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",i=this.renderer.$cursorLayer;i&&(i.setSmoothBlinking(/smooth/.test(e)),i.isBlinking=!this.$readOnly&&"wide"!=e,t.setCssClass(i.element,"ace_slim-cursors",/slim/.test(e)))}}.call(v.prototype),p.defineOptions(v.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._signal("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.textInput.setReadOnly(e),this.$resetCursorStyle()},initialValue:!1},copyWithEmptySelection:{set:function(e){this.textInput.setCopyWithEmptySelection(e)},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},mergeUndoDeltas:{values:[!1,!0,"always"],initialValue:!0},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},autoScrollEditorIntoView:{set:function(e){this.setAutoScrollEditorIntoView(e)}},keyboardHandler:{set:function(e){this.setKeyboardHandler(e)},get:function(){return this.$keybindingId},handlesSet:!0},value:{set:function(e){this.session.setValue(e)},get:function(){return this.getValue()},handlesSet:!0,hidden:!0},session:{set:function(e){this.setSession(e)},get:function(){return this.session},handlesSet:!0,hidden:!0},showLineNumbers:{set:function(e){this.renderer.$gutterLayer.setShowLineNumbers(e),this.renderer.$loop.schedule(this.renderer.CHANGE_GUTTER),e&&this.$relativeLineNumbers?y.attach(this):y.detach(this)},initialValue:!0},relativeLineNumbers:{set:function(e){this.$showLineNumbers&&e?y.attach(this):y.detach(this)}},hScrollBarAlwaysVisible:"renderer",vScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",displayIndentGuides:"renderer",showGutter:"renderer",fontSize:"renderer",fontFamily:"renderer",maxLines:"renderer",minLines:"renderer",scrollPastEnd:"renderer",fixedWidthGutter:"renderer",theme:"renderer",hasCssTransforms:"renderer",maxPixelHeight:"renderer",useTextareaForIME:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",dragEnabled:"$mouseHandler",focusTimeout:"$mouseHandler",tooltipFollowsMouse:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",navigateWithinSoftTabs:"session",tabSize:"session",wrap:"session",indentedSoftWrap:"session",foldStyle:"session",mode:"session"});var y={getText:function(e,t){return(Math.abs(e.selection.lead.row-t)||t+1+(t<9?"·":""))+""},getWidth:function(e,t,i){return Math.max(t.toString().length,(i.lastRow+1).toString().length,2)*i.characterWidth},update:function(e,t){t.renderer.$loop.schedule(t.renderer.CHANGE_GUTTER)},attach:function(e){e.renderer.$gutterLayer.$renderer=this,e.on("changeSelection",this.update),this.update(null,e)},detach:function(e){e.renderer.$gutterLayer.$renderer==this&&(e.renderer.$gutterLayer.$renderer=null),e.off("changeSelection",this.update),this.update(null,e)}};exports.Editor=v}),define("skylark-ace/undomanager",["require","exports","module","./range"],function(require,exports,module){var e=function(){this.$maxRev=0,this.$fromUndo=!1,this.reset()};(function(){this.addSession=function(e){this.$session=e},this.add=function(e,t,i){this.$fromUndo||e!=this.$lastDelta&&(!1!==t&&this.lastDeltas||(this.lastDeltas=[],this.$undoStack.push(this.lastDeltas),e.id=this.$rev=++this.$maxRev),"remove"!=e.action&&"insert"!=e.action||(this.$lastDelta=e),this.lastDeltas.push(e))},this.addSelection=function(e,t){this.selections.push({value:e,rev:t||this.$rev})},this.startNewGroup=function(){return this.lastDeltas=null,this.$rev},this.markIgnored=function(e,t){null==t&&(t=this.$rev+1);for(var i=this.$undoStack,n=i.length;n--;){var r=i[n][0];if(r.id<=e)break;r.id<t&&(r.ignore=!0)}this.lastDeltas=null},this.getSelection=function(e,t){for(var i=this.selections,n=i.length;n--;){var r=i[n];if(r.rev<e)return t&&(r=i[n+1]),r}},this.getRevision=function(){return this.$rev},this.getDeltas=function(e,t){null==t&&(t=this.$rev+1);for(var i=this.$undoStack,n=null,r=0,s=i.length;s--;){var o=i[s][0];if(o.id<t&&!n&&(n=s+1),o.id<=e){r=s+1;break}}return i.slice(r,n)},this.getChangedRanges=function(e,t){null==t&&(t=this.$rev+1)},this.getChangedLines=function(e,t){null==t&&(t=this.$rev+1)},this.undo=function(e,t){this.lastDeltas=null;var i=this.$undoStack;if(function(e,t){for(var i=t;i--;){var n=e[i];if(n&&!n[0].ignore){for(;i<t-1;){var r=a(e[i],e[i+1]);e[i]=r[0],e[i+1]=r[1],i++}return!0}}}(i,i.length)){e||(e=this.$session),this.$redoStackBaseRev!==this.$rev&&this.$redoStack.length&&(this.$redoStack=[]),this.$fromUndo=!0;var n=i.pop(),r=null;return n&&n.length&&(r=e.undoChanges(n,t),this.$redoStack.push(n),this.$syncRev()),this.$fromUndo=!1,r}},this.redo=function(e,t){if(this.lastDeltas=null,e||(e=this.$session),this.$fromUndo=!0,this.$redoStackBaseRev!=this.$rev){var i=this.getDeltas(this.$redoStackBaseRev,this.$rev+1);!function(e,t){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;r++)d(e,n[r])}(this.$redoStack,i),this.$redoStackBaseRev=this.$rev,this.$redoStack.forEach(function(e){e[0].id=++this.$maxRev},this)}var n=this.$redoStack.pop(),r=null;return n&&(r=e.redoChanges(n,t),this.$undoStack.push(n),this.$syncRev()),this.$fromUndo=!1,r},this.$syncRev=function(){var e=this.$undoStack,t=e[e.length-1],i=t&&t[0].id||0;this.$redoStackBaseRev=i,this.$rev=i},this.reset=function(){this.lastDeltas=null,this.$lastDelta=null,this.$undoStack=[],this.$redoStack=[],this.$rev=0,this.mark=0,this.$redoStackBaseRev=this.$rev,this.selections=[]},this.canUndo=function(){return this.$undoStack.length>0},this.canRedo=function(){return this.$redoStack.length>0},this.bookmark=function(e){void 0==e&&(e=this.$rev),this.mark=e},this.isAtBookmark=function(){return this.$rev===this.mark},this.toJSON=function(){},this.fromJSON=function(){},this.hasUndo=this.canUndo,this.hasRedo=this.canRedo,this.isClean=this.isAtBookmark,this.markClean=this.bookmark,this.$prettyPrint=function(e){return e?r(e):r(this.$undoStack)+"\n---\n"+r(this.$redoStack)}}).call(e.prototype);var t=require("./range").Range,i=t.comparePoints;t.comparePoints;function n(e){return{row:e.row,column:e.column}}function r(e){if(e=e||this,Array.isArray(e))return e.map(r).join("\n");var t="";return e.action?(t="insert"==e.action?"+":"-",t+="["+e.lines+"]"):e.value&&(t=Array.isArray(e.value)?e.value.map(s).join("\n"):s(e.value)),e.start&&(t+=s(e)),(e.id||e.rev)&&(t+="\t("+(e.id||e.rev)+")"),t}function s(e){return e.start.row+":"+e.start.column+"=>"+e.end.row+":"+e.end.column}function o(e,t){var n="insert"==e.action,r="insert"==t.action;if(n&&r)if(i(t.start,e.end)>=0)c(t,e,-1);else{if(!(i(t.start,e.start)<=0))return null;c(e,t,1)}else if(n&&!r)if(i(t.start,e.end)>=0)c(t,e,-1);else{if(!(i(t.end,e.start)<=0))return null;c(e,t,-1)}else if(!n&&r)if(i(t.start,e.start)>=0)c(t,e,1);else{if(!(i(t.start,e.start)<=0))return null;c(e,t,1)}else if(!n&&!r)if(i(t.start,e.start)>=0)c(t,e,1);else{if(!(i(t.end,e.start)<=0))return null;c(e,t,-1)}return[t,e]}function a(e,t){for(var i=e.length;i--;)for(var n=0;n<t.length;n++)if(!o(e[i],t[n])){for(;i<e.length;){for(;n--;)o(t[n],e[i]);n=t.length,i++}return[e,t]}return e.selectionBefore=t.selectionBefore=e.selectionAfter=t.selectionAfter=null,[t,e]}function l(e,n){var r="insert"==e.action,s="insert"==n.action;if(r&&s)i(e.start,n.start)<0?c(n,e,1):c(e,n,1);else if(r&&!s)i(e.start,n.end)>=0?c(e,n,-1):i(e.start,n.start)<=0?c(n,e,1):(c(e,t.fromPoints(n.start,e.start),-1),c(n,e,1));else if(!r&&s)i(n.start,e.end)>=0?c(n,e,-1):i(n.start,e.start)<=0?c(e,n,1):(c(n,t.fromPoints(e.start,n.start),-1),c(e,n,1));else if(!r&&!s)if(i(n.start,e.end)>=0)c(n,e,-1);else{var o,a;if(!(i(n.end,e.start)<=0))return i(e.start,n.start)<0&&(o=e,e=u(e,n.start)),i(e.end,n.end)>0&&(a=u(e,n.end)),h(n.end,e.start,e.end,-1),a&&!o&&(e.lines=a.lines,e.start=a.start,e.end=a.end,a=e),[n,o,a].filter(Boolean);c(e,n,-1)}return[n,e]}function c(e,t,i){h(e.start,t.start,t.end,i),h(e.end,t.start,t.end,i)}function h(e,t,i,n){e.row==(1==n?t:i).row&&(e.column+=n*(i.column-t.column)),e.row+=n*(i.row-t.row)}function u(e,t){var i=e.lines,r=e.end;e.end=n(t);var s=e.end.row-e.start.row,o=i.splice(s,i.length),a=s?t.column:t.column-e.start.column;i.push(o[0].substring(0,a)),o[0]=o[0].substr(a);var l={start:n(t),end:r,lines:o,action:e.action};return l}function d(e,t){t=function(e){return{start:n(e.start),end:n(e.end),action:e.action,lines:e.lines.slice()}}(t);for(var i=e.length;i--;){for(var r=e[i],s=0;s<r.length;s++){var o=r[s],a=l(o,t);t=a[0],2!=a.length&&(a[2]?(r.splice(s+1,1,a[1],a[2]),s++):a[1]||(r.splice(s,1),s--))}r.length||e.splice(i,1)}return e}exports.UndoManager=e}),define("skylark-ace/layer/lines",["require","exports","module","../lib/dom"],function(require,exports,module){var e=require("../lib/dom"),t=function(e,t){this.element=e,this.canvasHeight=t||5e5,this.element.style.height=2*this.canvasHeight+"px",this.cells=[],this.cellCache=[],this.$offsetCoefficient=0};(function(){this.moveContainer=function(t){e.translate(this.element,0,-t.firstRowScreen*t.lineHeight%this.canvasHeight-t.offset*this.$offsetCoefficient)},this.pageChanged=function(e,t){return Math.floor(e.firstRowScreen*e.lineHeight/this.canvasHeight)!==Math.floor(t.firstRowScreen*t.lineHeight/this.canvasHeight)},this.computeLineTop=function(e,t,i){var n=t.firstRowScreen*t.lineHeight,r=Math.floor(n/this.canvasHeight),s=i.documentToScreenRow(e,0)*t.lineHeight;return s-r*this.canvasHeight},this.computeLineHeight=function(e,t,i){return t.lineHeight*i.getRowLength(e)},this.getLength=function(){return this.cells.length},this.get=function(e){return this.cells[e]},this.shift=function(){this.$cacheCell(this.cells.shift())},this.pop=function(){this.$cacheCell(this.cells.pop())},this.push=function(t){if(Array.isArray(t)){this.cells.push.apply(this.cells,t);for(var i=e.createFragment(this.element),n=0;n<t.length;n++)i.appendChild(t[n].element);this.element.appendChild(i)}else this.cells.push(t),this.element.appendChild(t.element)},this.unshift=function(t){if(Array.isArray(t)){this.cells.unshift.apply(this.cells,t);for(var i=e.createFragment(this.element),n=0;n<t.length;n++)i.appendChild(t[n].element);this.element.firstChild?this.element.insertBefore(i,this.element.firstChild):this.element.appendChild(i)}else this.cells.unshift(t),this.element.insertAdjacentElement("afterbegin",t.element)},this.last=function(){return this.cells.length?this.cells[this.cells.length-1]:null},this.$cacheCell=function(e){e&&(e.element.remove(),this.cellCache.push(e))},this.createCell=function(t,i,n,r){var s=this.cellCache.pop();if(!s){var o=e.createElement("div");r&&r(o),this.element.appendChild(o),s={element:o,text:"",row:t}}return s.row=t,s}}).call(t.prototype),exports.Lines=t}),define("skylark-ace/layer/gutter",["require","exports","module","../lib/dom","../lib/oop","../lib/lang","../lib/event_emitter","./lines"],function(require,exports,module){var e=require("../lib/dom"),t=require("../lib/oop"),i=require("../lib/lang"),n=require("../lib/event_emitter").EventEmitter,r=require("./lines").Lines,s=function(t){this.element=e.createElement("div"),this.element.className="ace_layer ace_gutter-layer",t.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this),this.$lines=new r(this.element),this.$lines.$offsetCoefficient=1};function o(t){var i=document.createTextNode("");t.appendChild(i);var n=e.createElement("span");return t.appendChild(n),t}(function(){t.implement(this,n),this.setSession=function(e){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=e,e&&e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t=0;t<e.length;t++){var n=e[t],r=n.row,s=this.$annotations[r];s||(s=this.$annotations[r]={text:[]});var o=n.text;o=o?i.escapeHTML(o):n.html||"",-1===s.text.indexOf(o)&&s.text.push(o);var a=n.type;"error"==a?s.className=" ace_error":"warning"==a&&" ace_error"!=s.className?s.className=" ace_warning":"info"!=a||s.className||(s.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.start.row,i=e.end.row-t;if(0===i);else if("remove"==e.action)this.$annotations.splice(t,i+1,null);else{var n=new Array(i+1);n.unshift(t,1),this.$annotations.splice.apply(this.$annotations,n)}}},this.update=function(e){this.config=e;var t=this.session,i=e.firstRow,n=Math.min(e.lastRow+e.gutterOffset,t.getLength()-1);this.oldLastRow=n,this.config=e,this.$lines.moveContainer(e),this.$updateCursorRow();for(var r=t.getNextFoldLine(i),s=r?r.start.row:1/0,a=null,l=-1,c=i;;){if(c>s&&(c=r.end.row+1,r=t.getNextFoldLine(c,r),s=r?r.start.row:1/0),c>n){for(;this.$lines.getLength()>l+1;)this.$lines.pop();break}(a=this.$lines.get(++l))?a.row=c:(a=this.$lines.createCell(c,e,this.session,o),this.$lines.push(a)),this.$renderCell(a,e,r,c),c++}this._signal("afterRender"),this.$updateGutterWidth(e)},this.$updateGutterWidth=function(e){var t=this.session,i=t.gutterRenderer||this.$renderer,n=t.$firstLineNumber,r=this.$lines.last()?this.$lines.last().text:"";(this.$fixedWidth||t.$useWrapMode)&&(r=t.getLength()+n-1);var s=i?i.getWidth(t,r,e):r.toString().length*e.characterWidth,o=this.$padding||this.$computePadding();(s+=o.left+o.right)===this.gutterWidth||isNaN(s)||(this.gutterWidth=s,this.element.parentNode.style.width=this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._signal("changeGutterWidth",s))},this.$updateCursorRow=function(){if(this.$highlightGutterLine){var e=this.session.selection.getCursor();this.$cursorRow!==e.row&&(this.$cursorRow=e.row)}},this.updateLineHighlight=function(){if(this.$highlightGutterLine){var e=this.session.selection.cursor.row;if(this.$cursorRow=e,!this.$cursorCell||this.$cursorCell.row!=e){this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ",""));var t=this.$lines.cells;this.$cursorCell=null;for(var i=0;i<t.length;i++){var n=t[i];if(n.row>=this.$cursorRow){if(n.row>this.$cursorRow){var r=this.session.getFoldLine(this.$cursorRow);if(!(i>0&&r&&r.start.row==t[i-1].row))break;n=t[i-1]}n.element.className="ace_gutter-active-line "+n.element.className,this.$cursorCell=n;break}}}}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$updateCursorRow(),this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var i=Math.min(e.lastRow+e.gutterOffset,this.session.getLength()-1),n=this.oldLastRow;if(this.oldLastRow=i,!t||n<e.firstRow)return this.update(e);if(i<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var r=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);r>0;r--)this.$lines.shift();if(n>i)for(var r=this.session.getFoldedRowCount(i+1,n);r>0;r--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLines(e,e.firstRow,t.firstRow-1)),i>n&&this.$lines.push(this.$renderLines(e,n+1,i)),this.updateLineHighlight(),this._signal("afterRender"),this.$updateGutterWidth(e)},this.$renderLines=function(e,t,i){for(var n=[],r=t,s=this.session.getNextFoldLine(r),a=s?s.start.row:1/0;r>a&&(r=s.end.row+1,s=this.session.getNextFoldLine(r,s),a=s?s.start.row:1/0),!(r>i);){var l=this.$lines.createCell(r,e,this.session,o);this.$renderCell(l,e,s,r),n.push(l),r++}return n},this.$renderCell=function(t,i,n,r){var s=t.element,o=this.session,a=s.childNodes[0],l=s.childNodes[1],c=o.$firstLineNumber,h=o.$breakpoints,u=o.$decorations,d=o.gutterRenderer||this.$renderer,f=this.$showFoldWidgets&&o.foldWidgets,p=n?n.start.row:Number.MAX_VALUE,m="ace_gutter-cell ";if(this.$highlightGutterLine&&(r==this.$cursorRow||n&&r<this.$cursorRow&&r>=p&&this.$cursorRow<=n.end.row)&&(m+="ace_gutter-active-line ",this.$cursorCell!=t&&(this.$cursorCell&&(this.$cursorCell.element.className=this.$cursorCell.element.className.replace("ace_gutter-active-line ","")),this.$cursorCell=t)),h[r]&&(m+=h[r]),u[r]&&(m+=u[r]),this.$annotations[r]&&(m+=this.$annotations[r].className),s.className!=m&&(s.className=m),f){var g=f[r];null==g&&(g=f[r]=o.getFoldWidget(r))}if(g){var m="ace_fold-widget ace_"+g;"start"==g&&r==p&&r<n.end.row?m+=" ace_closed":m+=" ace_open",l.className!=m&&(l.className=m);var v=i.lineHeight+"px";e.setStyle(l.style,"height",v),e.setStyle(l.style,"display","inline-block")}else l&&e.setStyle(l.style,"display","none");var y=(d?d.getText(o,r):r+c).toString();return y!==a.data&&(a.data=y),e.setStyle(t.element.style,"height",this.$lines.computeLineHeight(r,i,o)+"px"),e.setStyle(t.element.style,"top",this.$lines.computeLineTop(r,i,o)+"px"),t.text=y,t},this.$fixedWidth=!1,this.$highlightGutterLine=!0,this.$renderer="",this.setHighlightGutterLine=function(e){this.$highlightGutterLine=e},this.$showLineNumbers=!0,this.$renderer="",this.setShowLineNumbers=function(e){this.$renderer=!e&&{getWidth:function(){return 0},getText:function(){return""}}},this.getShowLineNumbers=function(){return this.$showLineNumbers},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(t){t?e.addCssClass(this.element,"ace_folding-enabled"):e.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=t,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var t=e.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=(parseInt(t.borderLeftWidth)||0)+(parseInt(t.paddingLeft)||0)+1,this.$padding.right=(parseInt(t.borderRightWidth)||0)+(parseInt(t.paddingRight)||0),this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),i=this.element.getBoundingClientRect();return e.x<t.left+i.left?"markers":this.$showFoldWidgets&&e.x>i.right-t.right?"foldWidgets":void 0}}).call(s.prototype),exports.Gutter=s}),define("skylark-ace/layer/marker",["require","exports","module","../range","../lib/dom"],function(require,exports,module){var e=require("../range").Range,t=require("../lib/dom"),i=function(e){this.element=t.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.elt=function(e,t){var i=-1!=this.i&&this.element.childNodes[this.i];i?this.i++:(i=document.createElement("div"),this.element.appendChild(i),this.i=-1),i.style.cssText=t,i.className=e},this.update=function(e){if(e){var t;for(var i in this.config=e,this.i=0,this.markers){var n=this.markers[i];if(n.range){var r=n.range.clipRows(e.firstRow,e.lastRow);if(!r.isEmpty())if(r=r.toScreenRange(this.session),n.renderer){var s=this.$getTop(r.start.row,e),o=this.$padding+r.start.column*e.characterWidth;n.renderer(t,r,o,s,e)}else"fullLine"==n.type?this.drawFullLineMarker(t,r,n.clazz,e):"screenLine"==n.type?this.drawScreenLineMarker(t,r,n.clazz,e):r.isMultiLine()?"text"==n.type?this.drawTextMarker(t,r,n.clazz,e):this.drawMultiLineMarker(t,r,n.clazz,e):this.drawSingleLineMarker(t,r,n.clazz+" ace_start ace_br15",e)}else n.update(t,this,this.session,e)}if(-1!=this.i)for(;this.i<this.element.childElementCount;)this.element.removeChild(this.element.lastChild)}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(t,i,n,r,s){for(var o=this.session,a=i.start.row,l=i.end.row,c=a,h=0,u=0,d=o.getScreenLastRowColumn(c),f=new e(c,i.start.column,c,u);c<=l;c++)f.start.row=f.end.row=c,f.start.column=c==a?i.start.column:o.getRowWrapIndent(c),f.end.column=d,h=u,u=d,d=c+1<l?o.getScreenLastRowColumn(c+1):c==l?0:i.end.column,this.drawSingleLineMarker(t,f,n+(c==a?" ace_start":"")+" ace_br"+((c==a||c==a+1&&i.start.column?1:0)|(h<u?2:0)|(u>d?4:0)|(c==l?8:0)),r,c==l?0:1,s)},this.drawMultiLineMarker=function(e,t,i,n,r){var s=this.$padding,o=n.lineHeight,a=this.$getTop(t.start.row,n),l=s+t.start.column*n.characterWidth;if(r=r||"",this.session.$bidiHandler.isBidiRow(t.start.row)){var c=t.clone();c.end.row=c.start.row,c.end.column=this.session.getLine(c.start.row).length,this.drawBidiSingleLineMarker(e,c,i+" ace_br1 ace_start",n,null,r)}else this.elt(i+" ace_br1 ace_start","height:"+o+"px;right:0;top:"+a+"px;left:"+l+"px;"+(r||""));if(this.session.$bidiHandler.isBidiRow(t.end.row)){var c=t.clone();c.start.row=c.end.row,c.start.column=0,this.drawBidiSingleLineMarker(e,c,i+" ace_br12",n,null,r)}else{a=this.$getTop(t.end.row,n);var h=t.end.column*n.characterWidth;this.elt(i+" ace_br12","height:"+o+"px;width:"+h+"px;top:"+a+"px;left:"+s+"px;"+(r||""))}if(!((o=(t.end.row-t.start.row-1)*n.lineHeight)<=0)){a=this.$getTop(t.start.row+1,n);var u=(t.start.column?1:0)|(t.end.column?0:8);this.elt(i+(u?" ace_br"+u:""),"height:"+o+"px;right:0;top:"+a+"px;left:"+s+"px;"+(r||""))}},this.drawSingleLineMarker=function(e,t,i,n,r,s){if(this.session.$bidiHandler.isBidiRow(t.start.row))return this.drawBidiSingleLineMarker(e,t,i,n,r,s);var o=n.lineHeight,a=(t.end.column+(r||0)-t.start.column)*n.characterWidth,l=this.$getTop(t.start.row,n),c=this.$padding+t.start.column*n.characterWidth;this.elt(i,"height:"+o+"px;width:"+a+"px;top:"+l+"px;left:"+c+"px;"+(s||""))},this.drawBidiSingleLineMarker=function(e,t,i,n,r,s){var o=n.lineHeight,a=this.$getTop(t.start.row,n),l=this.$padding,c=this.session.$bidiHandler.getSelections(t.start.column,t.end.column);c.forEach(function(e){this.elt(i,"height:"+o+"px;width:"+e.width+(r||0)+"px;top:"+a+"px;left:"+(l+e.left)+"px;"+(s||""))},this)},this.drawFullLineMarker=function(e,t,i,n,r){var s=this.$getTop(t.start.row,n),o=n.lineHeight;t.start.row!=t.end.row&&(o+=this.$getTop(t.end.row,n)-s),this.elt(i,"height:"+o+"px;top:"+s+"px;left:0;right:0;"+(r||""))},this.drawScreenLineMarker=function(e,t,i,n,r){var s=this.$getTop(t.start.row,n),o=n.lineHeight;this.elt(i,"height:"+o+"px;top:"+s+"px;left:0;right:0;"+(r||""))}}).call(i.prototype),exports.Marker=i}),define("skylark-ace/layer/text",["require","exports","module","../lib/oop","../lib/dom","../lib/lang","./lines","../lib/event_emitter"],function(require,exports,module){var e=require("../lib/oop"),t=require("../lib/dom"),i=require("../lib/lang"),n=require("./lines").Lines,r=require("../lib/event_emitter").EventEmitter,s=function(e){this.dom=t,this.element=this.dom.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$updateEolChar=this.$updateEolChar.bind(this),this.$lines=new n(this.element)};(function(){e.implement(this,r),this.EOF_CHAR="¶",this.EOL_CHAR_LF="¬",this.EOL_CHAR_CRLF="¤",this.EOL_CHAR=this.EOL_CHAR_LF,this.TAB_CHAR="—",this.SPACE_CHAR="·",this.$padding=0,this.MAX_LINE_LENGTH=1e4,this.$updateEolChar=function(){var e=this.session.doc,t="\n"==e.getNewLineCharacter()&&"windows"!=e.getNewLineMode(),i=t?this.EOL_CHAR_LF:this.EOL_CHAR_CRLF;if(this.EOL_CHAR!=i)return this.EOL_CHAR=i,!0},this.setPadding=function(e){this.$padding=e,this.element.style.margin="0 "+e+"px"},this.getLineHeight=function(){return this.$fontMetrics.$characterSize.height||0},this.getCharacterWidth=function(){return this.$fontMetrics.$characterSize.width||0},this.$setFontMetrics=function(e){this.$fontMetrics=e,this.$fontMetrics.on("changeCharacterSize",function(e){this._signal("changeCharacterSize",e)}.bind(this)),this.$pollSizeChanges()},this.checkForSizeChanges=function(){this.$fontMetrics.checkForSizeChanges()},this.$pollSizeChanges=function(){return this.$pollSizeChangesTimer=this.$fontMetrics.$pollSizeChanges()},this.setSession=function(e){this.session=e,e&&this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(e){return this.showInvisibles!=e&&(this.showInvisibles=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides!=e&&(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],n=1;n<e+1;n++)if(this.showInvisibles){var r=this.dom.createElement("span");r.className="ace_invisible ace_invisible_tab",r.textContent=i.stringRepeat(this.TAB_CHAR,n),t.push(r)}else t.push(this.dom.createTextNode(i.stringRepeat(" ",n),this.element));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var s="ace_indent-guide",o="",a="";if(this.showInvisibles){s+=" ace_invisible",o=" ace_invisible_space",a=" ace_invisible_tab";var l=i.stringRepeat(this.SPACE_CHAR,this.tabSize),c=i.stringRepeat(this.TAB_CHAR,this.tabSize)}else var l=i.stringRepeat(" ",this.tabSize),c=l;var r=this.dom.createElement("span");r.className=s+o,r.textContent=l,this.$tabStrings[" "]=r;var r=this.dom.createElement("span");r.className=s+a,r.textContent=c,this.$tabStrings["\t"]=r}},this.updateLines=function(e,t,i){if(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)return this.update(e);this.config=e;for(var n=Math.max(t,e.firstRow),r=Math.min(i,e.lastRow),s=this.element.childNodes,o=0,a=e.firstRow;a<n;a++){var l=this.session.getFoldLine(a);if(l){if(l.containsRow(n)){n=l.start.row;break}a=l.end.row}o++}for(var c=!1,a=n,l=this.session.getNextFoldLine(a),h=l?l.start.row:1/0;a>h&&(a=l.end.row+1,l=this.session.getNextFoldLine(a,l),h=l?l.start.row:1/0),!(a>r);){var u=s[o++];if(u){this.dom.removeChildren(u),this.$renderLine(u,a,a==h&&l);var d=e.lineHeight*this.session.getRowLength(a)+"px";u.style.height!=d&&(c=!0,u.style.height=d)}a++}if(c)for(;o<this.$lines.cells.length;){var f=this.$lines.cells[o++];f.element.style.top=this.$lines.computeLineTop(f.row,e,this.session)+"px"}},this.scrollLines=function(e){var t=this.config;if(this.config=e,this.$lines.pageChanged(t,e))return this.update(e);this.$lines.moveContainer(e);var i=e.lastRow,n=t?t.lastRow:-1;if(!t||n<e.firstRow)return this.update(e);if(i<t.firstRow)return this.update(e);if(!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);if(t.firstRow<e.firstRow)for(var r=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);r>0;r--)this.$lines.shift();if(t.lastRow>e.lastRow)for(var r=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);r>0;r--)this.$lines.pop();e.firstRow<t.firstRow&&this.$lines.unshift(this.$renderLinesFragment(e,e.firstRow,t.firstRow-1)),e.lastRow>t.lastRow&&this.$lines.push(this.$renderLinesFragment(e,t.lastRow+1,e.lastRow))},this.$renderLinesFragment=function(e,i,n){for(var r=[],s=i,o=this.session.getNextFoldLine(s),a=o?o.start.row:1/0;s>a&&(s=o.end.row+1,o=this.session.getNextFoldLine(s,o),a=o?o.start.row:1/0),!(s>n);){var l=this.$lines.createCell(s,e,this.session),c=l.element;this.dom.removeChildren(c),t.setStyle(c.style,"height",this.$lines.computeLineHeight(s,e,this.session)+"px"),t.setStyle(c.style,"top",this.$lines.computeLineTop(s,e,this.session)+"px"),this.$renderLine(c,s,s==a&&o),this.$useLineGroups()?c.className="ace_line_group":c.className="ace_line",r.push(l),s++}return r},this.update=function(e){this.$lines.moveContainer(e),this.config=e;for(var t=e.firstRow,i=e.lastRow,n=this.$lines;n.getLength();)n.pop();n.push(this.$renderLinesFragment(e,t,i))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,n,r,s){for(var o,a=/(\t)|( +)|([\x00-\x1f\x80-\xa0\xad\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\uFEFF\uFFF9-\uFFFC]+)|(\u3000)|([\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]|[\uD800-\uDBFF][\uDC00-\uDFFF])/g,l=this.dom.createFragment(this.element),c=0;o=a.exec(s);){var h=o[1],u=o[2],d=o[3],f=o[4],p=o[5];if(this.showInvisibles||!u){var m=c!=o.index?s.slice(c,o.index):"";if(c=o.index+o[0].length,m&&l.appendChild(this.dom.createTextNode(m,this.element)),h){var g=this.session.getScreenTabSize(n+o.index);l.appendChild(this.$tabStrings[g].cloneNode(!0)),n+=g-1}else if(u)if(this.showInvisibles){var v=this.dom.createElement("span");v.className="ace_invisible ace_invisible_space",v.textContent=i.stringRepeat(this.SPACE_CHAR,u.length),l.appendChild(v)}else l.appendChild(this.com.createTextNode(u,this.element));else if(d){var v=this.dom.createElement("span");v.className="ace_invisible ace_invisible_space ace_invalid",v.textContent=i.stringRepeat(this.SPACE_CHAR,d.length),l.appendChild(v)}else if(f){this.showInvisibles&&this.SPACE_CHAR;n+=1;var v=this.dom.createElement("span");v.style.width=2*this.config.characterWidth+"px",v.className=this.showInvisibles?"ace_cjk ace_invisible ace_invisible_space":"ace_cjk",v.textContent=this.showInvisibles?this.SPACE_CHAR:"",l.appendChild(v)}else if(p){n+=1;var v=t.createElement("span");v.style.width=2*this.config.characterWidth+"px",v.className="ace_cjk",v.textContent=p,l.appendChild(v)}}}if(l.appendChild(this.dom.createTextNode(c?s.slice(c):s,this.element)),this.$textToken[r.type])e.appendChild(l);else{var y="ace_"+r.type.replace(/\./g," ace_"),v=this.dom.createElement("span");"fold"==r.type&&(v.style.width=r.value.length*this.config.characterWidth+"px"),v.className=y,v.appendChild(l),e.appendChild(v)}return n+s.length},this.renderIndentGuide=function(e,t,i){var n=t.search(this.$indentGuideRe);if(n<=0||n>=i)return t;if(" "==t[0]){for(var r=(n-=n%this.tabSize)/this.tabSize,s=0;s<r;s++)e.appendChild(this.$tabStrings[" "].cloneNode(!0));return t.substr(n)}if("\t"==t[0]){for(var s=0;s<n;s++)e.appendChild(this.$tabStrings["\t"].cloneNode(!0));return t.substr(n)}return t},this.$createLineElement=function(e){var t=this.dom.createElement("div");return t.className="ace_line",t.style.height=this.config.lineHeight+"px",t},this.$renderWrappedLine=function(e,t,n){var r=0,s=0,o=n[0],a=0,l=this.$createLineElement();e.appendChild(l);for(var c=0;c<t.length;c++){var h=t[c],u=h.value;if(0==c&&this.displayIndentGuides){if(r=u.length,!(u=this.renderIndentGuide(l,u,o)))continue;r-=u.length}if(r+u.length<o)a=this.$renderToken(l,a,h,u),r+=u.length;else{for(;r+u.length>=o;)a=this.$renderToken(l,a,h,u.substring(0,o-r)),u=u.substring(o-r),r=o,l=this.$createLineElement(),e.appendChild(l),l.appendChild(this.dom.createTextNode(i.stringRepeat(" ",n.indent),this.element)),a=0,o=n[++s]||Number.MAX_VALUE;0!=u.length&&(r+=u.length,a=this.$renderToken(l,a,h,u))}}},this.$renderSimpleLine=function(e,t){var i=0,n=t[0],r=n.value;this.displayIndentGuides&&(r=this.renderIndentGuide(e,r)),r&&(i=this.$renderToken(e,i,n,r));for(var s=1;s<t.length;s++){if(n=t[s],r=n.value,i+r.length>this.MAX_LINE_LENGTH)return this.$renderOverflowMessage(e,i,n,r);i=this.$renderToken(e,i,n,r)}},this.$renderOverflowMessage=function(e,t,i,n){this.$renderToken(e,t,i,n.slice(0,this.MAX_LINE_LENGTH-t));var r=this.dom.createElement("span");r.className="ace_inline_button ace_keyword ace_toggle_wrap",r.style.position="absolute",r.style.right="0",r.textContent="<click to see more...>",e.appendChild(r)},this.$renderLine=function(e,t,i){if(i||0==i||(i=this.session.getFoldLine(t)),i)var n=this.$getFoldLineTokens(t,i);else var n=this.session.getTokens(t);var r=e;if(n.length){var s=this.session.getRowSplitData(t);if(s&&s.length){this.$renderWrappedLine(e,n,s);var r=e.lastChild}else{var r=e;this.$useLineGroups()&&(r=this.$createLineElement(),e.appendChild(r)),this.$renderSimpleLine(r,n)}}else this.$useLineGroups()&&(r=this.$createLineElement(),e.appendChild(r));if(this.showInvisibles&&r){i&&(t=i.end.row);var o=this.dom.createElement("span");o.className="ace_invisible ace_invisible_eol",o.textContent=t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,r.appendChild(o)}},this.$getFoldLineTokens=function(e,t){var i=this.session,n=[];var r=i.getTokens(e);return t.walk(function(e,t,s,o,a){null!=e?n.push({type:"fold",value:e}):(a&&(r=i.getTokens(t)),r.length&&function(e,t,i){var r=0,s=0;for(;s+e[r].value.length<t;)if(s+=e[r].value.length,++r==e.length)return;if(s!=t){var o=e[r].value.substring(t-s);o.length>i-t&&(o=o.substring(0,i-t)),n.push({type:e[r].type,value:o}),s=t+o.length,r+=1}for(;s<i&&r<e.length;){var o=e[r].value;o.length+s>i?n.push({type:e[r].type,value:o.substring(0,i-s)}):n.push(e[r]),s+=o.length,r+=1}}(r,o,s))},t.end.row,this.session.getLine(t.end.row).length),n},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){}}).call(s.prototype),exports.Text=s}),define("skylark-ace/layer/cursor",["require","exports","module","../lib/dom"],function(require,exports,module){var e=require("../lib/dom"),t=function(t){this.element=e.createElement("div"),this.element.className="ace_layer ace_cursor-layer",t.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),e.addCssClass(this.element,"ace_hidden-cursors"),this.$updateCursors=this.$updateOpacity.bind(this)};(function(){this.$updateOpacity=function(t){for(var i=this.cursors,n=i.length;n--;)e.setStyle(i[n].style,"opacity",t?"":"0")},this.$startCssAnimation=function(){for(var t=this.cursors,i=t.length;i--;)t[i].style.animationDuration=this.blinkInterval+"ms";setTimeout(function(){e.addCssClass(this.element,"ace_animate-blinking")}.bind(this))},this.$stopCssAnimation=function(){e.removeCssClass(this.element,"ace_animate-blinking")},this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(t){t!=this.smoothBlinking&&(this.smoothBlinking=t,e.setCssClass(this.element,"ace_smooth-blinking",t),this.$updateCursors(!0),this.restartTimer())},this.addCursor=function(){var t=e.createElement("div");return t.className="ace_cursor",this.element.appendChild(t),this.cursors.push(t),t},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,e.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,e.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){var t=this.$updateCursors;if(clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.$stopCssAnimation(),this.smoothBlinking&&e.removeCssClass(this.element,"ace_smooth-blinking"),t(!0),this.isBlinking&&this.blinkInterval&&this.isVisible)if(this.smoothBlinking&&setTimeout(function(){e.addCssClass(this.element,"ace_smooth-blinking")}.bind(this)),e.HAS_CSS_ANIMATION)this.$startCssAnimation();else{var i=function(){this.timeoutId=setTimeout(function(){t(!1)},.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){t(!0),i()},this.blinkInterval),i()}else this.$stopCssAnimation()},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var i=this.session.documentToScreenPosition(e),n=this.$padding+(this.session.$bidiHandler.isBidiRow(i.row,e.row)?this.session.$bidiHandler.getPosLeft(i.column):i.column*this.config.characterWidth),r=(i.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight;return{left:n,top:r}},this.isCursorInView=function(e,t){return e.top>=0&&e.top<t.maxHeight},this.update=function(t){this.config=t;var i=this.session.$selectionMarkers,n=0,r=0;void 0!==i&&0!==i.length||(i=[{cursor:null}]);for(var n=0,s=i.length;n<s;n++){var o=this.getPixelPosition(i[n].cursor,!0);if(!((o.top>t.height+t.offset||o.top<0)&&n>1)){var a=this.cursors[r++]||this.addCursor(),l=a.style;this.drawCursor?this.drawCursor(a,o,t,i[n],this.session):this.isCursorInView(o,t)?(e.setStyle(l,"display","block"),e.translate(a,o.left,o.top),e.setStyle(l,"width",Math.round(t.characterWidth)+"px"),e.setStyle(l,"height",t.lineHeight+"px")):e.setStyle(l,"display","none")}}for(;this.cursors.length>r;)this.removeCursor();var c=this.session.getOverwrite();this.$setOverwrite(c),this.$pixelPos=o,this.restartTimer()},this.drawCursor=null,this.$setOverwrite=function(t){t!=this.overwrite&&(this.overwrite=t,t?e.addCssClass(this.element,"ace_overwrite-cursors"):e.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(t.prototype),exports.Cursor=t}),define("skylark-ace/scrollbar",["require","exports","module","./lib/oop","./lib/dom","./lib/event","./lib/event_emitter"],function(require,exports,module){var e=require("./lib/oop"),t=require("./lib/dom"),i=require("./lib/event"),n=require("./lib/event_emitter").EventEmitter,r=function(e){this.element=t.createElement("div"),this.element.className="ace_scrollbar ace_scrollbar"+this.classSuffix,this.inner=t.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),e.appendChild(this.element),this.setVisible(!1),this.skipEvent=!1,i.addListener(this.element,"scroll",this.onScroll.bind(this)),i.addListener(this.element,"mousedown",i.preventDefault)};(function(){e.implement(this,n),this.setVisible=function(e){this.element.style.display=e?"":"none",this.isVisible=e,this.coeff=1}}).call(r.prototype);var s=function(e,i){r.call(this,e),this.scrollTop=0,this.scrollHeight=0,i.$scrollbarWidth=this.width=t.scrollbarWidth(e.ownerDocument),this.inner.style.width=this.element.style.width=(this.width||15)+5+"px",this.$minWidth=0};e.inherits(s,r),function(){this.classSuffix="-v",this.onScroll=function(){if(!this.skipEvent){if(this.scrollTop=this.element.scrollTop,1!=this.coeff){var e=this.element.clientHeight/this.scrollHeight;this.scrollTop=this.scrollTop*(1-e)/(this.coeff-e)}this._emit("scroll",{data:this.scrollTop})}this.skipEvent=!1},this.getWidth=function(){return Math.max(this.isVisible?this.width:0,this.$minWidth||0)},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=this.setScrollHeight=function(e){this.scrollHeight=e,e>32768?(this.coeff=32768/e,e=32768):1!=this.coeff&&(this.coeff=1),this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=e,this.element.scrollTop=e*this.coeff)}}.call(s.prototype);var o=function(e,t){r.call(this,e),this.scrollLeft=0,this.height=t.$scrollbarWidth,this.inner.style.height=this.element.style.height=(this.height||15)+5+"px"};e.inherits(o,r),function(){this.classSuffix="-h",this.onScroll=function(){this.skipEvent||(this.scrollLeft=this.element.scrollLeft,this._emit("scroll",{data:this.scrollLeft})),this.skipEvent=!1},this.getHeight=function(){return this.isVisible?this.height:0},this.setWidth=function(e){this.element.style.width=e+"px"},this.setInnerWidth=function(e){this.inner.style.width=e+"px"},this.setScrollWidth=function(e){this.inner.style.width=e+"px"},this.setScrollLeft=function(e){this.scrollLeft!=e&&(this.skipEvent=!0,this.scrollLeft=this.element.scrollLeft=e)}}.call(o.prototype),exports.ScrollBar=s,exports.ScrollBarV=s,exports.ScrollBarH=o,exports.VScrollBar=s,exports.HScrollBar=o}),define("skylark-ace/renderloop",["require","exports","module","./lib/event"],function(require,exports,module){var e=require("./lib/event"),t=function(t,i){this.onRender=t,this.pending=!1,this.changes=0,this.$recursionLimit=2,this.window=i||window;var n=this;this._flush=function(t){n.pending=!1;var i=n.changes;if(i&&(e.blockIdle(100),n.changes=0,n.onRender(i)),n.changes){if(n.$recursionLimit--<0)return;n.schedule()}else n.$recursionLimit=2}};(function(){this.schedule=function(t){this.changes=this.changes|t,this.changes&&!this.pending&&(e.nextFrame(this._flush),this.pending=!0)},this.clear=function(e){var t=this.changes;return this.changes=0,t}}).call(t.prototype),exports.RenderLoop=t}),define("skylark-ace/layer/font_metrics",["require","exports","module","../lib/oop","../lib/dom","../lib/lang","../lib/event","../lib/useragent","../lib/event_emitter"],function(require,exports,module){var e=require("../lib/oop"),t=require("../lib/dom"),i=require("../lib/lang"),n=require("../lib/event"),r=require("../lib/useragent"),s=require("../lib/event_emitter").EventEmitter,o="function"==typeof ResizeObserver,a=200,l=exports.FontMetrics=function(e){this.el=t.createElement("div"),this.$setMeasureNodeStyles(this.el.style,!0),this.$main=t.createElement("div"),this.$setMeasureNodeStyles(this.$main.style),this.$measureNode=t.createElement("div"),this.$setMeasureNodeStyles(this.$measureNode.style),this.el.appendChild(this.$main),this.el.appendChild(this.$measureNode),e.appendChild(this.el),this.$measureNode.innerHTML=i.stringRepeat("X",256),this.$characterSize={width:0,height:0},o?this.$addObserver():this.checkForSizeChanges()};(function(){e.implement(this,s),this.$characterSize={width:0,height:0},this.$setMeasureNodeStyles=function(e,t){e.width=e.height="auto",e.left=e.top="0px",e.visibility="hidden",e.position="absolute",e.whiteSpace="pre",r.isIE<8?e["font-family"]="inherit":e.font="inherit",e.overflow=t?"hidden":"visible"},this.checkForSizeChanges=function(e){if(void 0===e&&(e=this.$measureSizes()),e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.charSizes=Object.create(null),this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$addObserver=function(){var e=this;this.$observer=new window.ResizeObserver(function(t){var i=t[0].contentRect;e.checkForSizeChanges({height:i.height,width:i.width/256})}),this.$observer.observe(this.$measureNode)},this.$pollSizeChanges=function(){if(this.$pollSizeChangesTimer||this.$observer)return this.$pollSizeChangesTimer;var e=this;return this.$pollSizeChangesTimer=n.onIdle(function t(){e.checkForSizeChanges(),n.onIdle(t,500)},500)},this.setPolling=function(e){e?this.$pollSizeChanges():this.$pollSizeChangesTimer&&(clearInterval(this.$pollSizeChangesTimer),this.$pollSizeChangesTimer=0)},this.$measureSizes=function(e){var t={height:(e||this.$measureNode).clientHeight,width:(e||this.$measureNode).clientWidth/256};return 0===t.width||0===t.height?null:t},this.$measureCharWidth=function(e){this.$main.innerHTML=i.stringRepeat(e,256);var t=this.$main.getBoundingClientRect();return t.width/256},this.getCharacterWidth=function(e){var t=this.charSizes[e];return void 0===t&&(t=this.charSizes[e]=this.$measureCharWidth(e)/this.$characterSize.width),t},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$observer&&this.$observer.disconnect(),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},this.$getZoom=function e(t){return t?(window.getComputedStyle(t).zoom||1)*e(t.parentElement):1},this.$initTransformMeasureNodes=function(){var e=function(e,t){return["div",{style:"position: absolute;top:"+e+"px;left:"+t+"px;"}]};this.els=t.buildDom([e(0,0),e(a,0),e(0,a),e(a,a)],this.el)},this.transformCoordinates=function(e,t){if(e){var i=this.$getZoom(this.el);e=o(1/i,e)}function n(e,t,i){var n=e[1]*t[0]-e[0]*t[1];return[(-t[1]*i[0]+t[0]*i[1])/n,(+e[1]*i[0]-e[0]*i[1])/n]}function r(e,t){return[e[0]-t[0],e[1]-t[1]]}function s(e,t){return[e[0]+t[0],e[1]+t[1]]}function o(e,t){return[e*t[0],e*t[1]]}function l(e){var t=e.getBoundingClientRect();return[t.left,t.top]}this.els||this.$initTransformMeasureNodes();var c=l(this.els[0]),h=l(this.els[1]),u=l(this.els[2]),d=l(this.els[3]),f=n(r(d,h),r(d,u),r(s(h,u),s(d,c))),p=o(1+f[0],r(h,c)),m=o(1+f[1],r(u,c));if(t){var g=t,v=f[0]*g[0]/a+f[1]*g[1]/a+1,y=s(o(g[0],p),o(g[1],m));return s(o(1/v/a,y),c)}var k=r(e,c),b=n(r(p,o(f[0],k)),r(m,o(f[1],k)),k);return o(a,b)}}).call(l.prototype)}),define("skylark-ace/css/editor.css",[],function(){return'/*\r\nstyles = []\r\nfor (var i = 1; i < 16; i++) {\r\n    styles.push(".ace_br" + i + "{" + (\r\n        ["top-left", "top-right", "bottom-right", "bottom-left"]\r\n    ).map(function(x, j) {\r\n        return i & (1<<j) ? "border-" + x + "-radius: 3px;" : "" \r\n    }).filter(Boolean).join(" ") + "}")\r\n}\r\nstyles.join("\\n")\r\n*/\r\n.ace_br1 {border-top-left-radius    : 3px;}\r\n.ace_br2 {border-top-right-radius   : 3px;}\r\n.ace_br3 {border-top-left-radius    : 3px; border-top-right-radius:    3px;}\r\n.ace_br4 {border-bottom-right-radius: 3px;}\r\n.ace_br5 {border-top-left-radius    : 3px; border-bottom-right-radius: 3px;}\r\n.ace_br6 {border-top-right-radius   : 3px; border-bottom-right-radius: 3px;}\r\n.ace_br7 {border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px;}\r\n.ace_br8 {border-bottom-left-radius : 3px;}\r\n.ace_br9 {border-top-left-radius    : 3px; border-bottom-left-radius:  3px;}\r\n.ace_br10{border-top-right-radius   : 3px; border-bottom-left-radius:  3px;}\r\n.ace_br11{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-left-radius:  3px;}\r\n.ace_br12{border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\r\n.ace_br13{border-top-left-radius    : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\r\n.ace_br14{border-top-right-radius   : 3px; border-bottom-right-radius: 3px; border-bottom-left-radius:  3px;}\r\n.ace_br15{border-top-left-radius    : 3px; border-top-right-radius:    3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px;}\r\n\r\n\r\n.ace_editor {\r\n    position: relative;\r\n    overflow: hidden;\r\n    font: 12px/normal \'Monaco\', \'Menlo\', \'Ubuntu Mono\', \'Consolas\', \'source-code-pro\', monospace;\r\n    direction: ltr;\r\n    text-align: left;\r\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\r\n}\r\n\r\n.ace_scroller {\r\n    position: absolute;\r\n    overflow: hidden;\r\n    top: 0;\r\n    bottom: 0;\r\n    background-color: inherit;\r\n    -ms-user-select: none;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    cursor: text;\r\n}\r\n\r\n.ace_content {\r\n    position: absolute;\r\n    box-sizing: border-box;\r\n    min-width: 100%;\r\n    contain: style size layout;\r\n}\r\n\r\n.ace_dragging .ace_scroller:before{\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    content: \'\';\r\n    background: rgba(250, 250, 250, 0.01);\r\n    z-index: 1000;\r\n}\r\n.ace_dragging.ace_dark .ace_scroller:before{\r\n    background: rgba(0, 0, 0, 0.01);\r\n}\r\n\r\n.ace_selecting, .ace_selecting * {\r\n    cursor: text !important;\r\n}\r\n\r\n.ace_gutter {\r\n    position: absolute;\r\n    overflow : hidden;\r\n    width: auto;\r\n    top: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    cursor: default;\r\n    z-index: 4;\r\n    -ms-user-select: none;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    contain: style size layout;\r\n}\r\n\r\n.ace_gutter-active-line {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n}\r\n\r\n.ace_scroller.ace_scroll-left {\r\n    box-shadow: 17px 0 16px -16px rgba(0, 0, 0, 0.4) inset;\r\n}\r\n\r\n.ace_gutter-cell {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding-left: 19px;\r\n    padding-right: 6px;\r\n    background-repeat: no-repeat;\r\n}\r\n\r\n.ace_gutter-cell.ace_error {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABOFBMVEX/////////QRswFAb/Ui4wFAYwFAYwFAaWGAfDRymzOSH/PxswFAb/SiUwFAYwFAbUPRvjQiDllog5HhHdRybsTi3/Tyv9Tir+Syj/UC3////XurebMBIwFAb/RSHbPx/gUzfdwL3kzMivKBAwFAbbvbnhPx66NhowFAYwFAaZJg8wFAaxKBDZurf/RB6mMxb/SCMwFAYwFAbxQB3+RB4wFAb/Qhy4Oh+4QifbNRcwFAYwFAYwFAb/QRzdNhgwFAYwFAbav7v/Uy7oaE68MBK5LxLewr/r2NXewLswFAaxJw4wFAbkPRy2PyYwFAaxKhLm1tMwFAazPiQwFAaUGAb/QBrfOx3bvrv/VC/maE4wFAbRPBq6MRO8Qynew8Dp2tjfwb0wFAbx6eju5+by6uns4uH9/f36+vr/GkHjAAAAYnRSTlMAGt+64rnWu/bo8eAA4InH3+DwoN7j4eLi4xP99Nfg4+b+/u9B/eDs1MD1mO7+4PHg2MXa347g7vDizMLN4eG+Pv7i5evs/v79yu7S3/DV7/498Yv24eH+4ufQ3Ozu/v7+y13sRqwAAADLSURBVHjaZc/XDsFgGIBhtDrshlitmk2IrbHFqL2pvXf/+78DPokj7+Fz9qpU/9UXJIlhmPaTaQ6QPaz0mm+5gwkgovcV6GZzd5JtCQwgsxoHOvJO15kleRLAnMgHFIESUEPmawB9ngmelTtipwwfASilxOLyiV5UVUyVAfbG0cCPHig+GBkzAENHS0AstVF6bacZIOzgLmxsHbt2OecNgJC83JERmePUYq8ARGkJx6XtFsdddBQgZE2nPR6CICZhawjA4Fb/chv+399kfR+MMMDGOQAAAABJRU5ErkJggg==");\r\n    background-repeat: no-repeat;\r\n    background-position: 2px center;\r\n}\r\n\r\n.ace_gutter-cell.ace_warning {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAmVBMVEX///8AAAD///8AAAAAAABPSzb/5sAAAAB/blH/73z/ulkAAAAAAAD85pkAAAAAAAACAgP/vGz/rkDerGbGrV7/pkQICAf////e0IsAAAD/oED/qTvhrnUAAAD/yHD/njcAAADuv2r/nz//oTj/p064oGf/zHAAAAA9Nir/tFIAAAD/tlTiuWf/tkIAAACynXEAAAAAAAAtIRW7zBpBAAAAM3RSTlMAABR1m7RXO8Ln31Z36zT+neXe5OzooRDfn+TZ4p3h2hTf4t3k3ucyrN1K5+Xaks52Sfs9CXgrAAAAjklEQVR42o3PbQ+CIBQFYEwboPhSYgoYunIqqLn6/z8uYdH8Vmdnu9vz4WwXgN/xTPRD2+sgOcZjsge/whXZgUaYYvT8QnuJaUrjrHUQreGczuEafQCO/SJTufTbroWsPgsllVhq3wJEk2jUSzX3CUEDJC84707djRc5MTAQxoLgupWRwW6UB5fS++NV8AbOZgnsC7BpEAAAAABJRU5ErkJggg==");\r\n    background-position: 2px center;\r\n}\r\n\r\n.ace_gutter-cell.ace_info {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAAAAAA6mKC9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAJ0Uk5TAAB2k804AAAAPklEQVQY02NgIB68QuO3tiLznjAwpKTgNyDbMegwisCHZUETUZV0ZqOquBpXj2rtnpSJT1AEnnRmL2OgGgAAIKkRQap2htgAAAAASUVORK5CYII=");\r\n    background-position: 2px center;\r\n}\r\n.ace_dark .ace_gutter-cell.ace_info {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAJFBMVEUAAAChoaGAgIAqKiq+vr6tra1ZWVmUlJSbm5s8PDxubm56enrdgzg3AAAAAXRSTlMAQObYZgAAAClJREFUeNpjYMAPdsMYHegyJZFQBlsUlMFVCWUYKkAZMxZAGdxlDMQBAG+TBP4B6RyJAAAAAElFTkSuQmCC");\r\n}\r\n\r\n.ace_scrollbar {\r\n    contain: strict;\r\n    position: absolute;\r\n    right: 0;\r\n    bottom: 0;\r\n    z-index: 6;\r\n}\r\n\r\n.ace_scrollbar-inner {\r\n    position: absolute;\r\n    cursor: text;\r\n    left: 0;\r\n    top: 0;\r\n}\r\n\r\n.ace_scrollbar-v{\r\n    overflow-x: hidden;\r\n    overflow-y: scroll;\r\n    top: 0;\r\n}\r\n\r\n.ace_scrollbar-h {\r\n    overflow-x: scroll;\r\n    overflow-y: hidden;\r\n    left: 0;\r\n}\r\n\r\n.ace_print-margin {\r\n    position: absolute;\r\n    height: 100%;\r\n}\r\n\r\n.ace_text-input {\r\n    position: absolute;\r\n    z-index: 0;\r\n    width: 0.5em;\r\n    height: 1em;\r\n    opacity: 0;\r\n    background: transparent;\r\n    -moz-appearance: none;\r\n    appearance: none;\r\n    border: none;\r\n    resize: none;\r\n    outline: none;\r\n    overflow: hidden;\r\n    font: inherit;\r\n    padding: 0 1px;\r\n    margin: 0 -1px;\r\n    contain: strict;\r\n    -ms-user-select: text;\r\n    -moz-user-select: text;\r\n    -webkit-user-select: text;\r\n    user-select: text;\r\n    /*with `pre-line` chrome inserts &nbsp; instead of space*/\r\n    white-space: pre!important;\r\n}\r\n.ace_text-input.ace_composition {\r\n    background: transparent;\r\n    color: inherit;\r\n    z-index: 1000;\r\n    opacity: 1;\r\n}\r\n.ace_composition_placeholder { color: transparent }\r\n.ace_composition_marker { \r\n    border-bottom: 1px solid;\r\n    position: absolute;\r\n    border-radius: 0;\r\n    margin-top: 1px;\r\n}\r\n\r\n[ace_nocontext=true] {\r\n    transform: none!important;\r\n    filter: none!important;\r\n    perspective: none!important;\r\n    clip-path: none!important;\r\n    mask : none!important;\r\n    contain: none!important;\r\n    perspective: none!important;\r\n    mix-blend-mode: initial!important;\r\n    z-index: auto;\r\n}\r\n\r\n.ace_layer {\r\n    z-index: 1;\r\n    position: absolute;\r\n    overflow: hidden;\r\n    /* workaround for chrome bug https://github.com/ajaxorg/ace/issues/2312*/\r\n    word-wrap: normal;\r\n    white-space: pre;\r\n    height: 100%;\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    /* setting pointer-events: auto; on node under the mouse, which changes\r\n        during scroll, will break mouse wheel scrolling in Safari */\r\n    pointer-events: none;\r\n}\r\n\r\n.ace_gutter-layer {\r\n    position: relative;\r\n    width: auto;\r\n    text-align: right;\r\n    pointer-events: auto;\r\n    height: 1000000px;\r\n    contain: style size layout;\r\n}\r\n\r\n.ace_text-layer {\r\n    font: inherit !important;\r\n    position: absolute;\r\n    height: 1000000px;\r\n    width: 1000000px;\r\n    contain: style size layout;\r\n}\r\n\r\n.ace_text-layer > .ace_line, .ace_text-layer > .ace_line_group {\r\n    contain: style size layout;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n}\r\n\r\n.ace_hidpi .ace_text-layer,\r\n.ace_hidpi .ace_gutter-layer,\r\n.ace_hidpi .ace_content,\r\n.ace_hidpi .ace_gutter {\r\n    contain: strict;\r\n    will-change: transform;\r\n}\r\n.ace_hidpi .ace_text-layer > .ace_line, \r\n.ace_hidpi .ace_text-layer > .ace_line_group {\r\n    contain: strict;\r\n}\r\n\r\n.ace_cjk {\r\n    display: inline-block;\r\n    text-align: center;\r\n}\r\n\r\n.ace_cursor-layer {\r\n    z-index: 4;\r\n}\r\n\r\n.ace_cursor {\r\n    z-index: 4;\r\n    position: absolute;\r\n    box-sizing: border-box;\r\n    border-left: 2px solid;\r\n    /* workaround for smooth cursor repaintng whole screen in chrome */\r\n    transform: translatez(0);\r\n}\r\n\r\n.ace_multiselect .ace_cursor {\r\n    border-left-width: 1px;\r\n}\r\n\r\n.ace_slim-cursors .ace_cursor {\r\n    border-left-width: 1px;\r\n}\r\n\r\n.ace_overwrite-cursors .ace_cursor {\r\n    border-left-width: 0;\r\n    border-bottom: 1px solid;\r\n}\r\n\r\n.ace_hidden-cursors .ace_cursor {\r\n    opacity: 0.2;\r\n}\r\n\r\n.ace_smooth-blinking .ace_cursor {\r\n    transition: opacity 0.18s;\r\n}\r\n\r\n.ace_animate-blinking .ace_cursor {\r\n    animation-duration: 1000ms;\r\n    animation-timing-function: step-end;\r\n    animation-name: blink-ace-animate;\r\n    animation-iteration-count: infinite;\r\n}\r\n\r\n.ace_animate-blinking.ace_smooth-blinking .ace_cursor {\r\n    animation-duration: 1000ms;\r\n    animation-timing-function: ease-in-out;\r\n    animation-name: blink-ace-animate-smooth;\r\n}\r\n    \r\n@keyframes blink-ace-animate {\r\n    from, to { opacity: 1; }\r\n    60% { opacity: 0; }\r\n}\r\n\r\n@keyframes blink-ace-animate-smooth {\r\n    from, to { opacity: 1; }\r\n    45% { opacity: 1; }\r\n    60% { opacity: 0; }\r\n    85% { opacity: 0; }\r\n}\r\n\r\n.ace_marker-layer .ace_step, .ace_marker-layer .ace_stack {\r\n    position: absolute;\r\n    z-index: 3;\r\n}\r\n\r\n.ace_marker-layer .ace_selection {\r\n    position: absolute;\r\n    z-index: 5;\r\n}\r\n\r\n.ace_marker-layer .ace_bracket {\r\n    position: absolute;\r\n    z-index: 6;\r\n}\r\n\r\n.ace_marker-layer .ace_active-line {\r\n    position: absolute;\r\n    z-index: 2;\r\n}\r\n\r\n.ace_marker-layer .ace_selected-word {\r\n    position: absolute;\r\n    z-index: 4;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.ace_line .ace_fold {\r\n    box-sizing: border-box;\r\n\r\n    display: inline-block;\r\n    height: 11px;\r\n    margin-top: -2px;\r\n    vertical-align: middle;\r\n\r\n    background-image:\r\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),\r\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACJJREFUeNpi+P//fxgTAwPDBxDxD078RSX+YeEyDFMCIMAAI3INmXiwf2YAAAAASUVORK5CYII=");\r\n    background-repeat: no-repeat, repeat-x;\r\n    background-position: center center, top left;\r\n    color: transparent;\r\n\r\n    border: 1px solid black;\r\n    border-radius: 2px;\r\n\r\n    cursor: pointer;\r\n    pointer-events: auto;\r\n}\r\n\r\n.ace_dark .ace_fold {\r\n}\r\n\r\n.ace_fold:hover{\r\n    background-image:\r\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAJCAYAAADU6McMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJpJREFUeNpi/P//PwOlgAXGYGRklAVSokD8GmjwY1wasKljQpYACtpCFeADcHVQfQyMQAwzwAZI3wJKvCLkfKBaMSClBlR7BOQikCFGQEErIH0VqkabiGCAqwUadAzZJRxQr/0gwiXIal8zQQPnNVTgJ1TdawL0T5gBIP1MUJNhBv2HKoQHHjqNrA4WO4zY0glyNKLT2KIfIMAAQsdgGiXvgnYAAAAASUVORK5CYII="),\r\n        url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAA3CAYAAADNNiA5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAACBJREFUeNpi+P//fz4TAwPDZxDxD5X4i5fLMEwJgAADAEPVDbjNw87ZAAAAAElFTkSuQmCC");\r\n}\r\n\r\n.ace_tooltip {\r\n    background-color: #FFF;\r\n    background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.1));\r\n    border: 1px solid gray;\r\n    border-radius: 1px;\r\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\r\n    color: black;\r\n    max-width: 100%;\r\n    padding: 3px 4px;\r\n    position: fixed;\r\n    z-index: 999999;\r\n    box-sizing: border-box;\r\n    cursor: default;\r\n    white-space: pre;\r\n    word-wrap: break-word;\r\n    line-height: normal;\r\n    font-style: normal;\r\n    font-weight: normal;\r\n    letter-spacing: normal;\r\n    pointer-events: none;\r\n}\r\n\r\n.ace_folding-enabled > .ace_gutter-cell {\r\n    padding-right: 13px;\r\n}\r\n\r\n.ace_fold-widget {\r\n    box-sizing: border-box;\r\n\r\n    margin: 0 -12px 0 1px;\r\n    display: none;\r\n    width: 11px;\r\n    vertical-align: top;\r\n\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42mWKsQ0AMAzC8ixLlrzQjzmBiEjp0A6WwBCSPgKAXoLkqSot7nN3yMwR7pZ32NzpKkVoDBUxKAAAAABJRU5ErkJggg==");\r\n    background-repeat: no-repeat;\r\n    background-position: center;\r\n\r\n    border-radius: 3px;\r\n    \r\n    border: 1px solid transparent;\r\n    cursor: pointer;\r\n}\r\n\r\n.ace_folding-enabled .ace_fold-widget {\r\n    display: inline-block;   \r\n}\r\n\r\n.ace_fold-widget.ace_end {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAANElEQVR42m3HwQkAMAhD0YzsRchFKI7sAikeWkrxwScEB0nh5e7KTPWimZki4tYfVbX+MNl4pyZXejUO1QAAAABJRU5ErkJggg==");\r\n}\r\n\r\n.ace_fold-widget.ace_closed {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAGCAYAAAAG5SQMAAAAOUlEQVR42jXKwQkAMAgDwKwqKD4EwQ26sSOkVWjgIIHAzPiCgaqiqnJHZnKICBERHN194O5b9vbLuAVRL+l0YWnZAAAAAElFTkSuQmCCXA==");\r\n}\r\n\r\n.ace_fold-widget:hover {\r\n    border: 1px solid rgba(0, 0, 0, 0.3);\r\n    background-color: rgba(255, 255, 255, 0.2);\r\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.7);\r\n}\r\n\r\n.ace_fold-widget:active {\r\n    border: 1px solid rgba(0, 0, 0, 0.4);\r\n    background-color: rgba(0, 0, 0, 0.05);\r\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.8);\r\n}\r\n/**\r\n * Dark version for fold widgets\r\n */\r\n.ace_dark .ace_fold-widget {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHklEQVQIW2P4//8/AzoGEQ7oGCaLLAhWiSwB146BAQCSTPYocqT0AAAAAElFTkSuQmCC");\r\n}\r\n.ace_dark .ace_fold-widget.ace_end {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAH0lEQVQIW2P4//8/AxQ7wNjIAjDMgC4AxjCVKBirIAAF0kz2rlhxpAAAAABJRU5ErkJggg==");\r\n}\r\n.ace_dark .ace_fold-widget.ace_closed {\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAFCAYAAACAcVaiAAAAHElEQVQIW2P4//+/AxAzgDADlOOAznHAKgPWAwARji8UIDTfQQAAAABJRU5ErkJggg==");\r\n}\r\n.ace_dark .ace_fold-widget:hover {\r\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\r\n    background-color: rgba(255, 255, 255, 0.1);\r\n}\r\n.ace_dark .ace_fold-widget:active {\r\n    box-shadow: 0 1px 1px rgba(255, 255, 255, 0.2);\r\n}\r\n\r\n.ace_inline_button {\r\n    border: 1px solid lightgray;\r\n    display: inline-block;\r\n    margin: -1px 8px;\r\n    padding: 0 5px;\r\n    pointer-events: auto;\r\n    cursor: pointer;\r\n}\r\n.ace_inline_button:hover {\r\n    border-color: gray;\r\n    background: rgba(200,200,200,0.2);\r\n    display: inline-block;\r\n    pointer-events: auto;\r\n}\r\n\r\n.ace_fold-widget.ace_invalid {\r\n    background-color: #FFB4B4;\r\n    border-color: #DE5555;\r\n}\r\n\r\n.ace_fade-fold-widgets .ace_fold-widget {\r\n    transition: opacity 0.4s ease 0.05s;\r\n    opacity: 0;\r\n}\r\n\r\n.ace_fade-fold-widgets:hover .ace_fold-widget {\r\n    transition: opacity 0.05s ease 0.05s;\r\n    opacity:1;\r\n}\r\n\r\n.ace_underline {\r\n    text-decoration: underline;\r\n}\r\n\r\n.ace_bold {\r\n    font-weight: bold;\r\n}\r\n\r\n.ace_nobold .ace_bold {\r\n    font-weight: normal;\r\n}\r\n\r\n.ace_italic {\r\n    font-style: italic;\r\n}\r\n\r\n\r\n.ace_error-marker {\r\n    background-color: rgba(255, 0, 0,0.2);\r\n    position: absolute;\r\n    z-index: 9;\r\n}\r\n\r\n.ace_highlight-marker {\r\n    background-color: rgba(255, 255, 0,0.2);\r\n    position: absolute;\r\n    z-index: 8;\r\n}\r\n'}),define("skylark-ace/virtual_renderer",["require","exports","module","./lib/oop","./lib/dom","./config","./layer/gutter","./layer/marker","./layer/text","./layer/cursor","./scrollbar","./scrollbar","./renderloop","./layer/font_metrics","./lib/event_emitter","./css/editor.css","./lib/useragent"],function(require,exports,module){var e=require("./lib/oop"),t=require("./lib/dom"),i=require("./config"),n=require("./layer/gutter").Gutter,r=require("./layer/marker").Marker,s=require("./layer/text").Text,o=require("./layer/cursor").Cursor,a=require("./scrollbar").HScrollBar,l=require("./scrollbar").VScrollBar,c=require("./renderloop").RenderLoop,h=require("./layer/font_metrics").FontMetrics,u=require("./lib/event_emitter").EventEmitter,d=require("./css/editor.css"),f=require("./lib/useragent"),p=f.isIE;t.importCssString(d,"ace_editor.css");var m=function(e,u){var d=this;this.container=e||t.createElement("div"),t.addCssClass(this.container,"ace_editor"),t.HI_DPI&&t.addCssClass(this.container,"ace_hidpi"),this.setTheme(u),this.$gutter=t.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.$gutter.setAttribute("aria-hidden",!0),this.scroller=t.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=t.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new n(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new r(this.content);var p=this.$textLayer=new s(this.content);this.canvas=p.element,this.$markerFront=new r(this.content),this.$cursorLayer=new o(this.content),this.$horizScroll=!1,this.$vScroll=!1,this.scrollBar=this.scrollBarV=new l(this.container,this),this.scrollBarH=new a(this.container,this),this.scrollBarV.addEventListener("scroll",function(e){d.$scrollAnimation||d.session.setScrollTop(e.data-d.scrollMargin.top)}),this.scrollBarH.addEventListener("scroll",function(e){d.$scrollAnimation||d.session.setScrollLeft(e.data-d.scrollMargin.left)}),this.scrollTop=0,this.scrollLeft=0,this.cursorPos={row:0,column:0},this.$fontMetrics=new h(this.container),this.$textLayer.$setFontMetrics(this.$fontMetrics),this.$textLayer.addEventListener("changeCharacterSize",function(e){d.updateCharacterSize(),d.onResize(!0,d.gutterWidth,d.$size.width,d.$size.height),d._signal("changeCharacterSize",e)}),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0,$dirty:!0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:0,characterWidth:0,minHeight:1,maxHeight:1,offset:0,height:1,gutterOffset:1},this.scrollMargin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.margin={left:0,right:0,top:0,bottom:0,v:0,h:0},this.$keepTextAreaAtCursor=!f.isIOS,this.$loop=new c(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),i.resetOptions(this),i._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,e.implement(this,u),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.layerConfig.characterWidth=this.characterWidth=this.$textLayer.getCharacterWidth(),this.layerConfig.lineHeight=this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(e){this.session&&this.session.doc.off("changeNewLineMode",this.onChangeNewLineMode),this.session=e,e&&this.scrollMargin.top&&e.getScrollTop()<=0&&e.setScrollTop(-this.scrollMargin.top),this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),e&&(this.$loop.schedule(this.CHANGE_FULL),this.session.$setFontMetrics(this.$fontMetrics),this.scrollBarH.scrollLeft=this.scrollBarV.scrollTop=null,this.onChangeNewLineMode=this.onChangeNewLineMode.bind(this),this.onChangeNewLineMode(),this.session.doc.on("changeNewLineMode",this.onChangeNewLineMode))},this.updateLines=function(e,t,i){if(void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.lastRow<this.layerConfig.firstRow){if(!i)return;this.$changedLines.lastRow=this.layerConfig.lastRow}this.$changedLines.firstRow>this.layerConfig.lastRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeNewLineMode=function(){this.$loop.schedule(this.CHANGE_TEXT),this.$textLayer.$updateEolChar(),this.session.$bidiHandler.setEolChar(this.$textLayer.EOL_CHAR)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.$changes=0,this.$updateSizeAsync=function(){this.$loop.pending?this.$size.$dirty=!0:this.onResize()},this.onResize=function(e,t,i,n){if(!(this.resizing>2)){this.resizing>0?this.resizing++:this.resizing=e?1:0;var r=this.container;n||(n=r.clientHeight||r.scrollHeight),i||(i=r.clientWidth||r.scrollWidth);var s=this.$updateCachedSize(e,t,i,n);if(!this.$size.scrollerHeight||!i&&!n)return this.resizing=0;e&&(this.$gutterLayer.$padding=null),e?this.$renderChanges(s|this.$changes,!0):this.$loop.schedule(s|this.$changes),this.resizing&&(this.resizing=0),this.scrollBarV.scrollLeft=this.scrollBarV.scrollTop=null}},this.$updateCachedSize=function(e,i,n,r){r-=this.$extraHeight||0;var s=0,o=this.$size,a={width:o.width,height:o.height,scrollerHeight:o.scrollerHeight,scrollerWidth:o.scrollerWidth};if(r&&(e||o.height!=r)&&(o.height=r,s|=this.CHANGE_SIZE,o.scrollerHeight=o.height,this.$horizScroll&&(o.scrollerHeight-=this.scrollBarH.getHeight()),this.scrollBarV.element.style.bottom=this.scrollBarH.getHeight()+"px",s|=this.CHANGE_SCROLL),n&&(e||o.width!=n)){s|=this.CHANGE_SIZE,o.width=n,null==i&&(i=this.$showGutter?this.$gutter.offsetWidth:0),this.gutterWidth=i,t.setStyle(this.scrollBarH.element.style,"left",i+"px"),t.setStyle(this.scroller.style,"left",i+this.margin.left+"px"),o.scrollerWidth=Math.max(0,n-i-this.scrollBarV.getWidth()-this.margin.h),t.setStyle(this.$gutter.style,"left",this.margin.left+"px");var l=this.scrollBarV.getWidth()+"px";t.setStyle(this.scrollBarH.element.style,"right",l),t.setStyle(this.scroller.style,"right",l),t.setStyle(this.scroller.style,"bottom",this.scrollBarH.getHeight()),(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(s|=this.CHANGE_FULL)}return o.$dirty=!n||!r,s&&this._signal("resize",a),s},this.onGutterResize=function(e){var t=this.$showGutter?e:0;t!=this.gutterWidth&&(this.$changes|=this.$updateCachedSize(!0,t,this.$size.width,this.$size.height)),this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$size.$dirty?this.$loop.schedule(this.CHANGE_FULL):this.$computeLayerConfig()},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e),this.session.$bidiHandler.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=t.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=t.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var i=this.$printMarginEl.style;i.left=Math.round(this.characterWidth*this.$printMarginColumn+this.$padding)+"px",i.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.scroller},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){var e=this.textarea.style;if(this.$keepTextAreaAtCursor){var i=this.$cursorLayer.$pixelPos;if(i){var n=this.$composition;n&&n.markerRange&&(i=this.$cursorLayer.getPixelPosition(n.markerRange.start,!0));var r=this.layerConfig,s=i.top,o=i.left;s-=r.offset;var a=n&&n.useTextareaForIME?this.lineHeight:p?0:1;if(s<0||s>r.height-a)t.translate(this.textarea,0,0);else{var l=1;if(n)if(n.useTextareaForIME){var c=this.textarea.value;l=this.characterWidth*this.session.$getStringScreenWidth(c)[0],a+=2}else s+=this.lineHeight+2;else s+=this.lineHeight;(o-=this.scrollLeft)>this.$size.scrollerWidth-l&&(o=this.$size.scrollerWidth-l),o+=this.gutterWidth+this.margin.left,t.setStyle(e,"height",a+"px"),t.setStyle(e,"width",l+"px"),t.translate(this.textarea,Math.min(o,this.$size.scrollerWidth-l),Math.min(s,this.$size.height-a))}}}else t.translate(this.textarea,-100,0)},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=this.layerConfig,t=e.lastRow,i=this.session.documentToScreenRow(t,0)*e.lineHeight;return i-this.session.getScrollTop()>e.height-e.lineHeight?t-1:t},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.setScrollMargin=function(e,t,i,n){var r=this.scrollMargin;r.top=0|e,r.bottom=0|t,r.right=0|n,r.left=0|i,r.v=r.top+r.bottom,r.h=r.left+r.right,r.top&&this.scrollTop<=0&&this.session&&this.session.setScrollTop(-r.top),this.updateFull()},this.setMargin=function(e,t,i,n){var r=this.margin;r.top=0|e,r.bottom=0|t,r.right=0|n,r.left=0|i,r.v=r.top+r.bottom,r.h=r.left+r.right,this.$updateCachedSize(!0,this.gutterWidth,this.$size.width,this.$size.height),this.updateFull()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.getVScrollBarAlwaysVisible=function(){return this.$vScrollBarAlwaysVisible},this.setVScrollBarAlwaysVisible=function(e){this.setOption("vScrollBarAlwaysVisible",e)},this.$updateScrollBarV=function(){var e=this.layerConfig.maxHeight,t=this.$size.scrollerHeight;!this.$maxLines&&this.$scrollPastEnd&&(e-=(t-this.lineHeight)*this.$scrollPastEnd,this.scrollTop>e-t&&(e=this.scrollTop+t,this.scrollBarV.scrollTop=null)),this.scrollBarV.setScrollHeight(e+this.scrollMargin.v),this.scrollBarV.setScrollTop(this.scrollTop+this.scrollMargin.top)},this.$updateScrollBarH=function(){this.scrollBarH.setScrollWidth(this.layerConfig.width+2*this.$padding+this.scrollMargin.h),this.scrollBarH.setScrollLeft(this.scrollLeft+this.scrollMargin.left)},this.$frozen=!1,this.freeze=function(){this.$frozen=!0},this.unfreeze=function(){this.$frozen=!1},this.$renderChanges=function(e,i){if(this.$changes&&(e|=this.$changes,this.$changes=0),this.session&&this.container.offsetWidth&&!this.$frozen&&(e||i)){if(this.$size.$dirty)return this.$changes|=e,this.onResize(!0);this.lineHeight||this.$textLayer.checkForSizeChanges(),this._signal("beforeRender"),this.session&&this.session.$bidiHandler&&this.session.$bidiHandler.updateCharacterWidths(this.$fontMetrics);var n=this.layerConfig;if(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL||e&this.CHANGE_H_SCROLL){if(e|=this.$computeLayerConfig()|this.$loop.clear(),n.firstRow!=this.layerConfig.firstRow&&n.firstRowScreen==this.layerConfig.firstRowScreen){var r=this.scrollTop+(n.firstRow-this.layerConfig.firstRow)*this.lineHeight;r>0&&(this.scrollTop=r,e|=this.CHANGE_SCROLL,e|=this.$computeLayerConfig()|this.$loop.clear())}n=this.layerConfig,this.$updateScrollBarV(),e&this.CHANGE_H_SCROLL&&this.$updateScrollBarH(),t.translate(this.content,-this.scrollLeft,-n.offset);var s=n.width+2*this.$padding+"px",o=n.minHeight+"px";t.setStyle(this.content.style,"width",s),t.setStyle(this.content.style,"height",o)}if(e&this.CHANGE_H_SCROLL&&(t.translate(this.content,-this.scrollLeft,-n.offset),this.scroller.className=this.scrollLeft<=0?"ace_scroller":"ace_scroller ace_scroll-left"),e&this.CHANGE_FULL)return this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender");if(e&this.CHANGE_SCROLL)return e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(n):this.$textLayer.scrollLines(n),this.$showGutter&&(e&this.CHANGE_GUTTER||e&this.CHANGE_LINES?this.$gutterLayer.update(n):this.$gutterLayer.scrollLines(n)),this.$markerBack.update(n),this.$markerFront.update(n),this.$cursorLayer.update(n),this.$moveTextAreaToCursor(),void this._signal("afterRender");e&this.CHANGE_TEXT?(this.$textLayer.update(n),this.$showGutter&&this.$gutterLayer.update(n)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(n):e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER?this.$showGutter&&this.$gutterLayer.update(n):e&this.CHANGE_CURSOR&&this.$highlightGutterLine&&this.$gutterLayer.updateLineHighlight(n),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(n),this.$moveTextAreaToCursor()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(n),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(n),this._signal("afterRender")}else this.$changes|=e},this.$autosize=function(){var e=this.session.getScreenLength()*this.lineHeight,t=this.$maxLines*this.lineHeight,i=Math.min(t,Math.max((this.$minLines||1)*this.lineHeight,e))+this.scrollMargin.v+(this.$extraHeight||0);this.$horizScroll&&(i+=this.scrollBarH.getHeight()),this.$maxPixelHeight&&i>this.$maxPixelHeight&&(i=this.$maxPixelHeight);var n=i<=2*this.lineHeight,r=!n&&e>t;if(i!=this.desiredHeight||this.$size.height!=this.desiredHeight||r!=this.$vScroll){r!=this.$vScroll&&(this.$vScroll=r,this.scrollBarV.setVisible(r));var s=this.container.clientWidth;this.container.style.height=i+"px",this.$updateCachedSize(!0,this.$gutterWidth,s,i),this.desiredHeight=i,this._signal("autosize")}},this.$computeLayerConfig=function(){var e=this.session,t=this.$size,i=t.height<=2*this.lineHeight,n=this.session.getScreenLength(),r=n*this.lineHeight,s=this.$getLongestLine(),o=!i&&(this.$hScrollBarAlwaysVisible||t.scrollerWidth-s-2*this.$padding<0),a=this.$horizScroll!==o;a&&(this.$horizScroll=o,this.scrollBarH.setVisible(o));var l=this.$vScroll;this.$maxLines&&this.lineHeight>1&&this.$autosize();var c=t.scrollerHeight+this.lineHeight,h=!this.$maxLines&&this.$scrollPastEnd?(t.scrollerHeight-this.lineHeight)*this.$scrollPastEnd:0;r+=h;var u=this.scrollMargin;this.session.setScrollTop(Math.max(-u.top,Math.min(this.scrollTop,r-t.scrollerHeight+u.bottom))),this.session.setScrollLeft(Math.max(-u.left,Math.min(this.scrollLeft,s+2*this.$padding-t.scrollerWidth+u.right)));var d=!i&&(this.$vScrollBarAlwaysVisible||t.scrollerHeight-r+h<0||this.scrollTop>u.top),f=l!==d;f&&(this.$vScroll=d,this.scrollBarV.setVisible(d));var p,m,g=this.scrollTop%this.lineHeight,v=Math.ceil(c/this.lineHeight)-1,y=Math.max(0,Math.round((this.scrollTop-g)/this.lineHeight)),k=y+v,b=this.lineHeight;y=e.screenToDocumentRow(y,0);var x=e.getFoldLine(y);x&&(y=x.start.row),p=e.documentToScreenRow(y,0),m=e.getRowLength(y)*b,k=Math.min(e.screenToDocumentRow(k,0),e.getLength()-1),c=t.scrollerHeight+e.getRowLength(k)*b+m,g=this.scrollTop-p*b;var w=0;return(this.layerConfig.width!=s||a)&&(w=this.CHANGE_H_SCROLL),(a||f)&&(w=this.$updateCachedSize(!0,this.gutterWidth,t.width,t.height),this._signal("scrollbarVisibilityChanged"),f&&(s=this.$getLongestLine())),this.layerConfig={width:s,padding:this.$padding,firstRow:y,firstRowScreen:p,lastRow:k,lineHeight:b,characterWidth:this.characterWidth,minHeight:c,maxHeight:r,offset:g,gutterOffset:b?Math.max(0,Math.ceil((g+t.height-t.scrollerHeight)/b)):0,height:this.$size.scrollerHeight},this.session.$bidiHandler&&this.session.$bidiHandler.setContentWidth(s-this.$padding),w},this.$updateLines=function(){if(this.$changedLines){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var i=this.layerConfig;if(!(e>i.lastRow+1||t<i.firstRow))return t===1/0?(this.$showGutter&&this.$gutterLayer.update(i),void this.$textLayer.update(i)):(this.$textLayer.updateLines(i,e,t),!0)}},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.showInvisibles&&!this.session.$useWrapMode&&(e+=1),this.$textLayer&&e>this.$textLayer.MAX_LINE_LENGTH&&(e=this.$textLayer.MAX_LINE_LENGTH+30),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,i){this.scrollCursorIntoView(e,i),this.scrollCursorIntoView(t,i)},this.scrollCursorIntoView=function(e,t,i){if(0!==this.$size.scrollerHeight){var n=this.$cursorLayer.getPixelPosition(e),r=n.left,s=n.top,o=i&&i.top||0,a=i&&i.bottom||0,l=this.$scrollAnimation?this.session.getScrollTop():this.scrollTop;l+o>s?(t&&l+o>s+this.lineHeight&&(s-=t*this.$size.scrollerHeight),0===s&&(s=-this.scrollMargin.top),this.session.setScrollTop(s)):l+this.$size.scrollerHeight-a<s+this.lineHeight&&(t&&l+this.$size.scrollerHeight-a<s-this.lineHeight&&(s+=t*this.$size.scrollerHeight),this.session.setScrollTop(s+this.lineHeight+a-this.$size.scrollerHeight));var c=this.scrollLeft;c>r?(r<this.$padding+2*this.layerConfig.characterWidth&&(r=-this.scrollMargin.left),this.session.setScrollLeft(r)):c+this.$size.scrollerWidth<r+this.characterWidth?this.session.setScrollLeft(Math.round(r+this.characterWidth-this.$size.scrollerWidth)):c<=this.$padding&&r-c<this.characterWidth&&this.session.setScrollLeft(0)}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var i=this.$cursorLayer.getPixelPosition(e),n=this.$size.scrollerHeight-this.lineHeight,r=i.top-n*(t||0);return this.session.setScrollTop(r),r},this.STEPS=8,this.$calcSteps=function(e,t){var i,n,r=0,s=this.STEPS,o=[];for(r=0;r<s;++r)o.push((i=r/this.STEPS,n=e,(t-e)*(Math.pow(i-1,3)+1)+n));return o},this.scrollToLine=function(e,t,i,n){var r=this.$cursorLayer.getPixelPosition({row:e,column:0}),s=r.top;t&&(s-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(s),!1!==i&&this.animateScrolling(o,n)},this.animateScrolling=function(e,t){var i=this.scrollTop;if(this.$animatedScroll){var n=this;if(e!=i){if(this.$scrollAnimation){var r=this.$scrollAnimation.steps;if(r.length&&(e=r[0])==i)return}var s=n.$calcSteps(e,i);this.$scrollAnimation={from:e,to:i,steps:s},clearInterval(this.$timer),n.session.setScrollTop(s.shift()),n.session.$scrollTop=i,this.$timer=setInterval(function(){s.length?(n.session.setScrollTop(s.shift()),n.session.$scrollTop=i):null!=i?(n.session.$scrollTop=-1,n.session.setScrollTop(i),i=null):(n.$timer=clearInterval(n.$timer),n.$scrollAnimation=null,t&&t())},10)}}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollTo=function(e,t){this.session.setScrollTop(t),this.session.setScrollLeft(t)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return t<0&&this.session.getScrollTop()>=1-this.scrollMargin.top||(t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1+this.scrollMargin.bottom||(e<0&&this.session.getScrollLeft()>=1-this.scrollMargin.left||(e>0&&this.session.getScrollLeft()+this.$size.scrollerWidth-this.layerConfig.width<-1+this.scrollMargin.right||void 0)))},this.pixelToScreenCoordinates=function(e,t){var i;if(this.$hasCssTransforms){i={top:0,left:0};var n=this.$fontMetrics.transformCoordinates([e,t]);e=n[1]-this.gutterWidth-this.margin.left,t=n[0]}else i=this.scroller.getBoundingClientRect();var r=e+this.scrollLeft-i.left-this.$padding,s=r/this.characterWidth,o=Math.floor((t+this.scrollTop-i.top)/this.lineHeight),a=this.$blockCursor?Math.floor(s):Math.round(s);return{row:o,column:a,side:s-a>0?1:-1,offsetX:r}},this.screenToTextCoordinates=function(e,t){var i;if(this.$hasCssTransforms){i={top:0,left:0};var n=this.$fontMetrics.transformCoordinates([e,t]);e=n[1]-this.gutterWidth-this.margin.left,t=n[0]}else i=this.scroller.getBoundingClientRect();var r=e+this.scrollLeft-i.left-this.$padding,s=r/this.characterWidth,o=this.$blockCursor?Math.floor(s):Math.round(s),a=Math.floor((t+this.scrollTop-i.top)/this.lineHeight);return this.session.screenToDocumentPosition(a,Math.max(o,0),r)},this.textToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=this.session.documentToScreenPosition(e,t),r=this.$padding+(this.session.$bidiHandler.isBidiRow(n.row,e)?this.session.$bidiHandler.getPosLeft(n.column):Math.round(n.column*this.characterWidth)),s=n.row*this.lineHeight;return{pageX:i.left+r-this.scrollLeft,pageY:i.top+s-this.scrollTop}},this.visualizeFocus=function(){t.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){t.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition=e,e.cssText||(e.cssText=this.textarea.style.cssText,e.keepTextAreaAtCursor=this.$keepTextAreaAtCursor),e.useTextareaForIME=this.$useTextareaForIME,this.$useTextareaForIME?(this.$keepTextAreaAtCursor=!0,t.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor(),this.$cursorLayer.element.style.display="none"):e.markerId=this.session.addMarker(e.markerRange,"ace_composition_marker","text")},this.setCompositionText=function(e){var t=this.session.selection.cursor;this.addToken(e,"composition_placeholder",t.row,t.column),this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(this.$composition.markerId&&this.session.removeMarker(this.$composition.markerId),t.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null,this.$cursorLayer.element.style.display="")},this.addToken=function(e,t,i,n){var r=this.session;r.bgTokenizer.lines[i]=null;var s={type:t,value:e},o=r.getTokens(i);if(null==n)o.push(s);else for(var a=0,l=0;l<o.length;l++){var c=o[l];if(a+=c.value.length,n<=a){var h=c.value.length-(a-n),u=c.value.slice(0,h),d=c.value.slice(h);o.splice(l,1,{type:c.type,value:u},s,{type:c.type,value:d});break}}this.updateLines(i,i)},this.setTheme=function(e,n){var r=this;if(this.$themeId=e,r._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)o(e);else{var s=e||this.$options.theme.initialValue;i.loadModule(["theme",s],o)}function o(module){if(r.$themeId!=e)return n&&n();if(!module||!module.cssClass)throw new Error("couldn't load module "+e+" or it didn't call define");module.$id&&(r.$themeId=module.$id),t.importCssString(module.cssText,module.cssClass,r.container),r.theme&&t.removeCssClass(r.container,r.theme.cssClass);var i="padding"in module?module.padding:"padding"in(r.theme||{})?4:r.$padding;r.$padding&&i!=r.$padding&&r.setPadding(i),r.$theme=module.cssClass,r.theme=module,t.addCssClass(r.container,module.cssClass),t.setCssClass(r.container,"ace_dark",module.isDark),r.$size&&(r.$size.width=0,r.$updateSizeAsync()),r._dispatchEvent("themeLoaded",{theme:module}),n&&n()}},this.getTheme=function(){return this.$themeId},this.setStyle=function(e,i){t.setCssClass(this.container,e,!1!==i)},this.unsetStyle=function(e){t.removeCssClass(this.container,e)},this.setCursorStyle=function(e){t.setStyle(this.scroller.style,"cursor",e)},this.setMouseCursor=function(e){t.setStyle(this.scroller.style,"cursor",e)},this.attachToShadowRoot=function(){t.importCssString(d,"ace_editor.css",this.container)},this.destroy=function(){this.$fontMetrics.destroy(),this.$cursorLayer.destroy()}}).call(m.prototype),i.defineOptions(m.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.$loop.schedule(this.CHANGE_FULL),this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){t.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){this.$gutterLayer.setHighlightGutterLine(e),this.$loop.schedule(this.CHANGE_GUTTER)},initialValue:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},vScrollBarAlwaysVisible:{set:function(e){this.$vScrollBarAlwaysVisible&&this.$vScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}},maxLines:{set:function(e){this.updateFull()}},minLines:{set:function(e){this.$minLines<562949953421311||(this.$minLines=0),this.updateFull()}},maxPixelHeight:{set:function(e){this.updateFull()},initialValue:0},scrollPastEnd:{set:function(e){e=+e||0,this.$scrollPastEnd!=e&&(this.$scrollPastEnd=e,this.$loop.schedule(this.CHANGE_SCROLL))},initialValue:0,handlesSet:!0},fixedWidthGutter:{set:function(e){this.$gutterLayer.$fixedWidth=!!e,this.$loop.schedule(this.CHANGE_GUTTER)}},theme:{set:function(e){this.setTheme(e)},get:function(){return this.$themeId||this.theme},initialValue:"./theme/textmate",handlesSet:!0},hasCssTransforms:{},useTextareaForIME:{initialValue:!f.isMobile&&!f.isIE}}),exports.VirtualRenderer=m}),define("skylark-ace/worker/worker_client",["require","exports","module","../lib/oop","../lib/net","../lib/event_emitter","../config"],function(require,exports,module){var e=require("../lib/oop"),t=require("../lib/net"),i=require("../lib/event_emitter").EventEmitter,n=require("../config");function r(e){if("undefined"==typeof Worker)return{postMessage:function(){},terminate:function(){}};if(n.get("loadWorkerFromBlob")){var i=function(e){var i="importScripts('"+t.qualifyURL(e)+"');";try{return new Blob([i],{type:"application/javascript"})}catch(e){var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,r=new n;return r.append(i),r.getBlob("application/javascript")}}(e),r=window.URL||window.webkitURL,s=r.createObjectURL(i);return new Worker(s)}return new Worker(e)}var s=function(e){e.postMessage||(e=this.$createWorkerFromOldConfig.apply(this,arguments)),this.$worker=e,this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.callbackId=1,this.callbacks={},this.$worker.onmessage=this.onMessage};(function(){e.implement(this,i),this.$createWorkerFromOldConfig=function(e,t,i,s,o){if(require.nameToUrl&&!require.toUrl&&(require.toUrl=require.nameToUrl),n.get("packaged")||!require.toUrl)s=s||n.moduleUrl(t,"worker");else{var a=this.$normalizePath;s=s||a(require.toUrl("ace/worker/worker.js",null,"_"));var l={};e.forEach(function(e){l[e]=a(require.toUrl(e,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}return this.$worker=r(s),o&&this.send("importScripts",o),this.$worker.postMessage({init:!0,tlns:l,module:t,classname:i}),this.$worker},this.onMessage=function(e){var t=e.data;switch(t.type){case"event":this._signal(t.name,{data:t.data});break;case"call":var i=this.callbacks[t.id];i&&(i(t.data),delete this.callbacks[t.id]);break;case"error":this.reportError(t.data);break;case"log":window.console&&console.log&&console.log.apply(console,t.data)}},this.reportError=function(e){window.console&&console.error&&console.error(e)},this.$normalizePath=function(e){return t.qualifyURL(e)},this.terminate=function(){this._signal("terminate",{}),this.deltaQueue=null,this.$worker.terminate(),this.$worker=null,this.$doc&&this.$doc.off("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,i){if(i){var n=this.callbackId++;this.callbacks[n]=i,t.push(n)}this.send(e,t)},this.emit=function(e,t){try{t.data&&t.data.err&&(t.data.err={message:t.data.err.message,stack:t.data.err.stack,code:t.data.err.code}),this.$worker.postMessage({event:e,data:{data:t.data}})}catch(e){console.error(e.stack)}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue||(this.deltaQueue=[],setTimeout(this.$sendDeltaQueue,0)),"insert"==e.action?this.deltaQueue.push(e.start,e.lines):this.deltaQueue.push(e.start,e.end)},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>50&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))}}).call(s.prototype);exports.UIWorkerClient=function(e,t,r){var o=null,a=!1,l=Object.create(i),c=[],h=new s({messageBuffer:c,terminate:function(){},postMessage:function(e){c.push(e),o&&(a?setTimeout(u):u())}});h.setEmitSync=function(e){a=e};var u=function(){var e=c.shift();e.command?o[e.command].apply(o,e.args):e.event&&l._signal(e.event,e.data)};return l.postMessage=function(e){h.onMessage({data:e})},l.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},l.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},n.loadModule(["worker",t],function(e){for(o=new e[r](l);c.length;)u()}),h},exports.WorkerClient=s,exports.createWorker=r}),define("skylark-ace/placeholder",["require","exports","module","./range","./lib/event_emitter","./lib/oop"],function(require,exports,module){var e=require("./range").Range,t=require("./lib/event_emitter").EventEmitter,i=require("./lib/oop"),n=function(e,t,i,n,r,s){var o=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=r,this.othersClass=s,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=n,this.$onCursorChange=function(){setTimeout(function(){o.onCursorChange()})},this.$pos=i;var a=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){i.implement(this,t),this.setup=function(){var t=this,i=this.doc,n=this.session;this.selectionBefore=n.selection.toJSON(),n.selection.inMultiSelectMode&&n.selection.toSingleRange(),this.pos=i.createAnchor(this.$pos.row,this.$pos.column);var r=this.pos;r.$insertRight=!0,r.detach(),r.markerId=n.addMarker(new e(r.row,r.column,r.row,r.column+this.length),this.mainClass,null,!1),this.others=[],this.$others.forEach(function(e){var n=i.createAnchor(e.row,e.column);n.$insertRight=!0,n.detach(),t.others.push(n)}),n.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var t=this.session,i=this;this.othersActive=!0,this.others.forEach(function(n){n.markerId=t.addMarker(new e(n.row,n.column,n.row,n.column+i.length),i.othersClass,null,!1)})}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(t){if(this.$updating)return this.updateAnchors(t);var i=t;if(i.start.row===i.end.row&&i.start.row===this.pos.row){this.$updating=!0;var n="insert"===t.action?i.end.column-i.start.column:i.start.column-i.end.column,r=i.start.column>=this.pos.column&&i.start.column<=this.pos.column+this.length+1,s=i.start.column-this.pos.column;if(this.updateAnchors(t),r&&(this.length+=n),r&&!this.session.$fromUndo)if("insert"===t.action)for(var o=this.others.length-1;o>=0;o--){var a=this.others[o],l={row:a.row,column:a.column+s};this.doc.insertMergedLines(l,t.lines)}else if("remove"===t.action)for(var o=this.others.length-1;o>=0;o--){var a=this.others[o],l={row:a.row,column:a.column+s};this.doc.remove(new e(l.row,l.column,l.row,l.column-n))}this.$updating=!1,this.updateMarkers()}},this.updateAnchors=function(e){this.pos.onChange(e);for(var t=this.others.length;t--;)this.others[t].onChange(e);this.updateMarkers()},this.updateMarkers=function(){if(!this.$updating){var t=this,i=this.session,n=function(n,r){i.removeMarker(n.markerId),n.markerId=i.addMarker(new e(n.row,n.column,n.row,n.column+t.length),r,null,!1)};n(this.pos,this.mainClass);for(var r=this.others.length;r--;)n(this.others[r],this.othersClass)}},this.onCursorChange=function(e){if(!this.$updating&&this.session){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.pos&&this.pos.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.session.setUndoSelect(!0),this.session=null},this.cancel=function(){if(-1!==this.$undoStackDepth){for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,i=0;i<t;i++)e.undo(this.session,!0);this.selectionBefore&&this.session.selection.fromJSON(this.selectionBefore)}}}).call(n.prototype),exports.PlaceHolder=n}),define("skylark-ace/mouse/multi_select_handler",["require","exports","module","../lib/event","../lib/useragent"],function(require,exports,module){var e=require("../lib/event"),t=require("../lib/useragent");function i(e,t){return e.row==t.row&&e.column==t.column}exports.onMouseDown=function(n){var r=n.domEvent,s=r.altKey,o=r.shiftKey,a=r.ctrlKey,l=n.getAccelKey(),c=n.getButton();a&&t.isMac&&(c=r.button);if(n.editor.inMultiSelectMode&&2==c)return void n.editor.textInput.onContextMenu(n.domEvent);if(!a&&!s&&!l)return void(0===c&&n.editor.inMultiSelectMode&&n.editor.exitMultiSelectMode());if(0!==c)return;var h,u=n.editor,d=u.selection,f=u.inMultiSelectMode,p=n.getDocumentPosition(),m=d.getCursor(),g=n.inSelection()||d.isEmpty()&&i(p,m),v=n.x,y=n.y,k=u.session,b=u.renderer.pixelToScreenCoordinates(v,y),x=b;if(u.$mouseHandler.$enableJumpToDef)a&&s||l&&s?h=o?"block":"add":s&&u.$blockSelectEnabled&&(h="block");else if(l&&!s){if(h="add",!f&&o)return}else s&&u.$blockSelectEnabled&&(h="block");h&&t.isMac&&r.ctrlKey&&u.$mouseHandler.cancelContextMenu();if("add"==h){if(!f&&g)return;if(!f){var w=d.toOrientedRange();u.addSelectionMarker(w)}var _=d.rangeList.rangeAtPoint(p);u.inVirtualSelectionMode=!0,o&&(_=null,w=d.ranges[0]||w,u.removeSelectionMarker(w)),u.once("mouseup",function(){var e=d.toOrientedRange();_&&e.isEmpty()&&i(_.cursor,e.cursor)?d.substractPoint(e.cursor):(o?d.substractPoint(w.cursor):w&&(u.removeSelectionMarker(w),d.addRange(w)),d.addRange(e)),u.inVirtualSelectionMode=!1})}else if("block"==h){var C;n.stop(),u.inVirtualSelectionMode=!0;var S=[],A=function(){var e=u.renderer.pixelToScreenCoordinates(v,y),t=k.screenToDocumentPosition(e.row,e.column,e.offsetX);i(x,e)&&i(t,d.lead)||(x=e,u.selection.moveToPosition(t),u.renderer.scrollCursorIntoView(),u.removeSelectionMarkers(S),S=d.rectangularRangeBlock(x,b),u.$mouseHandler.$clickSelection&&1==S.length&&S[0].isEmpty()&&(S[0]=u.$mouseHandler.$clickSelection.clone()),S.forEach(u.addSelectionMarker,u),u.updateSelectionMarkers())};f&&!l?d.toSingleRange():!f&&l&&(C=d.toOrientedRange(),u.addSelectionMarker(C)),o?b=k.documentToScreenPosition(d.lead):d.moveToPosition(p),x={row:-1,column:-1};var M=A;e.capture(u.container,function(e){v=e.clientX,y=e.clientY},function(e){A(),clearInterval(T),u.removeSelectionMarkers(S),S.length||(S=[d.toOrientedRange()]);C&&(u.removeSelectionMarker(C),d.toSingleRange(C));for(var t=0;t<S.length;t++)d.addRange(S[t]);u.inVirtualSelectionMode=!1,u.$mouseHandler.$clickSelection=null});var T=setInterval(function(){M()},20);return n.preventDefault()}}}),define("skylark-ace/commands/multi_select_commands",["require","exports","module","../keyboard/hash_handler"],function(require,exports,module){exports.defaultCommands=[{name:"addCursorAbove",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelow",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorAboveSkipCurrent",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},scrollIntoView:"cursor",readOnly:!0},{name:"addCursorBelowSkipCurrent",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreBefore",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectMoreAfter",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextBefore",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},scrollIntoView:"cursor",readOnly:!0},{name:"selectNextAfter",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},scrollIntoView:"cursor",readOnly:!0},{name:"splitIntoLines",exec:function(e){e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readOnly:!0},{name:"alignCursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"},scrollIntoView:"cursor"},{name:"findAll",exec:function(e){e.findAll()},bindKey:{win:"Ctrl-Alt-K",mac:"Ctrl-Alt-G"},scrollIntoView:"cursor",readOnly:!0}],exports.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},scrollIntoView:"cursor",readOnly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var e=require("../keyboard/hash_handler").HashHandler;exports.keyboardHandler=new e(exports.multiSelectCommands)}),define("skylark-ace/multi_select",["require","exports","module","./range_list","./range","./selection","./mouse/multi_select_handler","./lib/event","./lib/lang","./commands/multi_select_commands","./search","./edit_session","./editor","./config"],function(require,exports,module){var e=require("./range_list").RangeList,t=require("./range").Range,i=require("./selection").Selection,n=require("./mouse/multi_select_handler").onMouseDown,r=require("./lib/event"),s=require("./lib/lang"),o=require("./commands/multi_select_commands");exports.commands=o.defaultCommands.concat(o.multiSelectCommands);var a=require("./search").Search,l=new a;var c=require("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(c.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0===this.rangeCount){var i=this.toOrientedRange();if(this.rangeList.add(i),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(i),this.$onAddRange(i)}e.cursor||(e.cursor=e.end);var n=this.rangeList.add(e);return this.$onAddRange(e),n.length&&this.$onRemoveRange(n),this.rangeCount>1&&!this.inMultiSelectMode&&(this._signal("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);if(t)return this.$onRemoveRange(t),t[0]},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length&&this.$onRemoveRange(e)},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._signal("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var i=e.length;i--;){var n=this.ranges.indexOf(e[i]);this.ranges.splice(n,1)}this._signal("removeRange",{ranges:e}),0===this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._signal("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),(t=t||this.ranges[0])&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new e,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeCount?this.rangeList.ranges.concat():[this.getRange()]},this.splitIntoLines=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,i=e[e.length-1],n=t.fromPoints(e[0].start,i.end);this.toSingleRange(),this.setSelectionRange(n,i.cursor==i.start)}else{var n=this.getRange(),r=this.isBackwards(),s=n.start.row,o=n.end.row;if(s==o){if(r)var a=n.end,l=n.start;else var a=n.start,l=n.end;return this.addRange(t.fromPoints(l,l)),void this.addRange(t.fromPoints(a,a))}var c=[],h=this.getLineRange(s,!0);h.start.column=n.start.column,c.push(h);for(var u=s+1;u<o;u++)c.push(this.getLineRange(u,!0));(h=this.getLineRange(o,!0)).end.column=n.end.column,c.push(h),c.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,i=e[e.length-1],n=t.fromPoints(e[0].start,i.end);this.toSingleRange(),this.setSelectionRange(n,i.cursor==i.start)}else{var r=this.session.documentToScreenPosition(this.cursor),s=this.session.documentToScreenPosition(this.anchor),o=this.rectangularRangeBlock(r,s);o.forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,i,n){var r=[],s=e.column<i.column;if(s)var o=e.column,a=i.column,l=e.offsetX,c=i.offsetX;else var o=i.column,a=e.column,l=i.offsetX,c=e.offsetX;var h,u,d,f=e.row<i.row;if(f)var p=e.row,m=i.row;else var p=i.row,m=e.row;o<0&&(o=0),p<0&&(p=0),p==m&&(n=!0);for(var g=p;g<=m;g++){var v=t.fromPoints(this.session.screenToDocumentPosition(g,o,l),this.session.screenToDocumentPosition(g,a,c));if(v.isEmpty()){if(h&&(u=v.end,d=h,u.row==d.row&&u.column==d.column))break;h=v.end}v.cursor=s?v.start:v.end,r.push(v)}if(f&&r.reverse(),!n){for(var y=r.length-1;r[y].isEmpty()&&y>0;)y--;if(y>0)for(var k=0;r[k].isEmpty();)k++;for(var b=y;b>=k;b--)r[b].isEmpty()&&r.splice(b,1)}return r}}.call(i.prototype);var h=require("./editor").Editor;function u(e){e.$multiselectOnSessionChange||(e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),e.$multiselectOnSessionChange=exports.onSessionChange.bind(e),e.$checkMultiselectChange=e.$checkMultiselectChange.bind(e),e.$multiselectOnSessionChange(e),e.on("changeSession",e.$multiselectOnSessionChange),e.on("mousedown",n),e.commands.addCommands(o.defaultCommands),function(e){var t=e.textInput.getElement(),i=!1;function n(t){i&&(e.renderer.setMouseCursor(""),i=!1)}r.addListener(t,"keydown",function(t){var r=18==t.keyCode&&!(t.ctrlKey||t.shiftKey||t.metaKey);e.$blockSelectEnabled&&r?i||(e.renderer.setMouseCursor("crosshair"),i=!0):i&&n()}),r.addListener(t,"keyup",n),r.addListener(t,"blur",n)}(e))}(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,i=e.length;i--;){var n=e[i];if(n.marker){this.session.removeMarker(n.marker);var r=t.indexOf(n);-1!=r&&t.splice(r,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(o.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(o.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers(),this._emit("changeSelection"))},this.$onMultiSelectExec=function(e){var t=e.command,i=e.editor;if(i.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?n=i.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?n=i.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(i.exitMultiSelectMode(),n=t.exec(i,e.args||{})):n=t.multiSelectAction(i,e.args||{});else{var n=t.exec(i,e.args||{});i.multiSelect.addRange(i.multiSelect.toOrientedRange()),i.multiSelect.mergeOverlappingRanges()}return n}},this.forEachSelection=function(e,t,n){if(!this.inVirtualSelectionMode){var r,s=n&&n.keepOrder,o=1==n||n&&n.$byLines,a=this.session,l=this.selection,c=l.rangeList,h=(s?l:c).ranges;if(!h.length)return e.exec?e.exec(this,t||{}):e(this,t||{});var u=l._eventRegistry;l._eventRegistry={};var d=new i(a);this.inVirtualSelectionMode=!0;for(var f=h.length;f--;){if(o)for(;f>0&&h[f].start.row==h[f-1].end.row;)f--;d.fromOrientedRange(h[f]),d.index=f,this.selection=a.selection=d;var p=e.exec?e.exec(this,t||{}):e(this,t||{});r||void 0===p||(r=p),d.toOrientedRange(h[f])}d.detach(),this.selection=a.selection=l,this.inVirtualSelectionMode=!1,l._eventRegistry=u,l.mergeOverlappingRanges(),l.ranges[0]&&l.fromOrientedRange(l.ranges[0]);var m=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),m&&m.from==m.to&&this.renderer.animateScrolling(m.from),r}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getSelectedText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,i=[],n=0;n<t.length;n++)i.push(this.session.getTextRange(t[n]));var r=this.session.getDocument().getNewLineCharacter();(e=i.join(r)).length==(i.length-1)*r.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return e},this.$checkMultiselectChange=function(e,t){if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){var i=this.multiSelect.ranges[0];if(this.multiSelect.isEmpty()&&t==this.multiSelect.anchor)return;var n=t==this.multiSelect.anchor?i.cursor==i.start?i.end:i.start:i.cursor;n.row!=t.row||this.session.$clipPositionToDocument(n.row,n.column).column!=t.column?this.multiSelect.toSingleRange(this.multiSelect.toOrientedRange()):this.multiSelect.mergeOverlappingRanges()}},this.findAll=function(e,t,i){if((t=t||{}).needle=e||t.needle,void 0==t.needle){var n=this.selection.isEmpty()?this.selection.getWordRange():this.selection.getRange();t.needle=this.session.getTextRange(n)}this.$search.set(t);var r=this.$search.findAll(this.session);if(!r.length)return 0;var s=this.multiSelect;i||s.toSingleRange(r[0]);for(var o=r.length;o--;)s.addRange(r[o],!0);return n&&s.rangeList.rangeAtPoint(n.start)&&s.addRange(n,!0),r.length},this.selectMoreLines=function(e,i){var n=this.selection.toOrientedRange(),r=n.cursor==n.end,s=this.session.documentToScreenPosition(n.cursor);this.selection.$desiredColumn&&(s.column=this.selection.$desiredColumn);var o=this.session.screenToDocumentPosition(s.row+e,s.column);if(n.isEmpty())var a=o;else var l=this.session.documentToScreenPosition(r?n.end:n.start),a=this.session.screenToDocumentPosition(l.row+e,l.column);if(r){var c=t.fromPoints(o,a);c.cursor=c.start}else{var c=t.fromPoints(a,o);c.cursor=c.end}if(c.desiredColumn=s.column,this.selection.inMultiSelectMode){if(i)var h=n.cursor}else this.selection.addRange(n);this.selection.addRange(c),h&&this.selection.substractPoint(h)},this.transposeSelections=function(e){for(var t=this.session,i=t.multiSelect,n=i.ranges,r=n.length;r--;){var s=n[r];if(s.isEmpty()){var o=t.getWordRange(s.start.row,s.start.column);s.start.row=o.start.row,s.start.column=o.start.column,s.end.row=o.end.row,s.end.column=o.end.column}}i.mergeOverlappingRanges();for(var a=[],r=n.length;r--;){var s=n[r];a.unshift(t.getTextRange(s))}e<0?a.unshift(a.pop()):a.push(a.shift());for(var r=n.length;r--;){var s=n[r],o=s.clone();t.replace(s,a[r]),s.start.row=o.start.row,s.start.column=o.start.column}i.fromOrientedRange(i.ranges[0])},this.selectMore=function(e,t,i){var n=this.session,r=n.multiSelect,s=r.toOrientedRange();if(!s.isEmpty()||((s=n.getWordRange(s.start.row,s.start.column)).cursor=-1==e?s.start:s.end,this.multiSelect.addRange(s),!i)){var o=n.getTextRange(s),a=function(e,t,i){return l.$options.wrap=!0,l.$options.needle=t,l.$options.backwards=-1==i,l.find(e)}(n,o,e);a&&(a.cursor=-1==e?a.start:a.end,this.session.unfold(a),this.multiSelect.addRange(a),this.renderer.scrollCursorIntoView(null,.5)),t&&this.multiSelect.substractPoint(s.cursor)}},this.alignCursors=function(){var e=this.session,i=e.multiSelect,n=i.ranges,r=-1,o=n.filter(function(e){if(e.cursor.row==r)return!0;r=e.cursor.row});if(n.length&&o.length!=n.length-1){o.forEach(function(e){i.substractPoint(e.cursor)});var a=0,l=1/0,c=n.map(function(t){var i=t.cursor,n=e.getLine(i.row),r=n.substr(i.column).search(/\S/g);return-1==r&&(r=0),i.column>a&&(a=i.column),r<l&&(l=r),r});n.forEach(function(i,n){var r=i.cursor,o=a-r.column,h=c[n]-l;o>h?e.insert(r,s.stringRepeat(" ",o-h)):e.remove(new t(r.row,r.column,r.row,r.column-o+h)),i.start.column=i.end.column=a,i.start.row=i.end.row=r.row,i.cursor=i.end}),i.fromOrientedRange(n[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var h=this.selection.getRange(),u=h.start.row,d=h.end.row,f=u==d;if(f){var p,m=this.session.getLength();do{p=this.session.getLine(d)}while(/[=:]/.test(p)&&++d<m);do{p=this.session.getLine(u)}while(/[=:]/.test(p)&&--u>0);u<0&&(u=0),d>=m&&(d=m-1)}var g=this.session.removeFullLines(u,d);g=this.$reAlignText(g,f),this.session.insert({row:u,column:0},g.join("\n")+"\n"),f||(h.start.column=0,h.end.column=g[g.length-1].length),this.selection.setRange(h)}},this.$reAlignText=function(e,t){var i,n,r,o=!0,a=!0;return e.map(function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==i?(i=t[1].length,n=t[2].length,r=t[3].length,t):(i+n+r!=t[1].length+t[2].length+t[3].length&&(a=!1),i!=t[1].length&&(o=!1),i>t[1].length&&(i=t[1].length),n<t[2].length&&(n=t[2].length),r>t[3].length&&(r=t[3].length),t):[e]}).map(t?c:o?a?function(e){return e[2]?l(i+n-e[2].length)+e[2]+l(r)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}:c:function(e){return e[2]?l(i)+e[2]+l(r)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]});function l(e){return s.stringRepeat(" ",e)}function c(e){return e[2]?l(i)+e[2]+l(n-e[2].length+r)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}}}).call(h.prototype),exports.onSessionChange=function(e){var t=e.session;t&&!t.multiSelect&&(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t&&t.multiSelect;var i=e.oldSession;i&&(i.multiSelect.off("addRange",this.$onAddRange),i.multiSelect.off("removeRange",this.$onRemoveRange),i.multiSelect.off("multiSelect",this.$onMultiSelect),i.multiSelect.off("singleSelect",this.$onSingleSelect),i.multiSelect.lead.off("change",this.$checkMultiselectChange),i.multiSelect.anchor.off("change",this.$checkMultiselectChange)),t&&(t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),t.multiSelect.lead.on("change",this.$checkMultiselectChange),t.multiSelect.anchor.on("change",this.$checkMultiselectChange)),t&&this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},exports.MultiSelect=u,require("./config").defineOptions(h.prototype,"editor",{enableMultiselect:{set:function(e){u(this),e?(this.on("changeSession",this.$multiselectOnSessionChange),this.on("mousedown",n)):(this.off("changeSession",this.$multiselectOnSessionChange),this.off("mousedown",n))},value:!0},enableBlockSelect:{set:function(e){this.$blockSelectEnabled=e},value:!0}})}),define("skylark-ace/mode/folding/fold_mode",["require","exports","module","../../range"],function(require,exports,module){var e=require("../../range").Range,t=exports.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,i){var n=e.getLine(i);return this.foldingStartMarker.test(n)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(n)?"end":""},this.getFoldWidgetRange=function(e,t,i){return null},this.indentationBlock=function(t,i,n){var r=/\S/,s=t.getLine(i),o=s.search(r);if(-1!=o){for(var a=n||s.length,l=t.getLength(),c=i,h=i;++i<l;){var u=t.getLine(i).search(r);if(-1!=u){if(u<=o)break;h=i}}if(h>c){var d=t.getLine(h).length;return new e(c,a,h,d)}}},this.openingBracketBlock=function(t,i,n,r,s){var o={row:n,column:r+1},a=t.$findClosingBracket(i,o,s);if(a){var l=t.foldWidgets[a.row];return null==l&&(l=t.getFoldWidget(a.row)),"start"==l&&a.row>o.row&&(a.row--,a.column=t.getLine(a.row).length),e.fromPoints(o,a)}},this.closingBracketBlock=function(t,i,n,r,s){var o={row:n,column:r},a=t.$findOpeningBracket(i,o);if(a)return a.column++,o.column--,e.fromPoints(a,o)}}).call(t.prototype)}),define("skylark-ace/theme/textmate.css",[],function(){return'.ace-tm .ace_gutter {\r\n  background: #f0f0f0;\r\n  color: #333;\r\n}\r\n\r\n.ace-tm .ace_print-margin {\r\n  width: 1px;\r\n  background: #e8e8e8;\r\n}\r\n\r\n.ace-tm .ace_fold {\r\n    background-color: #6B72E6;\r\n}\r\n\r\n.ace-tm {\r\n  background-color: #FFFFFF;\r\n  color: black;\r\n}\r\n\r\n.ace-tm .ace_cursor {\r\n  color: black;\r\n}\r\n        \r\n.ace-tm .ace_invisible {\r\n  color: rgb(191, 191, 191);\r\n}\r\n\r\n.ace-tm .ace_storage,\r\n.ace-tm .ace_keyword {\r\n  color: blue;\r\n}\r\n\r\n.ace-tm .ace_constant {\r\n  color: rgb(197, 6, 11);\r\n}\r\n\r\n.ace-tm .ace_constant.ace_buildin {\r\n  color: rgb(88, 72, 246);\r\n}\r\n\r\n.ace-tm .ace_constant.ace_language {\r\n  color: rgb(88, 92, 246);\r\n}\r\n\r\n.ace-tm .ace_constant.ace_library {\r\n  color: rgb(6, 150, 14);\r\n}\r\n\r\n.ace-tm .ace_invalid {\r\n  background-color: rgba(255, 0, 0, 0.1);\r\n  color: red;\r\n}\r\n\r\n.ace-tm .ace_support.ace_function {\r\n  color: rgb(60, 76, 114);\r\n}\r\n\r\n.ace-tm .ace_support.ace_constant {\r\n  color: rgb(6, 150, 14);\r\n}\r\n\r\n.ace-tm .ace_support.ace_type,\r\n.ace-tm .ace_support.ace_class {\r\n  color: rgb(109, 121, 222);\r\n}\r\n\r\n.ace-tm .ace_keyword.ace_operator {\r\n  color: rgb(104, 118, 135);\r\n}\r\n\r\n.ace-tm .ace_string {\r\n  color: rgb(3, 106, 7);\r\n}\r\n\r\n.ace-tm .ace_comment {\r\n  color: rgb(76, 136, 107);\r\n}\r\n\r\n.ace-tm .ace_comment.ace_doc {\r\n  color: rgb(0, 102, 255);\r\n}\r\n\r\n.ace-tm .ace_comment.ace_doc.ace_tag {\r\n  color: rgb(128, 159, 191);\r\n}\r\n\r\n.ace-tm .ace_constant.ace_numeric {\r\n  color: rgb(0, 0, 205);\r\n}\r\n\r\n.ace-tm .ace_variable {\r\n  color: rgb(49, 132, 149);\r\n}\r\n\r\n.ace-tm .ace_xml-pe {\r\n  color: rgb(104, 104, 91);\r\n}\r\n\r\n.ace-tm .ace_entity.ace_name.ace_function {\r\n  color: #0000A2;\r\n}\r\n\r\n\r\n.ace-tm .ace_heading {\r\n  color: rgb(12, 7, 255);\r\n}\r\n\r\n.ace-tm .ace_list {\r\n  color:rgb(185, 6, 144);\r\n}\r\n\r\n.ace-tm .ace_meta.ace_tag {\r\n  color:rgb(0, 22, 142);\r\n}\r\n\r\n.ace-tm .ace_string.ace_regex {\r\n  color: rgb(255, 0, 0)\r\n}\r\n\r\n.ace-tm .ace_marker-layer .ace_selection {\r\n  background: rgb(181, 213, 255);\r\n}\r\n.ace-tm.ace_multiselect .ace_selection.ace_start {\r\n  box-shadow: 0 0 3px 0px white;\r\n}\r\n.ace-tm .ace_marker-layer .ace_step {\r\n  background: rgb(252, 255, 0);\r\n}\r\n\r\n.ace-tm .ace_marker-layer .ace_stack {\r\n  background: rgb(164, 229, 101);\r\n}\r\n\r\n.ace-tm .ace_marker-layer .ace_bracket {\r\n  margin: -1px 0 0 -1px;\r\n  border: 1px solid rgb(192, 192, 192);\r\n}\r\n\r\n.ace-tm .ace_marker-layer .ace_active-line {\r\n  background: rgba(0, 0, 0, 0.07);\r\n}\r\n\r\n.ace-tm .ace_gutter-active-line {\r\n    background-color : #dcdcdc;\r\n}\r\n\r\n.ace-tm .ace_marker-layer .ace_selected-word {\r\n  background: rgb(250, 250, 255);\r\n  border: 1px solid rgb(200, 200, 250);\r\n}\r\n\r\n.ace-tm .ace_indent-guide {\r\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;\r\n}\r\n'}),define("skylark-ace/theme/textmate",["require","exports","module","./textmate.css","../lib/dom"],function(require,exports,module){exports.isDark=!1,exports.cssClass="ace-tm",exports.cssText=require("./textmate.css"),exports.$id="ace/theme/textmate";var e=require("../lib/dom");e.importCssString(exports.cssText,exports.cssClass)}),define("skylark-ace/line_widgets",["require","exports","module","./lib/oop","./lib/dom","./range"],function(require,exports,module){require("./lib/oop");var e=require("./lib/dom");require("./range").Range;function t(e){this.session=e,this.session.widgetManager=this,this.session.getRowLength=this.getRowLength,this.session.$getWidgetScreenLength=this.$getWidgetScreenLength,this.updateOnChange=this.updateOnChange.bind(this),this.renderWidgets=this.renderWidgets.bind(this),this.measureWidgets=this.measureWidgets.bind(this),this.session._changedWidgets=[],this.$onChangeEditor=this.$onChangeEditor.bind(this),this.session.on("change",this.updateOnChange),this.session.on("changeFold",this.updateOnFold),this.session.on("changeEditor",this.$onChangeEditor)}(function(){this.getRowLength=function(e){var t;return t=this.lineWidgets&&this.lineWidgets[e]&&this.lineWidgets[e].rowCount||0,this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1+t:1+t},this.$getWidgetScreenLength=function(){var e=0;return this.lineWidgets.forEach(function(t){t&&t.rowCount&&!t.hidden&&(e+=t.rowCount)}),e},this.$onChangeEditor=function(e){this.attach(e.editor)},this.attach=function(e){e&&e.widgetManager&&e.widgetManager!=this&&e.widgetManager.detach(),this.editor!=e&&(this.detach(),this.editor=e,e&&(e.widgetManager=this,e.renderer.on("beforeRender",this.measureWidgets),e.renderer.on("afterRender",this.renderWidgets)))},this.detach=function(e){var t=this.editor;if(t){this.editor=null,t.widgetManager=null,t.renderer.off("beforeRender",this.measureWidgets),t.renderer.off("afterRender",this.renderWidgets);var i=this.session.lineWidgets;i&&i.forEach(function(e){e&&e.el&&e.el.parentNode&&(e._inDocument=!1,e.el.parentNode.removeChild(e.el))})}},this.updateOnFold=function(e,t){var i=t.lineWidgets;if(i&&e.action){for(var n=e.data,r=n.start.row,s=n.end.row,o="add"==e.action,a=r+1;a<s;a++)i[a]&&(i[a].hidden=o);i[s]&&(o?i[r]?i[s].hidden=o:i[r]=i[s]:(i[r]==i[s]&&(i[r]=void 0),i[s].hidden=o))}},this.updateOnChange=function(e){var t=this.session.lineWidgets;if(t){var i=e.start.row,n=e.end.row-i;if(0===n);else if("remove"==e.action){var r=t.splice(i+1,n);r.forEach(function(e){e&&this.removeLineWidget(e)},this),this.$updateRows()}else{var s=new Array(n);s.unshift(i,0),t.splice.apply(t,s),this.$updateRows()}}},this.$updateRows=function(){var e=this.session.lineWidgets;if(e){var t=!0;e.forEach(function(e,i){if(e)for(t=!1,e.row=i;e.$oldWidget;)e.$oldWidget.row=i,e=e.$oldWidget}),t&&(this.session.lineWidgets=null)}},this.addLineWidget=function(t){this.session.lineWidgets||(this.session.lineWidgets=new Array(this.session.getLength()));var i=this.session.lineWidgets[t.row];i&&(t.$oldWidget=i,i.el&&i.el.parentNode&&(i.el.parentNode.removeChild(i.el),i._inDocument=!1)),this.session.lineWidgets[t.row]=t,t.session=this.session;var n=this.editor.renderer;t.html&&!t.el&&(t.el=e.createElement("div"),t.el.innerHTML=t.html),t.el&&(e.addCssClass(t.el,"ace_lineWidgetContainer"),t.el.style.position="absolute",t.el.style.zIndex=5,n.container.appendChild(t.el),t._inDocument=!0),t.coverGutter||(t.el.style.zIndex=3),null==t.pixelHeight&&(t.pixelHeight=t.el.offsetHeight),null==t.rowCount&&(t.rowCount=t.pixelHeight/n.layerConfig.lineHeight);var r=this.session.getFoldAt(t.row,0);if(t.$fold=r,r){var s=this.session.lineWidgets;t.row!=r.end.row||s[r.start.row]?t.hidden=!0:s[r.start.row]=t}return this.session._emit("changeFold",{data:{start:{row:t.row}}}),this.$updateRows(),this.renderWidgets(null,n),this.onWidgetChanged(t),t},this.removeLineWidget=function(e){if(e._inDocument=!1,e.session=null,e.el&&e.el.parentNode&&e.el.parentNode.removeChild(e.el),e.editor&&e.editor.destroy)try{e.editor.destroy()}catch(e){}if(this.session.lineWidgets){var t=this.session.lineWidgets[e.row];if(t==e)this.session.lineWidgets[e.row]=e.$oldWidget,e.$oldWidget&&this.onWidgetChanged(e.$oldWidget);else for(;t;){if(t.$oldWidget==e){t.$oldWidget=e.$oldWidget;break}t=t.$oldWidget}}this.session._emit("changeFold",{data:{start:{row:e.row}}}),this.$updateRows()},this.getWidgetsAtRow=function(e){for(var t=this.session.lineWidgets,i=t&&t[e],n=[];i;)n.push(i),i=i.$oldWidget;return n},this.onWidgetChanged=function(e){this.session._changedWidgets.push(e),this.editor&&this.editor.renderer.updateFull()},this.measureWidgets=function(e,t){var i=this.session._changedWidgets,n=t.layerConfig;if(i&&i.length){for(var r=1/0,s=0;s<i.length;s++){var o=i[s];if(o&&o.el&&o.session==this.session){if(!o._inDocument){if(this.session.lineWidgets[o.row]!=o)continue;o._inDocument=!0,t.container.appendChild(o.el)}o.h=o.el.offsetHeight,o.fixedWidth||(o.w=o.el.offsetWidth,o.screenWidth=Math.ceil(o.w/n.characterWidth));var a=o.h/n.lineHeight;o.coverLine&&(a-=this.session.getRowLineCount(o.row))<0&&(a=0),o.rowCount!=a&&(o.rowCount=a,o.row<r&&(r=o.row))}}r!=1/0&&(this.session._emit("changeFold",{data:{start:{row:r}}}),this.session.lineWidgetWidth=null),this.session._changedWidgets=[]}},this.renderWidgets=function(e,t){var i=t.layerConfig,n=this.session.lineWidgets;if(n){for(var r=Math.min(this.firstRow,i.firstRow),s=Math.max(this.lastRow,i.lastRow,n.length);r>0&&!n[r];)r--;this.firstRow=i.firstRow,this.lastRow=i.lastRow,t.$cursorLayer.config=i;for(var o=r;o<=s;o++){var a=n[o];if(a&&a.el)if(a.hidden)a.el.style.top=-100-(a.pixelHeight||0)+"px";else{a._inDocument||(a._inDocument=!0,t.container.appendChild(a.el));var l=t.$cursorLayer.getPixelPosition({row:o,column:0},!0).top;a.coverLine||(l+=i.lineHeight*this.session.getRowLineCount(a.row)),a.el.style.top=l-i.offset+"px";var c=a.coverGutter?0:t.gutterWidth;a.fixedWidth||(c-=t.scrollLeft),a.el.style.left=c+"px",a.fullWidth&&a.screenWidth&&(a.el.style.minWidth=i.width+2*i.padding+"px"),a.fixedWidth?a.el.style.right=t.scrollBar.getWidth()+"px":a.el.style.right=""}}}}}).call(t.prototype),exports.LineWidgets=t}),define("skylark-ace/ext/error_marker",["require","exports","module","../line_widgets","../lib/dom","../range"],function(require,exports,module){var e=require("../line_widgets").LineWidgets,t=require("../lib/dom"),i=require("../range").Range;exports.showErrorMarker=function(n,r){var s=n.session;s.widgetManager||(s.widgetManager=new e(s),s.widgetManager.attach(n));var o=n.getCursorPosition(),a=o.row,l=s.widgetManager.getWidgetsAtRow(a).filter(function(e){return"errorMarker"==e.type})[0];l?l.destroy():a-=r;var c,h=function(e,t,n){var r=e.getAnnotations().sort(i.comparePoints);if(!r.length)return;var s=function(e,t,i){var n=0,r=e.length-1;for(;n<=r;){var s=n+r>>1,o=i(t,e[s]);if(o>0)n=s+1;else{if(!(o<0))return s;r=s-1}}return-(n+1)}(r,{row:t,column:-1},i.comparePoints);s<0&&(s=-s-1);s>=r.length?s=n>0?0:r.length-1:0===s&&n<0&&(s=r.length-1);var o=r[s];if(!o||!n)return;if(o.row===t){do{o=r[s+=n]}while(o&&o.row===t);if(!o)return r.slice()}var a=[];t=o.row;do{a[n<0?"unshift":"push"](o),o=r[s+=n]}while(o&&o.row==t);return a.length&&a}(s,a,r);if(h){var u=h[0];o.column=(u.pos&&"number"!=typeof u.column?u.pos.sc:u.column)||0,o.row=u.row,c=n.renderer.$gutterLayer.$annotations[o.row]}else{if(l)return;c={text:["Looks good!"],className:"ace_ok"}}n.session.unfold(o.row),n.selection.moveToPosition(o);var d={row:o.row,fixedWidth:!0,coverGutter:!0,el:t.createElement("div"),type:"errorMarker"},f=d.el.appendChild(t.createElement("div")),p=d.el.appendChild(t.createElement("div"));p.className="error_widget_arrow "+c.className;var m=n.renderer.$cursorLayer.getPixelPosition(o).left;p.style.left=m+n.renderer.gutterWidth-5+"px",d.el.className="error_widget_wrapper",f.className="error_widget "+c.className,f.innerHTML=c.text.join("<br>"),f.appendChild(t.createElement("div"));var g=function(e,t,i){if(0===t&&("esc"===i||"return"===i))return d.destroy(),{command:"null"}};d.destroy=function(){n.$mouseHandler.isMousePressed||(n.keyBinding.removeKeyboardHandler(g),s.widgetManager.removeLineWidget(d),n.off("changeSelection",d.destroy),n.off("changeSession",d.destroy),n.off("mouseup",d.destroy),n.off("change",d.destroy))},n.keyBinding.addKeyboardHandler(g),n.on("changeSelection",d.destroy),n.on("changeSession",d.destroy),n.on("mouseup",d.destroy),n.on("change",d.destroy),n.session.widgetManager.addLineWidget(d),d.el.onmousedown=n.focus.bind(n),n.renderer.scrollCursorIntoView(null,.5,{bottom:d.el.offsetHeight})},t.importCssString("    .error_widget_wrapper {        background: inherit;        color: inherit;        border:none    }    .error_widget {        border-top: solid 2px;        border-bottom: solid 2px;        margin: 5px 0;        padding: 10px 40px;        white-space: pre-wrap;    }    .error_widget.ace_error, .error_widget_arrow.ace_error{        border-color: #ff5a5a    }    .error_widget.ace_warning, .error_widget_arrow.ace_warning{        border-color: #F1D817    }    .error_widget.ace_info, .error_widget_arrow.ace_info{        border-color: #5a5a5a    }    .error_widget.ace_ok, .error_widget_arrow.ace_ok{        border-color: #5aaa5a    }    .error_widget_arrow {        position: absolute;        border: solid 5px;        border-top-color: transparent!important;        border-right-color: transparent!important;        border-left-color: transparent!important;        top: -5px;    }","")}),define("skylark-ace/main",["require","exports","module","./lib/fixoldbrowsers","./lib/dom","./lib/event","./range","./editor","./edit_session","./undomanager","./virtual_renderer","./worker/worker_client","./keyboard/hash_handler","./placeholder","./multi_select","./mode/folding/fold_mode","./theme/textmate","./ext/error_marker","./config"],function(require,exports,module){require("./lib/fixoldbrowsers");var e=require("./lib/dom"),t=require("./lib/event"),i=require("./range").Range,n=require("./editor").Editor,r=require("./edit_session").EditSession,s=require("./undomanager").UndoManager,o=require("./virtual_renderer").VirtualRenderer;require("./worker/worker_client"),require("./keyboard/hash_handler"),require("./placeholder"),require("./multi_select"),require("./mode/folding/fold_mode"),require("./theme/textmate"),require("./ext/error_marker"),exports.config=require("./config"),exports.require=require,"function"==typeof define&&(exports.define=define),exports.edit=function(i,r){if("string"==typeof i){var s=i;if(!(i=document.getElementById(s)))throw new Error("ace.edit can't find div #"+s)}if(i&&i.env&&i.env.editor instanceof n)return i.env.editor;var a="";if(i&&/input|textarea/i.test(i.tagName)){var l=i;a=l.value,i=e.createElement("pre"),l.parentNode.replaceChild(i,l)}else i&&(a=i.textContent,i.innerHTML="");var c=exports.createEditSession(a),h=new n(new o(i),c,r),u={document:c,editor:h,onResize:h.resize.bind(h,null)};return l&&(u.textarea=l),t.addListener(window,"resize",u.onResize),h.on("destroy",function(){t.removeListener(window,"resize",u.onResize),u.editor.container.env=null}),h.container.env=h.env=u,h},exports.createEditSession=function(e,t){var i=new r(e,t);return i.setUndoManager(new s),i},exports.Range=i,exports.Editor=n,exports.EditSession=r,exports.UndoManager=s,exports.VirtualRenderer=o,exports.version="1.4.3"}),define("skylark-ace",["skylark-ace/main"],function(e){return e}),define("skylark-widgets-coder/addons/edit/ace",["skylark-langx/langx","skylark-domx-data","skylark-ace","../../Addon","../../util","../../Coder"],function(e,t,i,n,r,s){"use strict";class o extends n{_init(){super._init();var n,s=this.coder,o=this.options;this.editor={};var o=this.options,a=s.$container.querySelectorAll(".coder-editor");for(n=0;n<a.length;n++){let s=a[n].querySelector("textarea"),l=t.data(s,"coder-type"),c=t.data(s,"coder-file"),h=document.createElement("div");a[n].appendChild(h),this.editor[l]=i.edit(h);let u=this.editor[l],d=e.clone(o);u.getSession().setMode("ace/mode/"+r.getMode(l,c)),u.getSession().setOptions(d),u.$blockScrolling=1/0}s.on("change",this.change.bind(this),1)}editorChange(e){return()=>{var t=this.editor[e.type];e.content=t.getValue(),this.coder.emit("change",e)}}change(e,t){var i=e.data,n=this.editor[i.type];i.aceEditor||(n.getSession().setValue(i.content),i.aceEditor=n,n.on("change",this.editorChange(i)))}static get categoryName(){return"edit"}static get addonName(){return"ace"}}return o.register(s),o}),define("skylark-widgets-coder/addons/general/console",["skylark-langx/langx","skylark-domx-styler","../../Addon","../../util","../../Coder"],function(e,t,i,n,r){"use strict";class s extends i{get options(){return{autoClear:!1}}_init(){super._init();var e=this.coder,i=this.options,n=`(function ${this.capture.toString()})();`,r=document.createElement("li");t.addClass(r,"coder-nav-item coder-nav-item-console"),r.innerHTML='<a href="#" data-coder-type="console">JS Console</a>';var s=document.createElement("div");t.addClass(s,"coder-pane coder-pane-console"),s.innerHTML='\n              <div class="coder-console-container">\n                <ul class="coder-console-output"></ul>\n                <form class="coder-console-input">\n                  <input type="text">\n                </form>\n              </div>\n              <button class="coder-button coder-console-clear">Clear</button>\n            ',e._velm.append(s),e._velm.find(".coder-nav").append(r);var o=e.$container.querySelector(".coder-console-container"),a=e.$container.querySelector(".coder-console-output"),l=e.$container.querySelector(".coder-console-input input"),c=e.$container.querySelector(".coder-console-input"),h=e.$container.querySelector(".coder-console-clear");c.addEventListener("submit",this.submit.bind(this)),l.addEventListener("keydown",this.history.bind(this)),h.addEventListener("click",this.clear.bind(this)),!0===i.autoClear&&e.on("change",this.autoClear.bind(this),29),e.on("change",this.change.bind(this),30),window.addEventListener("message",this.getMessage.bind(this)),this.$coderContainer=e.$container,this.$container=o,this.$input=l,this.$output=a,this.history=[],this.historyIndex=0,this.logCaptureSnippet=n,this.contentCache={html:"",css:"",js:""},this.getIframe=this.getIframe.bind(this)}getIframe(){return this.$coderContainer.querySelector(".coder-pane-result iframe")}getMessage(e){if(e.source===this.getIframe().contentWindow){var t={};try{t=JSON.parse(e.data)}catch(e){}"coder-console-log"===t.type&&this.log(t.message)}}autoClear(e,t){var i=e.content;"js"===e.type&&(i=i.replace(this.logCaptureSnippet,"")),!0!==e.forceRender&&this.contentCache[e.type]===i||this.clear(),this.contentCache[e.type]=i}change(e){var t=e.data;"js"===t.type&&-1===t.content.indexOf(this.logCaptureSnippet)&&(t.content=`${this.logCaptureSnippet}${t.content}`)}capture(){void 0!==window.console&&void 0!==window.console.log||(window.console={log:function(){}});var e=Function.prototype.bind.call(window.console.log,window.console);window.console.log=function(){[].slice.call(arguments).forEach(function(e){window.parent.postMessage(JSON.stringify({type:"coder-console-log",message:e}),"*")}),e.apply(e,arguments)}}log(e="",i){var n=document.createElement("li");t.addClass(n,"coder-console-log"),void 0!==i&&t.addClass(n,`coder-console-log-${i}`),n.innerHTML=e,this.$output.appendChild(n)}submit(e){var t=this.$input.value.trim();if(""===t)return e.preventDefault();this.history.push(t),this.historyIndex=this.history.length,this.log(t,"history"),0!==t.indexOf("return")&&(t="return "+t);try{var i=this.getIframe().contentWindow.eval(`(function() {${t}})()`);this.log(i)}catch(e){this.log(e,"error")}this.$input.value="",this.$container.scrollTop=this.$container.scrollHeight,e.preventDefault()}clear(){this.$output.innerHTML=""}history(e){var t=!1,i=this.$input.selectionStart;38===e.keyCode&&0!==this.historyIndex&&0===i&&(this.historyIndex--,t=!0),40===e.keyCode&&this.historyIndex!==this.history.length-1&&i===this.$input.value.length&&(this.historyIndex++,t=!0),t&&(this.$input.value=this.history[this.historyIndex])}static get categoryName(){return"general"}static get addonName(){return"console"}}return s.register(r),s}),define("skylark-widgets-coder/addons/general/play",["skylark-langx/langx","../../Addon","../../util","../../Coder"],function(e,t,i,n){class r extends t{get options(){return{firstRun:!0}}_init(){super._init();var e=this.coder,t=this.options,i={};!1===t.firstRun&&(i={html:{type:"html",content:""},css:{type:"css",content:""},js:{type:"js",content:""}});var n=document.createElement("button");n.className="coder-button coder-button-play",n.innerHTML="Run",e.$container.appendChild(n),n.addEventListener("click",this.run.bind(this)),e.on("change",this.change.bind(this),10),this.cache=i,this.code={},this.coder=e}change(t){var i=t.data;this.code[i.type]=e.clone(i),void 0!==this.cache[i.type]?this.cache[i.type].forceRender=null:this.cache[i.type]=e.clone(i)}run(){for(let t in this.code)this.cache[t]=e.mixin({forceRender:!0},this.code[t]),this.coder.emit("change",this.cache[t])}static get categoryName(){return"general"}static get addonName(){return"play"}}return r.register(n),r}),define("skylark-widgets-coder/addons/general/render",["skylark-langx/langx","../../Addon","../../util","../../Coder"],function(e,t,i,n){"use strict";class r extends t{_init(){super._init();var e=this.coder,t=(this.options,!!("srcdoc"in document.createElement("iframe"))),i=e.$container.querySelector(".coder-pane-result iframe");window.addEventListener("message",this.domready.bind(this)),e.on("change",this.change.bind(this),100),this.supportSrcdoc=t,this.content={html:"",css:"",js:""},this.frameContent="",this.$resultFrame=i,this.callbacks=[],this.index=0,this.lastCallback=(()=>{})}template(e="",t="",i=""){return`\n      <!doctype html>\n      <html>\n        <head>\n          <script>\n            (function () {\n              window.addEventListener('DOMContentLoaded', function () {\n                window.parent.postMessage(JSON.stringify({\n                  type: 'coder-dom-ready'\n                }), '*')\n              })\n            }())\n          <\/script>\n\n          <style>${e}</style>\n        </head>\n        <body>\n          ${t}\n\n          \x3c!--\n            Coder:\n            Empty script tag prevents malformed HTML from breaking the next script.\n          --\x3e\n          <script><\/script>\n          <script>${i}<\/script>\n        </body>\n      </html>\n    `}change(e){var t=e.data;this.content[t.type]=t.content;var i=this.frameContent;if(this.frameContent=this.template(this.content.css,this.content.html,this.content.js),this.lastCallback=(()=>{this.lastCallback=(()=>{})}),!0===t.forceRender||this.frameContent!==i)if(this.supportSrcdoc){var n=document.createElement("iframe");this.$resultFrame.parentNode.replaceChild(n,this.$resultFrame),this.$resultFrame=n,this.$resultFrame.contentWindow.document.open(),this.$resultFrame.contentWindow.document.write(this.frameContent),this.$resultFrame.contentWindow.document.close()}else{this.$resultFrame.setAttribute("data-srcdoc",this.frameContent);var r='javascript:window.frameElement.getAttribute("data-srcdoc");';this.$resultFrame.setAttribute("src",r),this.$resultFrame.contentWindow&&(this.$resultFrame.contentWindow.location=r)}}domready(e){if(e.source===this.$resultFrame.contentWindow){var t={};try{t=JSON.parse(e.data)}catch(e){}"coder-dom-ready"===t.type&&this.lastCallback()}}static get categoryName(){return"general"}static get addonName(){return"render"}}return r.register(n),r}),define("skylark-widgets-coder/main",["./Coder","./addons/edit/codemirror","./addons/edit/ace","./addons/general/console","./addons/general/play","./addons/general/render"],function(e){return e}),define("skylark-widgets-coder",["skylark-widgets-coder/main"],function(e){return e}),define("skylark-widgets-textpad/textpad",["skylark-langx/skylark"],function(e){return e.attach("widgets.textpad",{})}),define("skylark-easyeditor/EasyEditor",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-browser","skylark-domx-noder","skylark-domx-eventer","skylark-domx-finder","skylark-domx-data","skylark-domx-query","skylark-domx-plugins-base"],function(e,t,i,n,r,s,o,a,l){"use strict";var c=l.Plugin.inherit({klassName:"EasyEditor",_construct:function(e,t){this.elem=e,t=t||{},this.className=t.className||"easyeditor";this.buttons=t.buttons||["bold","italic","link","h2","h3","h4","alignleft","aligncenter","alignright"],this.buttonsHtml=t.buttonsHtml||null,this.overwriteButtonSettings=t.overwriteButtonSettings||null,this.css=t.css||null,this.onLoaded="function"==typeof t.onLoaded?t.onLoaded:null,this.randomString="cls"+Math.random().toString(36).substring(7),this.theme=t.theme||null,this.dropdown=t.dropdown||{},this.characterLimit=t.characterLimit||null,this.characterLimitText=t.characterLimitText||null,this.characterLimitPreventKeypress=t.characterLimitPreventKeypress||!1,this.attachEvents()},attachEvents:function(){this.bootstrap(),this.addToolbar(),this.handleKeypress(),this.handleResizeImage(),this.utils(),null!==this.onLoaded&&this.onLoaded.call(this,this),this.characterLimit&&this.enableCharacterLimit()},detachEvents:function(){var e=a(this.elem).closest("."+this.className+"-wrapper"),t=e.find("."+this.className+"-toolbar");t.remove(),a(this.elem).removeClass(this.className).removeAttr("contenteditable").unwrap()},bootstrap:function(){var e=a(this.elem).prop("tagName").toLowerCase();if("textarea"===e||"input"===e){var t=a(this.elem).attr("placeholder")||"",i=a(this.elem).css("marginTop")||0,n=a(this.elem).css("marginBottom")||0,r="";(i.length>0||n.length>0)&&(r=' style="margin-top: '+i+"; margin-bottom: "+n+'" '),a(this.elem).after('<div id="'+this.randomString+'-editor" placeholder="'+t+'">'+a(this.elem).val()+"</div>"),a(this.elem).hide().addClass(this.randomString+"-bind"),this.elem=document.getElementById(this.randomString+"-editor"),a(this.elem).attr("contentEditable",!0).addClass(this.className).wrap('<div class="'+this.className+'-wrapper"'+r+"></div>")}else a(this.elem).attr("contentEditable",!0).addClass(this.className).wrap('<div class="'+this.className+'-wrapper"></div>');this.$wrapperElem=a(this.elem).parent(),null!==this.css&&a(this.elem).css(this.css),this.containerClass="."+this.className+"-wrapper","string"==typeof this.elem&&(this.elem=a(this.elem).get(0)),null!==this.theme&&a(this.elem).closest(this.containerClass).addClass(this.theme)},handleKeypress:function(){var e=this;a(e.elem).keydown(function(t){if(13===t.keyCode&&!1===e.isSelectionInsideElement("li"))return t.preventDefault(),!0===t.shiftKey?document.execCommand("insertHTML",!1,"<br>"):document.execCommand("insertHTML",!1,"<br><br>"),!1}),e.elem.addEventListener("paste",function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain").replace(/\n/gi,"<br>");document.execCommand("insertHTML",!1,t)})},isSelectionInsideElement:function(e){var t,i;for(e=e.toUpperCase(),window.getSelection?(t=window.getSelection()).rangeCount>0&&(i=t.getRangeAt(0).commonAncestorContainer):(t=document.selection)&&"Control"!=t.type&&(i=t.createRange().parentElement());i;){if(1==i.nodeType&&i.tagName==e)return!0;i=i.parentNode}return!1},addToolbar:function(){a(this.elem).before('<div class="'+this.className+'-toolbar"><ul></ul></div>'),this.$toolbarContainer=this.$wrapperElem.find("."+this.className+"-toolbar"),this.populateButtons()},injectButton:function(e){var i,n=this;if(null!==n.overwriteButtonSettings&&void 0!==n.overwriteButtonSettings[e.buttonIdentifier]){var r=t.extend({},e,n.overwriteButtonSettings[e.buttonIdentifier]);e=r}if(null!==n.buttonsHtml&&void 0!==n.buttonsHtml[e.buttonIdentifier]&&(e.buttonHtml=n.buttonsHtml[e.buttonIdentifier]),i=e.buttonTitle?e.buttonTitle:e.buttonIdentifier.replace(/\W/g," "),e.buttonHtml)if(void 0!==e.childOf){var s=n.$toolbarContainer.find(".toolbar-"+e.childOf).parent("li");0===s.find("ul").length&&s.append("<ul></ul>"),(s=s.find("ul")).append('<li><button type="button" class="toolbar-'+e.buttonIdentifier+'" title="'+i+'">'+e.buttonHtml+"</button></li>")}else n.$toolbarContainer.children("ul").append('<li><button type="button" class="toolbar-'+e.buttonIdentifier+'" title="'+i+'">'+e.buttonHtml+"</button></li>");"function"==typeof e.clickHandler&&a(n.elem).closest(n.containerClass).on("click",".toolbar-"+e.buttonIdentifier,function(t){void 0!==typeof e.hasChild&&!0===e.hasChild?t.stopPropagation():t.preventDefault(),e.clickHandler.call(this,this),a(n.elem).trigger("keyup")})},openDropdownOf:function(e){a(this.elem).closest(this.containerClass).find(".toolbar-"+e).parent().children("ul").show()},populateButtons:function(){var e=this;t.each(e.buttons,function(t,i){"function"==typeof e[i]&&e[i]()})},handleResizeImage:function(){var e=this;a("html").on("click",e.containerClass+" figure",function(e){e.stopPropagation(),a(this).addClass("is-resizable")}),a("html").on("mousemove",e.containerClass+" figure.is-resizable",function(e){a(this).find("img").css({width:a(this).width()+"px"})}),a(document).click(function(){a(e.elem).find("figure").removeClass("is-resizable")})},getSelection:function(){if(window.getSelection){var e=window.getSelection();if(e.rangeCount)return e}return!1},removeFormatting:function(e){var i=e.inFullArea;if(!0===this.isSelectionOutsideOfEditor())return!1;if(!1===i){var n=this.getSelection(),r=n.toString();if(n&&r.length>0){var s=n.getRangeAt(0),o=a(s.commonAncestorContainer.parentNode);if(o.attr("class")===this.className||o.attr("class")===this.className+"-wrapper"){var l=document.createElement("span");a(l).attr("data-value","temp").html(r.replace(/\n/gi,"<br>")),s.deleteContents(),s.insertNode(l),a('[data-value="temp"]').contents().unwrap()}else{var c,h=!1;t.each(o.parentsUntil(this.elem),function(e,t){c=t,h=!0}),!0===h?a(c).html(a(c).text().replace(/\n/gi,"<br>")).contents().unwrap():o.contents().unwrap()}}}else a(this.elem).html(a(this.elem).text().replace(/\n/gi,"<br>"))},removeEmptyTags:function(){a(this.elem).html(a(this.elem).html().replace(/(<(?!\/)[^>]+>)+(<\/[^>]+>)+/,""))},removeBlockElementFromSelection:function(e,t){var i="";!0===(t=void 0!==t&&t)&&(i=", br");var n=e.getRangeAt(0),r=n.cloneContents(),s=document.createElement("temp");return a(s).html(r),a(s).find("h1, h2, h3, h4, h5, h6, p, div"+i).each(function(){a(this).replaceWith(this.childNodes)}),a(s).html()},wrapSelectionWithNodeName:function(e){if(!0===this.isSelectionOutsideOfEditor())return!1;var t={name:"span",blockElement:!1,style:null,class:null,attribute:null,keepHtml:!1};"string"==typeof e?t.name=e:(t.name=e.nodeName||t.name,t.blockElement=e.blockElement||t.blockElement,t.style=e.style||t.style,t.class=e.class||t.class,t.attribute=e.attribute||t.attribute,t.keepHtml=e.keepHtml||t.keepHtml);var i=this.getSelection();if(i&&i.toString().length>0&&i.rangeCount){var n=this.isAlreadyWrapped(i,t),r=i.getRangeAt(0).cloneRange(),s=document.createElement(t.name);if(null===t.style&&null===t.class&&null===t.attribute||(s=this.addAttribute(s,t)),this.selectionContainsHtml(r)){if(r=i.getRangeAt(0),!0===t.keepHtml){var o=r.cloneContents(),l=document.createElement("div");l.appendChild(o),a(s).html(l.innerHTML)}else s.textContent=i.toString();r.deleteContents(),r.insertNode(s),r.commonAncestorContainer.localName===t.name&&(a(r.commonAncestorContainer).contents().unwrap(),this.removeEmptyTags())}else r.surroundContents(s),i.removeAllRanges(),i.addRange(r);!0===n&&this.removeWrappedDuplicateTag(s),this.removeEmptyTags(),i.removeAllRanges()}},wrapSelectionWithList:function(e){if(e=e||"ul",!0===this.isSelectionOutsideOfEditor())return!1;var i=this.getSelection();if(i&&i.toString().length>0&&i.rangeCount){var n=this.removeBlockElementFromSelection(i,!0),r=n.split("\n").filter(function(e){return""!==e}),s=t.map(r,function(e){return"<li>"+t.trim(e)+"</li>"}),o=document.createElement(e);a(o).html(s);var l=i.getRangeAt(0);l.deleteContents(),l.insertNode(o),i.removeAllRanges()}},selectionContainsHtml:function(e){return e.startContainer.parentNode.className!==this.className+"-wrapper"},isAlreadyWrapped:function(e,i){var n=e.getRangeAt(0),r=a(n.commonAncestorContainer),s=!1;return r.parent().prop("tagName").toLowerCase()===i.name&&!1===r.parent().hasClass(this.className)?s=!0:!0===i.blockElement?t.each(r.parentsUntil(this.elem),function(e,i){var n=i.tagName.toLowerCase();-1!==t.inArray(n,["h1","h2","h3","h4","h5","h6"])&&(s=!0)}):t.each(r.parentsUntil(this.elem),function(e,t){var n=t.tagName.toLowerCase();n===i.name&&(s=!0)}),s},removeWrappedDuplicateTag:function(e){var t=e.tagName;a(e).unwrap(),a(e).prop("tagName")===t&&!1===a(e).parent().hasClass(this.className)&&a(e).parent().hasClass(this.className+"-wrapper")&&a(e).unwrap()},addAttribute:function(e,i){return null!==i.style&&a(e).attr("style",i.style),null!==i.class&&a(e).addClass(i.class),null!==i.attribute&&(!0===t.isArray(i.attribute)?(!0!==t.isArray(i.attribute[0])&&(i.attribute[0]=[i.attribute[0],i.attribute[1]]),t.each(i.attribute,function(t,i){a(e).attr(i[0],i[1])})):a(e).attr(i.attribute)),e},insertAtCaret:function(e){if(!0===this.isSelectionOutsideOfEditor())return!1;if(this.getSelection()){var t=this.getSelection().getRangeAt(0);t.insertNode(e)}else a(e).appendTo(this.elem)},isSelectionOutsideOfEditor:function(){return!this.elementContainsSelection(this.elem)},isActive:function(){return this.elementContainsSelection(this.elem)},readonly:function(e){return void 0===e?a(this.elem).attr("contentEditable"):(a(this.elem).attr("contentEditable",e&&!0),this)},isOrContains:function(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1},elementContainsSelection:function(e){var t;if(window.getSelection){if((t=window.getSelection()).rangeCount>0){for(var i=0;i<t.rangeCount;++i)if(!this.isOrContains(t.getRangeAt(i).commonAncestorContainer,e))return!1;return!0}}else if((t=document.selection)&&"Control"!==t.type)return this.isOrContains(t.createRange().parentElement(),e);return!1},insertHtml:function(e){a(this.elem).find("temp").html(e)},utils:function(){var e,t=this;(a("html").on("click","."+t.className+"-modal-close",function(e){e.preventDefault(),t.closeModal("#"+a(this).closest("."+t.className+"-modal").attr("id"))}),a("."+t.randomString+"-bind").length>0)&&a("html").on("click keyup",t.elem,function(){var i=t.elem;clearTimeout(e),e=setTimeout(function(){a("."+t.randomString+"-bind").html(a(i).html())},250)});a(document).click(function(e){a("."+t.className).closest("."+t.className+"-wrapper").find("."+t.className+"-toolbar > ul > li > ul").hide()})},getValue:function(){var e=a(this.elem).html(),t=a(this.elem).text(),i=t.length,n=t.trim().split(/\s+/).length;return{html:e,plainText:t,characterCount:i,wordCount:n}},enableCharacterLimit:function(){var e=this,t=e.characterLimit-e.getValue().characterCount;a(e.elem).after('<div class="'+e.className+"-character-remaining "+(t<=0?"is-invalid":"is-valid")+'">'+(e.characterLimitText?e.characterLimitText+" "+t:t)+"</div>"),a("html").on("keyup",e.elem,function(){var t=e.getValue(),i=e.characterLimit-t.characterCount,n=a(e.containerClass).find('[class*="-character-remaining"]');e.characterLimitText?n.text(e.characterLimitText+" "+i):n.text(i),i<=0?n.removeClass("is-valid").addClass("is-invalid"):n.removeClass("is-invalid").addClass("is-valid")}),a("html").on("keypress",e.elem,function(){var t=e.getValue();if(e.characterLimitPreventKeypress&&e.characterLimit<=t.characterCount)return!1})},getYoutubeVideoIdFromUrl:function(e){if(0===e.length)return!1;return e=e.replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/),void 0!==e[2]?e[2].split(/[^0-9a-z_\-]/i)[0]:e},openModal:function(e){var t=document.createElement("temp");t.textContent=".",this.insertAtCaret(t),a(e).removeClass("is-hidden")},closeModal:function(e){a(e).addClass("is-hidden").find("input").val(""),a(e).find("."+this.className+"-modal-content-body-loader").css("width","0");var t=a(this.elem).find("temp");"."===t.html()?t.remove():t.contents().unwrap(),a(this.elem).focus()},bold:function(){var e=this,t={buttonIdentifier:"bold",buttonHtml:"B",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"strong",keepHtml:!0})}};e.injectButton(t)},italic:function(){var e=this,t={buttonIdentifier:"italic",buttonHtml:"I",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"em",keepHtml:!0})}};e.injectButton(t)},h2:function(){var e=this,t={buttonIdentifier:"header-2",buttonHtml:"H2",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"h2",blockElement:!0})}};e.injectButton(t)},h3:function(){var e=this,t={buttonIdentifier:"header-3",buttonHtml:"H3",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"h3",blockElement:!0})}};e.injectButton(t)},h4:function(){var e=this,t={buttonIdentifier:"header-4",buttonHtml:"H4",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"h4",blockElement:!0})}};e.injectButton(t)},x:function(){var e=this,t={buttonIdentifier:"remove-formatting",buttonHtml:"x",clickHandler:function(){e.removeFormatting({inFullArea:!1})}};e.injectButton(t)},alignleft:function(){var e=this,t={buttonIdentifier:"align-left",buttonHtml:"Align left",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"p",style:"text-align: left",class:"text-left",keepHtml:!0})}};e.injectButton(t)},aligncenter:function(){var e=this,t={buttonIdentifier:"align-center",buttonHtml:"Align center",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"p",style:"text-align: center",class:"text-center",keepHtml:!0})}};e.injectButton(t)},alignright:function(){var e=this,t={buttonIdentifier:"align-right",buttonHtml:"Align right",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"p",style:"text-align: right",class:"text-right",keepHtml:!0})}};e.injectButton(t)},quote:function(){var e=this,t={buttonIdentifier:"quote",buttonHtml:"Quote",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"blockquote"})}};e.injectButton(t)},code:function(){var e=this,t={buttonIdentifier:"code",buttonHtml:"Code",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"pre"})}};e.injectButton(t)},link:function(){var e=this,t={buttonIdentifier:"link",buttonHtml:"Link",clickHandler:function(){e.wrapSelectionWithNodeName({nodeName:"a",attribute:["href",prompt("Insert link","")]})}};e.injectButton(t)},list:function(){var e=this,t={buttonIdentifier:"list",buttonHtml:"List",clickHandler:function(){e.wrapSelectionWithList()}};e.injectButton(t)},source:function(){var e=this,t={buttonIdentifier:"source",buttonHtml:"Source",clickHandler:function(t){var i,n=a(t).closest("."+e.className+"-wrapper"),r=n.find("."+e.className);a(t).hasClass("is-view-source-mode")?(i=a("body > textarea."+e.className+"-temp"),r.css("visibility","visible"),i.remove(),a(t).removeClass("is-view-source-mode")):(a("body").append('<textarea class="'+e.className+'-temp" style="position: absolute; margin: 0;"></textarea>'),(i=a("body > textarea."+e.className+"-temp")).css({top:r.offset().top,left:r.offset().left,width:r.outerWidth(),height:r.outerHeight()}).html(r.html()),void 0!==r.css("border")&&i.css("border",r.css("border")),r.css("visibility","hidden"),a(t).addClass("is-view-source-mode"),i.on("keyup click change keypress",function(){r.html(a(this).val())}))}};e.injectButton(t)}});return a.fn.easyEditor=function(e){return this.each(function(){o.data(this,"plugin_easyEditor")||o.data(this,"plugin_easyEditor",new c(this,e))})},c}),define("skylark-widgets-textpad/Preview",["skylark-langx/langx","skylark-domx-browser","skylark-domx-data","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-velm","skylark-domx-query","skylark-widgets-base/Widget"],function(e,t,i,n,r,s,o,a,l){"use strict";var c=l.inherit({klassName:"Preview",pluginName:"lark.codeeditor.preview",options:{className:"easyeditor",css:null,onLoaded:null,theme:null},_init:function(){this.elem=this._elm,this.className=this.options.className,this.css=this.options.css,this.onLoaded=this.options.onLoaded,this.randomString="Cls"+Math.random().toString(36).substring(7),this.theme=this.options.theme;var e=this.doc=this._elm.ownerDocument;this.win=e.defaultView||e.parentWindow,this.attachEvents()},attachEvents:function(){this.bootstrap(),this.handleKeypress(),this.handleResizeImage(),this.utils(),null!==this.onLoaded&&this.onLoaded.call(this)},detachEvents:function(){a(this.elem).removeClass(this.className).removeAttr("contenteditable").unwrap()},bootstrap:function(){a(this.elem).attr("contentEditable",!0).addClass(this.className).wrap('<div class="'+this.className+'-wrapper"></div>'),this.$wrapperElem=a(this.elem).parent(),null!==this.css&&a(this.elem).css(this.css),this.containerClass="."+this.className+"-wrapper","string"==typeof this.elem&&(this.elem=a(this.elem).get(0)),null!==this.theme&&a(this.elem).closest(this.containerClass).addClass(this.theme)},handleKeypress:function(){var e=this;a(e.elem).keydown(function(t){13===t.keyCode&&e.isSelectionInsideElement("li")}),e.elem.addEventListener("paste",function(t){t.preventDefault();var i=t.clipboardData.getData("text/plain").replace(/\n/gi,"<br>");e.doc.execCommand("insertHTML",!1,i)})},isSelectionInsideElement:function(e){var t,i,n=this.win,r=this.doc;for(e=e.toUpperCase(),n.getSelection?(t=n.getSelection()).rangeCount>0&&(i=t.getRangeAt(0).commonAncestorContainer):(t=r.selection)&&"Control"!=t.type&&(i=t.createRange().parentElement());i;){if(1==i.nodeType&&i.tagName==e)return!0;i=i.parentNode}return!1},handleResizeImage:function(){var e=this;a("html").on(e.containerClass+" figure","click",function(e){e.stopPropagation(),a(this).addClass("is-resizable")}),a("html").on(e.containerClass+" figure.is-resizable","mousemove",function(e){a(this).find("img").css({width:a(this).width()+"px"})}),a(e.doc).click(function(){a(e.elem).find("figure").removeClass("is-resizable")})},getSelection:function(){if(this.win.getSelection){var e=this.win.getSelection();if(e.rangeCount)return e}return!1},removeFormatting:function(e){var t=e.inFullArea;if(!0===this.isSelectionOutsideOfEditor())return!1;if(!1===t){var i=this.getSelection(),n=i.toString();if(i&&n.length>0){var r=i.getRangeAt(0),s=a(r.commonAncestorContainer.parentNode);if(s.attr("class")===this.className||s.attr("class")===this.className+"-wrapper"){var o=this.doc.createElement("span");a(o).attr("data-value","temp").html(n.replace(/\n/gi,"<br>")),r.deleteContents(),r.insertNode(o),a('[data-value="temp"]').contents().unwrap()}else{var l,c=!1;a.each(s.parentsUntil(this.elem),function(e,t){l=t,c=!0}),!0===c?a(l).html(a(l).text().replace(/\n/gi,"<br>")).contents().unwrap():s.contents().unwrap()}}}else a(this.elem).html(a(this.elem).text().replace(/\n/gi,"<br>"))},removeEmptyTags:function(){a(this.elem).html(a(this.elem).html().replace(/(<(?!\/)[^>]+>)+(<\/[^>]+>)+/,""))},removeBlockElementFromSelection:function(e,t){var i="";!0===(t=void 0!==t&&t)&&(i=", br");var n=e.getRangeAt(0),r=n.cloneContents(),s=this.doc.createElement("temp");return a(s).html(r),a(s).find("h1, h2, h3, h4, h5, h6, p, div"+i).each(function(){a(this).replaceWith(this.childNodes)}),a(s).html()},wrapSelectionWithNodeName:function(e){if(!0===this.isSelectionOutsideOfEditor())return!1;var t={name:"span",blockElement:!1,style:null,class:null,attribute:null,keepHtml:!1};"string"==typeof e?t.name=e:(t.name=e.nodeName||t.name,t.blockElement=e.blockElement||t.blockElement,t.style=e.style||t.style,t.class=e.class||t.class,t.attribute=e.attribute||t.attribute,t.keepHtml=e.keepHtml||t.keepHtml);var i=this.getSelection();if(i&&i.toString().length>0&&i.rangeCount){var n=this.isAlreadyWrapped(i,t),r=i.getRangeAt(0).cloneRange(),s=this.doc.createElement(t.name);if(null===t.style&&null===t.class&&null===t.attribute||(s=this.addAttribute(s,t)),this.selectionContainsHtml(r)){if(r=i.getRangeAt(0),!0===t.keepHtml){var o=r.cloneContents(),l=this.doc.createElement("div");l.appendChild(o),a(s).html(l.innerHTML)}else s.textContent=i.toString();r.deleteContents(),r.insertNode(s),r.commonAncestorContainer.localName===t.name&&(a(r.commonAncestorContainer).contents().unwrap(),this.removeEmptyTags())}else r.surroundContents(s),i.removeAllRanges(),i.addRange(r);!0===n&&this.removeWrappedDuplicateTag(s),this.removeEmptyTags(),i.select(),r.select()}},wrapSelectionWithList:function(e){if(e=e||"ul",!0===this.isSelectionOutsideOfEditor())return!1;var t=this.getSelection();if(t&&t.toString().length>0&&t.rangeCount){var i=this.removeBlockElementFromSelection(t,!0),n=i.split("\n").filter(function(e){return""!==e}),r=a.map(n,function(e){return"<li>"+a.trim(e)+"</li>"}),s=this.doc.createElement(e);a(s).html(r);var o=t.getRangeAt(0);o.deleteContents(),o.insertNode(s),t.removeAllRanges()}},selectionContainsHtml:function(e){return e.startContainer.parentNode.className!==this.className+"-wrapper"},isAlreadyWrapped:function(e,t){var i=e.getRangeAt(0),n=a(i.commonAncestorContainer),r=!1;return n.parent().prop("tagName").toLowerCase()===t.name&&!1===n.parent().hasClass(this.className)?r=!0:!0===t.blockElement?a.each(n.parentsUntil(this.elem),function(e,t){var i=t.tagName.toLowerCase();-1!==a.inArray(i,["h1","h2","h3","h4","h5","h6"])&&(r=!0)}):a.each(n.parentsUntil(this.elem),function(e,i){var n=i.tagName.toLowerCase();n===t.name&&(r=!0)}),r},removeWrappedDuplicateTag:function(e){var t=e.tagName;a(e).unwrap(),a(e).prop("tagName")===t&&!1===a(e).parent().hasClass(this.className)&&a(e).parent().hasClass(this.className+"-wrapper")&&a(e).unwrap()},addAttribute:function(e,t){return null!==t.style&&a(e).attr("style",t.style),null!==t.class&&a(e).addClass(t.class),null!==t.attribute&&(!0===a.isArray(t.attribute)?a(e).attr(t.attribute[0],t.attribute[1]):a(e).attr(t.attribute)),e},insertAtCaret:function(e){if(!0===this.isSelectionOutsideOfEditor())return!1;if(this.getSelection()){var t=this.getSelection().getRangeAt(0);t.insertNode(e)}else a(e).appendTo(this.elem)},isSelectionOutsideOfEditor:function(){return!this.elementContainsSelection(this.elem)},isActive:function(){return this.elementContainsSelection(this.elem)},readonly:function(e){return void 0===e?a(this.elem).attr("contentEditable"):(a(this.elem).attr("contentEditable",e&&!0),this)},isOrContains:function(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1},elementContainsSelection:function(e){var t;if(this.win.getSelection){if((t=this.win.getSelection()).rangeCount>0){for(var i=0;i<t.rangeCount;++i)if(!this.isOrContains(t.getRangeAt(i).commonAncestorContainer,e))return!1;return!0}}else if((t=this.doc.selection)&&"Control"!==t.type)return this.isOrContains(t.createRange().parentElement(),e);return!1},insertHtml:function(e){a(this.elem).find("temp").html(e)},utils:function(){var e,t=this;(a("html").on("."+t.className+"-modal-close","click",function(e){e.preventDefault(),t.closeModal("#"+a(this).closest("."+t.className+"-modal").attr("id"))}),a("."+t.randomString+"-bind").length>0)&&a("html").on(t.elem,"click keyup",function(){var i=t.elem;clearTimeout(e),e=setTimeout(function(){a("."+t.randomString+"-bind").html(a(i).html())},250)});a(t.doc).click(function(e){a("."+t.className).closest("."+t.className+"-wrapper").find("."+t.className+"-toolbar > ul > li > ul").hide()})},getYoutubeVideoIdFromUrl:function(e){if(0===e.length)return!1;return e=e.replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/),void 0!==e[2]?e[2].split(/[^0-9a-z_\-]/i)[0]:e},openModal:function(e){var t=this.doc.createElement("temp");t.textContent=".",this.insertAtCaret(t),a(e).removeClass("is-hidden")},closeModal:function(e){a(e).addClass("is-hidden").find("input").val(""),a(e).find("."+this.className+"-modal-content-body-loader").css("width","0");var t=a(this.elem).find("temp");"."===t.html()?t.remove():t.contents().unwrap(),a(this.elem).focus()},bold:function(){this.doc.execCommand("Bold")},italic:function(){this.doc.execCommand("Italic")},strike:function(){this.doc.execCommand("strikethrough")},listOl:function(){this.doc.execCommand("insertorderedlist")},listUl:function(){this.doc.execCommand("insertunorderedlist")},h2:function(){this.doc.execCommand("h2")},h3:function(){this.doc.execCommand("h3")},h4:function(){this.doc.execCommand("h4")},x:function(){this.doc.execCommand("h4")},alignleft:function(){this.doc.execCommand("justifyleft")},aligncenter:function(){this.doc.execCommand("justifycenter")},alignright:function(){this.doc.execCommand("justifyright")},alignfull:function(){this.doc.execCommand("justifyfull")},blockquote:function(){this.doc.execCommand("blockquote")},code:function(){this.doc.execCommand("p")},inserthorizontalrule:function(){this.doc.execCommand("inserthorizontalrule")},image:function(){var e=prompt("Insert Image URL","http://"),t=new RegExp("^((http|https)://|(mailto:)|(//))[a-z0-9]","i");null!==e&&""!==e&&"http://"!==e&&t.test(e)&&this.doc.execCommand("insertimage",!1,e)},link:function(){var e=prompt("Insert URL","http://"),t=new RegExp("^((http|https)://|(mailto:)|(//))[a-z0-9]","i");null!==e&&""!==e&&"http://"!==e&&t.test(e)&&this.doc.execCommand("createlink",!1,e)},indent:function(){this.doc.execCommand("indent")},outdent:function(){this.doc.execCommand("outdent")},toMd:function(){return toMarkdown(this.elem.innerHTML)}});return c}),define("skylark-widgets-textpad/helper",["skylark-langx/langx","skylark-domx-query","./textpad"],function(e,t,i){var n={debounce:function(e,t,i){var n;return function(){var r=this,s=arguments,o=i&&!n;clearTimeout(n),n=setTimeout(function(){n=null,i||e.apply(r,s)},t),o&&e.apply(r,s)}},options:function(t){if("string"!=e.type(t))return t;-1!=t.indexOf(":")&&"}"!=t.trim().substr(-1)&&(t="{"+t+"}");var i=t?t.indexOf("{"):-1,r={};if(-1!=i)try{r=n.str2json(t.substr(i))}catch(e){}return r},str2json:function(e,t){try{return t?JSON.parse(e.replace(/([\$\w]+)\s*:/g,function(e,t){return'"'+t+'":'}).replace(/'([^']+)'/g,function(e,t){return'"'+t+'"'})):new Function("","var json = "+e+"; return JSON.parse(JSON.stringify(json));")()}catch(e){return!1}}};return i.helper=n}),define("skylark-widgets-textpad/Editor",["skylark-langx/langx","skylark-domx-query","skylark-widgets-base/Widget","skylark-codemirror/CodeMirror","skylark-easyeditor/EasyEditor","./textpad","./Preview","./helper"],function(e,t,i,n,r,s,o,a){var l=i.inherit({options:{addons:[],iframe:!1,mode:"split",markdown:!1,autocomplete:!0,height:500,maxsplitsize:1e3,codemirror:{mode:"htmlmixed",lineWrapping:!0,dragDrop:!1,autoCloseTags:!0,matchTags:!0,autoCloseBrackets:!0,matchBrackets:!0,indentUnit:4,indentWithTabs:!1,tabSize:4,hintOptions:{completionSingle:!1}},toolbar:["bold","italic","strike","link","image","blockquote","listUl","listOl"],lblPreview:"Preview",lblCodeview:"HTML",lblMarkedview:"Markdown",template:['<div class="uk-htmleditor uk-clearfix" data-mode="split">','<div class="uk-htmleditor-navbar">','<ul class="uk-htmleditor-navbar-nav uk-htmleditor-toolbar"></ul>','<div class="uk-htmleditor-navbar-flip">','<ul class="uk-htmleditor-navbar-nav">','<li class="uk-htmleditor-button-code"><a>{:lblCodeview}</a></li>','<li class="uk-htmleditor-button-preview"><a>{:lblPreview}</a></li>','<li><a data-htmleditor-button="fullscreen"><i class="fa fa-expand"></i></a></li>',"</ul>","</div>","</div>",'<div class="uk-htmleditor-content">','<div class="uk-htmleditor-code"></div>','<div class="uk-htmleditor-preview"><div></div></div>',"</div>","</div>"].join("")},_init:function(){var e=this,i=this.options.template;this.element=t(this._elm),this.options.iframe=!0,this.CodeMirror=this.options.CodeMirror||n,this.buttons={},this.addButtons({fullscreen:{title:"Fullscreen",label:'<i class="fa fa-expand"></i>'},bold:{title:"Bold",label:'<i class="fa fa-bold"></i>'},italic:{title:"Italic",label:'<i class="fa fa-italic"></i>'},strike:{title:"Strikethrough",label:'<i class="fa fa-strikethrough"></i>'},blockquote:{title:"Blockquote",label:'<i class="fa fa-quote-right"></i>'},link:{title:"Link",label:'<i class="fa fa-link"></i>'},image:{title:"Image",label:'<i class="fa fa-image"></i>'},listUl:{title:"Unordered List",label:'<i class="fa fa-list-ul"></i>'},listOl:{title:"Ordered List",label:'<i class="fa fa-list-ol"></i>'}}),i=(i=i.replace(/\{:lblPreview}/g,this.options.lblPreview)).replace(/\{:lblCodeview}/g,this.options.lblCodeview),this.htmleditor=t(i),this.content=this.htmleditor.find(".uk-htmleditor-content"),this.toolbar=this.htmleditor.find(".uk-htmleditor-toolbar"),t(this.toolbar).attr("unselectable","on").css("user-select","none").on("selectstart",!1),this.preview=this.htmleditor.find(".uk-htmleditor-preview").children().eq(0),this.code=this.htmleditor.find(".uk-htmleditor-code"),this.element.before(this.htmleditor).appendTo(this.code),this.editor=this.CodeMirror.fromTextArea(this.element[0],this.options.codemirror),this.editor.htmleditor=this,this.editor.on("change",a.debounce(function(){e.render()},150)),this.editor.on("change",function(){e.editor.save(),e.element.trigger("input")}),this.code.find(".CodeMirror").css("height",this.options.height),this.options.iframe?(this.iframe=t('<iframe class="uk-htmleditor-iframe" frameborder="0" scrolling="auto" height="100" width="100%"></iframe>'),this.preview.append(this.iframe),this.iframe[0].contentWindow.document.open(),this.iframe[0].contentWindow.document.close(),this.preview.container=t(this.iframe[0].contentWindow.document).find("body"),"string"==typeof this.options.iframe&&this.preview.container.parent().append('<link rel="stylesheet" href="'+this.options.iframe+'">')):this.preview.container=this.preview,this.previewer=this.preview.container.plugin("lark.codeeditor.preview"),t(window).on("resize load",a.debounce(function(){e.fit()},200));var r=this.iframe?this.preview.container:e.preview.parent(),s=this.code.find(".CodeMirror-sizer"),o=this.code.find(".CodeMirror-scroll").on("scroll",a.debounce(function(){if("tab"!=e.htmleditor.attr("data-mode")){var t=s.height()-o.height(),i=r[0].scrollHeight-(e.iframe?e.iframe.height():r.height()),n=i/t,a=o.scrollTop()*n;r.scrollTop(a)}},10));this.htmleditor.on("click",".uk-htmleditor-button-code, .uk-htmleditor-button-preview",function(i){i.preventDefault(),"tab"==e.htmleditor.attr("data-mode")&&(e.htmleditor.find(".uk-htmleditor-button-code, .uk-htmleditor-button-preview").removeClass("uk-active").filter(this).addClass("uk-active"),e.activetab=t(this).hasClass("uk-htmleditor-button-code")?"code":"preview","code"==e.activetab&&e.editor.setValue(e.previewer.toMd()),e.htmleditor.attr("data-active-tab",e.activetab),e.editor.refresh())}),this.htmleditor.on("click","a[data-htmleditor-button]",function(){e.code.is(":visible")?e.trigger("action."+t(this).data("htmleditor-button"),[e.editor]):e.previewer[t(this).data("htmleditor-button")]()}),this.preview.parent().css("height",this.code.height()),this.options.autocomplete&&this.CodeMirror.showHint&&this.CodeMirror.hint&&this.CodeMirror.hint.html&&this.editor.on("inputRead",a.debounce(function(){var t=e.editor.getDoc(),i=t.getCursor(),n=e.CodeMirror.innerMode(e.editor.getMode(),e.editor.getTokenAt(i).state).mode.name;if("xml"==n){var r=e.editor.getCursor(),s=e.editor.getTokenAt(r);"<"!=s.string.charAt(0)&&"attribute"!=s.type||e.CodeMirror.showHint(e.editor,e.CodeMirror.hint.html,{completeSingle:!1})}},100)),this.addons=[],(this.options.addons.length?this.options.addons:Object.keys(c)).forEach(function(t){c[t].init&&(c[t].init(e),e.addons[t]=!0)}),this.debouncedRedraw=a.debounce(function(){e.redraw()},5),e.debouncedRedraw(),this.element.attr("data-uk-check-display",1).on("display.uk.check",function(e){this.htmleditor.is(":visible")&&this.fit()}.bind(this))},addButton:function(e,t){this.buttons[e]=t},addButtons:function(t){e.extend(this.buttons,t)},replaceInPreview:function(e,t){var i=this.editor,n=[],r=i.getValue(),s=-1,o=0;function a(e){var t=i.getValue().substring(0,e).split("\n");return{line:t.length-1,ch:t[t.length-1].length}}return this.currentvalue=this.currentvalue.replace(e,function(){s=r.indexOf(arguments[0],++s);var e={matches:arguments,from:a(s),to:a(s+arguments[0].length),replace:function(t){i.replaceRange(t,e.from,e.to)},inRange:function(t){return t.line===e.from.line&&t.line===e.to.line?t.ch>=e.from.ch&&t.ch<e.to.ch:t.line===e.from.line&&t.ch>=e.from.ch||t.line>e.from.line&&t.line<e.to.line||t.line===e.to.line&&t.ch<e.to.ch}},l="string"==typeof t?t:t(e,o);return l||""===l?(o++,n.push(e),l):arguments[0]}),n},_buildtoolbar:function(){if(this.options.toolbar&&this.options.toolbar.length){var e=this,t=[];this.toolbar.empty(),this.options.toolbar.forEach(function(i){if(e.buttons[i]){var n=e.buttons[i].title?e.buttons[i].title:i;t.push('<li><a data-htmleditor-button="'+i+'" title="'+n+'" data-uk-tooltip>'+e.buttons[i].label+"</a></li>")}}),this.toolbar.html(t.join("\n"))}},fit:function(){var e=this.options.mode;"split"==e&&this.htmleditor.width()<this.options.maxsplitsize&&(e="tab"),"tab"==e&&(this.activetab||(this.activetab="code",this.htmleditor.attr("data-active-tab",this.activetab)),this.htmleditor.find(".uk-htmleditor-button-code, .uk-htmleditor-button-preview").removeClass("uk-active").filter("code"==this.activetab?".uk-htmleditor-button-code":".uk-htmleditor-button-preview").addClass("uk-active")),this.previewer.readonly("tab"==e),this.editor.refresh(),this.preview.parent().css("height",this.code.height()),this.htmleditor.attr("data-mode",e)},redraw:function(){this._buildtoolbar(),this.render(),this.fit()},getMode:function(){return this.editor.getOption("mode")},getCursorMode:function(){var e={mode:"html"};return this.trigger("cursorMode",[e]),e.mode},render:function(){if(this.currentvalue=this.editor.getValue(),!this.currentvalue)return this.element.val(""),void this.preview.container.html("");this.trigger("render",[this]),this.trigger("renderLate",[this]),this.preview.container.html(this.currentvalue)},addShortcut:function(t,i){var n={};return e.isArray(t)||(t=[t]),t.forEach(function(e){n[e]=i}),this.editor.addKeyMap(n),n},addShortcutAction:function(e,t){var i=this;this.addShortcut(t,function(){i.element.trigger("action."+e,[i.editor])})},insertImage:function(e,i){if(this.code.is(":visible")){var i="\n!["+i+"]("+e+")\n";this.replaceSelection(i)}else{var n='<img src="'+e+'" alt="'+i+'">';this.previewer.insertAtCaret(t(n)[0])}},replaceSelection:function(e){var t=this.editor.getSelection();if(!t.length){for(var i=this.editor.getCursor(),n=this.editor.getLine(i.line),r=i.ch,s=r;s<n.length&&/[\w$]+/.test(n.charAt(s));)++s;for(;r&&/[\w$]+/.test(n.charAt(r-1));)--r;var o=r!=s&&n.slice(r,s);o&&(this.editor.setSelection({line:i.line,ch:r},{line:i.line,ch:s}),t=o)}var a=e.replace("$1",t);this.editor.replaceSelection(a,"end"),this.editor.focus()},replaceLine:function(e){var t=this.editor.getDoc().getCursor(),i=this.editor.getLine(t.line),n=e.replace("$1",i);this.editor.replaceRange(n,{line:t.line,ch:0},{line:t.line,ch:i.length}),this.editor.setCursor({line:t.line,ch:n.length}),this.editor.focus()},save:function(){this.editor.save()},_setPreviewFocus:function(){this.previewr.win.focus();var e=this.range;e?(e.select(),e=this.range=null):editor.doc.selection&&(e=editor.doc.selection.createRange())}}),c={};return l.addon=function(e,t){c[e]=t},s.Editor=l}),define("skylark-widgets-textpad/main",["./textpad","./Editor"],function(e){return e}),define("skylark-widgets-textpad",["skylark-widgets-textpad/main"],function(e){return e}),define("skylark-jqueryui/version",["skylark-jquery"],function(e){return e.ui=e.ui||{},e.ui.version="@VERSION"}),define("skylark-jqueryui/data",["skylark-jquery","./version"],function(e){return e.expr.pseudos}),define("skylark-jqueryui/disable-selection",["skylark-jquery","./version"],function(e){return e.fn.extend({disableSelection:(t="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(t+".ui-disableSelection",function(e){e.preventDefault()})}),enableSelection:function(){return this.off(".ui-disableSelection")}});var t}),define("skylark-jqueryui/focusable",["skylark-domx-query","skylark-domx-noder","./version"],function(e,t){return e.ui.focusable=t.focusable}),define("skylark-jqueryui/form",["skylark-jquery","./version"],function(e){return e.fn._form=function(){return"string"==typeof this[0].form?this.closest("form"):e(this[0].form)}}),define("skylark-jqueryui/ie",["skylark-jquery","./version"],function(e){return e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())}),define("skylark-jqueryui/keycode",["skylark-langx/objects","skylark-domx-query","skylark-domx-eventer","./version"],function(e,t,i){var n=t.ui.keyCode={};return e.each(i.keys,function(e,t){n[e.toUpperCase()]=t}),n}),define("skylark-jqueryui/escape-selector",["skylark-jquery","./version"],function(e){return e.ui.escapeSelector=(t=/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,function(e){return e.replace(t,"\\$1")});var t}),define("skylark-jqueryui/labels",["skylark-jquery","./version","./escape-selector"],function(e){return e.fn.labels=function(){var t,i,n,r,s;return this.length?this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(r=this.eq(0).parents("label"),(n=this.attr("id"))&&(t=this.eq(0).parents().last(),s=t.add(t.length?t.siblings():this.siblings()),i="label[for='"+e.ui.escapeSelector(n)+"']",r=r.add(s.find(i).addBack(i))),this.pushStack(r)):this.pushStack([])}}),define("skylark-jqueryui/jquery-1-7",["skylark-jquery","./version"],function(e){"1.7"===e.fn.jquery.substring(0,3)&&(e.each(["Width","Height"],function(t,i){var n="Width"===i?["Left","Right"]:["Top","Bottom"],r=i.toLowerCase(),s={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};function o(t,i,r,s){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,r&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),s&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}e.fn["inner"+i]=function(t){return void 0===t?s["inner"+i].call(this):this.each(function(){e(this).css(r,o(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?s["outer"+i].call(this,t):this.each(function(){e(this).css(r,o(this,t,!0,n)+"px")})}}),e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.expr.pseudos||(e.expr.pseudos=e.expr[":"]),e.uniqueSort||(e.uniqueSort=e.unique)}),define("skylark-jqueryui/plugin",["skylark-jquery","./version"],function(e){return e.ui.plugin={add:function(module,t,i){var n,r=e.ui[module].prototype;for(n in i)r.plugins[n]=r.plugins[n]||[],r.plugins[n].push([t,i[n]])},call:function(e,t,i,n){var r,s=e.plugins[t];if(s&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<s.length;r++)e.options[s[r][0]]&&s[r][1].apply(e.element,i)}}}),define("skylark-jqueryui/safe-active-element",["skylark-jquery","skylark-domx-noder","./version"],function(e,t){return e.ui.safeActiveElement=t.active}),define("skylark-jqueryui/safe-blur",["skylark-domx-query","skylark-domx-noder","./version"],function(e,t){return e.ui.safeBlur=t.blur}),define("skylark-jqueryui/scroll-parent",["skylark-jquery","./version"],function(e){return e.fn.scrollParent}),define("skylark-jqueryui/tabbable",["skylark-jquery","./version","./focusable"],function(e){return e.expr.pseudos}),define("skylark-jqueryui/unique-id",["skylark-jquery","./version"],function(e){return e.fn.extend({uniqueId:(t=0,function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}});var t}),define("skylark-jqueryui/widget",["skylark-jquery/widget"],function(e){return e}),define("skylark-jqueryui/widgets/accordion",["skylark-jquery","../version","../keycode","../unique-id","../widget"],function(e){return e.widget("ui.accordion",{version:"@VERSION",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t,i,n=this.options.icons;n&&(t=e("<span>"),this._addClass(t,"ui-accordion-header-icon","ui-icon "+n.header),t.prependTo(this.headers),i=this.active.children(".ui-accordion-header-icon"),this._removeClass(i,n.header)._addClass(i,null,n.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){"active"!==e?("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons())):this._activate(t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!e)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=e.ui.keyCode,n=this.headers.length,r=this.headers.index(t.target),s=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:s=this.headers[(r+1)%n];break;case i.LEFT:case i.UP:s=this.headers[(r-1+n)%n];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:s=this.headers[0];break;case i.END:s=this.headers[n-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),e(s).trigger("focus"),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().trigger("focus")},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=e()):!1===t.active?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,i=this.options,n=i.heightStyle,r=this.element.parent();this.active=this._findActive(i.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var t=e(this),i=t.uniqueId().attr("id"),n=t.next(),r=n.uniqueId().attr("id");t.attr("aria-controls",r),n.attr("aria-labelledby",i)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(i.event),"fill"===n?(t=r.height(),this.element.siblings(":visible").each(function(){var i=e(this),n=i.css("position");"absolute"!==n&&"fixed"!==n&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===n&&(t=0,this.headers.next().each(function(){var i=e(this).is(":visible");i||e(this).show(),t=Math.max(t,e(this).css("height","").height()),i||e(this).hide()}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var i,n,r=this.options,s=this.active,o=e(t.currentTarget),a=o[0]===s[0],l=a&&r.collapsible,c=l?e():o.next(),h=s.next(),u={oldHeader:s,oldPanel:h,newHeader:l?e():o,newPanel:c};t.preventDefault(),a&&!r.collapsible||!1===this._trigger("beforeActivate",t,u)||(r.active=!l&&this.headers.index(o),this.active=a?e():o,this._toggle(u),this._removeClass(s,"ui-accordion-header-active","ui-state-active"),r.icons&&(i=s.children(".ui-accordion-header-icon"),this._removeClass(i,null,r.icons.activeHeader)._addClass(i,null,r.icons.header)),a||(this._removeClass(o,"ui-accordion-header-collapsed")._addClass(o,"ui-accordion-header-active","ui-state-active"),r.icons&&(n=o.children(".ui-accordion-header-icon"),this._removeClass(n,null,r.icons.header)._addClass(n,null,r.icons.activeHeader)),this._addClass(o.next(),"ui-accordion-content-active")))},_toggle:function(t){var i=t.newPanel,n=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=i,this.prevHide=n,this.options.animate?this._animate(i,n,t):(n.hide(),i.show(),this._toggleComplete(t)),n.attr({"aria-hidden":"true"}),n.prev().attr({"aria-selected":"false","aria-expanded":"false"}),i.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):i.length&&this.headers.filter(function(){return 0===parseInt(e(this).attr("tabIndex"),10)}).attr("tabIndex",-1),i.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,i){var n,r,s=this,o=(e.css("box-sizing"),e.length&&(!t.length||e.index()<t.index())),a=this.options.animate||{},l=o&&a.down||a,c=function(){s._toggleComplete(i)};return"number"==typeof l&&(r=l),"string"==typeof l&&(n=l),n=n||l.easing||a.easing,r=r||l.duration||a.duration,t.length?e.length?(t.slideUp(),void e.slideDown(c)):t.animate(this.hideProps,r,n,c):e.animate(this.showProps,r,n,c)},_toggleComplete:function(e){var t=e.oldPanel,i=t.prev();this._removeClass(t,"ui-accordion-content-active"),this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}),define("skylark-jqueryui/position",["skylark-jquery","./version"],function(e){}),define("skylark-jqueryui/widgets/menu",["skylark-jquery","../keycode","../position","../safe-active-element","../unique-id","../version","../widget"],function(e){return e.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault(),this._activateItem(e)},"click .ui-menu-item":function(t){var i=e(t.target),n=e(e.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&n.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var i=this.active||this._menuItems().first();t||this.focus(e,i)},blur:function(t){this._delay(function(){var i=!e.contains(this.element[0],e.ui.safeActiveElement(this.document[0]));i&&this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e,!0),this.mouseHandled=!1}})},_activateItem:function(t){if(!this.previousFilter&&(t.clientX!==this.lastMousePosition.x||t.clientY!==this.lastMousePosition.y)){this.lastMousePosition={x:t.clientX,y:t.clientY};var i=e(t.target).closest(".ui-menu-item"),n=e(t.currentTarget);i[0]===n[0]&&(n.is(".ui-state-active")||(this._removeClass(n.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,n)))}},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),i=t.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),i.children().each(function(){var t=e(this);t.data("ui-menu-submenu-caret")&&t.remove()})},_keydown:function(t){var i,n,r,s,o=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1,n=this.previousFilter||"",s=!1,r=t.keyCode>=96&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),r===n?s=!0:r=n+r,i=this._filterMenuItems(r),(i=s&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i).length||(r=String.fromCharCode(t.keyCode),i=this._filterMenuItems(r)),i.length?(this.focus(t,i),this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}o&&t.preventDefault()},_activate:function(e){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,i,n,r,s,o=this,a=this.options.icons.submenu,l=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),n=l.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=e(this),i=t.prev(),n=e("<span>").data("ui-menu-submenu-caret",!0);o._addClass(n,"ui-menu-icon","ui-icon "+a),i.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",i.attr("id"))}),this._addClass(n,"ui-menu","ui-widget ui-widget-content ui-front"),t=l.add(this.element),(i=t.find(this.options.items)).not(".ui-menu-item").each(function(){var t=e(this);o._isDivider(t)&&o._addClass(t,"ui-menu-divider","ui-widget-content")}),r=i.not(".ui-menu-item, .ui-menu-divider"),s=r.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(r,"ui-menu-item")._addClass(s,"ui-menu-item-wrapper"),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if("icons"===e){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",String(e)),this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var i,n,r;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),r=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(r,null,"ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(i),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var i,n,r,s,o,a;this._hasScroll()&&(i=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,r=t.offset().top-this.activeMenu.offset().top-i-n,s=this.activeMenu.scrollTop(),o=this.activeMenu.height(),a=t.outerHeight(),r<0?this.activeMenu.scrollTop(s+r):r+a>o&&this.activeMenu.scrollTop(s+r-o+a))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",e,{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(e)},this.delay))},_open:function(t){var i=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer),this.timer=this._delay(function(){var n=i?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(t),this._removeClass(n.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=n},i?0:this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this._menuItems(this.active.children(".ui-menu")).first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(e,t)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(e){return(e||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(e,t,i){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").last():this.active[e+"All"](".ui-menu-item").first()),n&&n.length&&this.active||(n=this._menuItems(this.activeMenu)[t]()),this.focus(i,n)},nextPage:function(t){var i,n,r;this.active?this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return(i=e(this)).offset().top-n-r<0}),this.focus(t,i)):this.focus(t,this._menuItems(this.activeMenu)[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var i,n,r;this.active?this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,r=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return(i=e(this)).offset().top-n+r>0}),this.focus(t,i)):this.focus(t,this._menuItems(this.activeMenu).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,i)},_filterMenuItems:function(t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=new RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return n.test(e.trim(e(this).children(".ui-menu-item-wrapper").text()))})}})}),define("skylark-jqueryui/widgets/autocomplete",["skylark-jquery","./menu","../keycode","../position","../safe-active-element","../version","../widget"],function(e){return e.widget("ui.autocomplete",{version:"@VERSION",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var t,i,n,r=this.element[0].nodeName.toLowerCase(),s="textarea"===r,o="input"===r;this.isMultiLine=s||!o&&this._isContentEditable(this.element),this.valueMethod=this.element[s||o?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(r){if(this.element.prop("readOnly"))return t=!0,n=!0,void(i=!0);t=!1,n=!1,i=!1;var s=e.ui.keyCode;switch(r.keyCode){case s.PAGE_UP:t=!0,this._move("previousPage",r);break;case s.PAGE_DOWN:t=!0,this._move("nextPage",r);break;case s.UP:t=!0,this._keyEvent("previous",r);break;case s.DOWN:t=!0,this._keyEvent("next",r);break;case s.ENTER:this.menu.active&&(t=!0,r.preventDefault(),this.menu.select(r));break;case s.TAB:this.menu.active&&this.menu.select(r);break;case s.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(r),r.preventDefault());break;default:i=!0,this._searchTimeout(r)}},keypress:function(n){if(t)return t=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||n.preventDefault());if(!i){var r=e.ui.keyCode;switch(n.keyCode){case r.PAGE_UP:this._move("previousPage",n);break;case r.PAGE_DOWN:this._move("nextPage",n);break;case r.UP:this._keyEvent("previous",n);break;case r.DOWN:this._keyEvent("next",n)}}},input:function(e){if(n)return n=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault()},menufocus:function(t,i){var n,r;if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){e(t.target).trigger(t.originalEvent)});r=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:r})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value),(n=i.item.attr("aria-label")||r.value)&&e.trim(n).length&&(this.liveRegion.children().hide(),e("<div>").text(n).appendTo(this.liveRegion))},menuselect:function(t,i){var n=i.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==e.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=r,this._delay(function(){this.previous=r,this.selectedItem=n})),!1!==this._trigger("select",t,{item:n})&&this._value(n.value),this.term=this._value(),this.close(t),this.selectedItem=n}}),this.liveRegion=e("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(t){var i=this.menu.element[0];return t.target===this.element[0]||t.target===i||e.contains(i,t.target)},_closeOnClickOutside:function(e){this._isEventTargetInWidget(e)||this.close()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,i,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,n){n(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,r){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e){r(e)},error:function(){r([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t=this.term===this._value(),i=this.menu.element.is(":visible"),n=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;t&&(!t||i||n)||(this.selectedItem=null,this.search(null,e))},this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=++this.requestIndex;return function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}.bind(this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItemData(t,i)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return e("<li>").append(e("<div>").text(i.label)).appendTo(t)},_move:function(e,t){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())},_isContentEditable:function(e){if(!e.length)return!1;var t=e.prop("contentEditable");return"inherit"===t?this._isContentEditable(e.parent()):"true"===t}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,this.liveRegion.children().hide(),e("<div>").text(i).appendTo(this.liveRegion))}}),e.ui.autocomplete}),define("skylark-jqueryui/widgets/controlgroup",["skylark-jquery","../widget"],function(e){var t=/ui-corner-([a-z]){2,6}/g;return e.widget("ui.controlgroup",{version:"@VERSION",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var t=this,i=[];e.each(this.options.items,function(n,r){var s,o={};if(r)return"controlgroupLabel"===n?((s=t.element.find(r)).each(function(){var t=e(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),t._addClass(s,null,"ui-widget ui-widget-content ui-state-default"),void(i=i.concat(s.get()))):void(e.fn[n]&&(o=t["_"+n+"Options"]?t["_"+n+"Options"]("middle"):{classes:{}},t.element.find(r).each(function(){var r=e(this),s=r[n]("instance"),a=e.widget.extend({},o);if("button"!==n||!r.parent(".ui-spinner").length){s||(s=r[n]()[n]("instance")),s&&(a.classes=t._resolveClassesValues(a.classes,s)),r[n](a);var l=r[n]("widget");e.data(l[0],"ui-controlgroup-data",s||r[n]("instance")),i.push(l[0])}})))}),this.childWidgets=e(e.uniqueSort(i)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(t){this.childWidgets.each(function(){var i=e(this),n=i.data("ui-controlgroup-data");n&&n[t]&&n[t]()})},_updateCornerClass:function(e,t){var i=this._buildSimpleOptions(t,"label").classes.label;this._removeClass(e,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(e,null,i)},_buildSimpleOptions:function(e,t){var i="vertical"===this.options.direction,n={classes:{}};return n.classes[t]={middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[e],n},_spinnerOptions:function(e){var t=this._buildSimpleOptions(e,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(e){return this._buildSimpleOptions(e,"ui-button")},_checkboxradioOptions:function(e){return this._buildSimpleOptions(e,"ui-checkboxradio-label")},_selectmenuOptions:function(e){var t="vertical"===this.options.direction;return{width:!!t&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(t?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(t?"top":"left")},last:{"ui-selectmenu-button-open":t?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(t?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[e]}},_resolveClassesValues:function(i,n){var r={};return e.each(i,function(s){var o=n.options.classes[s]||"";o=e.trim(o.replace(t,"")),r[s]=(o+" "+i[s]).replace(/\s+/g," ")}),r},_setOption:function(e,t){"direction"===e&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(e,t),"disabled"!==e?this.refresh():this._callChildMethod(t?"disable":"enable")},refresh:function(){var t,i=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),t=this.childWidgets,this.options.onlyVisible&&(t=t.filter(":visible")),t.length&&(e.each(["first","last"],function(e,n){var r=t[n]().data("ui-controlgroup-data");if(r&&i["_"+r.widgetName+"Options"]){var s=i["_"+r.widgetName+"Options"](1===t.length?"only":n);s.classes=i._resolveClassesValues(s.classes,r),r.element[r.widgetName](s)}else i._updateCornerClass(t[n](),n)}),this._callChildMethod("refresh"))}})}),define("skylark-jqueryui/form-reset-mixin",["skylark-jquery","./form","./version"],function(e){return e.ui.formResetMixin={_formResetHandler:function(){var t=e(this);setTimeout(function(){var i=t.data("ui-form-reset-instances");e.each(i,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element._form(),this.form.length){var e=this.form.data("ui-form-reset-instances")||[];e.length||this.form.on("reset.ui-form-reset",this._formResetHandler),e.push(this),this.form.data("ui-form-reset-instances",e)}},_unbindFormResetHandler:function(){if(this.form.length){var t=this.form.data("ui-form-reset-instances");t.splice(e.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}}}),define("skylark-jqueryui/widgets/checkboxradio",["skylark-jquery","../escape-selector","../form-reset-mixin","../labels","../widget"],function(e){return e.widget("ui.checkboxradio",[e.ui.formResetMixin,{version:"@VERSION",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,i,n=this,r=this._super()||{};return this._readType(),i=this.element.labels(),this.label=e(i[i.length-1]),this.label.length||e.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){n.originalLabel+=3===this.nodeType?e(this).text():this.outerHTML}),this.originalLabel&&(r.label=this.originalLabel),null!=(t=this.element[0].disabled)&&(r.disabled=t),r},_create:function(){var e=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),e&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||e.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,i="input[name='"+e.ui.escapeSelector(t)+"']";return t?(this.form.length?e(this.form[0].elements).filter(i):e(i).filter(function(){return 0===e(this)._form().length})).not(this.element):e([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each(function(){var t=e(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(e,t){if("label"!==e||t){if(this._super(e,t),"disabled"===e)return this._toggleClass(this.label,null,"ui-state-disabled",t),void(this.element[0].disabled=t);this.refresh()}},_updateIcon:function(t){var i="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=e("<span>"),this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(i+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):i+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",i),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var e=this.label.contents().not(this.element[0]);this.icon&&(e=e.not(this.icon[0])),this.iconSpace&&(e=e.not(this.iconSpace[0])),e.remove(),this.label.append(this.options.label)},refresh:function(){var e=this.element[0].checked,t=this.element[0].disabled;this._updateIcon(e),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),null!==this.options.label&&this._updateLabel(),t!==this.options.disabled&&this._setOptions({disabled:t})}}]),e.ui.checkboxradio}),define("skylark-jqueryui/widgets/button",["skylark-jquery","./controlgroup","./checkboxradio","../keycode","../widget"],function(e){var t;return e.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var e,t=this._super()||{};return this.isInput=this.element.is("input"),null!=(e=this.element[0].disabled)&&(t.disabled=e),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(t.label=this.originalLabel),t},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===e.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,i){var n="iconPosition"!==t,r=n?this.options.iconPosition:i,s="top"===r||"bottom"===r;this.icon?n&&this._removeClass(this.icon,null,this.options.icon):(this.icon=e("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),n&&this._addClass(this.icon,null,i),this._attachIcon(r),s?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(r))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(e){this.icon[/^(?:end|bottom)/.test(e)?"before":"after"](this.iconSpace)},_attachIcon:function(e){this.element[/^(?:end|bottom)/.test(e)?"append":"prepend"](this.icon)},_setOptions:function(e){var t=void 0===e.showLabel?this.options.showLabel:e.showLabel,i=void 0===e.icon?this.options.icon:e.icon;t||i||(e.showLabel=!0),this._super(e)},_setOption:function(e,t){"icon"===e&&(t?this._updateIcon(e,t):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===e&&this._updateIcon(e,t),"showLabel"===e&&(this._toggleClass("ui-button-icon-only",null,!t),this._updateTooltip()),"label"===e&&(this.isInput?this.element.val(t):(this.element.html(t),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(e,t),"disabled"===e&&(this._toggleClass(null,"ui-state-disabled",t),this.element[0].disabled=t,t&&this.element.blur())},refresh:function(){var e=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOptions({disabled:e}),this._updateTooltip()}}),!1!==e.uiBackCompat&&(e.widget("ui.button",e.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(e,t){"text"!==e?("showLabel"===e&&(this.options.text=t),"icon"===e&&(this.options.icons.primary=t),"icons"===e&&(t.primary?(this._super("icon",t.primary),this._super("iconPosition","beginning")):t.secondary&&(this._super("icon",t.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",t)}}),e.fn.button=(t=e.fn.button,function(i){var n="string"==typeof i,r=Array.prototype.slice.call(arguments,1),s=this;return n?this.length||"instance"!==i?this.each(function(){var t,n=e(this).attr("type"),o="checkbox"!==n&&"radio"!==n?"button":"checkboxradio",a=e.data(this,"ui-"+o);return"instance"===i?(s=a,!1):a?e.isFunction(a[i])&&"_"!==i.charAt(0)?(t=a[i].apply(a,r))!==a&&void 0!==t?(s=t&&t.jquery?s.pushStack(t.get()):t,!1):void 0:e.error("no such method '"+i+"' for button widget instance"):e.error("cannot call methods on button prior to initialization; attempted to call method '"+i+"'")}):s=void 0:(r.length&&(i=e.widget.extend.apply(null,[i].concat(r))),this.each(function(){var n=e(this).attr("type"),r="checkbox"!==n&&"radio"!==n?"button":"checkboxradio",s=e.data(this,"ui-"+r);if(s)s.option(i||{}),s._init&&s._init();else{if("button"===r)return void t.call(e(this),i);e(this).checkboxradio(e.extend({icon:!1},i))}})),s}),e.fn.buttonset=function(){return e.ui.controlgroup||e.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),e.ui.button}),define("skylark-jqueryui/widgets/datepicker",["skylark-jquery","../version","../keycode"],function(e){var t;function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=n(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function n(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",i,function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",i,r)}function r(){e.datepicker._isDisabledDatepicker(t.inline?t.dpDiv.parent()[0]:t.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function s(t,i){for(var n in e.extend(t,i),i)null==i[n]&&(t[n]=i[n]);return t}return e.extend(e.ui,{datepicker:{version:"@VERSION"}}),e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return s(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var n,r,s;n=t.nodeName.toLowerCase(),r="div"===n||"span"===n,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(s=this._newInst(e(t),r)).settings=e.extend({},i||{}),"input"===n?this._connectDatepicker(t,s):r&&this._inlineDatepicker(t,s)},_newInst:function(t,i){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?n(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var n=e(t);i.append=e([]),i.trigger=e([]),n.hasClass(this.markerClassName)||(this._attachments(n,i),n.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var n,r,s,o=this._get(i,"appendText"),a=this._get(i,"isRTL");i.append&&i.append.remove(),o&&(i.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[a?"before":"after"](i.append)),t.off("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),"focus"!==(n=this._get(i,"showOn"))&&"both"!==n||t.on("focus",this._showDatepicker),"button"!==n&&"both"!==n||(r=this._get(i,"buttonText"),s=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:r,title:r}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:r,title:r}):r)),t[a?"before":"after"](i.trigger),i.trigger.on("click",function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,n,r,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(i=0,n=0,r=0;r<e.length;r++)e[r].length>i&&(i=e[r].length,n=r);return n},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,i){var n=e(t);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,n,r,o){var a,l,c,h,u,d=this._dialogInst;return d||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),e("body").append(this._dialogInput),(d=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},e.data(this._dialogInput[0],"datepicker",d)),s(d.settings,r||{}),i=i&&i.constructor===Date?this._formatDate(d,i):i,this._dialogInput.val(i),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(l=document.documentElement.clientWidth,c=document.documentElement.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+h,c/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(i){var n,r=e(i),s=e.data(i,"datepicker");r.hasClass(this.markerClassName)&&(n=i.nodeName.toLowerCase(),e.removeData(i,"datepicker"),"input"===n?(s.append.remove(),s.trigger.remove(),r.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==n&&"span"!==n||r.removeClass(this.markerClassName).empty(),t===s&&(t=null))},_enableDatepicker:function(t){var i,n,r=e(t),s=e.data(t,"datepicker");r.hasClass(this.markerClassName)&&("input"===(i=t.nodeName.toLowerCase())?(t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==i&&"span"!==i||((n=r.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,n,r=e(t),s=e.data(t,"datepicker");r.hasClass(this.markerClassName)&&("input"===(i=t.nodeName.toLowerCase())?(t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==i&&"span"!==i||((n=r.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,n){var r,o,a,l,c=this._getInst(t);if(2===arguments.length&&"string"==typeof i)return"defaults"===i?e.extend({},e.datepicker._defaults):c?"all"===i?e.extend({},c.settings):this._get(c,i):null;r=i||{},"string"==typeof i&&((r={})[i]=n),c&&(this._curInst===c&&this._hideDatepicker(),o=this._getDateDatepicker(t,!0),a=this._getMinMaxDate(c,"min"),l=this._getMinMaxDate(c,"max"),s(c.settings,r),null!==a&&void 0!==r.dateFormat&&void 0===r.minDate&&(c.settings.minDate=this._formatDate(c,a)),null!==l&&void 0!==r.dateFormat&&void 0===r.maxDate&&(c.settings.maxDate=this._formatDate(c,l)),"disabled"in r&&(r.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),c),this._autoSize(c),this._setDate(c,o),this._updateAlternate(c),this._updateDatepicker(c))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,n,r,s=e.datepicker._getInst(t.target),o=!0,a=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return(r=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv))[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,r[0]),(i=e.datepicker._get(s,"onSelect"))?(n=e.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[n,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,a?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,n,r=e.datepicker._getInst(t.target);if(e.datepicker._get(r,"constrainInput"))return i=e.datepicker._possibleChars(e.datepicker._get(r,"dateFormat")),n=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||n<" "||!i||i.indexOf(n)>-1},_doKeyUp:function(t){var i=e.datepicker._getInst(t.target);if(i.input.val()!==i.lastVal)try{e.datepicker.parseDate(e.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,e.datepicker._getFormatConfig(i))&&(e.datepicker._setDateFromField(i),e.datepicker._updateAlternate(i),e.datepicker._updateDatepicker(i))}catch(e){}return!0},_showDatepicker:function(t){var i,n,r,o,a,l,c;("input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t)||(i=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==i&&(e.datepicker._curInst.dpDiv.stop(!0,!0),i&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(i,"beforeShow"),!1!==(r=n?n.apply(t,[t,i]):{})&&(s(i.settings,r),i.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(i),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return!(o|="fixed"===e(this).css("position"))}),a={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(i),a=e.datepicker._checkOffset(i,a,o),i.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"}),i.inline||(l=e.datepicker._get(i,"showAnim"),c=e.datepicker._get(i,"duration"),i.dpDiv.css("z-index",function(e){var t,i;for(;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[l]?i.dpDiv.show(l,e.datepicker._get(i,"showOptions"),c):i.dpDiv[l||"show"](l?c:null),e.datepicker._shouldFocusInput(i)&&i.input.trigger("focus"),e.datepicker._curInst=i)))},_updateDatepicker:function(i){this.maxRows=4,t=i,i.dpDiv.empty().append(this._generateHTML(i)),this._attachHandlers(i);var n,s=this._getNumberOfMonths(i),o=s[1],a=i.dpDiv.find("."+this._dayOverClass+" a");a.length>0&&r.apply(a.get(0)),i.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&i.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",17*o+"em"),i.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),i.dpDiv[(this._get(i,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),i===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(i)&&i.input.trigger("focus"),i.yearshtml&&(n=i.yearshtml,setTimeout(function(){n===i.yearshtml&&i.yearshtml&&i.dpDiv.find("select.ui-datepicker-year:first").replaceWith(i.yearshtml),n=i.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,n){var r=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,a=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?r-o:0,i.left-=n&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=n&&i.top===t.input.offset().top+a?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+r>l&&l>r?Math.abs(i.left+r-l):0),i.top-=Math.min(i.top,i.top+s>c&&c>s?Math.abs(s+a):0),i},_findPos:function(t){for(var i,n=this._getInst(t),r=this._get(n,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[r?"previousSibling":"nextSibling"];return[(i=e(t).offset()).left,i.top]},_hideDatepicker:function(t){var i,n,r,s,o=this._curInst;!o||t&&o!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(o,"showAnim"),n=this._get(o,"duration"),r=function(){e.datepicker._tidyDialog(o)},e.effects&&(e.effects.effect[i]||e.effects[i])?o.dpDiv.hide(i,e.datepicker._get(o,"showOptions"),n,r):o.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?n:null,r),i||r(),this._datepickerShowing=!1,(s=this._get(o,"onClose"))&&s.apply(o.input?o.input[0]:null,[o.input?o.input.val():"",o]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),n=e.datepicker._getInst(i[0]);(i[0].id===e.datepicker._mainDivId||0!==i.parents("#"+e.datepicker._mainDivId).length||i.hasClass(e.datepicker.markerClassName)||i.closest("."+e.datepicker._triggerClass).length||!e.datepicker._datepickerShowing||e.datepicker._inDialog&&e.blockUI)&&(!i.hasClass(e.datepicker.markerClassName)||e.datepicker._curInst===n)||e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,n){var r=e(t),s=this._getInst(r[0]);this._isDisabledDatepicker(r[0])||(this._adjustInstDate(s,i,n),this._updateDatepicker(s))},_gotoToday:function(t){var i,n=e(t),r=this._getInst(n[0]);this._get(r,"gotoCurrent")&&r.currentDay?(r.selectedDay=r.currentDay,r.drawMonth=r.selectedMonth=r.currentMonth,r.drawYear=r.selectedYear=r.currentYear):(i=new Date,r.selectedDay=i.getDate(),r.drawMonth=r.selectedMonth=i.getMonth(),r.drawYear=r.selectedYear=i.getFullYear()),this._notifyChange(r),this._adjustDate(n)},_selectMonthYear:function(t,i,n){var r=e(t),s=this._getInst(r[0]);s["selected"+("M"===n?"Month":"Year")]=s["draw"+("M"===n?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(r)},_selectDay:function(t,i,n,r){var s,o=e(t);e(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||((s=this._getInst(o[0])).selectedDay=s.currentDay=e("a",r).html(),s.selectedMonth=s.currentMonth=i,s.selectedYear=s.currentYear=n,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var n,r=e(t),s=this._getInst(r[0]);i=null!=i?i:this._formatDate(s),s.input&&s.input.val(i),this._updateAlternate(s),(n=this._get(s,"onSelect"))?n.apply(s.input?s.input[0]:null,[i,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var i,n,r,s=this._get(t,"altField");s&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),n=this._getDate(t),r=this.formatDate(i,n,this._getFormatConfig(t)),e(s).val(r))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,n){if(null==t||null==i)throw"Invalid arguments";if(""===(i="object"==typeof i?i.toString():i+""))return null;var r,s,o,a,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,h="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),u=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,d=(n?n.dayNames:null)||this._defaults.dayNames,f=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,p=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,v=-1,y=-1,k=!1,b=function(e){var i=r+1<t.length&&t.charAt(r+1)===e;return i&&r++,i},x=function(e){var t=b(e),n="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,r="y"===e?n:1,s=new RegExp("^\\d{"+r+","+n+"}"),o=i.substring(l).match(s);if(!o)throw"Missing number at position "+l;return l+=o[0].length,parseInt(o[0],10)},w=function(t,n,r){var s=-1,o=e.map(b(t)?r:n,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(o,function(e,t){var n=t[1];if(i.substr(l,n.length).toLowerCase()===n.toLowerCase())return s=t[0],l+=n.length,!1}),-1!==s)return s+1;throw"Unknown name at position "+l},_=function(){if(i.charAt(l)!==t.charAt(r))throw"Unexpected literal at position "+l;l++};for(r=0;r<t.length;r++)if(k)"'"!==t.charAt(r)||b("'")?_():k=!1;else switch(t.charAt(r)){case"d":v=x("d");break;case"D":w("D",u,d);break;case"o":y=x("o");break;case"m":g=x("m");break;case"M":g=w("M",f,p);break;case"y":m=x("y");break;case"@":a=new Date(x("@")),m=a.getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"!":a=new Date((x("!")-this._ticksTo1970)/1e4),m=a.getFullYear(),g=a.getMonth()+1,v=a.getDate();break;case"'":b("'")?_():k=!0;break;default:_()}if(l<i.length&&(o=i.substr(l),!/^\s+/.test(o)))throw"Extra/unparsed characters found in date: "+o;if(-1===m?m=(new Date).getFullYear():m<100&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(m<=h?0:-100)),y>-1)for(g=1,v=y;;){if(s=this._getDaysInMonth(m,g-1),v<=s)break;g++,v-=s}if((a=this._daylightSavingAdjust(new Date(m,g-1,v))).getFullYear()!==m||a.getMonth()+1!==g||a.getDate()!==v)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var n,r=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,s=(i?i.dayNames:null)||this._defaults.dayNames,o=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=n+1<e.length&&e.charAt(n+1)===t;return i&&n++,i},c=function(e,t,i){var n=""+t;if(l(e))for(;n.length<i;)n="0"+n;return n},h=function(e,t,i,n){return l(e)?n[t]:i[t]},u="",d=!1;if(t)for(n=0;n<e.length;n++)if(d)"'"!==e.charAt(n)||l("'")?u+=e.charAt(n):d=!1;else switch(e.charAt(n)){case"d":u+=c("d",t.getDate(),2);break;case"D":u+=h("D",t.getDay(),r,s);break;case"o":u+=c("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":u+=c("m",t.getMonth()+1,2);break;case"M":u+=h("M",t.getMonth(),o,a);break;case"y":u+=l("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":u+=t.getTime();break;case"!":u+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?u+="'":d=!0;break;default:u+=e.charAt(n)}return u},_possibleChars:function(e){var t,i="",n=!1,r=function(i){var n=t+1<e.length&&e.charAt(t+1)===i;return n&&t++,n};for(t=0;t<e.length;t++)if(n)"'"!==e.charAt(t)||r("'")?i+=e.charAt(t):n=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":r("'")?i+="'":n=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,r=this._getDefaultDate(e),s=r,o=this._getFormatConfig(e);try{s=this.parseDate(i,n,o)||r}catch(e){n=t?"":n}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=n?s.getDate():0,e.currentMonth=n?s.getMonth():0,e.currentYear=n?s.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,n){var r=null==i||""===i?n:"string"==typeof i?function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(e){}var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,r=n.getFullYear(),s=n.getMonth(),o=n.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=a.exec(i);for(;l;){switch(l[2]||"d"){case"d":case"D":o+=parseInt(l[1],10);break;case"w":case"W":o+=7*parseInt(l[1],10);break;case"m":case"M":s+=parseInt(l[1],10),o=Math.min(o,e.datepicker._getDaysInMonth(r,s));break;case"y":case"Y":r+=parseInt(l[1],10),o=Math.min(o,e.datepicker._getDaysInMonth(r,s))}l=a.exec(i)}return new Date(r,s,o)}(i):"number"==typeof i?isNaN(i)?n:function(e){var t=new Date;return t.setDate(t.getDate()+e),t}(i):new Date(i.getTime());return(r=r&&"Invalid Date"===r.toString()?n:r)&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0)),this._daylightSavingAdjust(r)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var n=!t,r=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),r===e.selectedMonth&&s===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),n="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(n,-i,"M")},next:function(){e.datepicker._adjustDate(n,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(n)},selectDay:function(){return e.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(n,this,"Y"),!1}};e(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,n,r,s,o,a,l,c,h,u,d,f,p,m,g,v,y,k,b,x,w,_,C,S,A,M,T,L,$,E,O,R,D,I,P,N,F,H,z=new Date,W=this._daylightSavingAdjust(new Date(z.getFullYear(),z.getMonth(),z.getDate())),B=this._get(e,"isRTL"),j=this._get(e,"showButtonPanel"),q=this._get(e,"hideIfNoPrevNext"),V=this._get(e,"navigationAsDateFormat"),U=this._getNumberOfMonths(e),K=this._get(e,"showCurrentAtPos"),G=this._get(e,"stepMonths"),Y=1!==U[0]||1!==U[1],X=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),Q=this._getMinMaxDate(e,"min"),Z=this._getMinMaxDate(e,"max"),J=e.drawMonth-K,ee=e.drawYear;if(J<0&&(J+=12,ee--),Z)for(t=this._daylightSavingAdjust(new Date(Z.getFullYear(),Z.getMonth()-U[0]*U[1]+1,Z.getDate())),t=Q&&t<Q?Q:t;this._daylightSavingAdjust(new Date(ee,J,1))>t;)--J<0&&(J=11,ee--);for(e.drawMonth=J,e.drawYear=ee,i=this._get(e,"prevText"),i=V?this.formatDate(i,this._daylightSavingAdjust(new Date(ee,J-G,1)),this._getFormatConfig(e)):i,n=this._canAdjustMonth(e,-1,ee,J)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>":q?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"e":"w")+"'>"+i+"</span></a>",r=this._get(e,"nextText"),r=V?this.formatDate(r,this._daylightSavingAdjust(new Date(ee,J+G,1)),this._getFormatConfig(e)):r,s=this._canAdjustMonth(e,1,ee,J)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+r+"</span></a>":q?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+r+"'><span class='ui-icon ui-icon-circle-triangle-"+(B?"w":"e")+"'>"+r+"</span></a>",o=this._get(e,"currentText"),a=this._get(e,"gotoCurrent")&&e.currentDay?X:W,o=V?this.formatDate(o,a,this._getFormatConfig(e)):o,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",c=j?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(B?l:"")+(this._isInRange(e,a)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(B?"":l)+"</div>":"",h=parseInt(this._get(e,"firstDay"),10),h=isNaN(h)?0:h,u=this._get(e,"showWeek"),d=this._get(e,"dayNames"),f=this._get(e,"dayNamesMin"),p=this._get(e,"monthNames"),m=this._get(e,"monthNamesShort"),g=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),k=this._getDefaultDate(e),b="",w=0;w<U[0];w++){for(_="",this.maxRows=4,C=0;C<U[1];C++){if(S=this._daylightSavingAdjust(new Date(ee,J,e.selectedDay)),A=" ui-corner-all",M="",Y){if(M+="<div class='ui-datepicker-group",U[1]>1)switch(C){case 0:M+=" ui-datepicker-group-first",A=" ui-corner-"+(B?"right":"left");break;case U[1]-1:M+=" ui-datepicker-group-last",A=" ui-corner-"+(B?"left":"right");break;default:M+=" ui-datepicker-group-middle",A=""}M+="'>"}for(M+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?B?s:n:"")+(/all|right/.test(A)&&0===w?B?n:s:"")+this._generateMonthYearHeader(e,J,ee,Q,Z,w>0||C>0,p,m)+"</div><table class='ui-datepicker-calendar'><thead><tr>",T=u?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",x=0;x<7;x++)L=(x+h)%7,T+="<th scope='col'"+((x+h+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+d[L]+"'>"+f[L]+"</span></th>";for(M+=T+"</tr></thead><tbody>",$=this._getDaysInMonth(ee,J),ee===e.selectedYear&&J===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,$)),E=(this._getFirstDayOfMonth(ee,J)-h+7)%7,O=Math.ceil((E+$)/7),R=Y&&this.maxRows>O?this.maxRows:O,this.maxRows=R,D=this._daylightSavingAdjust(new Date(ee,J,1-E)),I=0;I<R;I++){for(M+="<tr>",P=u?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(D)+"</td>":"",x=0;x<7;x++)N=g?g.apply(e.input?e.input[0]:null,[D]):[!0,""],F=D.getMonth()!==J,H=F&&!y||!N[0]||Q&&D<Q||Z&&D>Z,P+="<td class='"+((x+h+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(D.getTime()===S.getTime()&&J===e.selectedMonth&&e._keyEvent||k.getTime()===D.getTime()&&k.getTime()===S.getTime()?" "+this._dayOverClass:"")+(H?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!v?"":" "+N[1]+(D.getTime()===X.getTime()?" "+this._currentClass:"")+(D.getTime()===W.getTime()?" ui-datepicker-today":""))+"'"+(F&&!v||!N[2]?"":" title='"+N[2].replace(/'/g,"&#39;")+"'")+(H?"":" data-handler='selectDay' data-event='click' data-month='"+D.getMonth()+"' data-year='"+D.getFullYear()+"'")+">"+(F&&!v?"&#xa0;":H?"<span class='ui-state-default'>"+D.getDate()+"</span>":"<a class='ui-state-default"+(D.getTime()===W.getTime()?" ui-state-highlight":"")+(D.getTime()===X.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+D.getDate()+"</a>")+"</td>",D.setDate(D.getDate()+1),D=this._daylightSavingAdjust(D);M+=P+"</tr>"}++J>11&&(J=0,ee++),M+="</tbody></table>"+(Y?"</div>"+(U[0]>0&&C===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),_+=M}b+=_}return b+=c,e._keyEvent=!1,b},_generateMonthYearHeader:function(e,t,i,n,r,s,o,a){var l,c,h,u,d,f,p,m,g=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),k="<div class='ui-datepicker-title'>",b="";if(s||!g)b+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(l=n&&n.getFullYear()===i,c=r&&r.getFullYear()===i,b+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",h=0;h<12;h++)(!l||h>=n.getMonth())&&(!c||h<=r.getMonth())&&(b+="<option value='"+h+"'"+(h===t?" selected='selected'":"")+">"+a[h]+"</option>");b+="</select>"}if(y||(k+=b+(!s&&g&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!v)k+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(u=this._get(e,"yearRange").split(":"),d=(new Date).getFullYear(),p=(f=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?d+parseInt(e,10):parseInt(e,10);return isNaN(t)?d:t})(u[0]),m=Math.max(p,f(u[1]||"")),p=n?Math.max(p,n.getFullYear()):p,m=r?Math.min(m,r.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p<=m;p++)e.yearshtml+="<option value='"+p+"'"+(p===i?" selected='selected'":"")+">"+p+"</option>";e.yearshtml+="</select>",k+=e.yearshtml,e.yearshtml=null}return k+=this._get(e,"yearSuffix"),y&&(k+=(!s&&g&&v?"":"&#xa0;")+b),k+="</div>"},_adjustInstDate:function(e,t,i){var n=e.selectedYear+("Y"===i?t:0),r=e.selectedMonth+("M"===i?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(n,r))+("D"===i?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,r,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),r=i&&t<i?i:t;return n&&r>n?n:r},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,n){var r=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(i,n+(t<0?t:r[0]*r[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var i,n,r=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,a=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),n=(new Date).getFullYear(),o=parseInt(i[0],10),a=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(o+=n),i[1].match(/[+\-].*/)&&(a+=n)),(!r||t.getTime()>=r.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!a||t.getFullYear()<=a)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var r=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),r,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).on("mousedown",e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="@VERSION",e.datepicker}),define("skylark-jqueryui-interact/Mouse",["skylark-domx-browser","skylark-domx-data","skylark-domx-query","skylark-domx-plugins-base","skylark-jquery/JqueryPlugin"],function(e,t,i,n,r){var s=!1;i(document).on("mouseup",function(){s=!1});var o=r.inherit({klassName:"MousePlugin",pluginName:"ui.mouse",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.pluginName,function(t){return e._mouseDown(t)}).on("click."+this.pluginName,function(i){if(!0===t.data(i.target,e.pluginName+".preventClickEvent"))return t.removeData(i.target,e.pluginName+".preventClickEvent"),i.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.pluginName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.pluginName,this._mouseMoveDelegate).off("mouseup."+this.pluginName,this._mouseUpDelegate)},_mouseDown:function(e){if(!s){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var n=this,r=1===e.which,o=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&i(e.target).closest(this.options.cancel).length;return!(r&&!o&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.pluginName+".preventClickEvent")&&t.removeData(e.target,this.pluginName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},this.document.on("mousemove."+this.pluginName,this._mouseMoveDelegate).on("mouseup."+this.pluginName,this._mouseUpDelegate),e.preventDefault(),s=!0,!0))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(e){this.document.off("mousemove."+this.pluginName,this._mouseMoveDelegate).off("mouseup."+this.pluginName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.pluginName+".preventClickEvent",!0),this._mouseStop(e)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,s=!1,e.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});return n.register(o),o}),define("skylark-jqueryui-interact/patch",[],function(){return{add:function(module,e,t){var i,n=module.prototype;for(i in t)n.patches[i]=n.patches[i]||[],n.patches[i].push([e,t[i]])},call:function(e,t,i,n){var r,s=e.patches[t];if(s&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(r=0;r<s.length;r++)e.options[s[r][0]]&&s[r][1].apply(e.element,i)}}}),define("skylark-jqueryui-interact/ddmanager",["skylark-langx/langx"],function(e){var t={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var n,r,s=t.droppables[e.options.scope]||[],o=i?i.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<s.length;n++)if(!(s[n].options.disabled||e&&!s[n].accept.call(s[n].element[0],e.currentItem||e.element))){for(r=0;r<a.length;r++)if(a[r]===s[n].element[0]){s[n].proportions().height=0;continue e}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===o&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(i,n){var r=!1;return e.each((t.droppables[i.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.intersect(i,this,this.options.tolerance,n)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),r},dragStart:function(e,i){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||t.prepareOffsets(e,i)})},drag:function(i,n){i.options.refreshPositions&&t.prepareOffsets(i,n),e.each(t.droppables[i.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var e,r,s,o=t.intersect(i,this,this.options.tolerance,n),a=!o&&this.isover?"isout":o&&!this.isover?"isover":null;a&&(this.options.greedy&&(r=this.options.scope,(s=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===r})).length&&((e=$(s[0]).droppable("instance")).greedyChild="isover"===a)),e&&"isover"===a&&(e.isover=!1,e.isout=!0,e._out.call(e,n)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,n),e&&"isout"===a&&(e.isout=!1,e.isover=!0,e._over.call(e,n)))}})},dragStop:function(e,i){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.prepareOffsets(e,i)}};return t.intersect=function(){function e(e,t,i){return e>=t&&e<t+i}return function(t,i,n,r){if(!i.offset)return!1;var s=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,a=s+t.helperProportions.width,l=o+t.helperProportions.height,c=i.offset.left,h=i.offset.top,u=c+i.proportions().width,d=h+i.proportions().height;switch(n){case"fit":return c<=s&&a<=u&&h<=o&&l<=d;case"intersect":return c<s+t.helperProportions.width/2&&a-t.helperProportions.width/2<u&&h<o+t.helperProportions.height/2&&l-t.helperProportions.height/2<d;case"pointer":return e(r.pageY,h,i.proportions().height)&&e(r.pageX,c,i.proportions().width);case"touch":return(o>=h&&o<=d||l>=h&&l<=d||o<h&&l>d)&&(s>=c&&s<=u||a>=c&&a<=u||s<c&&a>u);default:return!1}}}(),t}),define("skylark-jqueryui-interact/Draggable",["skylark-langx/langx","skylark-domx-eventer","skylark-domx-noder","skylark-domx-query","skylark-domx-plugins-base","./Mouse","./patch","./ddmanager"],function(e,t,i,n,r,s,o,a){var l=s.inherit({klassName:"Draggable",pluginName:"ui.draggable",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(e){var t=this.options;return!(this.helper||t.disabled||n(e.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(e),!!this.handle&&(this._blurActiveElement(e),this._blockFrames(!0===t.iframeFix?"iframe":t.iframeFix),!0))},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=n(this);return n("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var t=i.active(this.document[0]),r=n(e.target);r.closest(t).length||i.blur(t)},_mouseStart:function(e){var t=this.options;return this.helper=this._createHelper(e),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),a&&(a.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===n(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,t.cursorAt&&this._adjustOffsetFromHelper(t.cursorAt),this._setContainment(),!1===this._trigger("start",e)?(this._clear(),!1):(this._cacheHelperProportions(),a&&!t.dropBehaviour&&a.prepareOffsets(this,e),this._mouseDrag(e,!0),a&&a.dragStart(this,e),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(!1===this._trigger("drag",e,n))return this._mouseUp(new t.create("mouseup",e)),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",a&&a.drag(this,e),!1},_mouseStop:function(t){var i=this,r=!1;return a&&!this.options.dropBehaviour&&(r=a.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||!0===this.options.revert||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?n(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==i._trigger("stop",t)&&i._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),a&&a.dragStop(this,e),this.handleElement.is(e.target)&&this.element.trigger("focus"),this.overrided(e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(t.create("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(e){return!this.options.handle||!!n(e.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var i=this.options,r=e.isFunction(i.helper),s=r?n(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),r&&s[0]===this.element[0]&&this._setPositionRelative(),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),t=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==t&&i.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,r=this.options,s=this.document[0];this.relativeContainer=null,r.containment?"window"!==r.containment?"document"!==r.containment?r.containment.constructor!==Array?("parent"===r.containment&&(r.containment=this.helper[0].parentNode),t=n(r.containment),(i=t[0])&&(e=/(scroll|auto)/.test(t.css("overflow")),this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(e?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=t)):this.containment=r.containment:this.containment=[0,0,n(s).width()-this.helperProportions.width-this.margins.left,(n(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[n(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,n(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,n(window).scrollLeft()+n(window).width()-this.helperProportions.width-this.margins.left,n(window).scrollTop()+(n(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,n,r,s,o=this.options,a=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return a&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(c=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(c=i[3]+this.offset.click.top)),o.grid&&(r=o.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,c=i?r-this.offset.click.top>=i[1]||r-this.offset.click.top>i[3]?r:r-this.offset.click.top>=i[1]?r-o.grid[1]:r+o.grid[1]:r,s=o.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-o.grid[0]:s+o.grid[0]:s),"y"===o.axis&&(l=this.originalPageX),"x"===o.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:a?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:a?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(e,t,i){return i=i||this._uiHash(),o.call(this,e,[t,i,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),this.overrided(e,t,i)},patches:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});return r.register(l,"draggable"),o.add(l,"connectToSortable",{start:function(t,i,r){var s=e.extend({},i,{item:r.element});r.sortables=[],n(r.options.connectToSortable).each(function(){var e=n(this).sortable("instance");e&&!e.options.disabled&&(r.sortables.push(e),e.refreshPositions(),e._trigger("activate",t,s))})},stop:function(t,i,n){var r=e.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,e.each(n.sortables,function(){this.isOver?(this.isOver=0,n.cancelHelperRemoval=!0,this.cancelHelperRemoval=!1,this._storedCSS={position:this.placeholder.css("position"),top:this.placeholder.css("top"),left:this.placeholder.css("left")},this._mouseStop(t),this.options.helper=this.options._helper):(this.cancelHelperRemoval=!0,this._trigger("deactivate",t,r))})},drag:function(t,n,r){e.each(r.sortables,function(){var s=!1,o=this;o.positionAbs=r.positionAbs,o.helperProportions=r.helperProportions,o.offset.click=r.offset.click,o._intersectsWith(o.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.positionAbs=r.positionAbs,this.helperProportions=r.helperProportions,this.offset.click=r.offset.click,this!==o&&this._intersectsWith(this.containerCache)&&i.contains(o.element[0],this.element[0])&&(s=!1),s})),s?(o.isOver||(o.isOver=1,r._parent=n.helper.parent(),o.currentItem=n.helper.appendTo(o.element).data("ui-sortable-item",!0),o.options._helper=o.options.helper,o.options.helper=function(){return n.helper[0]},t.target=o.currentItem[0],o._mouseCapture(t,!0),o._mouseStart(t,!0,!0),o.offset.click.top=r.offset.click.top,o.offset.click.left=r.offset.click.left,o.offset.parent.left-=r.offset.parent.left-o.offset.parent.left,o.offset.parent.top-=r.offset.parent.top-o.offset.parent.top,r._trigger("toSortable",t),r.dropped=o.element,e.each(r.sortables,function(){this.refreshPositions()}),r.currentItem=r.element,o.fromOutside=r),o.currentItem&&(o._mouseDrag(t),n.position=o.position)):o.isOver&&(o.isOver=0,o.cancelHelperRemoval=!0,o.options._revert=o.options.revert,o.options.revert=!1,o._trigger("out",t,o._uiHash(o)),o._mouseStop(t,!0),o.options.revert=o.options._revert,o.options.helper=o.options._helper,o.placeholder&&o.placeholder.remove(),n.helper.appendTo(r._parent),r._refreshOffsets(t),n.position=r._generatePosition(t,!0),r._trigger("fromSortable",t),r.dropped=!1,e.each(r.sortables,function(){this.refreshPositions()}))})}}),o.add(l,"cursor",{start:function(e,t,i){var r=n("body"),s=i.options;r.css("cursor")&&(s._cursor=r.css("cursor")),r.css("cursor",s.cursor)},stop:function(e,t,i){var r=i.options;r._cursor&&n("body").css("cursor",r._cursor)}}),o.add(l,"opacity",{start:function(e,t,i){var r=n(t.helper),s=i.options;r.css("opacity")&&(s._opacity=r.css("opacity")),r.css("opacity",s.opacity)},stop:function(e,t,i){var r=i.options;r._opacity&&n(t.helper).css("opacity",r._opacity)}}),o.add(l,"scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,t,i){var r=i.options,s=!1,o=i.scrollParentNotHidden[0],l=i.document[0];o!==l&&"HTML"!==o.tagName?(r.axis&&"x"===r.axis||(i.overflowOffset.top+o.offsetHeight-e.pageY<r.scrollSensitivity?o.scrollTop=s=o.scrollTop+r.scrollSpeed:e.pageY-i.overflowOffset.top<r.scrollSensitivity&&(o.scrollTop=s=o.scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(i.overflowOffset.left+o.offsetWidth-e.pageX<r.scrollSensitivity?o.scrollLeft=s=o.scrollLeft+r.scrollSpeed:e.pageX-i.overflowOffset.left<r.scrollSensitivity&&(o.scrollLeft=s=o.scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-n(l).scrollTop()<r.scrollSensitivity?s=n(l).scrollTop(n(l).scrollTop()-r.scrollSpeed):n(window).height()-(e.pageY-n(l).scrollTop())<r.scrollSensitivity&&(s=n(l).scrollTop(n(l).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-n(l).scrollLeft()<r.scrollSensitivity?s=n(l).scrollLeft(n(l).scrollLeft()-r.scrollSpeed):n(window).width()-(e.pageX-n(l).scrollLeft())<r.scrollSensitivity&&(s=n(l).scrollLeft(n(l).scrollLeft()+r.scrollSpeed)))),!1!==s&&a&&!r.dropBehaviour&&a.prepareOffsets(i,e)}}),o.add(l,"snap",{start:function(e,t,i){var r=i.options;i.snapElements=[],n(r.snap.constructor!==String?r.snap.items||":data(ui-draggable)":r.snap).each(function(){var e=n(this),t=e.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:t.top,left:t.left})})},drag:function(t,n,r){var s,o,a,l,c,h,u,d,f,p,m=r.options,g=m.snapTolerance,v=n.offset.left,y=v+r.helperProportions.width,k=n.offset.top,b=k+r.helperProportions.height;for(f=r.snapElements.length-1;f>=0;f--)c=r.snapElements[f].left-r.margins.left,h=c+r.snapElements[f].width,u=r.snapElements[f].top-r.margins.top,d=u+r.snapElements[f].height,y<c-g||v>h+g||b<u-g||k>d+g||!i.contains(r.snapElements[f].item.ownerDocument,r.snapElements[f].item)?(r.snapElements[f].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[f].item})),r.snapElements[f].snapping=!1):("inner"!==m.snapMode&&(s=Math.abs(u-b)<=g,o=Math.abs(d-k)<=g,a=Math.abs(c-y)<=g,l=Math.abs(h-v)<=g,s&&(n.position.top=r._convertPositionTo("relative",{top:u-r.helperProportions.height,left:0}).top),o&&(n.position.top=r._convertPositionTo("relative",{top:d,left:0}).top),a&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left),l&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h}).left)),p=s||o||a||l,"outer"!==m.snapMode&&(s=Math.abs(u-k)<=g,o=Math.abs(d-b)<=g,a=Math.abs(c-v)<=g,l=Math.abs(h-y)<=g,s&&(n.position.top=r._convertPositionTo("relative",{top:u,left:0}).top),o&&(n.position.top=r._convertPositionTo("relative",{top:d-r.helperProportions.height,left:0}).top),a&&(n.position.left=r._convertPositionTo("relative",{top:0,left:c}).left),l&&(n.position.left=r._convertPositionTo("relative",{top:0,left:h-r.helperProportions.width}).left)),!r.snapElements[f].snapping&&(s||o||a||l||p)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[f].item})),r.snapElements[f].snapping=s||o||a||l||p)}}),o.add(l,"stack",{start:function(t,i,r){var s,o=r.options,a=e.makeArray(n(o.stack)).sort(function(e,t){return(parseInt(n(e).css("zIndex"),10)||0)-(parseInt(n(t).css("zIndex"),10)||0)});a.length&&(s=parseInt(n(a[0]).css("zIndex"),10)||0,n(a).each(function(e){n(this).css("zIndex",s+e)}),this.css("zIndex",s+a.length))}}),o.add(l,"zIndex",{start:function(e,t,i){var r=n(t.helper),s=i.options;r.css("zIndex")&&(s._zIndex=r.css("zIndex")),r.css("zIndex",s.zIndex)},stop:function(e,t,i){var r=i.options;r._zIndex&&n(t.helper).css("zIndex",r._zIndex)}}),l}),define("skylark-jqueryui/widgets/draggable",["skylark-jquery","skylark-jqueryui-interact/Draggable","../version"],function(e,t){return e.ui.draggable=t}),define("skylark-jqueryui/widgets/mouse",["skylark-jquery","skylark-jqueryui-interact/Mouse","../version"],function(e,t){return e.ui.mouse=t}),define("skylark-jqueryui-interact/Resizable",["skylark-langx/langx","skylark-domx-data","skylark-domx-eventer","skylark-domx-noder","skylark-domx-query","skylark-domx-plugins-base","./Mouse","./patch","./ddmanager"],function(e,t,i,n,r,s,o,a,l){var c=o.inherit({klassName:"Resizable",pluginName:"ui.resizable",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(e,t){if("hidden"===r(e).css("overflow"))return!1;var i=t&&"left"===t?"scrollLeft":"scrollTop",n=!1;return e[i]>0||(e[i]=1,n=e[i]>0,e[i]=0,n)},_create:function(){var t,i=this.options,n=this;this._addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(r("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),i.autoHide&&r(this.element).on("mouseenter",function(){i.disabled||(n._removeClass("ui-resizable-autohide"),n._handles.show())}).on("mouseleave",function(){i.disabled||n.resizing||(n._addClass("ui-resizable-autohide"),n._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy(),this._addedHandles.remove();var e,t=function(e){r(e).removeData("resizable").removeData("ui-resizable").off(".resizable")};return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_setOption:function(e,t){switch(this._super(e,t),e){case"handles":this._removeHandles(),this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!t}},_setupHandles:function(){var t,i,n,s,o,a=this.options,l=this;if(this.handles=a.handles||(r(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=r(),this._addedHandles=r(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)t=e.trim(n[i]),s="ui-resizable-"+t,o=r("<div>"),this._addClass(o,"ui-resizable-handle "+s),o.css({zIndex:a.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.children(this.handles[t]).length||(this.element.append(o),this._addedHandles=this._addedHandles.add(o));this._renderAxis=function(e){var t,i,n,s;for(t in e=e||this.element,this.handles)this.handles[t].constructor===String?this.handles[t]=this.element.children(this.handles[t]).first().show():(this.handles[t].jquery||this.handles[t].nodeType)&&(this.handles[t]=r(this.handles[t]),this._on(this.handles[t],{mousedown:l._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(i=r(this.handles[t],this.element),s=/sw|ne|nw|se|n|s/.test(t)?i.outerHeight():i.outerWidth(),n=["padding",/ne|nw|n/.test(t)?"Top":/se|sw|s/.test(t)?"Bottom":/^e$/.test(t)?"Right":"Left"].join(""),e.css(n,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[t])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){l.resizing||(this.className&&(o=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),l.axis=o&&o[1]?o[1]:"se")}),a.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(e){var t,i,s=!1;for(t in this.handles)((i=r(this.handles[t])[0])===e.target||n.contains(i,e.target))&&(s=!0);return!this.options.disabled&&s},_mouseStart:function(e){var t,i,n,s=this.options,o=this.element;return this.resizing=!0,this._renderProxy(),t=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),s.containment&&(t+=r(s.containment).scrollLeft()||0,i+=r(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:t,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:o.width(),height:o.height()},this.originalSize=this._helper?{width:o.outerWidth(),height:o.outerHeight()}:{width:o.width(),height:o.height()},this.sizeDiff={width:o.outerWidth()-o.width(),height:o.outerHeight()-o.height()},this.originalPosition={left:t,top:i},this.originalMousePosition={left:e.pageX,top:e.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=r(".ui-resizable-"+this.axis).css("cursor"),r("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),this._propagate("start",e),!0},_mouseDrag:function(t){var i,n,r=this.originalMousePosition,s=this.axis,o=t.pageX-r.left||0,a=t.pageY-r.top||0,l=this._change[s];return this._updatePrevProperties(),!!l&&(i=l.apply(this,[t,o,a]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1)},_mouseStop:function(t){this.resizing=!1;var i,n,s,o,a,l,c,h=this.options;return this._helper&&(i=this._proportionallyResizeElements,n=i.length&&/textarea/i.test(i[0].nodeName),s=n&&this._hasScroll(i[0],"left")?0:this.sizeDiff.height,o=n?0:this.sizeDiff.width,a={width:this.helper.width()-o,height:this.helper.height()-s},l=parseFloat(this.element.css("left"))+(this.position.left-this.originalPosition.left)||null,c=parseFloat(this.element.css("top"))+(this.position.top-this.originalPosition.top)||null,h.animate||this.element.css(e.extend(a,{top:c,left:l})),this.helper.height(this.size.height),this.helper.width(this.size.width),this._helper&&!h.animate&&this._proportionallyResize()),r("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,i,n,r,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=s.minHeight*this.aspectRatio,n=s.minWidth/this.aspectRatio,i=s.maxHeight*this.aspectRatio,r=s.maxWidth/this.aspectRatio,t>s.minWidth&&(s.minWidth=t),n>s.minHeight&&(s.minHeight=n),i<s.maxWidth&&(s.maxWidth=i),r<s.maxHeight&&(s.maxHeight=r)),this._vBoundaries=s},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,i=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(i.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(i.height-e.height),e.left=t.left+(i.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,i=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,r=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(i),h=/nw|ne|n/.test(i);return s&&(e.width=t.minWidth),o&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),r&&(e.height=t.maxHeight),s&&c&&(e.left=a-t.minWidth),n&&c&&(e.left=a-t.maxWidth),o&&h&&(e.top=l-t.minHeight),r&&h&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,i=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],r=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)i[t]=parseFloat(n[t])||0,i[t]+=parseFloat(r[t])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,i=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:i.height()-this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var e=this.element,t=this.options;this.elementOffset=e.offset(),this._helper?(this.helper=this.helper||r("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++t.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var i=this.originalSize,n=this.originalPosition;return{left:n.left+t,width:i.width-t}},n:function(e,t,i){var n=this.originalSize,r=this.originalPosition;return{top:r.top+i,height:n.height-i}},s:function(e,t,i){return{height:this.originalSize.height+i}},se:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},sw:function(t,i,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,n]))},ne:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,n]))},nw:function(t,i,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,n]))}},_propagate:function(e,t){a.call(this,e,[t,this.ui(),this],!0),"resize"!==e&&this._trigger(e,t,this.ui())},patches:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});return a.add(c,"animate",{stop:function(t){var i=r(this).resizable("instance"),n=i.options,s=i._proportionallyResizeElements,o=s.length&&/textarea/i.test(s[0].nodeName),a=o&&i._hasScroll(s[0],"left")?0:i.sizeDiff.height,l=o?0:i.sizeDiff.width,c={width:i.size.width-l,height:i.size.height-a},h=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,u=parseFloat(i.element.css("top"))+(i.position.top-i.originalPosition.top)||null;i.element.animate(e.extend(c,u&&h?{top:u,left:h}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var e={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};s&&s.length&&r(s[0]).css({width:e.width,height:e.height}),i._updateCache(e),i._propagate("resize",t)}})}}),a.add(c,"containment",{start:function(){var e,t,i,n,s,o,a,l=r(this).resizable("instance"),c=l.options,h=l.element,u=c.containment,d=u instanceof r?u.get(0):/parent/.test(u)?h.parent().get(0):u;d&&(l.containerElement=r(d),/document/.test(u)||u===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:r(document),left:0,top:0,width:r(document).width(),height:r(document).height()||document.body.parentNode.scrollHeight}):(e=r(d),t=[],r(["Top","Right","Left","Bottom"]).each(function(i,n){t[i]=l._num(e.css("padding"+n))}),l.containerOffset=e.offset(),l.containerPosition=e.position(),l.containerSize={height:e.innerHeight()-t[3],width:e.innerWidth()-t[1]},i=l.containerOffset,n=l.containerSize.height,s=l.containerSize.width,o=l._hasScroll(d,"left")?d.scrollWidth:s,a=l._hasScroll(d)?d.scrollHeight:n,l.parentData={element:d,left:i.left,top:i.top,width:o,height:a}))},resize:function(e){var t,i,n,s,o=r(this).resizable("instance"),a=o.options,l=o.containerOffset,c=o.position,h=o._aspectRatio||e.shiftKey,u={top:0,left:0},d=o.containerElement,f=!0;d[0]!==document&&/static/.test(d.css("position"))&&(u=l),c.left<(o._helper?l.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-l.left:o.position.left-u.left),h&&(o.size.height=o.size.width/o.aspectRatio,f=!1),o.position.left=a.helper?l.left:0),c.top<(o._helper?l.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-l.top:o.position.top),h&&(o.size.width=o.size.height*o.aspectRatio,f=!1),o.position.top=o._helper?l.top:0),n=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),n&&s?(o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top):(o.offset.left=o.element.offset().left,o.offset.top=o.element.offset().top),t=Math.abs(o.sizeDiff.width+(o._helper?o.offset.left-u.left:o.offset.left-l.left)),i=Math.abs(o.sizeDiff.height+(o._helper?o.offset.top-u.top:o.offset.top-l.top)),t+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-t,h&&(o.size.height=o.size.width/o.aspectRatio,f=!1)),i+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-i,h&&(o.size.width=o.size.height*o.aspectRatio,f=!1)),f||(o.position.left=o.prevPosition.left,o.position.top=o.prevPosition.top,o.size.width=o.prevSize.width,o.size.height=o.prevSize.height)},stop:function(){var e=r(this).resizable("instance"),t=e.options,i=e.containerOffset,n=e.containerPosition,s=e.containerElement,o=r(e.helper),a=o.offset(),l=o.outerWidth()-e.sizeDiff.width,c=o.outerHeight()-e.sizeDiff.height;e._helper&&!t.animate&&/relative/.test(s.css("position"))&&r(this).css({left:a.left-n.left-i.left,width:l,height:c}),e._helper&&!t.animate&&/static/.test(s.css("position"))&&r(this).css({left:a.left-n.left-i.left,width:l,height:c})}}),a.add(c,"alsoResize",{start:function(){var e=r(this).resizable("instance"),t=e.options;r(t.alsoResize).each(function(){var e=r(this);e.data("ui-resizable-alsoresize",{width:parseFloat(e.width()),height:parseFloat(e.height()),left:parseFloat(e.css("left")),top:parseFloat(e.css("top"))})})},resize:function(t,i){var n=r(this).resizable("instance"),s=n.options,o=n.originalSize,a=n.originalPosition,l={height:n.size.height-o.height||0,width:n.size.width-o.width||0,top:n.position.top-a.top||0,left:n.position.left-a.left||0};r(s.alsoResize).each(function(){var t=r(this),n=r(this).data("ui-resizable-alsoresize"),s={},o=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var i=(n[t]||0)+(l[t]||0);i&&i>=0&&(s[t]=i||null)}),t.css(s)})},stop:function(){r(this).removeData("ui-resizable-alsoresize")}}),a.add(c,"ghost",{start:function(){var e=r(this).resizable("instance"),t=e.size;e.ghost=e.originalElement.clone(),e.ghost.css({opacity:.25,display:"block",position:"relative",height:t.height,width:t.width,margin:0,left:0,top:0}),e._addClass(e.ghost,"ui-resizable-ghost"),e.ghost.appendTo(e.helper)},resize:function(){var e=r(this).resizable("instance");e.ghost&&e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})},stop:function(){var e=r(this).resizable("instance");e.ghost&&e.helper&&e.helper.get(0).removeChild(e.ghost.get(0))}}),a.add(c,"grid",{resize:function(){var e,t=r(this).resizable("instance"),i=t.options,n=t.size,s=t.originalSize,o=t.originalPosition,a=t.axis,l="number"==typeof i.grid?[i.grid,i.grid]:i.grid,c=l[0]||1,h=l[1]||1,u=Math.round((n.width-s.width)/c)*c,d=Math.round((n.height-s.height)/h)*h,f=s.width+u,p=s.height+d,m=i.maxWidth&&i.maxWidth<f,g=i.maxHeight&&i.maxHeight<p,v=i.minWidth&&i.minWidth>f,y=i.minHeight&&i.minHeight>p;i.grid=l,v&&(f+=c),y&&(p+=h),m&&(f-=c),g&&(p-=h),/^(se|s|e)$/.test(a)?(t.size.width=f,t.size.height=p):/^(ne)$/.test(a)?(t.size.width=f,t.size.height=p,t.position.top=o.top-d):/^(sw)$/.test(a)?(t.size.width=f,t.size.height=p,t.position.left=o.left-u):((p-h<=0||f-c<=0)&&(e=t._getPaddingPlusBorderDimensions(this)),p-h>0?(t.size.height=p,t.position.top=o.top-d):(p=h-e.height,t.size.height=p,t.position.top=o.top+s.height-p),f-c>0?(t.size.width=f,t.position.left=o.left-u):(f=c-e.width,t.size.width=f,t.position.left=o.left+s.width-f))}}),s.register(c,"resizable"),c}),define("skylark-jqueryui/widgets/resizable",["skylark-jquery","skylark-jqueryui-interact/Resizable","../version"],function(e,t){return e.ui.resizable=t}),define("skylark-jqueryui/widgets/dialog",["skylark-jquery","./button","./draggable","./mouse","./resizable","../focusable","../keycode","../position","../safe-active-element","../safe-blur","../tabbable","../unique-id","../version","../widget"],function(e){return e.widget("ui.dialog",{version:"@VERSION",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=e(this).css(t).offset().top;i<0&&e(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var i=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||e.ui.safeBlur(e.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,i){var n=!1,r=this.uiDialog.siblings(".ui-front:visible").map(function(){return+e(this).css("z-index")}).get(),s=Math.max.apply(null,r);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),n=!0),n&&!i&&this._trigger("focus",t),n},open:function(){var t=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=e(e.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).trigger("focus")},_keepFocus:function(t){function i(){var t=e.ui.safeActiveElement(this.document[0]),i=this.uiDialog[0]===t||e.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault(),i.call(this),this._delay(i)},_createWrapper:function(){this.uiDialog=e("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var i=this.uiDialog.find(":tabbable"),n=i.filter(":first"),r=i.filter(":last");t.target!==r[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==n[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){r.trigger("focus")}),t.preventDefault()):(this._delay(function(){n.trigger("focus")}),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:e("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title?e.text(this.options.title):e.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var t=this,i=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(i)||e.isArray(i)&&!i.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(e.each(i,function(i,n){var r,s;n=e.isFunction(n)?{click:n,text:i}:n,n=e.extend({type:"button"},n),r=n.click,s={icon:n.icon,iconPosition:n.iconPosition,showLabel:n.showLabel,icons:n.icons,text:n.text},delete n.click,delete n.icon,delete n.iconPosition,delete n.showLabel,delete n.icons,"boolean"==typeof n.text&&delete n.text,e("<button></button>",n).button(s).appendTo(t.uiButtonSet).on("click",function(){r.apply(t.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var t=this,i=this.options;function n(e){return{position:e.position,offset:e.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(i,r){t._addClass(e(this),"ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",i,n(r))},drag:function(e,i){t._trigger("drag",e,n(i))},stop:function(r,s){var o=s.offset.left-t.document.scrollLeft(),a=s.offset.top-t.document.scrollTop();i.position={my:"left top",at:"left"+(o>=0?"+":"")+o+" top"+(a>=0?"+":"")+a,of:t.window},t._removeClass(e(this),"ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",r,n(s))}})},_makeResizable:function(){var t=this,i=this.options,n=i.resizable,r=this.uiDialog.css("position"),s="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";function o(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:this._minHeight(),handles:s,start:function(i,n){t._addClass(e(this),"ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",i,o(n))},resize:function(e,i){t._trigger("resize",e,o(i))},stop:function(n,r){var s=t.uiDialog.offset(),a=s.left-t.document.scrollLeft(),l=s.top-t.document.scrollTop();i.height=t.uiDialog.height(),i.width=t.uiDialog.width(),i.position={my:"left top",at:"left"+(a>=0?"+":"")+a+" top"+(l>=0?"+":"")+l,of:t.window},t._removeClass(e(this),"ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",n,o(r))}}).css("position",r)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),i=e.inArray(this,t);-1!==i&&t.splice(i,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var i=this,n=!1,r={};e.each(t,function(e,t){i._setOption(e,t),e in i.sizeRelatedOptions&&(n=!0),e in i.resizableRelatedOptions&&(r[e]=t)}),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",r)},_setOption:function(t,i){var n,r,s=this.uiDialog;"disabled"!==t&&(this._super(t,i),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:e("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&((n=s.is(":data(ui-draggable)"))&&!i&&s.draggable("destroy"),!n&&i&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((r=s.is(":data(ui-resizable)"))&&!i&&s.resizable("destroy"),r&&"string"==typeof i&&s.resizable("option","handles",i),r||!1===i||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,i,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),i="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!e(t.target).closest(".ui-dialog").length||!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=!0;this._delay(function(){t=!1}),this.document.data("ui-dialog-overlays")||this.document.on("focusin.ui-dialog",function(e){if(!t){var i=this._trackingInstances()[0];i._allowInteraction(e)||(e.preventDefault(),i._focusTabbable())}}.bind(this)),this.overlay=e("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==e.uiBackCompat&&e.widget("ui.dialog",e.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(e,t){"dialogClass"===e&&this.uiDialog.removeClass(this.options.dialogClass).addClass(t),this._superApply(arguments)}}),e.ui.dialog}),define("skylark-jqueryui-interact/Droppable",["skylark-langx/langx","skylark-domx-eventer","skylark-domx-noder","skylark-domx-query","skylark-domx-plugins-base","skylark-jquery/JqueryPlugin","./patch","./ddmanager"],function(e,t,i,n,r,s,o,a){var l=s.inherit({klassName:"Droppable",pluginName:"ui.Droppable",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(n)?n:function(e){return e.is(n)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(i.scope),i.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){a.droppables[e]=a.droppables[e]||[],a.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=a.droppables[this.options.scope];this._splice(e)},_setOption:function(t,i){if("accept"===t)this.accept=e.isFunction(i)?i:function(e){return e.is(i)};else if("scope"===t){var n=a.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(t,i)},_activate:function(e){var t=a.current;this._addActiveClass(),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=a.current;this._removeActiveClass(),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=a.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=a.current;t&&(t.currentItem||t.element)[0]!==this.element[0]&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(t)))},_drop:function(t,i){var r=i||a.current,s=!1;return!(!r||(r.currentItem||r.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=n(this).droppable("instance");if(i.options.greedy&&!i.options.disabled&&i.options.scope===r.options.scope&&i.accept.call(i.element[0],r.currentItem||r.element)&&a.intersect(r,e.extend(i,{offset:i.element.offset()}),i.options.tolerance,t))return s=!0,!1}),!s&&(!!this.accept.call(this.element[0],r.currentItem||r.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",t,this.ui(r)),this.element)))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});return r.register(l,"droppable"),l}),define("skylark-jqueryui/widgets/droppable",["skylark-jquery","skylark-jqueryui-interact/Droppable","../version"],function(e,t){return e.ui.droppable=t}),define("skylark-jqueryui/widgets/progressbar",["skylark-jquery","../version","../widget"],function(e){return e.widget("ui.progressbar",{version:"@VERSION",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=e("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(e){if(void 0===e)return this.options.value;this.options.value=this._constrainedValue(e),this._refreshValue()},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).width(i.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,t===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}})}),define("skylark-jqueryui-interact/Selectable",["skylark-langx/langx","skylark-domx-data","skylark-domx-eventer","skylark-domx-noder","skylark-domx-query","skylark-domx-plugins-base","./Mouse"],function(e,t,i,n,r,s,o){var a=o.inherit({klassName:"Selectable",pluginName:"ui.selectable",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e.elementPos=r(e.element[0]).offset(),e.selectees=r(e.options.filter,e.element[0]),e._addClass(e.selectees,"ui-selectee"),e.selectees.each(function(){var i=r(this),n=i.offset(),s={left:n.left-e.elementPos.left,top:n.top-e.elementPos.top};t.data(this,"selectable-item",{element:this,$element:i,left:s.left,top:s.top,right:s.left+i.outerWidth(),bottom:s.top+i.outerHeight(),startselected:!1,selected:i.hasClass("ui-selected"),selecting:i.hasClass("ui-selecting"),unselecting:i.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=r("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.elementPos=r(this.element[0]).offset(),this.options.disabled||(this.selectees=r(n.filter,this.element[0]),this._trigger("start",e),r(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(i._removeClass(n.$element,"ui-selected"),n.selected=!1,i._addClass(n.$element,"ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),r(e.target).parents().addBack().each(function(){var n,r=t.data(this,"selectable-item");if(r)return n=!e.metaKey&&!e.ctrlKey||!r.$element.hasClass("ui-selected"),i._removeClass(r.$element,n?"ui-unselecting":"ui-selected")._addClass(r.$element,n?"ui-selecting":"ui-unselecting"),r.unselecting=!n,r.selecting=n,r.selected=n,n?i._trigger("selecting",e,{selecting:r.element}):i._trigger("unselecting",e,{unselecting:r.element}),!1}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,r=this.options,s=this.opos[0],o=this.opos[1],a=e.pageX,l=e.pageY;return s>a&&(i=a,a=s,s=i),o>l&&(i=l,l=o,o=i),this.helper.css({left:s,top:o,width:a-s,height:l-o}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),c=!1,h={};i&&i.element!==n.element[0]&&(h.left=i.left+n.elementPos.left,h.right=i.right+n.elementPos.left,h.top=i.top+n.elementPos.top,h.bottom=i.bottom+n.elementPos.top,"touch"===r.tolerance?c=!(h.left>a||h.right<s||h.top>l||h.bottom<o):"fit"===r.tolerance&&(c=h.left>s&&h.right<a&&h.top>o&&h.bottom<l),c?(i.selected&&(n._removeClass(i.$element,"ui-selected"),i.selected=!1),i.unselecting&&(n._removeClass(i.$element,"ui-unselecting"),i.unselecting=!1),i.selecting||(n._addClass(i.$element,"ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(n._removeClass(i.$element,"ui-selecting"),i.selecting=!1,n._addClass(i.$element,"ui-selected"),i.selected=!0):(n._removeClass(i.$element,"ui-selecting"),i.selecting=!1,i.startselected&&(n._addClass(i.$element,"ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(n._removeClass(i.$element,"ui-selected"),i.selected=!1,n._addClass(i.$element,"ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,r(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");i._removeClass(n.$element,"ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),r(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");i._removeClass(n.$element,"ui-selecting")._addClass(n.$element,"ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}});return s.register(a,"selectable"),a}),define("skylark-jqueryui/widgets/selectable",["skylark-jquery","skylark-jqueryui-interact/Selectable","../version"],function(e,t){return e.ui.selectable=t}),define("skylark-jqueryui/widgets/selectmenu",["skylark-jquery","./menu","../escape-selector","../form-reset-mixin","../keycode","../labels","../position","../unique-id","../version","../widget"],function(e){return e.widget("ui.selectmenu",[e.ui.formResetMixin,{version:"@VERSION",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=e()},_drawButton:function(){var t,i=this,n=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(e){this.button.focus(),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),t=e("<span>").appendTo(this.button),this._addClass(t,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(n).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){i._rendered||i._refreshMenu()})},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(e,i){e.preventDefault(),t._setSelection(),t._select(i.item.data("ui-selectmenu-item"),e)},focus:function(e,i){var n=i.item.data("ui-selectmenu-item");null!=t.focusIndex&&n.index!==t.focusIndex&&(t._trigger("focus",e,{item:n}),t.isOpen||t._select(n,e)),t.focusIndex=n.index,t.button.attr("aria-activedescendant",t.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var e,t=this.element.find("option");this.menu.empty(),this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,t.length&&(e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e)))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(t){var i=e("<span>");return this._setText(i,t.label),this._addClass(i,"ui-selectmenu-text"),i},_renderMenu:function(t,i){var n=this,r="";e.each(i,function(i,s){var o;s.optgroup!==r&&(o=e("<li>",{text:s.optgroup}),n._addClass(o,"ui-selectmenu-optgroup","ui-menu-divider"+(s.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),o.appendTo(t),r=s.optgroup),n._renderItemData(t,s)})},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,i){var n=e("<li>"),r=e("<div>",{title:i.element.attr("title")});return i.disabled&&this._addClass(n,null,"ui-state-disabled"),this._setText(r,i.label),n.append(r).appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var i,n,r=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),r+=":not(.ui-state-disabled)"),(n="first"===e||"last"===e?i["first"===e?"prevAll":"nextAll"](r).eq(-1):i[e+"All"](r).eq(0)).length&&this.menuInstance.focus(t,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?((e=window.getSelection()).removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+e.ui.escapeSelector(this.ids.button)).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection()).rangeCount&&(this.range=e.getRangeAt(0)):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var i=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),i=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),i=!1}i&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex).parent("li");t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(e)),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==i&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){if("icons"===e){var i=this.button.find("span.ui-icon");this._removeClass(i,null,this.options.icons.button)._addClass(i,null,t.button)}this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"width"===e&&this._resizeButton()},_setOptionDisabled:function(e){this._super(e),this.menuInstance.option("disabled",e),this.button.attr("aria-disabled",e),this._toggleClass(this.button,null,"ui-state-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;!1!==e?(null===e&&(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var e=this._super();return e.disabled=this.element.prop("disabled"),e},_parseOptions:function(t){var i=this,n=[];t.each(function(t,r){r.hidden||n.push(i._parseOption(e(r),t))}),this.items=n},_parseOption:function(e,t){var i=e.parent("optgroup");return{element:e,index:t,value:e.val(),label:e.text(),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||e.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}])}),define("skylark-jqueryui/widgets/slider",["skylark-jquery","./mouse","../keycode","../version","../widget"],function(e){return e.widget("ui.slider",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,i,n=this.options,r=this.element.find(".ui-slider-handle"),s=[];for(i=n.values&&n.values.length||1,r.length>i&&(r.slice(i).remove(),r=r.slice(0,i)),t=r.length;t<i;t++)s.push("<span tabindex='0'></span>");this.handles=r.add(e(s.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t).attr("tabIndex",0)})},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=e("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var i,n,r,s,o,a,l,c=this,h=this.options;return!h.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(i),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var i=Math.abs(n-c.values(t));(r>i||r===i&&(t===c._lastChangedValue||c.values(t)===h.min))&&(r=i,s=e(this),o=t)}),!1!==this._start(t,o)&&(this._mouseSliding=!0,this._handleIndex=o,this._addClass(s,null,"ui-state-active"),s.trigger("focus"),a=s.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-a.left-s.width()/2,top:t.pageY-a.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},i=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,i),!1},_mouseStop:function(e){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,i,n,r,s;return"horizontal"===this.orientation?(t=this.elementSize.width,i=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,i=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(n=i/t)>1&&(n=1),n<0&&(n=0),"vertical"===this.orientation&&(n=1-n),r=this._valueMax()-this._valueMin(),s=this._valueMin()+n*r,this._trimAlignValue(s)},_uiHash:function(e,t,i){var n={handle:this.handles[e],handleIndex:e,value:void 0!==t?t:this.value()};return this._hasMultipleValues()&&(n.value=void 0!==t?t:this.values(e),n.values=i||this.values()),n},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(e,t){return this._trigger("start",e,this._uiHash(t))},_slide:function(e,t,i){var n,r=this.value(),s=this.values();this._hasMultipleValues()&&(n=this.values(t?0:1),r=this.values(t),2===this.options.values.length&&!0===this.options.range&&(i=0===t?Math.min(n,i):Math.max(n,i)),s[t]=i),i!==r&&!1!==this._trigger("slide",e,this._uiHash(t,i,s))&&(this._hasMultipleValues()?this.values(t,i):this.value(i))},_stop:function(e,t){this._trigger("stop",e,this._uiHash(t))},_change:function(e,t){this._keySliding||this._mouseSliding||(this._lastChangedValue=t,this._trigger("change",e,this._uiHash(t)))},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(t,i){var n,r,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,t);if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this._hasMultipleValues()?this._values(t):this.value();for(n=this.options.values,r=arguments[0],s=0;s<n.length;s+=1)n[s]=this._trimAlignValue(r[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,i){var n,r=0;switch("range"===t&&!0===this.options.range&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(r=this.options.values.length),this._super(t,i),t){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(i),this.handles.css("horizontal"===i?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=r-1;n>=0;n--)this._change(null,n);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(e){this._super(e),this._toggleClass(null,"ui-state-disabled",!!e)},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,i,n;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this._hasMultipleValues()){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(e-this._valueMin())%t,n=e-i;return 2*Math.abs(i)>=t&&(n+=i>0?t:-t),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),i=this.options.step,n=Math.round((e-t)/i)*i;(e=n+t)>this.options.max&&(e-=i),this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(e){"vertical"===e&&this.range.css({width:"",left:""}),"horizontal"===e&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var t,i,n,r,s,o=this.options.range,a=this.options,l=this,c=!this._animateOff&&a.animate,h={};this._hasMultipleValues()?this.handles.each(function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,h["horizontal"===l.orientation?"left":"bottom"]=i+"%",e(this).stop(1,1)[c?"animate":"css"](h,a.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({width:i-t+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[c?"animate":"css"]({height:i-t+"%"},{queue:!1,duration:a.animate}))),t=i}):(n=this.value(),r=this._valueMin(),s=this._valueMax(),i=s!==r?(n-r)/(s-r)*100:0,h["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[c?"animate":"css"](h,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:i+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:100-i+"%"},a.animate),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:i+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:100-i+"%"},a.animate))},_handleEvents:{keydown:function(t){var i,n,r,s=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(e(t.target),null,"ui-state-active"),!1===this._start(t,s)))return}switch(r=this.options.step,i=n=this._hasMultipleValues()?this.values(s):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(i===this._valueMax())return;n=this._trimAlignValue(i+r);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(i===this._valueMin())return;n=this._trimAlignValue(i-r)}this._slide(t,s,n)},keyup:function(t){var i=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),this._removeClass(e(t.target),null,"ui-state-active"))}}})}),define("skylark-jqueryui-interact/Sortable",["skylark-langx/langx","skylark-domx-data","skylark-domx-eventer","skylark-domx-noder","skylark-domx-query","skylark-domx-plugins-base","./Mouse","./ddmanager"],function(e,t,i,n,r,s,o,a){var l=o.inherit({klassName:"Sortable",pluginName:"ui.sortable",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.pluginName+"-item");return this},_mouseCapture:function(e,i){var n=null,s=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),r(e.target).parents().each(function(){if(t.data(this,o.pluginName+"-item")===o)return n=r(this),!1}),t.data(e.target,o.pluginName+"-item")===o&&(n=r(e.target)),!!n&&(!(this.options.handle&&!i&&(r(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(s=!0)}),!s))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,i,n){var s,o,l=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=r("parent"!==l.appendTo?l.appendTo:this.currentItem.parent()),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),l.cursorAt&&this._adjustOffsetFromHelper(l.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),e.extend(this.offset,{parent:this._getParentOffset()}),l.containment&&this._setContainment(),l.cursor&&"auto"!==l.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",l.cursor),this.storedStylesheet=r("<style>*{ cursor: "+l.cursor+" !important; }</style>").appendTo(o)),l.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",l.zIndex)),l.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",l.opacity)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return a&&(a.current=this),a&&!l.dropBehaviour&&a.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(t),!0},_scroll:function(e){var t=this.options,i=!1;return this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<t.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+t.scrollSpeed:e.pageY-this.overflowOffset.top<t.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-t.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<t.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+t.scrollSpeed:e.pageX-this.overflowOffset.left<t.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-t.scrollSpeed)):(e.pageY-this.document.scrollTop()<t.scrollSensitivity?i=this.document.scrollTop(this.document.scrollTop()-t.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<t.scrollSensitivity&&(i=this.document.scrollTop(this.document.scrollTop()+t.scrollSpeed)),e.pageX-this.document.scrollLeft()<t.scrollSensitivity?i=this.document.scrollLeft(this.document.scrollLeft()-t.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<t.scrollSensitivity&&(i=this.document.scrollLeft(this.document.scrollLeft()+t.scrollSpeed))),i},_mouseDrag:function(e){var t,i,r,s,o=this.options;if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),this._contactContainers(e),null!==this.innermostContainer)for(o.scroll&&!1!==this._scroll(e)&&(this._refreshItemPositions(!0),a&&!o.dropBehaviour&&a.prepareOffsets(this,e)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},t=this.items.length-1;t>=0;t--)if(i=this.items[t],r=i.item[0],(s=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(r===this.currentItem[0]||this.placeholder[1===s?"next":"prev"]()[0]===r||n.contains(this.placeholder[0],r)||"semi-dynamic"===this.options.type&&n.contains(this.element[0],r))){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;this._rearrange(e,i),this._trigger("change",e,this._uiHash());break}return a&&a.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,t){if(e){if(a&&!this.options.dropBehaviour&&a.drop(this,e),this.options.revert){var i=this,n=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=n.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=n.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,r(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(e)})}else this._clear(e,t);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new i.create("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?r(this.domPosition.prev).after(this.currentItem):r(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},r(t).each(function(){var t=(r(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);t&&i.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!i.length&&e.key&&i.push(e.key+"="),i.join("&")},toArray:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},t.each(function(){i.push(r(e.item||this).attr(e.attribute||"id")||"")}),i},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,r=n+this.helperProportions.height,s=e.left,o=s+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,h=this.offset.click.left,u="x"===this.options.axis||n+c>a&&n+c<l,d="y"===this.options.axis||t+h>s&&t+h<o,f=u&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?f:s<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&a<n+this.helperProportions.height/2&&r-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t,i,n="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),r="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),s=n&&r;return!!s&&(t=this.dragDirection.vertical,i=this.dragDirection.horizontal,this.floating?"right"===i||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this.dragDirection.vertical,r=this.dragDirection.horizontal;return this.floating&&r?"right"===r&&i||"left"===r&&!i:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(i){var n,s,o,a,l=[],c=[],h=this._connectWith();if(h&&i)for(n=h.length-1;n>=0;n--)for(o=r(h[n],this.document[0]),s=o.length-1;s>=0;s--)(a=t.data(o[s],this.pluginName))&&a!==this&&!a.options.disabled&&c.push([e.isFunction(a.options.items)?a.options.items.call(a.element):r(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);function u(){l.push(this)}for(c.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):r(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=c.length-1;n>=0;n--)c[n][0].each(u);return r(l)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.pluginName+"-item)");this.items=this.items.filter(function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(i){this.items=[],this.containers=[this];var n,s,o,a,l,c,h,u,d=this.items,f=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],i,{item:this.currentItem}):r(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(n=p.length-1;n>=0;n--)for(o=r(p[n],this.document[0]),s=o.length-1;s>=0;s--)(a=t.data(o[s],this.pluginName))&&a!==this&&!a.options.disabled&&(f.push([e.isFunction(a.options.items)?a.options.items.call(a.element[0],i,{item:this.currentItem}):r(a.options.items,a.element),a]),this.containers.push(a));for(n=f.length-1;n>=0;n--)for(l=f[n][1],c=f[n][0],s=0,u=c.length;s<u;s++)(h=r(c[s])).data(this.pluginName+"-item",l),d.push({item:h,instance:l,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(e){var t,i,n,s;for(t=this.items.length-1;t>=0;t--)i=this.items[t],this.currentContainer&&i.instance!==this.currentContainer&&i.item[0]!==this.currentItem[0]||(n=this.options.toleranceElement?r(this.options.toleranceElement,i.item):i.item,e||(i.width=n.outerWidth(),i.height=n.outerHeight()),s=n.offset(),i.left=s.left,i.top=s.top)},refreshPositions:function(e){var t,i;if(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),null!==this.innermostContainer&&this._refreshItemPositions(e),this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;t>=0;t--)i=this.containers[t].element.offset(),this.containers[t].containerCache.left=i.left,this.containers[t].containerCache.top=i.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(e){var t,i,n=(e=e||this).options;n.placeholder&&n.placeholder.constructor!==String||(t=n.placeholder,i=e.currentItem[0].nodeName.toLowerCase(),n.placeholder={element:function(){var n=r("<"+i+">",e.document[0]);return e._addClass(n,"ui-sortable-placeholder",t||e.currentItem[0].className)._removeClass(n,"ui-sortable-helper"),"tbody"===i?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),r("<tr>",e.document[0]).appendTo(n)):"tr"===i?e._createTrPlaceholder(e.currentItem,n):"img"===i&&n.attr("src",e.currentItem.attr("src")),t||n.css("visibility","hidden"),n},update:function(r,s){t&&!n.forcePlaceholderSize||(s.height()&&(!n.forcePlaceholderSize||"tbody"!==i&&"tr"!==i)||s.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),s.width()||s.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=r(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,t){var i=this;e.children().each(function(){r("<td>&#160;</td>",i.document[0]).attr("colspan",r(this).attr("colspan")||1).appendTo(t)})},_contactContainers:function(e){var t,i,r,s,o,a,l,c,h,u,d=null,f=null;for(t=this.containers.length-1;t>=0;t--)if(!n.contains(this.currentItem[0],this.containers[t].element[0]))if(this._intersectsWith(this.containers[t].containerCache)){if(d&&n.contains(this.containers[t].element[0],d.element[0]))continue;d=this.containers[t],f=t}else this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",e,this._uiHash(this)),this.containers[t].containerCache.over=0);if(this.innermostContainer=d,d)if(1===this.containers.length)this.containers[f].containerCache.over||(this.containers[f]._trigger("over",e,this._uiHash(this)),this.containers[f].containerCache.over=1);else{for(r=1e4,s=null,h=d.floating||this._isFloating(this.currentItem),o=h?"left":"top",a=h?"width":"height",u=h?"pageX":"pageY",i=this.items.length-1;i>=0;i--)n.contains(this.containers[f].element[0],this.items[i].item[0])&&this.items[i].item[0]!==this.currentItem[0]&&(l=this.items[i].item.offset()[o],c=!1,e[u]-l>this.items[i][a]/2&&(c=!0),Math.abs(e[u]-l)<r&&(r=Math.abs(e[u]-l),s=this.items[i],this.direction=c?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[f])return void(this.currentContainer.containerCache.over||(this.containers[f]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(e,s,null,!0):this._rearrange(e,null,this.containers[f].element,!0),this._trigger("change",e,this._uiHash()),this.containers[f]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[f],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[f]._trigger("over",e,this._uiHash(this)),this.containers[f].containerCache.over=1}},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?r(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||this.appendTo[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!i.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!i.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&n.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,t,i,n=this.options;"parent"===n.containment&&(n.containment=this.helper[0].parentNode),"document"!==n.containment&&"window"!==n.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===n.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===n.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(n.containment)||(e=r(n.containment)[0],t=r(n.containment).offset(),i="hidden"!==r(e).css("overflow"),this.containment=[t.left+(parseInt(r(e).css("borderLeftWidth"),10)||0)+(parseInt(r(e).css("paddingLeft"),10)||0)-this.margins.left,t.top+(parseInt(r(e).css("borderTopWidth"),10)||0)+(parseInt(r(e).css("paddingTop"),10)||0)-this.margins.top,t.left+(i?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(r(e).css("borderLeftWidth"),10)||0)-(parseInt(r(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,t.top+(i?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(r(e).css("borderTopWidth"),10)||0)-(parseInt(r(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&n.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(r[0].tagName);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:r.scrollTop())*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:r.scrollLeft())*i}},_generatePosition:function(e){var t,i,r=this.options,s=e.pageX,o=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&n.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),r.grid&&(t=this.originalPageY+Math.round((o-this.originalPageY)/r.grid[1])*r.grid[1],o=this.containment?t-this.offset.click.top>=this.containment[1]&&t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-r.grid[1]:t+r.grid[1]:t,i=this.originalPageX+Math.round((s-this.originalPageX)/r.grid[0])*r.grid[0],s=this.containment?i-this.offset.click.left>=this.containment[0]&&i-this.offset.click.left<=this.containment[2]?i:i-this.offset.click.left>=this.containment[0]?i-r.grid[0]:i+r.grid[0]:i)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this.counter;this._delay(function(){r===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function r(e,t,i){return function(n){i._trigger(e,n,t._uiHash(t))}}for(this.fromOutside&&!t&&n.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(n.push(function(e){this._trigger("remove",e,this._uiHash())}),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||n.push(r("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(r("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(i=0;i<n.length;i++)n[i].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(e,t,i){!1===this.overrided(e,t,i)&&this.cancel()},_uiHash:function(e){var t=e||this;return{helper:t.helper,placeholder:t.placeholder||r([]),position:t.position,originalPosition:t.originalPosition,offset:t.positionAbs,item:t.currentItem,sender:e?e.element:null}}});return s.register(l,"sortable"),l}),define("skylark-jqueryui/widgets/sortable",["skylark-jquery","skylark-jqueryui-interact/Sortable","../version"],function(e,t){return e.ui.sortable=t}),define("skylark-jqueryui/widgets/spinner",["skylark-jquery","./button","../version","../keycode","../safe-active-element","../widget"],function(e){function t(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}return e.widget("ui.spinner",{version:"@VERSION",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t=this._super(),i=this.element;return e.each(["min","max","step"],function(e,n){var r=i.attr(n);null!=r&&r.length&&(t[n]=r)}),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e))},mousewheel:function(t,i){var n=e.ui.safeActiveElement(this.document[0]),r=this.element[0]===n;if(r&&i){if(!this.spinning&&!this._start(t))return!1;this._spin((i>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){var i;function n(){var t=this.element[0]===e.ui.safeActiveElement(this.document[0]);t||(this.element.trigger("focus"),this.previous=i,this._delay(function(){this.previous=i}))}i=this.element[0]===e.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,n.call(this)}),!1!==this._start(t)&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(e(t.currentTarget).hasClass("ui-state-active"))return!1!==this._start(t)&&void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(t){var i=this.options,n=e.ui.keyCode;switch(t.keyCode){case n.UP:return this._repeat(null,1,t),!0;case n.DOWN:return this._repeat(null,-1,t),!0;case n.PAGE_UP:return this._repeat(null,i.page,t),!0;case n.PAGE_DOWN:return this._repeat(null,-i.page,t),!0}return!1},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(e,t,i){e=e||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,t,i)},e),this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:i})||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?e.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,n=this.options;return t=null!==n.min?n.min:0,i=e-t,i=Math.round(i/n.step)*n.step,e=t+i,e=parseFloat(e.toFixed(this._precision())),null!==n.max&&e>n.max?n.max:null!==n.min&&e<n.min?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){var i,n,r;if("culture"===e||"numberFormat"===e)return i=this._parse(this.element.val()),this.options[e]=t,void this.element.val(this._format(i));"max"!==e&&"min"!==e&&"step"!==e||"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(n=this.buttons.first().find(".ui-icon"),this._removeClass(n,null,this.options.icons.up),this._addClass(n,null,t.up),r=this.buttons.last().find(".ui-icon"),this._removeClass(r,null,this.options.icons.down),this._addClass(r,null,t.down)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable")},_setOptions:t(function(e){this._super(e)}),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var i;""!==e&&null!==(i=this._parse(e))&&(t||(i=this._adjustValue(i)),e=this._format(i)),this.element.val(e),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:t(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:t(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:t(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:t(function(e){this._stepDown((e||1)*this.options.page)}),value:function(e){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,e)},widget:function(){return this.uiSpinner}}),!1!==e.uiBackCompat&&e.widget("ui.spinner",e.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),e.ui.spinner}),define("skylark-jqueryui/widgets/tabs",["skylark-jquery","../escape-selector","../keycode","../safe-active-element","../unique-id","../version","../widget"],function(e){var t;return e.widget("ui.tabs",{version:"@VERSION",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(t=/#.*$/,function(e){var i,n;i=e.href.replace(t,""),n=location.href.replace(t,"");try{i=decodeURIComponent(i)}catch(e){}try{n=decodeURIComponent(n)}catch(e){}return e.hash.length>1&&i===n}),_create:function(){var t=this,i=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,i.collapsible),this._processTabs(),i.active=this._initialActive(),e.isArray(i.disabled)&&(i.disabled=e.uniqueSort(i.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),function(e){return t.tabs.index(e)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(i.active):this.active=e(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===t&&(n&&this.tabs.each(function(i,r){if(e(r).attr("aria-controls")===n)return t=i,!1}),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==t&&-1!==t||(t=!!this.tabs.length&&0)),!1!==t&&-1===(t=this.tabs.index(this.tabs.eq(t)))&&(t=!i&&0),!i&&!1===t&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var i=e(e.ui.safeActiveElement(this.document[0])).closest("li"),n=this.tabs.index(i),r=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:n++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:r=!1,n--;break;case e.ui.keyCode.END:n=this.anchors.length-1;break;case e.ui.keyCode.HOME:n=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}t.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,r),t.ctrlKey||t.metaKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",n)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){var n=this.tabs.length-1;function r(){return t>n&&(t=0),t<0&&(t=n),t}for(;-1!==e.inArray(r(),this.options.disabled);)t=i?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).trigger("focus"),e},_setOption:function(e,t){"active"!==e?(this._super(e,t),"collapsible"===e&&(this._toggleClass("ui-tabs-collapsible",null,t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t)):this._activate(t)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=e.map(i.filter(".ui-state-disabled"),function(e){return i.index(e)}),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,i=this.tabs,n=this.anchors,r=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return e("a",this)[0]}).attr({tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=e(),this.anchors.each(function(i,n){var r,s,o,a=e(n).uniqueId().attr("id"),l=e(n).closest("li"),c=l.attr("aria-controls");t._isLocal(n)?(r=n.hash,o=r.substring(1),s=t.element.find(t._sanitizeSelector(r))):(o=l.attr("aria-controls")||e({}).uniqueId()[0].id,r="#"+o,(s=t.element.find(r)).length||(s=t._createPanel(o)).insertAfter(t.panels[i-1]||t.tablist),s.attr("aria-live","polite")),s.length&&(t.panels=t.panels.add(s)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":o,"aria-labelledby":a}),s.attr("aria-labelledby",a)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),i&&(this._off(i.not(this.tabs)),this._off(n.not(this.anchors)),this._off(r.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(t){var i,n,r;for(e.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1),r=0;n=this.tabs[r];r++)i=e(n),!0===t||-1!==e.inArray(r,t)?(i.attr("aria-disabled","true"),this._addClass(i,null,"ui-state-disabled")):(i.removeAttr("aria-disabled"),this._removeClass(i,null,"ui-state-disabled"));this.options.disabled=t,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===t)},_setupEvents:function(t){var i={};t&&e.each(t.split(" "),function(e,t){i[t]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,n=this.element.parent();"fill"===t?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=e(this).outerHeight(!0)}),this.panels.each(function(){e(this).height(Math.max(0,i-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,e(this).height("").height())}).height(i))},_eventHandler:function(t){var i=this.options,n=this.active,r=e(t.currentTarget),s=r.closest("li"),o=s[0]===n[0],a=o&&i.collapsible,l=a?e():this._getPanelForTab(s),c=n.length?this._getPanelForTab(n):e(),h={oldTab:n,oldPanel:c,newTab:a?e():s,newPanel:l};t.preventDefault(),s.hasClass("ui-state-disabled")||s.hasClass("ui-tabs-loading")||this.running||o&&!i.collapsible||!1===this._trigger("beforeActivate",t,h)||(i.active=!a&&this.tabs.index(s),this.active=o?e():s,this.xhr&&this.xhr.abort(),c.length||l.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),l.length&&this.load(this.tabs.index(s),t),this._toggle(t,h))},_toggle:function(t,i){var n=this,r=i.newPanel,s=i.oldPanel;function o(){n.running=!1,n._trigger("activate",t,i)}function a(){n._addClass(i.newTab.closest("li"),"ui-tabs-active","ui-state-active"),r.length&&n.options.show?n._show(r,n.options.show,o):(r.show(),o())}this.running=!0,s.length&&this.options.hide?this._hide(s,this.options.hide,function(){n._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),a()}):(this._removeClass(i.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),s.hide(),a()),s.attr("aria-hidden","true"),i.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),r.length&&s.length?i.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),r.attr("aria-hidden","false"),i.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var i,n=this._findActive(t);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:e.noop}))},_findActive:function(t){return!1===t?e():this.tabs.eq(t)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+e.ui.escapeSelector(t)+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var t=e(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var i=this.options.disabled;!1!==i&&(void 0===t?i=!1:(t=this._getIndex(t),i=e.isArray(i)?e.map(i,function(e){return e!==t?e:null}):e.map(this.tabs,function(e,i){return i!==t?i:null})),this._setOptionDisabled(i))},disable:function(t){var i=this.options.disabled;if(!0!==i){if(void 0===t)i=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,i))return;i=e.isArray(i)?e.merge([t],i).sort():[t]}this._setOptionDisabled(i)}},load:function(t,i){t=this._getIndex(t);var n=this,r=this.tabs.eq(t),s=r.find(".ui-tabs-anchor"),o=this._getPanelForTab(r),a={tab:r,panel:o},l=function(e,t){"abort"===t&&n.panels.stop(!1,!0),n._removeClass(r,"ui-tabs-loading"),o.removeAttr("aria-busy"),e===n.xhr&&delete n.xhr};this._isLocal(s[0])||(this.xhr=e.ajax(this._ajaxSettings(s,i,a)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(r,"ui-tabs-loading"),o.attr("aria-busy","true"),this.xhr.done(function(e,t,r){setTimeout(function(){o.html(e),n._trigger("load",i,a),l(r,t)},1)}).fail(function(e,t){setTimeout(function(){l(e,t)},1)})))},_ajaxSettings:function(t,i,n){var r=this;return{url:t.attr("href").replace(/#.*$/,""),beforeSend:function(t,s){return r._trigger("beforeLoad",i,e.extend({jqXHR:t,ajaxSettings:s},n))}}},_getPanelForTab:function(t){var i=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}}),!1!==e.uiBackCompat&&e.widget("ui.tabs",e.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),e.ui.tabs}),define("skylark-jqueryui/widgets/tooltip",["skylark-jquery","../keycode","../position","../unique-id","../version","../widget"],function(e){return e.widget("ui.tooltip",{version:"@VERSION",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var t=e(this).attr("title")||"";return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(t,i){var n=(t.attr("aria-describedby")||"").split(/\s+/);n.push(i),t.data("ui-tooltip-id",i).attr("aria-describedby",e.trim(n.join(" ")))},_removeDescribedBy:function(t){var i=t.data("ui-tooltip-id"),n=(t.attr("aria-describedby")||"").split(/\s+/),r=e.inArray(i,n);-1!==r&&n.splice(r,1),t.removeData("ui-tooltip-id"),(n=e.trim(n.join(" ")))?t.attr("aria-describedby",n):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=e([])},_setOption:function(t,i){var n=this;this._super(t,i),"content"===t&&e.each(this.tooltips,function(e,t){n._updateContent(t.element)})},_setOptionDisabled:function(e){this[e?"_disable":"_enable"]()},_disable:function(){var t=this;e.each(this.tooltips,function(i,n){var r=e.Event("blur");r.target=r.currentTarget=n.element[0],t.close(r,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var t=e(this);if(t.is("[title]"))return t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))}),this.disabledTitles=e([])},open:function(t){var i=this,n=e(t?t.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&n.parents().each(function(){var t,n=e(this);n.data("ui-tooltip-open")&&((t=e.Event("blur")).target=t.currentTarget=this,i.close(t,!0)),n.attr("title")&&(n.uniqueId(),i.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))}),this._registerCloseHandlers(t,n),this._updateContent(n,t))},_updateContent:function(e,t){var i,n=this.options.content,r=this,s=t?t.type:null;if("string"==typeof n||n.nodeType||n.jquery)return this._open(t,e,n);(i=n.call(e[0],function(i){r._delay(function(){e.data("ui-tooltip-open")&&(t&&(t.type=s),this._open(t,e,i))})}))&&this._open(t,e,i)},_open:function(t,i,n){var r,s,o,a,l=e.extend({},this.options.position);function c(e){l.of=e,s.is(":hidden")||s.position(l)}n&&((r=this._find(i))?r.tooltip.find(".ui-tooltip-content").html(n):(i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),r=this._tooltip(i),s=r.tooltip,this._addDescribedBy(i,s.attr("id")),s.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),(a=e("<div>").html(s.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),a.removeAttr("id").find("[id]").removeAttr("id"),a.appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:c}),c(t)):s.position(e.extend({of:i},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(o=this.delayedShow=setInterval(function(){s.is(":visible")&&(c(l.of),clearInterval(o))},e.fx.interval)),this._trigger("open",t,{tooltip:s})))},_registerCloseHandlers:function(t,i){var n={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=i[0],this.close(n,!0)}}};i[0]!==this.element[0]&&(n.remove=function(){this._removeTooltip(this._find(i).tooltip)}),t&&"mouseover"!==t.type||(n.mouseleave="close"),t&&"focusin"!==t.type||(n.focusout="close"),this._on(!0,i,n)},close:function(t){var i,n=this,r=e(t?t.currentTarget:this.element),s=this._find(r);s?(i=s.tooltip,s.closing||(clearInterval(this.delayedShow),r.data("ui-tooltip-title")&&!r.attr("title")&&r.attr("title",r.data("ui-tooltip-title")),this._removeDescribedBy(r),s.hiding=!0,i.stop(!0),this._hide(i,this.options.hide,function(){n._removeTooltip(e(this))}),r.removeData("ui-tooltip-open"),this._off(r,"mouseleave focusout keyup"),r[0]!==this.element[0]&&this._off(r,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete n.parents[t]}),s.closing=!0,this._trigger("close",t,{tooltip:i}),s.hiding||(s.closing=!1))):r.removeData("ui-tooltip-open")},_tooltip:function(t){var i=e("<div>").attr("role","tooltip"),n=e("<div>").appendTo(i),r=i.uniqueId().attr("id");return this._addClass(n,"ui-tooltip-content"),this._addClass(i,"ui-tooltip","ui-widget ui-widget-content"),i.appendTo(this._appendTo(t)),this.tooltips[r]={element:t,tooltip:i}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){clearInterval(this.delayedShow),e.remove(),delete this.tooltips[e.attr("id")]},_appendTo:function(e){var t=e.closest(".ui-front, dialog");return t.length||(t=this.document[0].body),t},_destroy:function(){var t=this;e.each(this.tooltips,function(i,n){var r=e.Event("blur"),s=n.element;r.target=r.currentTarget=s[0],t.close(r,!0),e("#"+i).remove(),s.data("ui-tooltip-title")&&(s.attr("title")||s.attr("title",s.data("ui-tooltip-title")),s.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),!1!==e.uiBackCompat&&e.widget("ui.tooltip",e.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var e=this._superApply(arguments);return this.options.tooltipClass&&e.tooltip.addClass(this.options.tooltipClass),e}}),e.ui.tooltip}),define("skylark-domx-placeholders/placeholders",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-data"],function(e,t,i){const n="placeholder-style";function r(){return r}return t.mixin(r,{saveStyle:function(e){i.data(e,n,e.style.cssText)},restoreStyle:function(e){e.style.cssText=i.data(e,n)||"",i.removeData(e,n)}}),e.attach("domx.placeholders",r)}),define("skylark-domx-placeholders/create",["skylark-domx-styler","skylark-domx-noder","skylark-domx-geom","skylark-domx-data","./placeholders"],function(e,t,i,n,r){return r.create=function(r){var s,o=e.css(r,"position"),a=i.relativePosition(r);e.css(r,e.css(r,["marginTop","marginBottom","marginLeft","marginRight"])),i.size(r,i.size(r)),/^(static|relative)/.test(o)&&(o="absolute",s=t.createElement(r.nodeName),e.css(s,{display:/^(inline|ruby)/.test(e.css(r,"display"))?"inline-block":"block",visibility:"hidden"}),e.css(s,e.css(r,["marginTop","marginBottom","marginLeft","marginRight","float"])),n.data(r,"placeholder",s),i.size(s,i.size(r)),t.after(r,s));return e.css(r,{position:o,left:a.left,top:a.top}),s}}),define("skylark-domx-placeholders/remove",["skylark-domx-noder","skylark-domx-data","./placeholders"],function(e,t,i){return i.remove=function(i){var n=t.data(i,"placeholder");n&&(e.remove(n),t.removeData(i,"placeholder"))}}),define("skylark-domx-placeholders/cleanup",["skylark-domx-styler","skylark-domx-noder","skylark-domx-geom","./placeholders","./remove"],function(e,t,i,n,r){return n.cleanup=function(e){n.restoreStyle(e),r(e)}}),define("skylark-domx-placeholders/main",["./placeholders","./create","./remove","./cleanup"],function(e){return e}),define("skylark-domx-placeholders",["skylark-domx-placeholders/main"],function(e){return e}),define("skylark-jqueryui-effects/effects",["skylark-langx/skylark","skylark-langx/langx","skylark-domx-fx","skylark-domx-styler","skylark-domx-placeholders","skylark-domx-query"],function(e,t,i,n,r,s){var o,a="ui-effects-animated",l={},c=function(){};function h(e,n,r,o){return t.isPlainObject(e)&&(n=e,e=e.effect),e={effect:e},null==n&&(n={}),t.isFunction(n)&&(o=n,r=null,n={}),("number"==typeof n||i.speeds[n])&&(o=r,r=n,n={}),t.isFunction(r)&&(o=r,r=null),n&&t.mixin(e,n),r=r||n.duration,e.duration=i.off?0:"number"==typeof r?r:r in s.fx.speeds?i.speeds[r]:i.speeds._default,e.complete=o||n.complete,e}function u(e){return!(e&&"number"!=typeof e&&!i.speeds[e])||("string"==typeof e&&!l[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}function d(e,t){var i=t.outerWidth(),n=t.outerHeight(),r=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(e)||["",0,i,n,0];return{top:parseFloat(r[1])||0,right:"auto"===r[2]?i:parseFloat(r[2]),bottom:"auto"===r[3]?n:parseFloat(r[3]),left:parseFloat(r[4])||0}}t.mixin(c,{define:function(e,t,i){return i||(i=t,t="effect"),l[e]=i,l[e].mode=t,i},scaledDimensions:function(e,t,i){if(0===t)return{height:0,width:0,outerHeight:0,outerWidth:0};var n="horizontal"!==i?(t||100)/100:1,r="vertical"!==i?(t||100)/100:1;return{height:e.height()*r,width:e.width()*n,outerHeight:e.outerHeight()*r,outerWidth:e.outerWidth()*n}},clipToBox:function(e){return{width:e.clip.right-e.clip.left,height:e.clip.bottom-e.clip.top,left:e.clip.left,top:e.clip.top}},unshift:function(e,t,i){var n=e.queue();t>1&&n.splice.apply(n,[1,0].concat(n.splice(t,i))),e.dequeue()},saveStyle:function(e){r.saveStyle(e[0])},restoreStyle:function(e){r.restoreStyle(e[0])},mode:function(e,t){var i=e.is(":hidden");return"toggle"===t&&(t=i?"show":"hide"),(i?"hide"===t:"show"===t)&&(t="none"),t},getBaseline:function(e,t){var i,n;switch(e[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:i}},createPlaceholder:function(e){var t;return e.length&&(t=r.create(e[0])),t&&n.addClass(t,"ui-effects-placeholder"),t},removePlaceholder:function(e){e.length&&r.remove(e[0])},cleanUp:function(e){e.length&&r.cleanup(e[0])},setTransition:function(e,i,n,r){return r=r||{},t.each(i,function(t,i){var s=e.cssUnit(i);s[0]>0&&(r[i]=s[0]*n+s[1])}),r}}),t.mixin(s.fn,{effect:function(){var e=h.apply(this,arguments),n=l[e.effect],r=n.mode,o=(e.queue,e.complete),u=e.mode,d=[];if(i.off||!n)return u?this[u](e.duration,o):this.each(function(){o&&o.call(this)});return this.each(function(e){var i=s(this),n=c.mode(i,u)||r;i.data(a,!0),d.push(n),r&&("show"===n||n===r&&"hide"===n)&&i.show();r&&"none"===n||c.saveStyle(i);t.isFunction(e)&&e()}).each(function(i){var l=s(this);function h(){t.isFunction(o)&&o.call(l[0]),t.isFunction(i)&&i()}e.mode=d.shift(),!1===s.uiBackCompat||r?"none"===e.mode?(l[u](),h()):n.call(l[0],e,function(){l.removeData(a),c.cleanUp(l),"hide"===e.mode&&l.hide();h()}):(l.is(":hidden")?"hide"===u:"show"===u)?(l[u](),h()):n.call(l[0],e,h)})},show:(o=s.fn.show,function(e){if(u(e))return o.apply(this,arguments);var t=h.apply(this,arguments);return t.mode="show",this.effect.call(this,t)}),hide:function(e){return function(t){if(u(t))return e.apply(this,arguments);var i=h.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(s.fn.hide),toggle:function(e){return function(t){if(u(t)||"boolean"==typeof t)return e.apply(this,arguments);var i=h.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(s.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],function(e,t){i.indexOf(t)>0&&(n=[parseFloat(i),t])}),n},cssClip:function(e){return e?this.css("clip","rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)"):d(this.css("clip"),this)},transfer:function(e,i){var n=s(this),r=s(e.to),o="fixed"===r.css("position"),a=s("body"),l=o?a.scrollTop():0,c=o?a.scrollLeft():0,h=r.offset(),u={top:h.top-l,left:h.left-c,height:r.innerHeight(),width:r.innerWidth()},d=n.offset(),f=s("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(e.className).css({top:d.top-l,left:d.left-c,height:n.innerHeight(),width:n.innerWidth(),position:o?"fixed":"absolute"}).animate(u,e.duration,e.easing,function(){f.remove(),t.isFunction(i)&&i()})}}),i.step=i.step||{},i.step.clip=function(e){e.clipInit||(e.start=s(e.elem).cssClip(),"string"==typeof e.end&&(e.end=d(e.end,e.elem)),e.clipInit=!0),s(e.elem).cssClip({top:e.pos*(e.end.top-e.start.top)+e.start.top,right:e.pos*(e.end.right-e.start.right)+e.start.right,bottom:e.pos*(e.end.bottom-e.start.bottom)+e.start.bottom,left:e.pos*(e.end.left-e.start.left)+e.start.left})};var f={};return t.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,t){f[t]=function(t){return Math.pow(t,e+2)}}),t.mixin(f,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,i=4;e<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*t-2)/22-e,2)}}),i.easing=i.easing||{},t.each(f,function(e,t){i.easing["easeIn"+e]=t,i.easing["easeOut"+e]=function(e){return 1-t(1-e)},i.easing["easeInOut"+e]=function(e){return e<.5?t(2*e)/2:1-t(-2*e+2)/2}}),e.attach("intg.jquery.effects",c)}),define("skylark-jqueryui/effect",["skylark-jquery","skylark-jqueryui-effects/effects"],function(e,t){return e.effects=t}),define("skylark-jqueryui-effects/plugins/blind",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){return i.define("blind","hide",function(n,r){var s={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},o=t(this),a=n.direction||"up",l=o.cssClip(),c={clip:e.mixin({},l)},h=i.createPlaceholder(o);c.clip[s[a][0]]=c.clip[s[a][1]],"show"===n.mode&&(o.cssClip(c.clip),h&&h.css(i.clipToBox(c)),c.clip=l),h&&h.animate(i.clipToBox(c),n.duration,n.easing),o.animate(c,{queue:!1,duration:n.duration,easing:n.easing,complete:r})})}),define("skylark-jqueryui/effects/effect-blind",["skylark-jqueryui-effects/plugins/blind"],function(e){return e}),define("skylark-jqueryui-effects/plugins/bounce",["skylark-langx/langx","skylark-domx-fx/bounce","../effects"],function(e,t,i){return i.define("bounce",function(e,n){return i.createPlaceholder($(this)),t(this,e,n)})}),define("skylark-jqueryui/effects/effect-bounce",["skylark-jqueryui-effects/plugins/bounce"],function(e){return e}),define("skylark-jqueryui-effects/plugins/clip",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){return i.define("clip","hide",function(e,n){var r,s={},o=t(this),a=e.direction||"vertical",l="both"===a,c=l||"horizontal"===a,h=l||"vertical"===a;r=o.cssClip(),s.clip={top:h?(r.bottom-r.top)/2:r.top,right:c?(r.right-r.left)/2:r.right,bottom:h?(r.bottom-r.top)/2:r.bottom,left:c?(r.right-r.left)/2:r.left},i.createPlaceholder(o),"show"===e.mode&&(o.cssClip(s.clip),s.clip=r),o.animate(s,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})}),define("skylark-jqueryui/effects/effect-clip",["skylark-jqueryui-effects/plugins/clip"],function(e){return e}),define("skylark-jqueryui-effects/plugins/drop",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){return i.define("drop","hide",function(e,n){var r,s=t(this),o=e.mode,a="show"===o,l=e.direction||"left",c="up"===l||"down"===l?"top":"left",h="up"===l||"left"===l?-1:1,u=-1*h,d={opacity:0},f=s.position()[c];i.createPlaceholder(s),r=e.distance||s["top"===c?"outerHeight":"outerWidth"](!0)/2,d[c]=f+h*r,a&&(s.css(d),d[c]=f+u*r,d.opacity=1),s.animate(d,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})}),define("skylark-jqueryui/effects/effect-drop",["skylark-jqueryui-effects/plugins/drop"],function(e){return e}),define("skylark-jqueryui-effects/plugins/explode",["skylark-langx/langx","skylark-domx-query","skylark-domx-fx/explode","../effects"],function(e,t,i,n){return n.define("explode","hide",function(e,t){i(this,e,t)})}),define("skylark-jqueryui/effects/effect-explode",["skylark-jqueryui-effects/plugins/explode"],function(e){return e}),define("skylark-jqueryui-effects/plugins/fade",["skylark-langx/langx","skylark-domx-styler","skylark-domx-query","skylark-domx-fx/fade","../effects"],function(e,t,i,n,r){return r.define("fade","toggle",function(e,i){var r="show"===e.mode;t.css(this,"opacity",r?0:1),n(this,r?1:0,e,i)})}),define("skylark-jqueryui/effects/effect-fade",["skylark-jqueryui-effects/plugins/fade"],function(e){return e}),define("skylark-jqueryui-effects/plugins/fold",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){return i.define("fold","hide",function(n,r){var s=t(this),o=n.mode,a="show"===o,l="hide"===o,c=n.size||15,h=/([0-9]+)%/.exec(c),u=!!n.horizFirst,d=u?["right","bottom"]:["bottom","right"],f=n.duration/2,p=i.createPlaceholder(s),m=s.cssClip(),g={clip:e.mixin({},m)},v={clip:e.mixin({},m)},y=[m[d[0]],m[d[1]]];h&&(c=parseInt(h[1],10)/100*y[l?0:1]),g.clip[d[0]]=c,v.clip[d[0]]=c,v.clip[d[1]]=0,a&&(s.cssClip(v.clip),p&&p.css(i.clipToBox(v)),v.clip=m);var k=e.Deferred,b=[];function x(e,t,i,n){return function(){var r=new k;return e.animate(t,i,n,function(){r.resolve()}),r.promise}}p&&(b.push(x(p,i.clipToBox(g),f,n.easing)),b.push(x(p,i.clipToBox(v),f,n.easing))),b.push(x(s,g,f,n.easing)),b.push(x(s,v,f,n.easing)),b.push(r),b.reduce(function(e,t,i,n){return e.then(t)},k.resolve())})}),define("skylark-jqueryui/effects/effect-fold",["skylark-jqueryui-effects/plugins/fold"],function(e){return e}),define("skylark-jqueryui-effects/plugins/highlight",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){return i.define("highlight","show",function(e,n){var r=t(this),s={backgroundColor:r.css("backgroundColor")};"hide"===e.mode&&(s.opacity=0),i.saveStyle(r),r.css({backgroundImage:"none",backgroundColor:e.color||"#ffff99"}).animate(s,{queue:!1,duration:e.duration,easing:e.easing,complete:n})})}),define("skylark-jqueryui/effects/effect-highlight",["skylark-jqueryui-effects/plugins/highlight"],function(e){return e}),define("skylark-jqueryui-effects/plugins/size",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){return i.define("size",function(e,n){var r,s,o,a=t(this),l=["fontSize"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],h=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],u=e.mode,d="effect"!==u,f=e.scale||"both",p=e.origin||["middle","center"],m=a.css("position"),g=a.position(),v=i.scaledDimensions(a),y=e.from||v,k=e.to||i.scaledDimensions(a,0);i.createPlaceholder(a),"show"===u&&(o=y,y=k,k=o),s={from:{y:y.height/v.height,x:y.width/v.width},to:{y:k.height/v.height,x:k.width/v.width}},"box"!==f&&"both"!==f||(s.from.y!==s.to.y&&(y=i.setTransition(a,c,s.from.y,y),k=i.setTransition(a,c,s.to.y,k)),s.from.x!==s.to.x&&(y=i.setTransition(a,h,s.from.x,y),k=i.setTransition(a,h,s.to.x,k))),"content"!==f&&"both"!==f||s.from.y!==s.to.y&&(y=i.setTransition(a,l,s.from.y,y),k=i.setTransition(a,l,s.to.y,k)),p&&(r=i.getBaseline(p,v),y.top=(v.outerHeight-y.outerHeight)*r.y+g.top,y.left=(v.outerWidth-y.outerWidth)*r.x+g.left,k.top=(v.outerHeight-k.outerHeight)*r.y+g.top,k.left=(v.outerWidth-k.outerWidth)*r.x+g.left),a.css(y),"content"!==f&&"both"!==f||(c=c.concat(["marginTop","marginBottom"]).concat(l),h=h.concat(["marginLeft","marginRight"]),a.find("*[width]").each(function(){var n=t(this),r=i.scaledDimensions(n),o={height:r.height*s.from.y,width:r.width*s.from.x,outerHeight:r.outerHeight*s.from.y,outerWidth:r.outerWidth*s.from.x},a={height:r.height*s.to.y,width:r.width*s.to.x,outerHeight:r.height*s.to.y,outerWidth:r.width*s.to.x};s.from.y!==s.to.y&&(o=i.setTransition(n,c,s.from.y,o),a=i.setTransition(n,c,s.to.y,a)),s.from.x!==s.to.x&&(o=i.setTransition(n,h,s.from.x,o),a=i.setTransition(n,h,s.to.x,a)),d&&i.saveStyle(n),n.css(o),n.animate(a,e.duration,e.easing,function(){d&&i.restoreStyle(n)})})),a.animate(k,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){var e=a.offset();0===k.opacity&&a.css("opacity",y.opacity),d||(a.css("position","static"===m?"relative":m).offset(e),i.saveStyle(a)),n()}})})}),define("skylark-jqueryui-effects/plugins/scale",["skylark-langx/langx","skylark-domx-query","../effects","./size"],function(e,t,i,n){return i.define("scale",function(r,s){var o=t(this),a=r.mode,l=parseInt(r.percent,10)||(0===parseInt(r.percent,10)?0:"effect"!==a?0:100),c=e.mixin({from:i.scaledDimensions(o),to:i.scaledDimensions(o,l,r.direction||"both"),origin:r.origin||["middle","center"]},r);r.fade&&(c.from.opacity=1,c.to.opacity=0),n.call(this,c,s)})}),define("skylark-jqueryui-effects/plugins/puff",["skylark-langx/langx","skylark-domx-query","../effects","./scale"],function(e,t,i,n){return i.define("puff","hide",function(t,i){var r=e.mixin({},t,{fade:!0,percent:parseInt(t.percent,10)||150});n.call(this,r,i)})}),define("skylark-jqueryui/effects/effect-puff",["skylark-jqueryui-effects/plugins/puff"],function(e){return e}),define("skylark-jqueryui-effects/plugins/pulsate",["skylark-langx/langx","skylark-domx-query","skylark-domx-fx/pulsate","../effects"],function(e,t,i,n){return n.define("pulsate","show",function(e,t){i(this,e,t)})}),define("skylark-jqueryui/effects/effect-pulsate",["skylark-jqueryui-effects/plugins/pulsate"],function(e){return e}),define("skylark-jqueryui/effects/effect-scale",["skylark-jqueryui-effects/plugins/scale"],function(e){return e}),define("skylark-jqueryui-effects/plugins/shake",["skylark-langx/langx","skylark-domx-query","skylark-domx-fx/shake","../effects"],function(e,t,i,n){return n.define("shake",function(e,r){n.createPlaceholder(t(this)),i(this,e,r)})}),define("skylark-jqueryui/effects/effect-shake",["skylark-jqueryui-effects/plugins/shake"],function(e){return e}),define("skylark-jqueryui/effects/effect-size",["skylark-jqueryui-effects/plugins/size"],function(e){return e}),define("skylark-jqueryui-effects/plugins/slide",["skylark-langx/langx","skylark-domx-query","skylark-domx-fx/slide","../effects"],function(e,t,i,n){return n.define("slide","show",function(e,t){e.direction||(e.direction="left"),i(this,e,t)})}),define("skylark-jqueryui/effects/effect-slide",["skylark-jqueryui-effects/plugins/slide"],function(e){return e}),define("skylark-jqueryui-effects/plugins/transfer",["skylark-langx/langx","skylark-domx-query","../effects"],function(e,t,i){var n;return!1!==t.uiBackCompat&&(n=i.define("transfer",function(e,i){t(this).transfer(e,i)})),n}),define("skylark-jqueryui/effects/effect-transfer",["skylark-jqueryui-effects/plugins/transfer"],function(e){return e}),define("skylark-jqueryui/main",["skylark-jquery","./data","./disable-selection","./focusable","./form","./ie","./keycode","./labels","./jquery-1-7","./plugin","./safe-active-element","./safe-blur","./scroll-parent","./tabbable","./unique-id","./version","./widgets/accordion","./widgets/autocomplete","./widgets/button","./widgets/checkboxradio","./widgets/controlgroup","./widgets/datepicker","./widgets/dialog","./widgets/draggable","./widgets/droppable","./widgets/menu","./widgets/mouse","./widgets/progressbar","./widgets/resizable","./widgets/selectable","./widgets/selectmenu","./widgets/slider","./widgets/sortable","./widgets/spinner","./widgets/tabs","./widgets/tooltip","./effect","./effects/effect-blind","./effects/effect-bounce","./effects/effect-clip","./effects/effect-drop","./effects/effect-explode","./effects/effect-fade","./effects/effect-fold","./effects/effect-highlight","./effects/effect-puff","./effects/effect-pulsate","./effects/effect-scale","./effects/effect-shake","./effects/effect-size","./effects/effect-slide","./effects/effect-transfer"],function(e){return e}),define("skylark-jqueryui",["skylark-jqueryui/main"],function(e){return e}),define("slax-skydoku/main",["skylark-slax-runtime","skylark-bootstrap3/loadedInit","skylark-appify-shells","skylark-widgets-coder","skylark-widgets-textpad","skylark-jqueryui"],function(e,t){return t(),e}),define("slax-skydoku",["slax-skydoku/main"],function(e){return e})}(define,require),!isAmd){var skylarkjs=require("skylark-langx-ns");isCmd?module.exports=skylarkjs:globals.skylarkjs=skylarkjs}}(0,this);
//# sourceMappingURL=sourcemaps/slax-skydoku-all.js.map
