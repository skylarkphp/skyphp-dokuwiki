/**
 * skylark-ace - A version of ace v1.4.3 that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(function(e,t,n){"use strict";var r=e("../../lib/oop"),a=e("./fold_mode").FoldMode,o=e("../../range").Range,i=e("../../token_iterator").TokenIterator,s={"\\subparagraph":1,"\\paragraph":2,"\\subsubsubsection":3,"\\subsubsection":4,"\\subsection":5,"\\section":6,"\\chapter":7,"\\part":8,"\\begin":9,"\\end":10},g=t.FoldMode=function(){};r.inherits(g,a),function(){this.foldingStartMarker=/^\s*\\(begin)|\s*\\(part|chapter|(?:sub)*(?:section|paragraph))\b|{\s*$/,this.foldingStopMarker=/^\s*\\(end)\b|^\s*}/,this.getFoldWidgetRange=function(e,t,n){var r,a=e.doc.getLine(n);return(r=this.foldingStartMarker.exec(a))?r[1]?this.latexBlock(e,n,r[0].length-1):r[2]?this.latexSection(e,n,r[0].length-1):this.openingBracketBlock(e,"{",n,r.index):(r=this.foldingStopMarker.exec(a))?r[1]?this.latexBlock(e,n,r[0].length-1):this.closingBracketBlock(e,"}",n,r.index+r[0].length):void 0},this.latexBlock=function(e,t,n,r){var a={"\\begin":1,"\\end":-1},s=new i(e,t,n),g=s.getCurrentToken();if(g&&("storage.type"==g.type||"constant.character.escape"==g.type)){var c=a[g.value],l=function(){var e="lparen"==s.stepForward().type?s.stepForward().value:"";return-1===c&&(s.stepBackward(),e&&s.stepBackward()),e},p=[l()],u=-1===c?s.getCurrentTokenColumn():e.getLine(t).length,h=t;for(s.step=-1===c?s.stepBackward:s.stepForward;g=s.step();)if(g&&("storage.type"==g.type||"constant.character.escape"==g.type)){var f=a[g.value];if(f){var d=l();if(f===c)p.unshift(d);else if(p.shift()!==d||!p.length)break}}if(!p.length){if(1==c&&(s.stepBackward(),s.stepBackward()),r)return s.getCurrentTokenRange();t=s.getCurrentTokenRow();return-1===c?new o(t,e.getLine(t).length,h,u):new o(h,u,t,s.getCurrentTokenColumn())}}},this.latexSection=function(e,t,n){var r=new i(e,t,n),a=r.getCurrentToken();if(a&&"storage.type"==a.type){for(var g=s[a.value]||0,c=0,l=t;a=r.stepForward();)if("storage.type"===a.type){var p=s[a.value]||0;if(p>=9){if(c||(l=r.getCurrentTokenRow()-1),(c+=9==p?1:-1)<0)break}else if(p>=g)break}for(c||(l=r.getCurrentTokenRow()-1);l>t&&!/\S/.test(e.getLine(l));)l--;return new o(t,e.getLine(t).length,l,e.getLine(l).length)}}}.call(g.prototype)});
//# sourceMappingURL=../../sourcemaps/mode/folding/latex.js.map
