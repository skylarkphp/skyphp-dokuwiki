{"version":3,"sources":["mouse/fold_handler.js"],"names":["define","require","exports","module","dom","FoldHandler","editor","on","e","position","getDocumentPosition","session","fold","getFoldAt","row","column","getAccelKey","removeFold","expandFold","stop","target","domEvent","hasCssClass","setOption","renderer","scrollCursorIntoView","$gutterLayer","getRegion","foldWidgets","onFoldWidgetClick","isFocused","focus","data","getParentFoldRangeData","range","firstRange","start","getLine","length","addFold"],"mappings":";;;;;;;AA8BAA,OAAO,SAASC,EAASC,EAASC,GAClC,aACA,IAAIC,EAAMH,EAAQ,cAmElBC,EAAQG,YAjER,SAAqBC,GAEjBA,EAAOC,GAAG,QAAS,SAASC,GACxB,IAAIC,EAAWD,EAAEE,sBACbC,EAAUL,EAAOK,QAGjBC,EAAOD,EAAQE,UAAUJ,EAASK,IAAKL,EAASM,OAAQ,GACxDH,IACIJ,EAAEQ,cACFL,EAAQM,WAAWL,GAEnBD,EAAQO,WAAWN,GAEvBJ,EAAEW,QAGN,IAAIC,EAASZ,EAAEa,UAAYb,EAAEa,SAASD,OAClCA,GAAUhB,EAAIkB,YAAYF,EAAQ,sBAC9BhB,EAAIkB,YAAYF,EAAQ,qBACxBT,EAAQY,UAAU,QAAQ,GAC1BjB,EAAOkB,SAASC,0BAK5BnB,EAAOC,GAAG,cAAe,SAASC,GAG9B,GAAoB,eAFDF,EAAOkB,SAASE,aAAaC,UAAUnB,GAEvB,CAC/B,IAAIM,EAAMN,EAAEE,sBAAsBI,IAC9BH,EAAUL,EAAOK,QACjBA,EAAQiB,aAAejB,EAAQiB,YAAYd,IAC3CR,EAAOK,QAAQkB,kBAAkBf,EAAKN,GACrCF,EAAOwB,aACRxB,EAAOyB,QACXvB,EAAEW,UAIVb,EAAOC,GAAG,iBAAkB,SAASC,GAGjC,GAAoB,eAFDF,EAAOkB,SAASE,aAAaC,UAAUnB,GAEvB,CAC/B,IAAIM,EAAMN,EAAEE,sBAAsBI,IAC9BH,EAAUL,EAAOK,QACjBqB,EAAOrB,EAAQsB,uBAAuBnB,GAAK,GAC3CoB,EAAQF,EAAKE,OAASF,EAAKG,WAE/B,GAAID,EAAO,CACPpB,EAAMoB,EAAME,MAAMtB,IAClB,IAAIF,EAAOD,EAAQE,UAAUC,EAAKH,EAAQ0B,QAAQvB,GAAKwB,OAAQ,GAE3D1B,EACAD,EAAQM,WAAWL,IAEnBD,EAAQ4B,QAAQ,MAAOL,GACvB5B,EAAOkB,SAASC,sBAAsBX,IAAKoB,EAAME,MAAMtB,IAAKC,OAAQ,KAG5EP,EAAEW","file":"../../mouse/fold_handler.js","sourcesContent":["/* ***** BEGIN LICENSE BLOCK *****\r\n * Distributed under the BSD license:\r\n *\r\n * Copyright (c) 2010, Ajax.org B.V.\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *     * Redistributions of source code must retain the above copyright\r\n *       notice, this list of conditions and the following disclaimer.\r\n *     * Redistributions in binary form must reproduce the above copyright\r\n *       notice, this list of conditions and the following disclaimer in the\r\n *       documentation and/or other materials provided with the distribution.\r\n *     * Neither the name of Ajax.org B.V. nor the\r\n *       names of its contributors may be used to endorse or promote products\r\n *       derived from this software without specific prior written permission.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\r\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\r\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\r\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\r\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\r\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\r\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\r\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\r\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\r\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n * ***** END LICENSE BLOCK ***** */\r\n\r\ndefine(function(require, exports, module) {\r\n\"use strict\";\r\nvar dom = require(\"../lib/dom\");\r\n\r\nfunction FoldHandler(editor) {\r\n\r\n    editor.on(\"click\", function(e) {\r\n        var position = e.getDocumentPosition();\r\n        var session = editor.session;\r\n\r\n        // If the user clicked on a fold, then expand it.\r\n        var fold = session.getFoldAt(position.row, position.column, 1);\r\n        if (fold) {\r\n            if (e.getAccelKey())\r\n                session.removeFold(fold);\r\n            else\r\n                session.expandFold(fold);\r\n\r\n            e.stop();\r\n        }\r\n        \r\n        var target = e.domEvent && e.domEvent.target;\r\n        if (target && dom.hasCssClass(target, \"ace_inline_button\")) {\r\n            if (dom.hasCssClass(target, \"ace_toggle_wrap\")) {\r\n                session.setOption(\"wrap\", true);\r\n                editor.renderer.scrollCursorIntoView();\r\n            }\r\n        }\r\n    });\r\n\r\n    editor.on(\"gutterclick\", function(e) {\r\n        var gutterRegion = editor.renderer.$gutterLayer.getRegion(e);\r\n\r\n        if (gutterRegion == \"foldWidgets\") {\r\n            var row = e.getDocumentPosition().row;\r\n            var session = editor.session;\r\n            if (session.foldWidgets && session.foldWidgets[row])\r\n                editor.session.onFoldWidgetClick(row, e);\r\n            if (!editor.isFocused())\r\n                editor.focus();\r\n            e.stop();\r\n        }\r\n    });\r\n\r\n    editor.on(\"gutterdblclick\", function(e) {\r\n        var gutterRegion = editor.renderer.$gutterLayer.getRegion(e);\r\n\r\n        if (gutterRegion == \"foldWidgets\") {\r\n            var row = e.getDocumentPosition().row;\r\n            var session = editor.session;\r\n            var data = session.getParentFoldRangeData(row, true);\r\n            var range = data.range || data.firstRange;\r\n\r\n            if (range) {\r\n                row = range.start.row;\r\n                var fold = session.getFoldAt(row, session.getLine(row).length, 1);\r\n\r\n                if (fold) {\r\n                    session.removeFold(fold);\r\n                } else {\r\n                    session.addFold(\"...\", range);\r\n                    editor.renderer.scrollCursorIntoView({row: range.start.row, column: 0});\r\n                }\r\n            }\r\n            e.stop();\r\n        }\r\n    });\r\n}\r\n\r\nexports.FoldHandler = FoldHandler;\r\n\r\n});\r\n"]}