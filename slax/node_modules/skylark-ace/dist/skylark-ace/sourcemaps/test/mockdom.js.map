{"version":3,"sources":["test/mockdom.js"],"names":["define","require","exports","module","Style","prototype","__defineGetter__","cssText","Object","keys","this","forEach","key","__defineSetter__","value","split","parts","length","trim","initializers","textarea","setSelectionRange","start","end","selectionStart","Math","min","selectionEnd","Node","name","localName","tagName","toUpperCase","children","childNodes","ownerDocument","window","document","$attributes","style","hasOwnProperty","call","Event","type","walk","node","fn","ch","i","result","TextNode","data","removeAllChildren","parentNode","contains","activeElement","body","cloneNode","recursive","clone","setAttribute","appendChild","insertBefore","removeChild","indexOf","Error","splice","remove","replaceChild","oldNode","before","slice","j","querySelectorAll","s","nodes","push","querySelector","getElementsByTagName","getElementById","getAttribute","a","v","String","map","class","outerHTML","join","attributes","attr","JSON","stringify","innerHTML","m","root","tagRe","skipped","lastIndex","exec","substring","index","createTextNode","createElement","replace","_","v1","v2","v3","getBoundingClientRect","w","h","top","left","documentElement","width","textContent","parseFloat","height","right","rect","scrollHeight","addEventListener","listener","capturing","console","trace","_events","removeEventListener","createEvent","dispatchEvent","e","target","timeStamp","Date","now","currentTarget","events","stopped","bubbles","focus","blur","initMouseEvent","_1","_2","detail","x","y","_x","_y","ctrl","alt","shift","meta","button","relatedTarget","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","preventDefault","defaultPrevented","stopPropagation","navigator","createElementNS","ns","t","createDocumentFragment","hasFocus","head","defaultView","setTimeout","clearTimeout","getComputedStyle","Element","CustomEvent","requestAnimationFrame","callback","addedProperties","load","global","loadInBrowser","ResizeObserver","val","createElementOrig","n","bind","defineProperty","enumerable","configurable","unload","_cache","__filename"],"mappings":"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","file":"../../test/mockdom.js","sourcesContent":["define(function(require, exports, module) {\r\n\"use strict\";\r\n\r\nvar CHAR_HEIGHT = 10;\r\nvar CHAR_WIDTH = 6;\r\nvar WINDOW_HEIGHT = 768;\r\nvar WINDOW_WIDTH = 1024;\r\n\r\nfunction Style() {\r\n    \r\n}\r\nStyle.prototype.__defineGetter__(\"cssText\", function() {\r\n    var cssText = \"\";\r\n    Object.keys(this).forEach(function(key) {\r\n        if (this[key])\r\n            cssText += (cssText ? \" \" : \"\") +  key + \": \" + this[key] + \";\";\r\n    }, this);\r\n    return cssText;\r\n});\r\nStyle.prototype.__defineSetter__(\"cssText\", function(value) {\r\n    Object.keys(this).forEach(function(key) {\r\n        delete this[key];\r\n    }, this);\r\n    value.split(\";\").forEach(function(key) {\r\n        var parts = key.split(\":\");\r\n        if (parts.length == 2)\r\n            this[parts[0].trim()] = parts[1].trim();\r\n    }, this);\r\n});\r\n\r\n\r\nvar initializers = {\r\n    textarea: function() {\r\n        this.setSelectionRange = function(start, end) {\r\n            this.selectionStart = Math.min(start, this.value.length, end);\r\n            this.selectionEnd = Math.min(end, this.value.length);\r\n        };\r\n        this.value = \"\";\r\n    }\r\n};\r\n\r\nfunction Node(name) {\r\n    this.localName = name;\r\n    this.value = \"\";\r\n    this.tagName = name && name.toUpperCase();\r\n    this.children = this.childNodes = [];\r\n    this.ownerDocument = window.document || this;\r\n    this.$attributes = {};\r\n    this.style = new Style();\r\n    if (initializers.hasOwnProperty(name))\r\n        initializers[name].call(this);\r\n}\r\n(function() {\r\n    this.cloneNode = function(recursive) {\r\n        var clone = new Node(this.localName);\r\n        for (var i in this.$attributes) {\r\n            clone.setAttribute(i, this.$attributes[i]);\r\n        }\r\n        if (recursive) {\r\n            this.children.forEach(function(ch) {\r\n                clone.appendChild(ch.cloneNode(true));\r\n            }, this);\r\n        }\r\n        return clone;\r\n    };\r\n    this.appendChild = function(node) {\r\n        return this.insertBefore(node, null);\r\n    };\r\n    this.removeChild = function(node) {\r\n        var i = this.children.indexOf(node);\r\n        if (i == -1)\r\n            throw new Error(\"not a child\");\r\n        node.parentNode = null;\r\n        this.children.splice(i, 1);\r\n        if (!document.contains(document.activeElement))\r\n            document.activeElement = document.body;\r\n    };\r\n    this.remove = function() { \r\n        this.parentNode && this.parentNode.removeChild(this); \r\n    };\r\n    this.replaceChild = function(node, oldNode) {\r\n        this.insertBefore(node, oldNode);\r\n        this.removeChild(oldNode);\r\n        return oldNode;\r\n    };\r\n    this.insertBefore = function(node, before) {\r\n        if (node.parentNode)\r\n            node.parentNode.removeChild(node);\r\n        var i = this.children.indexOf(before);\r\n        if (i == -1) i = this.children.length + 1;\r\n        if (node.localName == \"#fragment\") {\r\n            var children = node.children.slice();\r\n            for (var j = 0; j < children.length; j++)\r\n                this.insertBefore(children[j], before);\r\n        }\r\n        else {\r\n            this.children.splice(i - 1, 0, node);\r\n            node.parentNode = this;\r\n        }\r\n        \r\n        return node;\r\n    };\r\n    this.querySelectorAll = function(s) {\r\n        var nodes = [];\r\n        walk(this, function(node) {\r\n            if (node.localName == s)\r\n                nodes.push(node);\r\n        });\r\n        return nodes;\r\n    };\r\n    this.querySelector = function(s) {\r\n        return this.querySelectorAll(s)[0];\r\n    };\r\n    this.getElementsByTagName = function(s) {\r\n        var nodes = [];\r\n        walk(this, function(node) {\r\n            if (node.localName == s)\r\n                nodes.push(node);\r\n        });\r\n        return nodes;\r\n    };\r\n    this.getElementById = function(s) {\r\n        return walk(this, function(node) {\r\n            // console.log(node.getAttribute && node.getAttribute(\"id\"))\r\n            if (node.getAttribute && node.getAttribute(\"id\") == s)\r\n                return node;\r\n        });\r\n    };\r\n    this.setAttribute = function(a, v) {\r\n        this.$attributes[a] = v;\r\n    };\r\n    this.getAttribute = function(a, v) {\r\n        return String(this.$attributes[a]);\r\n    };\r\n    this.__defineGetter__(\"attributes\", function() {\r\n        var style = this.style.cssText;\r\n        if (style)\r\n            this.$attributes.style = style;\r\n        return Object.keys(this.$attributes).map(function(key) {\r\n            return {name: key, value: this.$attributes[key]};\r\n        }, this);\r\n    });\r\n    this.__defineGetter__(\"className\", function() {\r\n        return this.$attributes.class || \"\";\r\n    });\r\n    this.__defineSetter__(\"className\", function(v) {\r\n        this.$attributes.class = v;\r\n    });\r\n    this.__defineGetter__(\"textContent\", function() {\r\n        var v = \"\";\r\n        walk(this, function(node) {\r\n            if (node instanceof TextNode)\r\n                v += node.data;\r\n        });\r\n        return v;\r\n    });\r\n    this.__defineSetter__(\"textContent\", function(v) {\r\n        removeAllChildren(this);\r\n        this.appendChild(new TextNode(v));\r\n    });\r\n    this.__defineGetter__(\"id\", function() {\r\n        return this.getAttribute(\"id\");\r\n    });\r\n    this.__defineSetter__(\"id\", function(v) {\r\n        this.setAttribute(\"id\", v);\r\n    });\r\n    this.__defineGetter__(\"parentElement\", function() {\r\n        return this.parentNode == document ? null : this.parentNode;\r\n    });\r\n    this.__defineGetter__(\"innerHTML\", function() {\r\n        return this.children.map(function(ch) {\r\n            return \"outerHTML\" in ch ? ch.outerHTML : ch.data;\r\n        }).join(\"\");\r\n    });\r\n    this.__defineGetter__(\"outerHTML\", function() {\r\n        var attributes = this.attributes.map(function(attr) { \r\n            return attr.name + \"=\" + JSON.stringify(attr.value);\r\n        }, this).join(\" \");\r\n        return \"<\" + this.localName + (attributes ? \" \" + attributes : \"\") + \">\" + this.innerHTML + \"</\" + this.localName + \">\";\r\n    });\r\n    this.__defineSetter__(\"innerHTML\", function(v) {\r\n        removeAllChildren(this);\r\n\r\n        var root = this;\r\n        var tagRe = /<(\\/?\\w+)|&(?:(#?\\w+);)|$/g;\r\n        var skipped = \"\";\r\n\r\n        for (var m, lastIndex = 0; m = tagRe.exec(v);) { \r\n            skipped += v.substring(lastIndex, m.index);\r\n            if (m[2]) {\r\n                if (m[2] == \"gt\") {\r\n                    skipped += \">\";\r\n                } else if (m[2] == \"lt\") {\r\n                    skipped += \"<\";\r\n                } else if (m[2] == \"amp\") {\r\n                    skipped += \"&\";\r\n                }\r\n                lastIndex = tagRe.lastIndex ;\r\n            } else {\r\n                if (skipped) {\r\n                    root.appendChild(document.createTextNode(skipped));\r\n                    skipped = \"\";\r\n                }\r\n                var end = v.indexOf(\">\", tagRe.lastIndex);\r\n                var attributes = v.slice(tagRe.lastIndex, end).trim();\r\n                \r\n                tagRe.lastIndex = lastIndex = end < 0 ? v.length : end + 1;\r\n            \r\n                if (!m[1]) {\r\n                    return;\r\n                }\r\n                if (m[1][0] == \"/\") {\r\n                    if (root != this)\r\n                        root = root.parentNode;\r\n                } else {\r\n                    var tagName = m[1];\r\n                    root = root.appendChild(document.createElement(tagName));\r\n                    attributes && attributes.replace(/([\\w:-]+)\\s*=\\s*(?:\"([^\"]*)\"|'([^\"]*)'|(\\w+))/, function(_, key, v1,v2,v3) {\r\n                        root.setAttribute(key, v1 || v2 || v3 || key);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    });\r\n    this.getBoundingClientRect = function(v) {\r\n        var w = 0;\r\n        var h = 0;\r\n        var top = 0;\r\n        var left = 0;\r\n        if (this == document.documentElement) {\r\n            w = WINDOW_WIDTH;\r\n            h = WINDOW_HEIGHT;\r\n        }\r\n        else if (!document.contains(this)) {\r\n            w = h = 0;\r\n        }\r\n        else if (this.style.width == \"auto\" || this.localName == \"span\") {\r\n            w = this.textContent.length * CHAR_WIDTH;\r\n            h = CHAR_HEIGHT;\r\n        }\r\n        else if (this.style.width)  {\r\n            w = parseFloat(this.style.width) || 0;\r\n            h = parseFloat(this.style.height) || 0;\r\n            top = parseFloat(this.style.top) || 0;\r\n            left = parseFloat(this.style.left) || 0;\r\n        }\r\n        else if (this.style.right)  {\r\n            var rect = this.parentNode.getBoundingClientRect();\r\n            w = rect.width - (parseFloat(this.style.left) || 0) - (parseFloat(this.style.right) || 0);\r\n            h = parseFloat(this.style.height) || rect.height;\r\n            top = rect.top;\r\n            left = rect.left + (parseFloat(this.style.left) || 0);\r\n        }\r\n        else if (this.localName == \"div\") {\r\n            w = WINDOW_WIDTH;\r\n        }\r\n        return {top: top, left: left, width: w, height: h, right: 0};\r\n    };\r\n\r\n    this.__defineGetter__(\"clientHeight\", function() {\r\n        return this.getBoundingClientRect().height;\r\n    });\r\n    this.__defineGetter__(\"clientWidth\", function() {\r\n        return this.getBoundingClientRect().width;\r\n    });\r\n    this.__defineGetter__(\"offsetHeight\", function() {\r\n        return this.getBoundingClientRect().height;\r\n    });\r\n    this.__defineGetter__(\"offsetWidth\", function() {\r\n        return this.getBoundingClientRect().width;\r\n    });\r\n\r\n    this.__defineGetter__(\"lastChild\", function() {\r\n        return this.childNodes[this.childNodes.length - 1];\r\n    });\r\n    this.__defineGetter__(\"firstChild\", function() {\r\n        return this.childNodes[0];\r\n    });\r\n    // TODO this is a waorkaround for scrollHeight usage in virtualRenderer\r\n    this.scrollHeight = 1;\r\n\r\n\r\n    this.addEventListener = function(name, listener, capturing) {\r\n        if (!listener) {\r\n            console.trace();\r\n            throw new Error(\"attempting to add empty listener\");\r\n        }\r\n        if (!this._events) this._events = {};\r\n        if (!this._events[name]) this._events[name] = [];\r\n        var i = this._events[name].indexOf(listener);\r\n        if (i == -1)\r\n            this._events[name][capturing ? \"unshift\" : \"push\"](listener);\r\n    };\r\n    this.removeEventListener = function(name, listener) {\r\n        if (!this._events) return;\r\n        if (!this._events[name]) return;\r\n        var i = this._events[name].indexOf(this._events[name]);\r\n        if (i !== -1)\r\n            this._events[name].splice(i, 1);\r\n    };\r\n    this.createEvent = function(v) {\r\n        return new Event();\r\n    };\r\n    this.dispatchEvent = function(e) {\r\n        if (!e.target) e.target = this;\r\n        if (!e.timeStamp) e.timeStamp = Date.now();\r\n        e.currentTarget = this;\r\n        var events = this._events && this._events[e.type];\r\n        events && events.forEach(function(listener) {\r\n            if (!e.stopped)\r\n                listener.call(this, e);\r\n        }, this);\r\n        if (!e.bubbles) return;\r\n        if (this.parentNode)\r\n            this.parentNode.dispatchEvent(e);\r\n        else if (this != window)\r\n            window.dispatchEvent(e);\r\n    };\r\n    this.contains = function(node) {\r\n        while (node) {\r\n            if (node == this) return true;\r\n            node = node.parentNode;\r\n        }\r\n    };\r\n    this.focus = function() {\r\n        if (document.activeElement == this)\r\n            return;\r\n        if (document.activeElement)\r\n            document.activeElement.dispatchEvent({type: \"blur\"});\r\n        document.activeElement = this;\r\n        this.dispatchEvent({type: \"focus\"});\r\n    };\r\n    this.blur = function() {\r\n        document.body.focus();\r\n    };\r\n    \r\n    function removeAllChildren(node) {\r\n        node.children.forEach(function(node) {\r\n            node.parentNode = null;\r\n        });\r\n        node.children.length = 0;\r\n        if (!document.contains(document.activeElement))\r\n            document.activeElement = document.body;\r\n    }\r\n}).call(Node.prototype);\r\n\r\n\r\nfunction Event(type) {\r\n    this.type = type;\r\n}\r\n(function() {\r\n    this.initMouseEvent = function(\r\n        type, _1, _2, window,\r\n        detail, x, y, _x, _y,\r\n        ctrl, alt, shift, meta,\r\n        button, relatedTarget\r\n    ) {\r\n        this.bubbles = true;\r\n        this.type = type;\r\n        this.detail = detail || 0;\r\n        this.clientX = x;\r\n        this.clientY = y;\r\n        this.button = button;\r\n        this.relatedTarget = relatedTarget;\r\n        this.ctrlKey = ctrl;\r\n        this.altKey = alt;\r\n        this.shiftKey = shift;\r\n        this.metaKey = meta;\r\n    };\r\n    this.preventDefault = function() {\r\n        this.defaultPrevented = true;\r\n    };\r\n    this.stopPropagation = function() {\r\n        this.stopped = true;\r\n    };\r\n}).call(Event.prototype);\r\n\r\nfunction walk(node, fn) {\r\n    var ch = node.children || [];\r\n    for (var i = 0; i < ch.length; i++) {\r\n        var result = fn(ch[i]) || walk(ch[i], fn);\r\n        if (result)\r\n            return result;\r\n    }\r\n}\r\n\r\nfunction TextNode(value) {\r\n    this.data = value || \"\";\r\n}\r\nTextNode.prototype.cloneNode = function() {\r\n    return new TextNode(this.data);\r\n};\r\n\r\n\r\nvar window = {};\r\nvar document = new Node();\r\n\r\ndocument.navigator = {};\r\ndocument.createElementNS = function(ns, t) {\r\n    return new Node(t);\r\n};\r\ndocument.createElement = function(t) {\r\n    return new Node(t);\r\n};\r\ndocument.createTextNode = function(v) {\r\n    return new TextNode(v);\r\n};\r\ndocument.createDocumentFragment = function() {\r\n    return new Node(\"#fragment\");\r\n};\r\ndocument.hasFocus = function() {\r\n    return true;\r\n};\r\ndocument.documentElement = document.appendChild(new Node(\"html\"));\r\ndocument.body = new Node(\"body\");\r\ndocument.head = new Node(\"head\");\r\ndocument.documentElement.appendChild(document.head);\r\ndocument.documentElement.appendChild(document.body);\r\n\r\nwindow.document = document;\r\nwindow.document.defaultView = window;\r\n\r\nwindow.setTimeout = setTimeout;\r\nwindow.clearTimeout = clearTimeout;\r\nwindow.getComputedStyle = function(node) {\r\n    return node.style;\r\n};\r\nwindow.addEventListener = document.addEventListener;\r\nwindow.removeEventListener = document.removeEventListener;\r\nwindow.dispatchEvent = document.dispatchEvent;\r\nwindow.name = \"nodejs\";\r\nwindow.focus = function() {};\r\n\r\nwindow.Node = window.Element = Node;\r\nwindow.window = window;\r\nwindow.CustomEvent = window.Event = Event;\r\nwindow.requestAnimationFrame = function(callback) {\r\n    return setTimeout(function() {\r\n        callback();\r\n    });\r\n};\r\n\r\n\r\nvar addedProperties = [];\r\nexports.load = function() {\r\n    if (typeof global == \"undefined\") return;\r\n    Object.keys(window).forEach(function(i) {\r\n        if (!global[i]) { \r\n            addedProperties.push(i);\r\n            global[i] = window[i];\r\n        }\r\n    });\r\n};\r\n\r\nexports.loadInBrowser = function(global) {\r\n    delete global.ResizeObserver;\r\n    Object.keys(window).forEach(function(i) {\r\n        if (i != \"document\" && i != \"window\") {\r\n            delete global[i];\r\n            global[i] = window[i];\r\n        }\r\n    });\r\n    for (var i in window.document) {\r\n        var val = window.document[i];\r\n        if (typeof val == \"function\") {\r\n            if (i == \"createElement\") {\r\n                global.document.createElementOrig = global.document.createElement;\r\n                val = function(n) {\r\n                    if (n == \"script\")\r\n                        return global.document.createElementOrig(n);\r\n                    return window.document.createElement(n);\r\n                };\r\n            }\r\n            val = val.bind(window.document);\r\n        }\r\n        Object.defineProperty(\r\n            global.document, \r\n            i, \r\n            {\r\n                value: val,\r\n                enumerable: true,\r\n                configurable: true\r\n            }\r\n        );\r\n    }\r\n};\r\n\r\nexports.unload = function() {\r\n    if (typeof global == \"undefined\") return;\r\n    var req = require;\r\n    var cache = req(\"module\")._cache;\r\n    delete cache[__filename];\r\n    addedProperties.forEach(function(i) {\r\n        delete global[i];\r\n    });\r\n};\r\n\r\nexports.load();\r\n\r\n});\r\n"]}