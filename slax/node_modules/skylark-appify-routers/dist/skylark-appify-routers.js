/**
 * skylark-appify-routers - An Elegant HTML5 Routing Framework.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.6
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,e){var r=e.define,require=e.require,n="function"==typeof r&&r.amd,i=!n&&"undefined"!=typeof exports;if(!n&&!r){var a={};r=e.define=function(t,e,r){"function"==typeof r?(a[t]={factory:r,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var r=e.split("/"),n=t.split("/");r.pop();for(var i=0;i<n.length;i++)"."!=n[i]&&(".."==n[i]?r.pop():r.push(n[i]));return r.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):a[t]={factory:null,resolved:!0,exports:r}},require=e.require=function(t){if(!a.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=a[t];if(!module.resolved){var r=[];module.deps.forEach(function(t){r.push(require(t))}),module.exports=module.factory.apply(e,r)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-appify-routers/routers",["skylark-langx/skylark","skylark-langx/langx"],function(t,e){return t.attach("appify.routers",{createEvent:function(t,r){var n=new CustomEvent(t,r);return e.safeMixin(n,r)}})}),t("skylark-appify-routers/route",["skylark-langx/langx","./routers"],function(t,e){var r=e.createEvent,n=t.Evented.inherit({klassName:"Route",init:function(e,r){var n=(r=t.mixin({},r)).pathto||"",i=n,a=i.match(/\:([a-zA-Z0-9_]+)/g);null!==a?(a=a.map(function(t){return t.substring(1)}),i=i.replace(/\:([a-zA-Z0-9_]+)/g,"(.*?)")):a=[],i="*"===i?"(.*)":i.replace("/","\\/"),this._setting=r,this.name=e,this.pathto=n,this.paramNames=a,this.params=i,this.regex=new RegExp("^"+i+"$","");var o=this;["entering","entered","exiting","exited"].forEach(function(e){t.isFunction(r[e])&&o.on(e,r[e])})},enter:function(e,n){if(n){var i=this._entering(e),a=this;return t.Deferred.when(i).then(function(){var t=r("entering",{route:a,result:!0});return a.trigger(t),t.result})}return this._entered(e),this.trigger(r("entered",t.safeMixin({route:this},e))),this},exit:function(e,n){if(n){var i=this._exiting(e);if(!i)return!1;var a=r("exiting",{route:this,result:!0});return this.trigger(a),a.result}return this._exited(e),this.trigger(r("exited",t.safeMixin({route:this},e))),this},match:function(t){var e=this.paramNames,r=t.indexOf("?"),t=~r?t.slice(0,r):decodeURIComponent(t),n=this.regex.exec(t);if(!n)return!1;for(var i={},a=1,o=n.length;a<o;++a){var u=e[a-1],s=decodeURIComponent(n[a]);i[u]=s}return i},path:function(t){var e=this.pathto;return t&&(e=e.replace(/:([a-zA-Z0-9_]+)/g,function(e,r){return t[r]})),e},_entering:function(t){return!0},_entered:function(t){return!0},_exiting:function(t){return!0},_exited:function(t){return!0}});return e.Route=n}),t("skylark-appify-routers/router",["skylark-langx/langx","./routers","./route"],function(t,e,r){var n=e.createEvent;return e.Router=function(){var e,i,a,o,u={},s={},f=new t.Evented,p=this;function h(r){if(e){var a=e.route.exit({path:e.path,params:e.params},!0);if(!a)return}if(i=e,!(e=r).route){var o=l(e.path);e.route=o.route,e.params=o.params}var u=e.route.enter({force:e.force,path:e.path,params:e.params},!0);t.Deferred.when(u).then(function(){f.trigger(n("routing",{current:e,previous:i})),e.route.enter({path:e.path,params:e.params},!1),i&&i.route.exit({path:i.path,params:i.params},!1),f.trigger(n("routed",{current:e,previous:i}))})}function c(t,r){if(!r&&e&&e.path==t)return!1;var i=l(t);if(i)if(i.path=t,p.useHistoryApi){var o={force:r,path:t};window.history.pushState(o,document.title,(a+t).replace("//","/")),window.dispatchEvent(n("popstate",{state:o}))}else if(p.useHashbang){var u="#!"+t;window.location.hash!==u?window.location.hash=u:h(i)}else h(i);return!0}function l(e,r){var n=!1;return!r&&(n=s[e])?n:(t.each(u,function(t,r){var i=r.match(e);return!i||(n={route:r,params:i},!1)}),n&&!r&&(s[e]=n),n)}function d(e){if(!t.isDefined(e))return t.mixin({},u);for(var r in e)u[r]=new p.Route(r,e[r])}t.mixin(p,{Route:r,current:function(){return e},go:c,map:l,hub:function(){return f},off:function(){f.off.apply(f,arguments)},on:function(){f.on.apply(f,arguments)},one:function(){f.one.apply(f,arguments)},path:function(t,e){var r,n=u[t];n&&(r=n.path(e));return r},previous:function(){return i},baseUrl:function(e){return t.isDefined(e)?(a=e,this):a},homePath:function(e){return t.isDefined(e)?(o=e,this):o},route:function(e,r){if(t.isDefined(r)){var n={};return n[e]=r,d(n),this}return u[e]},routes:d,start:function(){null==p.useHashbang&&null==p.useHistoryApi&&(window.location.host&&window.history.pushState?p.useHistoryApi=!0:p.useHashbang=!0);var t="";p.useHistoryApi?(t=window.location.pathname,void 0===a&&(a=t.replace(/\/$/,"")),t=t.replace(a,"")||o||"/"):t=p.useHashbang&&(window.location.hash.replace("#!","")||o)||"/";t.startsWith("/")||(t="/"+t);p.useHistoryApi?window.addEventListener("popstate",function(t){t.state&&h(t.state),t.preventDefault()}):p.useHashbang&&window.addEventListener("hashchange",function(t){h({path:window.location.hash.replace(/^#!/,"")}),t.preventDefault()});c(t)},trigger:function(t){return f.trigger(t),this},useHistoryApi:null,useHashbang:null})}}),t("skylark-appify-routers/main",["./routers","./router","./route"],function(t){return t}),t("skylark-appify-routers",["skylark-appify-routers/main"],function(t){return t})}(r),!n){var o=require("skylark-langx-ns");i?module.exports=o:e.skylarkjs=o}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-appify-routers.js.map
