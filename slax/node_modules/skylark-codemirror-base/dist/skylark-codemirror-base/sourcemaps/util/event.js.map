{"version":3,"sources":["util/event.js"],"names":["define","a","b","noHandlers","on","emitter","type","f","addEventListener","attachEvent","map","_handlers","concat","getHandlers","off","removeEventListener","detachEvent","arr","index","indexOf","slice","signal","handlers","length","args","Array","prototype","call","arguments","i","apply","e_preventDefault","e","preventDefault","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_defaultPrevented","defaultPrevented","signalDOMEvent","cm","override","this","codemirrorIgnore","signalCursorActivity","cursorActivity","set","curOp","cursorActivityHandlers","push","hasHandler","eventMixin","ctor","e_stop","e_target","target","srcElement","e_button","which","button","mac","ctrlKey"],"mappings":"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","file":"../../util/event.js","sourcesContent":["define([\n    './browser',\n    './misc'\n], function (a, b) {\n    'use strict';\n    const noHandlers = [];\n    let on = function (emitter, type, f) {\n        if (emitter.addEventListener) {\n            emitter.addEventListener(type, f, false);\n        } else if (emitter.attachEvent) {\n            emitter.attachEvent('on' + type, f);\n        } else {\n            let map = emitter._handlers || (emitter._handlers = {});\n            map[type] = (map[type] || noHandlers).concat(f);\n        }\n    };\n    function getHandlers(emitter, type) {\n        return emitter._handlers && emitter._handlers[type] || noHandlers;\n    }\n    function off(emitter, type, f) {\n        if (emitter.removeEventListener) {\n            emitter.removeEventListener(type, f, false);\n        } else if (emitter.detachEvent) {\n            emitter.detachEvent('on' + type, f);\n        } else {\n            let map = emitter._handlers, arr = map && map[type];\n            if (arr) {\n                let index = b.indexOf(arr, f);\n                if (index > -1)\n                    map[type] = arr.slice(0, index).concat(arr.slice(index + 1));\n            }\n        }\n    }\n    function signal(emitter, type) {\n        let handlers = getHandlers(emitter, type);\n        if (!handlers.length)\n            return;\n        let args = Array.prototype.slice.call(arguments, 2);\n        for (let i = 0; i < handlers.length; ++i)\n            handlers[i].apply(null, args);\n    }\n    function signalDOMEvent(cm, e, override) {\n        if (typeof e == 'string')\n            e = {\n                type: e,\n                preventDefault: function () {\n                    this.defaultPrevented = true;\n                }\n            };\n        signal(cm, override || e.type, cm, e);\n        return e_defaultPrevented(e) || e.codemirrorIgnore;\n    }\n    function signalCursorActivity(cm) {\n        let arr = cm._handlers && cm._handlers.cursorActivity;\n        if (!arr)\n            return;\n        let set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n        for (let i = 0; i < arr.length; ++i)\n            if (b.indexOf(set, arr[i]) == -1)\n                set.push(arr[i]);\n    }\n    function hasHandler(emitter, type) {\n        return getHandlers(emitter, type).length > 0;\n    }\n    function eventMixin(ctor) {\n        ctor.prototype.on = function (type, f) {\n            on(this, type, f);\n        };\n        ctor.prototype.off = function (type, f) {\n            off(this, type, f);\n        };\n    }\n    function e_preventDefault(e) {\n        if (e.preventDefault)\n            e.preventDefault();\n        else\n            e.returnValue = false;\n    }\n    function e_stopPropagation(e) {\n        if (e.stopPropagation)\n            e.stopPropagation();\n        else\n            e.cancelBubble = true;\n    }\n    function e_defaultPrevented(e) {\n        return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false;\n    }\n    function e_stop(e) {\n        e_preventDefault(e);\n        e_stopPropagation(e);\n    }\n    function e_target(e) {\n        return e.target || e.srcElement;\n    }\n    function e_button(e) {\n        let b = e.which;\n        if (b == null) {\n            if (e.button & 1)\n                b = 1;\n            else if (e.button & 2)\n                b = 3;\n            else if (e.button & 4)\n                b = 2;\n        }\n        if (a.mac && e.ctrlKey && b == 1)\n            b = 3;\n        return b;\n    }\n    return {\n        on: on,\n        getHandlers: getHandlers,\n        off: off,\n        signal: signal,\n        signalDOMEvent: signalDOMEvent,\n        signalCursorActivity: signalCursorActivity,\n        hasHandler: hasHandler,\n        eventMixin: eventMixin,\n        e_preventDefault: e_preventDefault,\n        e_stopPropagation: e_stopPropagation,\n        e_defaultPrevented: e_defaultPrevented,\n        e_stop: e_stop,\n        e_target: e_target,\n        e_button: e_button\n    };\n});"]}