/**
 * skylark-domx-i18n - The filer features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(r,e){var t=e.define,require=e.require,n="function"==typeof t&&t.amd,a=!n&&"undefined"!=typeof exports;if(!n&&!t){var i={};t=e.define=function(r,e,t){"function"==typeof t?(i[r]={factory:t,deps:e.map(function(e){return function(r,e){if("."!==r[0])return r;var t=e.split("/"),n=r.split("/");t.pop();for(var a=0;a<n.length;a++)"."!=n[a]&&(".."==n[a]?t.pop():t.push(n[a]));return t.join("/")}(e,r)}),resolved:!1,exports:null},require(r)):i[r]={factory:null,resolved:!0,exports:t}},require=e.require=function(r){if(!i.hasOwnProperty(r))throw new Error("Module "+r+" has not been defined");var module=i[r];if(!module.resolved){var t=[];module.deps.forEach(function(r){t.push(require(r))}),module.exports=module.factory.apply(e,t)||null,module.resolved=!0}return module.exports}}if(!t)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(r,require){r("skylark-domx-i18n/i18n",["skylark-langx/skylark","skylark-domx-query","skylark-domx-data","skylark-domx-styler"],function(r){return r.attach("domx.i18n",{escape:function(r){return"string"==typeof r?r.replace(/\[\[/g,"&lsqb;&lsqb;").replace(/\]\]/g,"&rsqb;&rsqb;"):r},unescape:function(r){return"string"==typeof r?r.replace(/&lsqb;|\\\[/g,"[").replace(/&rsqb;|\\\]/g,"]"):r},compile:function(){var r=Array.prototype.slice.call(arguments,0).map(function(r){return String(r).replace(/%/g,"&#37;").replace(/,/g,"&#44;")});return"[["+r.join(", ")+"]]"}})}),r("skylark-domx-i18n/Translator",["skylark-langx/langx","./i18n"],function(r,e){var t=Object.freeze({amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,"OElig;":338,"oelig;":339,"Scaron;":352,"scaron;":353,"Yuml;":376,"fnof;":402,"circ;":710,"tilde;":732,"Alpha;":913,"Beta;":914,"Gamma;":915,"Delta;":916,"Epsilon;":917,"Zeta;":918,"Eta;":919,"Theta;":920,"Iota;":921,"Kappa;":922,"Lambda;":923,"Mu;":924,"Nu;":925,"Xi;":926,"Omicron;":927,"Pi;":928,"Rho;":929,"Sigma;":931,"Tau;":932,"Upsilon;":933,"Phi;":934,"Chi;":935,"Psi;":936,"Omega;":937,"alpha;":945,"beta;":946,"gamma;":947,"delta;":948,"epsilon;":949,"zeta;":950,"eta;":951,"theta;":952,"iota;":953,"kappa;":954,"lambda;":955,"mu;":956,"nu;":957,"xi;":958,"omicron;":959,"pi;":960,"rho;":961,"sigmaf;":962,"sigma;":963,"tau;":964,"upsilon;":965,"phi;":966,"chi;":967,"psi;":968,"omega;":969,"thetasym;":977,"upsih;":978,"piv;":982,"ensp;":8194,"emsp;":8195,"thinsp;":8201,"zwnj;":8204,"zwj;":8205,"lrm;":8206,"rlm;":8207,"ndash;":8211,"mdash;":8212,"lsquo;":8216,"rsquo;":8217,"sbquo;":8218,"ldquo;":8220,"rdquo;":8221,"bdquo;":8222,"dagger;":8224,"Dagger;":8225,"bull;":8226,"hellip;":8230,"permil;":8240,"prime;":8242,"Prime;":8243,"lsaquo;":8249,"rsaquo;":8250,"oline;":8254,"frasl;":8260,"euro;":8364,"image;":8465,"weierp;":8472,"real;":8476,"trade;":8482,"alefsym;":8501,"larr;":8592,"uarr;":8593,"rarr;":8594,"darr;":8595,"harr;":8596,"crarr;":8629,"lArr;":8656,"uArr;":8657,"rArr;":8658,"dArr;":8659,"hArr;":8660,"forall;":8704,"part;":8706,"exist;":8707,"empty;":8709,"nabla;":8711,"isin;":8712,"notin;":8713,"ni;":8715,"prod;":8719,"sum;":8721,"minus;":8722,"lowast;":8727,"radic;":8730,"prop;":8733,"infin;":8734,"ang;":8736,"and;":8743,"or;":8744,"cap;":8745,"cup;":8746,"int;":8747,"there4;":8756,"sim;":8764,"cong;":8773,"asymp;":8776,"ne;":8800,"equiv;":8801,"le;":8804,"ge;":8805,"sub;":8834,"sup;":8835,"nsub;":8836,"sube;":8838,"supe;":8839,"oplus;":8853,"otimes;":8855,"perp;":8869,"sdot;":8901,"lceil;":8968,"rceil;":8969,"lfloor;":8970,"rfloor;":8971,"lang;":9001,"rang;":9002,"loz;":9674,"spades;":9824,"clubs;":9827,"hearts;":9829,"diams;":9830});function n(e){return r.escapeHTML((n=String(e).replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,""),String(n).replace(/&#(\d+);?/g,function(r,e){return String.fromCharCode(e)}).replace(/&#[xX]([A-Fa-f0-9]+);?/g,function(r,e){return String.fromCharCode(parseInt(e,16))}).replace(/&([^;\W]+;?)/g,function(r,e){var n=e.replace(/;$/,""),a=t[e]||e.match(/;$/)&&t[n];return"number"==typeof a?String.fromCharCode(a):"string"==typeof a?a:r})));var n}var a=function(){console.warn.apply(console,arguments)};Object.assign||jQuery.extend;function i(r,e){if(!r)throw new TypeError("Parameter `language` must be a language string. Received "+r+(""===r?"(empty string)":""));this.modules=Object.keys(i.moduleFactories).map(function(e){var t=i.moduleFactories[e];return[e,t(r)]}).reduce(function(r,e){var t=e[0],module=e[1];return r[t]=module,r},{}),this.lang=r,this.translations={},this.load=e}return i.prototype.translate=function(r){var e=new RegExp("[a-zA-Z0-9\\-_.\\/]"),t=new RegExp("[^a-zA-Z0-9\\-_.\\/\\]]"),n=0,a=0,i=r.length,o=[],s=!1;function l(r){for(var e=r.length,t=[],n=0,a=0,i=0;n+2<=e;)"["===r[n]&&"["===r[n+1]?(i+=1,n+=1):"]"===r[n]&&"]"===r[n+1]?(i-=1,n+=1):0===i&&","===r[n]&&"\\"!==r[n-1]&&(t.push(r.slice(a,n).trim()),a=n+=1),n+=1;return t.push(r.slice(a,n+1).trim()),t}for(n=r.indexOf("[[",n);n+2<=i&&-1!==n;){o.push(r.slice(a,n)),a=n+=2,s=!0;for(var u,c,p=0,f=!1,m=!1,d=!1,g=!1;n+2<=i;)if(u=r[n],c=r[n+1],!f&&e.test(u))f=!0,n+=1;else if(f&&!m&&":"===u)m=!0,n+=1;else if(m&&!d&&e.test(u))d=!0,n+=1;else if(d&&!g&&","===u)g=!0,n+=1;else if(f&&m&&d&&g||!t.test(u))if("["===u&&"["===c)p+=1,n+=2;else if("]"===u&&"]"===c){if(0===p){var h=r.slice(a,n),y=l(h),v=y[0],k=y.slice(1),x="";k&&k.length&&(x=this.translate(h)),o.push(this.translateKey(v,k,x)),a=n+=2,s=!1;break}p-=1,n+=2}else n+=1;else{if(n+=1,a-=2,s=!1,!(p>0))break;p-=1}n=r.indexOf("[[",n)}var b=r.slice(a);return s&&(b=this.translate(b)),o.push(b),Promise.all(o).then(function(r){return r.join("")})},i.prototype.translateKey=function(r,e,t){var i=this,o=r.split(":",2),s=o[0],l=o[1];if(i.modules[s])return Promise.resolve(i.modules[s](l,e));if(s&&!l)return a('Missing key in translation token "'+r+'"'),Promise.resolve("[["+s+"]]");var u=this.getTranslation(s,l);return u.then(function(o){if(!o)return a('Missing translation "'+r+'"'),t||l;var s=e.map(function(r){return i.translate(n(r))});return Promise.all(s).then(function(r){var e=o;return r.forEach(function(r,t){var n=r.replace(/%(?=\d)/g,"&#37;").replace(/\\,/g,"&#44;");e=e.replace(new RegExp("%"+(t+1),"g"),n)}),e})})},i.prototype.getTranslation=function(r,e){var t;return r?(this.translations[r]=this.translations[r]||this.load(this.lang,r).catch(function(){return{}}),t=this.translations[r]):(a("[translator] Parameter `namespace` is "+r+(""===r?"(empty string)":"")),t=Promise.resolve({})),e?t.then(function(r){return r&&r[e]}):t},i.prototype.translateInPlace=function(r,e){e=e||["placeholder","title"];var t=function(r){var e=[];return function r(t){if(3===t.nodeType)e.push(t);else for(var n=0,a=t.childNodes,i=a.length;n<i;n+=1)r(a[n])}(r),e}(r),n=t.map(function(r){return r.nodeValue}).join("  ||  "),a=e.reduce(function(e,t){var n=Array.prototype.map.call(r.querySelectorAll("["+t+'*="[["]'),function(r){return[t,r]});return e.concat(n)},[]),i=a.map(function(r){return r[1].getAttribute(r[0])}).join("  ||  ");return Promise.all([this.translate(n),this.translate(i)]).then(function(r){var e=r[0],n=r[1];e&&e.split("  ||  ").forEach(function(r,e){$(t[e]).replaceWith(r)}),n&&n.split("  ||  ").forEach(function(r,e){a[e][1].setAttribute(a[e][0],r)})})},i.getLanguage=function(){return"en-GB"},i.create=function(r){return r||(r=i.getLanguage()),i.cache[r]=i.cache[r]||new i(r),i.cache[r]},i.cache={},i.registerModule=function(r,e){i.moduleFactories[r]=e,Object.keys(i.cache).forEach(function(t){var n=i.cache[t];n.modules[r]=e(n.lang)})},i.moduleFactories={},i.removePatterns=function(r){for(var e,t=r.length,n=0,a=0,i=0,o="";n<t;)"[["===(e=r.slice(n,n+2))?(0===i&&(o+=r.slice(a,n)),i+=1,n+=2):"]]"===e?(n+=2,0===(i-=1)&&(a=n)):n+=1;return o+=r.slice(a,n)},e.Translator=i}),r("skylark-domx-i18n/translate",["./i18n","./Translator"],function(r,e){return r.translate=function(r,t,n){var a=n,i=t;"function"==typeof t&&(a=t,i=null);if(!("string"==typeof r||r instanceof String)||""===r)return a("");return e.create(i).translate(r).then(function(r){return a&&setTimeout(a,0,r),r},function(r){console.warn("Translation failed: "+r.stack)})}}),r("skylark-domx-i18n/prepareDom",["skylark-domx-query","./i18n","./translate"],function(r,e,t){return e.prepareDOM=function(){t("[[language:dir]]",function(e){e&&!r("html").attr("data-dir")&&r("html").css("direction",e).attr("data-dir",e)})}}),r("skylark-domx-i18n/addTranslation",["skylark-domx-query","./i18n","./Translator"],function(r,e,t){return e.addTranslation=function(r,e,n){t.create(r).getTranslation(e).then(function(r){assign(r,n)})}}),r("skylark-domx-i18n/getTranslations",["skylark-domx-query","./i18n","./Translator"],function(r,e,t){return e.getTranslations=function(r,e,n){n=n||function(){},t.create(r).getTranslation(e).then(n)}}),r("skylark-domx-i18n/main",["./i18n","./Translator","./prepareDom","./translate","./addTranslation","./getTranslations"],function(r){return r}),r("skylark-domx-i18n",["skylark-domx-i18n/main"],function(r){return r})}(t),!n){var o=require("skylark-langx/skylark");a?module.exports=o:e.skylarkjs=o}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-i18n.js.map
