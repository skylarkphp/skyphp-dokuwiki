{"version":3,"sources":["loaded.js"],"names":["define","finder","images","watch","loaded","elm","options","imgs","addBackgroundImage","elm1","matches","exec","styler","css","url","img","Image","src","push","nodeName","childImgs","findAll","i","length","background","children"],"mappings":";;;;;;;AAAAA,QACC,sBACA,WACA,WACC,SAASC,EAAOC,EAAOC,GA4CvB,OAAOD,EAAOE,OA1Cd,SAAgBC,EAAIC,GAClB,IAAIC,KAIJ,SAASC,EAAoBC,GAE3B,IACIC,EADQ,0BACQC,KAAMC,OAAOC,IAAIJ,EAAK,qBACtCK,EAAMJ,GAAWA,EAAQ,GAC7B,GAAKI,EAAM,CACT,IAAIC,EAAM,IAAIC,MACdD,EAAIE,IAAMH,EACVP,EAAKW,KAAKH,IAKd,GAfAT,EAAUA,MAeW,OAAhBD,EAAIc,SACPZ,EAAKW,KAAMb,OACN,CAIL,IAFA,IAAIe,EAAYnB,EAAOoB,QAAQhB,EAAI,OAEzBiB,EAAE,EAAGA,EAAIF,EAAUG,OAAQD,IACnCf,EAAKW,KAAKE,EAAUE,IAItB,IAA4B,IAAvBhB,EAAQkB,WACXhB,EAAmBH,QACb,GAAkC,iBAAtBC,EAAQkB,WAAyB,CACnD,IAAIC,EAAWxB,EAAOoB,QAAQhB,EAAKC,EAAQkB,YAC3C,IAAMF,EAAE,EAAGA,EAAIG,EAASF,OAAQD,IAC9Bd,EAAoBiB,EAASH,KAKnC,OAAOnB,EAAMI","file":"../loaded.js","sourcesContent":["define([\r\n\t\"skylark-domx-finder\",\r\n\t\"./images\",\r\n\t\"./watch\"\r\n],function(finder,images,watch){\r\n\r\n  function loaded(elm,options) {\r\n    var imgs = [];\r\n\r\n    options = options || {};\r\n\r\n    function addBackgroundImage (elm1) {\r\n\r\n      var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\r\n      var matches = reURL.exec( styler.css(elm1,\"background-image\"));\r\n      var url = matches && matches[2];\r\n      if ( url ) {\r\n        var img = new Image();\r\n        img.src = url;\r\n        imgs.push(img);\r\n      }\r\n    }\r\n\r\n    // filter siblings\r\n    if ( elm.nodeName == 'IMG' ) {\r\n      imgs.push( elm );\r\n    } else {\r\n      // find children\r\n      var childImgs = finder.findAll(elm,'img');\r\n      // concat childElems to filterFound array\r\n      for ( var i=0; i < childImgs.length; i++ ) {\r\n        imgs.push(childImgs[i]);\r\n      }\r\n\r\n      // get background image on element\r\n      if ( options.background === true ) {\r\n        addBackgroundImage(elm);\r\n      } else  if ( typeof options.background == 'string' ) {\r\n        var children = finder.findAll(elm, options.background );\r\n        for ( i=0; i < children.length; i++ ) {\r\n          addBackgroundImage( children[i] );\r\n        }\r\n      }\r\n    }\r\n\r\n    return watch(imgs);\r\n  }\r\n\r\n  return images.loaded = loaded;\r\n});"]}