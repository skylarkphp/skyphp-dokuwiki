{"version":3,"sources":["viewer.js"],"names":["define","langx","noder","geom","styler","transforms","images","viewer","el","options","img","style","clientSize","loadedCallback","loaded","onload","css","top","height","offsetHeight","left","width","offsetWidth","reset","visibility","onerror","_load","url","src","failered","position","Image","border","padding","margin","append","ret","load","dispose","remove","forEach","name","args","makeArray","arguments","unshift","apply"],"mappings":";;;;;;;AAAAA,QACI,sBACA,qBACA,oBACA,sBACA,0BACA,YACD,SAASC,EAAMC,EAAMC,EAAKC,EAAOC,EAAWC,GAyF7C,OAAOA,EAAOC,OApFd,SAAgBC,EAAGC,GACjB,IAAIC,EACAC,KACAC,EAAaT,EAAKS,WAAWJ,GAC7BK,EAAiBJ,EAAQK,OAG7B,SAASC,IACLX,EAAOY,IAAIN,GACTO,KAAML,EAAWM,OAASR,EAAIS,cAAgB,EAAI,KAClDC,MAAOR,EAAWS,MAAQX,EAAIY,aAAe,EAAI,OAGnDjB,EAAWkB,MAAMb,GAEjBN,EAAOY,IAAIN,GACTc,WAAY,YAGVX,GACFA,IAIN,SAASY,KA4BT,SAASC,EAAMC,GACXjB,EAAIC,MAAMa,WAAa,SACvBd,EAAIkB,IAAMD,EAjDSlB,EAAQoB,SAwBP,aADtBlB,EAAQP,EAAOY,IAAIR,GAAI,WAAW,cACxBsB,UAA4C,YAAlBnB,EAAMmB,UACxC1B,EAAOY,IAAIR,EAAG,WAAY,YAE5BJ,EAAOY,IAAIR,EAAG,WAAY,UAE1BE,EAAM,IAAIqB,MAEV3B,EAAOY,IAAIN,GACToB,SAAU,WACVE,OAAQ,EAAGC,QAAS,EAAGC,OAAQ,EAAGb,MAAO,OAAQH,OAAQ,OACzDM,WAAY,WAGdd,EAAIK,OAASA,EACbL,EAAIe,QAAUA,EAEdvB,EAAMiC,OAAO3B,EAAGE,GAEZD,EAAQkB,KACVD,EAAMjB,EAAQkB,KAiBlB,IAAIS,GACFC,KAAOX,EACPY,QAVF,WACIpC,EAAMqC,OAAO7B,GACbN,EAAOY,IAAIR,EAAGG,GACdD,EAAMA,EAAIK,OAASL,EAAIe,QAAU,OAoBrC,OAVC,WAAW,aAAa,SAAS,OAAO,QAAQ,QAAQ,OAAO,SAAS,UAAU,SAASe,QAC1F,SAASC,GACPL,EAAIK,GAAQ,WACV,IAAIC,EAAOzC,EAAM0C,UAAUC,WAC3BF,EAAKG,QAAQnC,GACbL,EAAWoC,GAAMK,MAAM,KAAKJ,MAK3BN","file":"../viewer.js","sourcesContent":["define([\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx-noder\",\r\n    \"skylark-domx-geom\",\r\n    \"skylark-domx-styler\",\r\n    \"skylark-domx-transforms\",\r\n    \"./images\"\r\n], function(langx,noder,geom,styler,transforms,images) {\r\n\r\n\r\n\r\n\r\n  function viewer(el,options) {\r\n    var img ,\r\n        style = {},\r\n        clientSize = geom.clientSize(el),\r\n        loadedCallback = options.loaded,\r\n        faileredCallback = options.failered;\r\n\r\n    function onload() {\r\n        styler.css(img,{//center\r\n          top: (clientSize.height - img.offsetHeight) / 2 + \"px\",\r\n          left: (clientSize.width - img.offsetWidth) / 2 + \"px\"\r\n        });\r\n\r\n        transforms.reset(img);\r\n\r\n        styler.css(img,{\r\n          visibility: \"visible\"\r\n        });\r\n\r\n        if (loadedCallback) {\r\n          loadedCallback();\r\n        }\r\n    }\r\n\r\n    function onerror() {\r\n\r\n    }\r\n    function _init() {\r\n      style = styler.css(el,[\"position\",\"overflow\"]);\r\n      if (style.position != \"relative\" && style.position != \"absolute\") { \r\n        styler.css(el,\"position\", \"relative\" );\r\n      }\r\n      styler.css(el,\"overflow\", \"hidden\" );\r\n\r\n      img = new Image();\r\n\r\n      styler.css(img,{\r\n        position: \"absolute\",\r\n        border: 0, padding: 0, margin: 0, width: \"auto\", height: \"auto\",\r\n        visibility: \"hidden\"\r\n      });\r\n\r\n      img.onload = onload;\r\n      img.onerror = onerror;\r\n\r\n      noder.append(el,img);\r\n\r\n      if (options.url) {\r\n        _load(options.url);\r\n      }\r\n    }\r\n\r\n    function _load(url) {\r\n        img.style.visibility = \"hidden\";\r\n        img.src = url;\r\n    }\r\n\r\n    function _dispose() {\r\n        noder.remove(img);\r\n        styler.css(el,style);\r\n        img = img.onload = img.onerror = null;\r\n    }\r\n\r\n    _init();\r\n\r\n    var ret =  {\r\n      load : _load,\r\n      dispose : _dispose\r\n    };\r\n\r\n    [\"vertical\",\"horizontal\",\"rotate\",\"left\",\"right\",\"scale\",\"zoom\",\"zoomin\",\"zoomout\",\"reset\"].forEach(\r\n      function(name){\r\n        ret[name] = function() {\r\n          var args = langx.makeArray(arguments);\r\n          args.unshift(img);\r\n          transforms[name].apply(null,args);\r\n        }\r\n      }\r\n    );\r\n\r\n    return ret;\r\n  }\r\n\r\n\r\n  return images.viewer = viewer;\r\n});"]}