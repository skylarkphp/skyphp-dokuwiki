{"version":3,"sources":["skylark-domx-placeholders.js"],"names":["define","skylark","langx","datax","dataSpaceStyle","placeholders","mixin","saveStyle","elm","data","style","cssText","restoreStyle","removeData","attach","styler","noder","geom","create","placeholder","cssPosition","css","position","relativePosition","size","test","createElement","nodeName","display","visibility","after","left","top","remove","removePlaceholder","cleanup","main"],"mappings":";;;;;;;g4BAAAA,EAAA,0CACA,wBACA,sBACA,qBACA,SAAAC,EAAAC,EAAAC,GACA,MAAAC,EAAA,oBAEA,SAAAC,IACA,OAAAA,EAkBA,OALAH,EAAAI,MAAAD,GACAE,UAVA,SAAAC,GACAL,EAAAM,KAAAD,EAAAJ,EAAAI,EAAAE,MAAAC,UAUAC,aAPA,SAAAJ,GACAA,EAAAE,MAAAC,QAAAR,EAAAM,KAAAD,EAAAJ,IAAA,GACAD,EAAAU,WAAAL,EAAAJ,MAQAH,EAAAa,OAAA,oBAAAT,KAEAL,EAAA,oCACA,sBACA,qBACA,oBACA,oBACA,kBACA,SAAAe,EAAAC,EAAAC,EAAAd,EAAAE,GAjCA,OAAAA,EAAAa,OAmCA,SAAAV,GACA,IAAAW,EACAC,EAAAL,EAAAM,IAAAb,EAAA,YACAc,EAAAL,EAAAM,iBAAAf,GAMAO,EAAAM,IAAAb,EAAAO,EAAAM,IAAAb,GAAA,YAAA,eAAA,aAAA,iBACAS,EAAAO,KAAAhB,EAAAS,EAAAO,KAAAhB,IAEA,qBAAAiB,KAAAL,KACAA,EAAA,WAEAD,EAAAH,EAAAU,cAAAlB,EAAAmB,UAEAZ,EAAAM,IAAAF,GAGAS,QAAA,iBAAAH,KAAAV,EAAAM,IAAAb,EAAA,YACA,eACA,QACAqB,WAAA,WAIAd,EAAAM,IAAAF,EAAAJ,EAAAM,IAAAb,GAAA,YAAA,eAAA,aAAA,cAAA,WAEAL,EAAAM,KAAAD,EAAA,cAAAW,GAEAF,EAAAO,KAAAL,EAAAF,EAAAO,KAAAhB,IAEAQ,EAAAc,MAAAtB,EAAAW,IAUA,OANAJ,EAAAM,IAAAb,GACAc,SAAAF,EACAW,KAAAT,EAAAS,KACAC,IAAAV,EAAAU,MAGAb,KA3EAnB,EAAA,oCACA,qBACA,oBACA,kBACA,SAAAgB,EAAAb,EAAAE,GAYA,OAAAA,EAAA4B,OAVA,SAAAzB,GACA,IACAW,EAAAhB,EAAAM,KAAAD,EADA,eAGAW,IACAH,EAAAiB,OAAAd,GACAhB,EAAAU,WAAAL,EALA,mBAWAR,EAAA,qCACA,sBACA,qBACA,oBACA,iBACA,YACA,SAAAe,EAAAC,EAAAC,EAAAZ,EAAA6B,GAQA,OAAA7B,EAAA8B,QALA,SAAA3B,GACAH,EAAAO,aAAAJ,GACA0B,EAAA1B,MAKAR,EAAA,kCACA,iBACA,WACA,WACA,aACA,SAAAK,GACA,OAAAA,IAEAL,EAAA,6BAAA,kCAAA,SAAAoC,GAAA,OAAAA","file":"../skylark-domx-placeholders.js","sourcesContent":["define('skylark-domx-placeholders/placeholders',[\r\n    \"skylark-langx/skylark\",\r\n    \"skylark-langx/langx\",\r\n    \"skylark-domx-data\"\r\n], function(skylark,langx,datax) {\r\n\tconst dataSpaceStyle = \"placeholder-style\";\r\n\r\n    function placeholders() {\r\n        return placeholders;\r\n    }\r\n\r\n\r\n\tfunction saveStyle(elm) {\r\n\t\tdatax.data(elm, dataSpaceStyle, elm.style.cssText );\r\n\t}\r\n\r\n\tfunction restoreStyle(elm) {\r\n\t\telm.style.cssText = datax.data(elm,dataSpaceStyle) || \"\";\r\n\t\tdatax.removeData(elm, dataSpaceStyle );\r\n\t}\r\n\r\n\tlangx.mixin(placeholders,{\r\n\t\tsaveStyle,\r\n\t\trestoreStyle\r\n\t});\r\n\r\n    return skylark.attach(\"domx.placeholders\", placeholders);\r\n});\ndefine('skylark-domx-placeholders/create',[\r\n\t\"skylark-domx-styler\",\r\n\t\"skylark-domx-noder\",\r\n\t\"skylark-domx-geom\",\r\n\t\"skylark-domx-data\",\r\n\t\"./placeholders\"\r\n],function(styler,noder,geom,datax,placeholders){\r\n\t// Creates a placeholder element so that the original element can be made absolute\r\n\tfunction createPlaceholder( elm ) {\r\n\t\tvar placeholder,\r\n\t\t\tcssPosition = styler.css(elm,\"position\" ),\r\n\t\t\tposition = geom.relativePosition(elm);\r\n\r\n\t\t// Lock in margins first to account for form elements, which\r\n\t\t// will change margin if you explicitly set height\r\n\t\t// see: http://jsfiddle.net/JZSMt/3/ https://bugs.webkit.org/show_bug.cgi?id=107380\r\n\t\t// Support: Safari\r\n\t\tstyler.css(elm, styler.css(elm,[\"marginTop\",\"marginBottom\",\"marginLeft\", \"marginRight\"]));\r\n\t\tgeom.size(elm,geom.size(elm));\r\n\r\n\t\tif ( /^(static|relative)/.test( cssPosition ) ) {\r\n\t\t\tcssPosition = \"absolute\";\r\n\r\n\t\t\tplaceholder = noder.createElement(elm.nodeName);\r\n\r\n\t\t\tstyler.css(placeholder,{\r\n\t\t\t\t// Convert inline to inline block to account for inline elements\r\n\t\t\t\t// that turn to inline block based on content (like img)\r\n\t\t\t\tdisplay: /^(inline|ruby)/.test( styler.css(elm,\"display\" ) ) ?\r\n\t\t\t\t\t\"inline-block\" :\r\n\t\t\t\t\t\"block\",\r\n\t\t\t\tvisibility: \"hidden\"\r\n\t\t\t});\r\n\r\n\t\t\t// Margins need to be set to account for margin collapse\r\n\t\t\tstyler.css(placeholder, styler.css(elm,[\"marginTop\",\"marginBottom\",\"marginLeft\", \"marginRight\",\"float\"]));\r\n\r\n\t\t\tdatax.data(elm, \"placeholder\", placeholder );\r\n\r\n\t\t\tgeom.size(placeholder,geom.size(elm));\r\n\r\n\t\t\tnoder.after(elm,placeholder);\r\n\r\n\t\t}\r\n\r\n\t\tstyler.css(elm, {\r\n\t\t\tposition: cssPosition,\r\n\t\t\tleft: position.left,\r\n\t\t\ttop: position.top\r\n\t\t} );\r\n\r\n\t\treturn placeholder;\r\n\t}\r\n\r\n\treturn placeholders.create = createPlaceholder;\r\n\r\n});\ndefine('skylark-domx-placeholders/remove',[\r\n\t\"skylark-domx-noder\",\r\n\t\"skylark-domx-data\",\r\n\t\"./placeholders\"\r\n],function(noder,datax,placeholders){\r\n\r\n\tfunction removePlaceholder( elm ) {\r\n\t\tvar dataKey = \"placeholder\",\r\n\t\t\tplaceholder = datax.data(elm, dataKey );\r\n\r\n\t\tif ( placeholder ) {\r\n\t\t\tnoder.remove(placeholder);\r\n\t\t\tdatax.removeData(elm,dataKey);\r\n\t\t}\r\n\t}\r\n\r\n\treturn placeholders.remove = removePlaceholder;\r\n});\ndefine('skylark-domx-placeholders/cleanup',[\r\n\t\"skylark-domx-styler\",\r\n\t\"skylark-domx-noder\",\r\n\t\"skylark-domx-geom\",\r\n\t\"./placeholders\",\r\n\t\"./remove\"\r\n],function(styler,noder,geom,placeholders,removePlaceholder){\r\n\t// Removes a placeholder if it exists and restores\r\n\t// properties that were modified during placeholder creation\r\n\tfunction cleanup( elm ) {\r\n\t\tplaceholders.restoreStyle(elm);\r\n\t\tremovePlaceholder(elm );\r\n\t}\r\n\r\n\treturn placeholders.cleanup = cleanup;\r\n});\ndefine('skylark-domx-placeholders/main',[\r\n\t\"./placeholders\",\r\n\t\"./create\",\r\n\t\"./remove\",\r\n\t\"./cleanup\"\r\n],function(placeholders){\r\n\treturn placeholders;\r\n});\ndefine('skylark-domx-placeholders', ['skylark-domx-placeholders/main'], function (main) { return main; });\n\n"]}