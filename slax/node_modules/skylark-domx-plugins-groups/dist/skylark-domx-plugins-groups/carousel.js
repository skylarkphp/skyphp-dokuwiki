/**
 * skylark-domx-plugins-groups - The skylark list plugin library.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx/skylark-domx-plugins-groups/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-query","skylark-domx-velm","skylark-domx-plugins-base","./groups","./group","./_carousel/indicators","./_carousel/mode-slide","./_carousel/mode-rotate","./_carousel/mode-coverflow"],function(t,e,s,i,o,n,r,l,a,c,h,m){"use strict";var d=l.inherit({klassName:"Carousel",pluginName:"lark.groups.carousel",options:{classes:{display:"display",single:"single",leftEdge:"left",rightEdge:"right",cycling:"cycling",controls:"controls"},cycle:{interval:5e3,pause:"hover"},loop:!0,wrap:!0,keyboard:!0,controls:{selectors:{toggle:".toggle",prev:".prev",next:".next",close:".close",cycleStop:".cycle-stop"}},indicators:{indicator:{template:"<li/>",indexAttrName:"data-index"}},selectors:{itemsContainer:".items",indicatorsContainer:".indicators"},item:{selector:".item",classes:{base:"item"}},data:{},mode:"slide",modes:{slide:{classes:{base:"slide"}},rotate:{classes:{base:"rotate",threedContainer:"items-container"},radius:240},coverflow:{classes:{base:"coverflow",itemPast:"past",itemFuture:"future",itemCurrent:"current",itemContent:"content"},spacing:-.6}},onjumped:null,onjumping:null},_construct:function(e,i){l.prototype._construct.call(this,e,i),this.options.item.selectable=!0,this.options.item.multiSelect=!1,this._$elm=this.$(),this._$itemsContainer=this._$elm.find(this.options.selectors.itemsContainer);let o=this._$elm.find(this.options.selectors.indicatorsContainer);o.length>0&&(this._indicators=new a(o[0],t.mixin({carousel:this,active:0},this.options.indicators)),this._indicators.setActiveIndicator(0)),this.paused=null,this.moving=null,this.interval=null,this.$active=null,this.options.cycle.interval>0?this.cycle(!0):this.cycle(!1);this.options.keyboard&&this._$elm.on("keydown.lark.carousel",t.proxy(this.keydown,this)),"hover"==this.options.cycle.pause&&!("ontouchstart"in document.documentElement)&&this._$elm.on("mouseenter.lark.carousel",t=>{this.pause(!0)}).on("mouseleave.lark.carousel",t=>{this.pause(!1)}),this._$elm.find(this.options.controls.selectors.prev).on("click",t=>{this.prev(),s.stop(t)}),this._$elm.find(this.options.controls.selectors.next).on("click",t=>{this.next(),s.stop(t)}),this._$elm.find(this.options.controls.selectors.cycleStop).on("click",t=>{this.cycle(!this.cycled),s.stop(t)}),this.options.data.items&&this.addItems(this.options.data.items),this._mode=new p[this.options.mode](this);let n=this.options.start;void 0!==n&&("center"===n&&(n=Math.floor(this.getItemsCount()/2)),this.jump(n)),this.options.onjumped&&this.on("jumped",this.options.onjumped),this.options.onjumping&&this.on("jumping",this.options.onjumping)},changeMode:function(t){if(t==this.options.mode)return;this.options.mode=t,this._mode&&this._mode.dispose&&this._mode.dispose(),this._mode=null,this.clearItems(),this.$().removeClass("slide rotate coverflow").addClass(this.options.modes[t].classes.base),this.$items,this.addItems(this.options.data.items),this._mode=new p[this.options.mode](this);let e=this.options.start;void 0!==e&&("center"===e&&(e=Math.floor(this.getItemsCount()/2)),this.jump(e))},keydown:function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},cycle:function(e){return t.isDefined(e)&&(this.cycled=!!e,this.cycled?this._velm.addClass(this.options.classes.cycling):this._velm.removeClass(this.options.classes.cycling)),this.interval&&clearInterval(this.interval),this.options.cycle.interval&&this.cycled&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.cycle.interval)),this},getItemForDirection:function(t,e){var s=this.getItemIndex(e);if(("prev"==t&&0===s||"next"==t&&s==this._$items.length-1)&&!this.options.wrap)return e;var i=(s+("prev"==t?-1:1))%this._$items.length;return this._$items.eq(i)},setActiveItem:function(t){l.prototype.setActiveItem.call(this,t),this._indicators&&this._indicators.setActiveIndicator(t)},jump:function(t){if(this.jumping)return;let e=this.getItemsCount();if(e<=1)return;let i,o,n=this.getActiveItem(),r=n?this.getItemIndex(n):-1;if("prev"===t?(o=t,r>0?i=r-1:this.options.loop&&(i=e-1)):"next"===t?(o=t,r<e-1?i=r+1:this.options.loop&&(i=0)):"number"==typeof t?i=t:"string"==typeof t?i=parseInt(t):void 0!==t&&(i=this.getItemIndex(t)),!(i<0||i==r)){o||(o=i>r?"next":"prev"),this.jumping=!0;var l=s.create("jumping.lark.carousel",{toIndex:i,currentIndex:r,type:o});if(this.trigger(l),!l.isDefaultPrevented())return this._mode.jump(i,r,o,()=>{this.setActiveItem(i);var t=s.create("jumped.lark.carousel",{toIndex:i,currentIndex:r,type:o});setTimeout(()=>{this.trigger(t)},0),this.jumping=!1}),this;this.jumping=!1}},pause:function(e){return t.isUndefined(e)&&(e=!0),this.paused=!!e,this.cycle(),this},next:function(){return this.jump("next")},prev:function(){return this.jump("prev")},resetItems:function(){l.prototype.resetItems.call(this),this._mode&&this._mode.resetItems&&this._mode.resetItems()},addItems:function(t){let e=this.getItemsCount();for(var s=0;s<t.length;s++)this.addItem(e++,t[s]);this.resetItems()},addItem:function(t,e){let s=this.renderItemHtml(e),o=this.options.item.classes.base,n=i(s);o&&n.addClass(o),this._$itemsContainer&&this._$itemsContainer.append(n),this._indicators&&this._indicators.addIndicator(t,e)},clearItems:function(){this._$itemsContainer&&this._$itemsContainer.attr("style",""),this._$items.remove(),this._$items=i(),this._indicators&&this._indicators.clearIndicators()}}),p=d.modes={slide:c,rotate:h,coverflow:m};return n.register(d),r.Carousel=d});
//# sourceMappingURL=sourcemaps/carousel.js.map
