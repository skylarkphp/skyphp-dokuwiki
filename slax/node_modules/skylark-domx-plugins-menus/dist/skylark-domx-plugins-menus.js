/**
 * skylark-domx-plugins-menus - The skylark menu plugin library.
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx/skylark-domx-plugins-menus/
 * @license MIT
 */
!function(e,s){var t=s.define,require=s.require,i="function"==typeof t&&t.amd,n=!i&&"undefined"!=typeof exports;if(!i&&!t){var a={};t=s.define=function(e,s,t){"function"==typeof t?(a[e]={factory:t,deps:s.map(function(s){return function(e,s){if("."!==e[0])return e;var t=s.split("/"),i=e.split("/");t.pop();for(var n=0;n<i.length;n++)"."!=i[n]&&(".."==i[n]?t.pop():t.push(i[n]));return t.join("/")}(s,e)}),resolved:!1,exports:null},require(e)):a[e]={factory:null,resolved:!0,exports:t}},require=s.require=function(e){if(!a.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=a[e];if(!module.resolved){var t=[];module.deps.forEach(function(e){t.push(require(e))}),module.exports=module.factory.apply(s,t)||null,module.resolved=!0}return module.exports}}if(!t)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-domx-plugins-menus/menus",["skylark-langx/skylark"],function(e){return e.attach("domx.plugins.menus")}),e("skylark-domx-plugins-menus/menu",["skylark-langx/langx","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","./menus"],function(e,s,t,i,n){"use strict";var a=i.Plugin.inherit({klassName:"Menu",pluginName:"lark.menus.menu",options:{template:"",classes:{base:"lark-menu"},selectors:{container:null},item:{templates:{general:'<li class="menu-item"><a href="#" class="link"><%= title %></a></li>',separator:"",hasChildren:'<li class="menu-item hasChildren"><a href="#" class="link"><%= title %></a><ul class="submenu"></ul>'},classes:{base:"menu-item",active:"active",hasChildren:"hasChildren"},selectors:{general:"li",hasChildren:":has(ul)"}},submenu:{template:"<ul></ul>",classes:{base:"submenu"},selectors:{children:"> ul",descendant:"ul"}},data:{},onAction:null},_construct:function(e,t){i.Plugin.prototype._construct.call(this,e,t),this._$container=this.$(this.options.selectors.container),this.options.onAction&&this.listenTo(this._$container,"click",`.${this.options.item.classes.base}`,e=>{var t=s(e.currentTarget).data("item");this.options.onAction(t)})},renderMenuItemHtml:function(s){if(!this._renderItemHtml){let s=this.options.item.template;e.isString(s)?this._renderItemHtml=e.template(s):e.isFunction(s)&&(this._renderItemHtml=s)}return this._renderItemHtml(s)},renderGeneralMenuItem:function(t){if(!this._renderGeneralItemHtml){let s=this.options.item.templates.general;e.isString(s)?this._renderGeneralItemHtml=e.template(s):e.isFunction(s)&&(this._renderGeneralItemHtml=s)}return s(this._renderGeneralItemHtml(t))},renderHasChildrenMenuItem:function(t){if(!this._renderHasChildrenItemHtml){let s=this.options.item.templates.hasChildren;e.isString(s)?this._renderHasChildrenItemHtml=e.template(s):e.isFunction(s)&&(this._renderHasChildrenItemHtml=s)}return s(this._renderHasChildrenItemHtml(t))}});return i.register(a),n.Menu=a}),e("skylark-domx-plugins-menus/accordion-menu",["skylark-langx/langx","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","./menus","./menu"],function(e,s,t,i,n,a){"use strict";var l=a.inherit({klassName:"AccordionMenu",pluginName:"lark.menus.accordion",_construct:function(e,s){a.prototype._construct.call(this,e,s),t.multitier(e,{togglable:!0,classes:{active:this.options.item.classes.active},selectors:{item:this.options.item.selectors.general,sublist:this.options.submenu.selectors.descendant,hasSublist:this.options.item.selectors.hasChildren},multiExpand:!1})}});return i.register(l),n.AccordionMenu=l}),e("skylark-domx-plugins-menus/cascade-menu",["skylark-langx/langx","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","./menus","./menu"],function(e,s,t,i,n,a){"use strict";var l=a.inherit({klassName:"CascadeMenu",pluginName:"lark.menus.cascade",_construct:function(e,s){a.prototype._construct.call(this,e,s),t.multitier(e,{togglable:!0,classes:{active:this.options.item.classes.active},selectors:{item:this.options.item.selectors.general,sublist:this.options.submenu.selectors.descendant,hasSublist:this.options.item.selectors.hasChildren},multiExpand:!1})}});return i.register(l),n.CascadeMenu=l}),e("skylark-domx-plugins-menus/mega-menu",["skylark-langx/langx","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","./menus","./menu"],function(e,s,t,i,n,a){"use strict";var l=a.inherit({klassName:"MegaMenu",pluginName:"lark.menus.mega",options:{menuBehaviour:"click",stickyHeader:!0,caret:!1,caretArrows:[{up:"caret-up",down:"caret-down",upUrl:"",downUrl:""}],highlighter:!0,followingHighlighter:!1,highlightColor:"",textHighlighter:!1,textHighlighterColor:"",animation:!1,animationClass:""},_construct:function(t,i){a.prototype._construct.call(this,t,i);let n=this.options;n.selector;var l=s(".main-links ul li a"),o=s(".menu-dropdown .menu-item-wrapper"),r=[],c=[],h=(s("#"+o.attr("id")),this.options.caretArrows[0].up),u=this.options.caretArrows[0].down;if(!1===n.stickyHeader?s(".mega-menu").removeClass("sticky-header"):s(".mega-menu").addClass("sticky-header"),!0===n.caret)var h=n.caretArrows[0].up,u=n.caretArrows[0].down;(n.caretArrows[0].up||n.caretArrows[0].down)&&(n.caretArrows[0].upUrl=null,n.caretArrows[0].downUrl=null),s("a[data-submenu]").append('<span class="caret '+u+'"></span>'),!0===n.caret&&""!==n.caretArrows[0].downUrl&&(s(".mega-menu span.caret").removeClass("undefined"),s(".mega-menu span.caret").addClass("caret-img down"),s(".mega-menu span.caret.caret-img.down").css({"background-image":"url("+n.caretArrows[0].downUrl+")"})),s("<style>\n            .mega-menu .main-links ul li a:hover{\n              border-color:"+n.highlightColor+"}\n          </style>").appendTo("head"),l.on(n.menuBehaviour,function(){l.removeClass("highlight"),l.css({"border-color":""})}),""===n.menuBehaviour&&(n.menuBehaviour="click"),l.each(function(t){var i=s(this).attr("data-submenu");r.push(s(this).attr("data-submenu")),s(this).on(n.menuBehaviour,function(){var a=e.inArray(i,c),m=s(this).find(".caret.caret-img");if(l.find("span").removeClass(h),l.find("span").addClass(u),r[t]!=c[a]||s(o[a]).hasClass("active")?(s(o[a]).removeClass("active"),s(this).find("span").removeClass(h),s(this).find("span").addClass(u)):(o.removeClass("active"),s(o[a]).addClass("active"),s(this).find("span").removeClass(u),s(this).find("span").addClass(h)),s(".menu-dropdown").find(".menu-item-wrapper").hasClass("active")&&(s(".mega-menu span.caret").addClass("down"),s(".mega-menu span.caret").css({"background-image":"url("+n.caretArrows[0].downUrl+")"})),m.hasClass("down")?(m.removeClass("down"),m.addClass("up"),m.css({"background-image":"url("+n.caretArrows[0].upUrl+")"})):(m.removeClass("up"),m.addClass("down"),m.css({"background-image":"url("+n.caretArrows[0].downUrl+")"})),(l.find("span").hasClass("caret-up")||s(this).find("span").hasClass("up")&&!s(this).hasClass("highlight"))&&(s(this).addClass("highlight"),s(this).css({"border-color":n.highlightColor})),o.hasClass("dropdown")){var p=s("#"+c[a]+".dropdown");p.css({left:s(this).offset().left})}})}),!0===n.followingHighlighter&&(s(".main-links ul").append('<div class="follow-highlighter"></div>'),l.mouseover(function(e,t){e.pageX,s(this).offset().left,s(this).innerWidth();s(".follow-highlighter").css({display:"block"}),s(".main-links ul").addClass("follow-highlighter-enabled"),s(".follow-highlighter").css({width:s(this).innerWidth(),left:s(this).offset().left,"background-color":n.highlightColor})})),s(".main-links ul").each(function(){s(this).mouseleave(function(){s(".main-links ul").removeClass("follow-highlighter-enabled"),s(".follow-highlighter").css({display:"none",left:s(l[0]).offset().left})})}),!1===n.highlighter&&(s(".main-links").addClass("disable-highlighter"),s(".follow-highlighter").remove()),!0===n.textHighlighter&&s(".main-links").addClass("text-highlighter"),n.textHighlighterColor&&s("style").append(".mega-menu .text-highlighter.main-links ul li a:hover{\n            color:"+n.textHighlighterColor+"}"),o.each(function(e){c.push(s(o[e]).attr("id"))}),!0===n.animation&&o.addClass(n.animationClass),s(".mobile-nav-icon a").click(function(){s(".follow-highlighter").remove(),s(".main-links").hasClass("active")?(s(".main-links").removeClass("active"),s(".menu-dropdown").hide()):(s(".main-links").addClass("active"),s(".menu-dropdown").show())}),s(".menu-item-wrapper").prepend('<a href="#" class="back-link">Back</a>'),s(window).resize(function(){s(window).width()<768?s(".mega-menu").hasClass("sticky-header")&&(s(".mega-menu").addClass("responsive-menu"),s(".main-links").css({"margin-top":s(".mobile-nav-icon").outerHeight()+"px"})):s(".main-links").css({"margin-top":"0px"})})}});return i.register(l),n.MegaMenu=l}),e("skylark-domx-plugins-menus/nav-menu",["skylark-langx/langx","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","./menus","./menu"],function(e,s,t,i,n,a){"use strict";var l=a.inherit({klassName:"NavMenu",pluginName:"lark.menus.nav",options:{item:{templates:{}}},_construct:function(e,s){a.prototype._construct.call(this,e,s),this.options.data.items&&this.resetItems(this.options.data.items),t.multitier(e,{togglable:!1,classes:{active:this.options.item.classes.active},selectors:{item:this.options.item.selectors.general,sublist:this.options.submenu.selectors.descendant,hasSublist:this.options.item.selectors.hasChildren},multiExpand:!1})},resetItems:function(e){let s=this;let t=this.$(this.options.selectors.container);e.forEach(e=>{!function e(t,i){let n;n=t.children?s.renderHasChildrenMenuItem(t):s.renderGeneralMenuItem(t);n.data("item",t);i.append(n);if(t.children){let i=n.find(s.options.submenu.selectors.children);t.children.forEach(s=>{e(s,i)})}}(e,t)})}});return i.register(l),n.NavMenu=l}),e("skylark-domx-plugins-menus/tree-menu",["skylark-langx/langx","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","./menus","./menu","skylark-domx-plugins-toggles"],function(e,s,t,i,n,a){"use strict";var l=a.inherit({klassName:"Tree",pluginName:"lark.menus.tree",_construct:function(s,i){a.prototype._construct.call(this,s,i),t.multitier(s,e.mixin({hide:function(e){e.plugin("lark.toggles.collapse").hide()},toggle:function(e){e.plugin("lark.toggles.collapse").toggle()}},this.options))}});return i.register(l),n.TreeMenu=l}),e("skylark-domx-plugins-menus/popup-menu",["skylark-langx/langx","skylark-devices-keyboard/keys","skylark-domx-noder","skylark-domx-styler","skylark-domx-query","skylark-domx-lists","skylark-domx-plugins-base","skylark-domx-plugins-popups/popups","./menus","./menu"],function(e,s,t,i,n,a,l,o,r,c){"use strict";var h=c.inherit({klassName:"PopupMenu",pluginName:"lark.menus.popup",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},position:{my:"left top",at:"right top"},role:"menu",item:{classes:{base:"menu-item",active:"active",disabled:"disabled",wrapper:"menu-item-wrapper"},selector:"> *"},blur:null,focus:null,select:null},_construct:function(e,s){c.prototype._construct.call(this,e,s),this.element=this.$(),this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.attr({role:this.options.role,tabIndex:0}),this.listenTo(this.element,{mousedown:function(e){e.preventDefault(),this._activateItem(e)},click:function(e){var s=n(e.target),i=n(t.active());!this.mouseHandled&&s.not(`.${this.options.item.classes.disable}`).length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),s.has(`.${this.options.submenu.classes.base}`).length?this.expand(e):!this.element.is(":focus")&&i.closest(`.${this.options.submenu.classes.base}`).length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(`.${this.options.submenu.classes.base}`).length&&clearTimeout(this.timer)))},mouseenter:"_activateItem",mousemove:"_activateItem"},`.${this.options.item.classes.base}`),this.listenTo(this.element,{mouseleave:"collapseAll",focus:function(e,s){var t=this.active||this._menuItems().first();s||this.focus(e,t)},blur:function(e){this._delay(function(){var s=!t.contains(this.element[0],t.active());s&&this.collapseAll(e)})},keydown:"_keydown"}),this.listenTo(this.element,"mouseleave",`.${this.options.submenu.classes.base}`,"collapseAll"),this.listenTo(n(document),{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e,!0),this.mouseHandled=!1}})},_activateItem:function(e){if(!this.previousFilter&&(e.clientX!==this.lastMousePosition.x||e.clientY!==this.lastMousePosition.y)){this.lastMousePosition={x:e.clientX,y:e.clientY};var s=n(e.target).closest(`.${this.options.item.classes.base}`),t=n(e.currentTarget);s[0]===t[0]&&(t.is(`.${this.options.item.classes.active}`)||(t.siblings().children(`.${this.options.item.classes.active}`).removeClass(this.options.item.classes.active),this.focus(e,t)))}},_keydown:function(e){var t,i,n,a,l=!0;switch(e.keyCode){case s.PAGE_UP:this.previousPage(e);break;case s.PAGE_DOWN:this.nextPage(e);break;case s.HOME:this._move("first","first",e);break;case s.END:this._move("last","last",e);break;case s.UP:this.previous(e);break;case s.DOWN:this.next(e);break;case s.LEFT:this.collapse(e);break;case s.RIGHT:this.active&&!this.active.is(`.${this.options.item.classes.disabled}`)&&this.expand(e);break;case s.ENTER:case s.SPACE:this._activate(e);break;case s.ESC:this.collapse(e);break;default:l=!1,i=this.previousFilter||"",a=!1,n=e.keyCode>=96&&e.keyCode<=105?(e.keyCode-96).toString():String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),n===i?a=!0:n=i+n,t=this._filterMenuItems(n),(t=a&&-1!==t.index(this.active.next())?this.active.nextAll(`.${this.options.item.classes.base}`):t).length||(n=String.fromCharCode(e.keyCode),t=this._filterMenuItems(n)),t.length?(this.focus(e,t),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}l&&e.preventDefault()},_activate:function(e){this.active&&!this.active.is(`.${this.options.item.classes.disabled}`)&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(e,s){var t,i;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(s),this.active=s.first(),(i=this.active.children(`.${this.options.item.classes.wrapper}`)).addClass(this.options.item.classes.active),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),this.active.parent().closest(`.${this.options.item.classes.base}`).children(`.${this.options.item.classes.wrapper}`).addClass(this.options.item.classes.active),e&&"keydown"===e.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(t=s.children(`.${this.options.submenu.classes.base}`)).length&&e&&/^mouse/.test(e.type)&&this._startOpening(t),this.activeMenu=s.parent(),this.trigger("focus",{item:s})},_scrollIntoView:function(e){var s,t,n,a,l,o;this._hasScroll()&&(s=parseFloat(i.css(this.activeMenu[0],"borderTopWidth"))||0,t=parseFloat(i.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-s-t,a=this.activeMenu.scrollTop(),l=this.activeMenu.height(),o=e.outerHeight(),n<0?this.activeMenu.scrollTop(a+n):n+o>l&&this.activeMenu.scrollTop(a+n-l+o))},blur:function(e,s){s||clearTimeout(this.timer),this.active&&(this.active.children(`.${this.options.item.classes.wrapper}`).removeClass(this.options.item.classes.active),this.trigger("blur",{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),this.timer=this._delay(function(){this._close(),this._open(e)},this.delay)},_open:function(s){var t=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(`.${this.options.submenu.classes.base}`).not(s.parents(`.${this.options.submenu.classes.base}`)).hide().attr("aria-hidden","true"),o.open(s.attr("aria-expanded","true"),{position:t})},collapseAll:function(e,s){clearTimeout(this.timer),this.timer=this._delay(function(){var t=s?this.element:n(e&&e.target).closest(this.element.find(`.${this.options.submenu.classes.base}`));t.length||(t=this.element),this._close(t),this.blur(e),t.find(`.${this.options.item.classes.active}`).removeClass(this.options.item.classes.active),this.activeMenu=t},s?0:this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),o.close(e.find(`.${this.options.submenu.classes.base}`).attr("aria-expanded","false"))},_closeOnDocumentClick:function(e){return!n(e.target).closest(`.${this.options.submenu.classes.base}`).length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var s=this.active&&this.active.parent().closest(`.${this.options.item.classes.base}`,this.element);s&&s.length&&(this._close(),this.focus(e,s))},expand:function(e){var s=this.active&&this._menuItems(this.active.children(`.${this.options.submenu.classes.base}`)).first();s&&s.length&&(this._open(s.parent()),this._delay(function(){this.focus(e,s)}))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(`.${this.options.item.classes.base}`).length},isLastItem:function(){return this.active&&!this.active.nextAll(`.${this.options.item.classes.base}`).length},_menuItems:function(e){return(e||this.element).find(this.options.items).filter(`.${this.options.item.classes.base}`)},_move:function(e,s,t){var i;this.active&&(i="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](`.${this.options.item.classes.base}`).last():this.active[e+"All"](`.${this.options.item.classes.base}`).first()),i&&i.length&&this.active||(i=this._menuItems(this.activeMenu)[s]()),this.focus(t,i)},nextPage:function(e){var s,t,i;this.active?this.isLastItem()||(this._hasScroll()?(t=this.active.offset().top,i=this.element.height(),this.active.nextAll(`.${this.options.item.classes.base}`).each(function(){return(s=n(this)).offset().top-t-i<0}),this.focus(e,s)):this.focus(e,this._menuItems(this.activeMenu)[this.active?"last":"first"]())):this.next(e)},previousPage:function(e){var s,t,i;this.active?this.isFirstItem()||(this._hasScroll()?(t=this.active.offset().top,i=this.element.height(),this.active.prevAll(`.${this.options.item.classes.base}`).each(function(){return(s=n(this)).offset().top-t+i>0}),this.focus(e,s)):this.focus(e,this._menuItems(this.activeMenu).first())):this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||n(e.target).closest(`.${this.options.item.classes.base}`);var s={item:this.active};this.active.has(`.${this.options.submenu.classes.base}`).length||this.collapseAll(e,!0),this.trigger("select",s)},_filterMenuItems:function(s){var t=s.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),i=new RegExp("^"+t,"i");return this.activeMenu.find(this.options.items).filter(`.${this.options.item.classes.base}`).filter(function(){return i.test(e.trim(n(this).children(`.${this.options.item.classes.wrapper}`).text()))})}});return l.register(h),r.PopupMenu=h}),e("skylark-domx-plugins-menus/main",["./menus","./accordion-menu","./cascade-menu","./mega-menu","./nav-menu","./tree-menu","./popup-menu"],function(e){return e}),e("skylark-domx-plugins-menus",["skylark-domx-plugins-menus/main"],function(e){return e})}(t),!i){var l=require("skylark-langx-ns");n?module.exports=l:s.skylarkjs=l}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-menus.js.map
