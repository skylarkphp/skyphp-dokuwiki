/**
 * skylark-domx-plugins-popups - The skylark popup utility library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(e,t){var i=t.define,require=t.require,s="function"==typeof i&&i.amd,n=!s&&"undefined"!=typeof exports;if(!s&&!i){var o={};i=t.define=function(e,t,i){"function"==typeof i?(o[e]={factory:i,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var i=t.split("/"),s=e.split("/");i.pop();for(var n=0;n<s.length;n++)"."!=s[n]&&(".."==s[n]?i.pop():i.push(s[n]));return i.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:i}},require=t.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var i=[];module.deps.forEach(function(e){i.push(require(e))}),module.exports=module.factory.apply(t,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-domx-plugins-popups/popups",["skylark-langx-ns","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base/plugins"],function(e,t,i,s){var n=[];return s.popups={around:function(e){var i=t.size(popup),s=i.width,n=i.height,o=t.height(e),r=e.ownerDocument,l=r.documentElement,a=l.clientWidth+t.scrollLeft(r),d=l.clientHeight+t.scrollTop(r),h=t.pagePosition(e),c=h.left,u=h.top;return u+=o,c-=Math.min(c,c+s>a&&a>s?Math.abs(c+s-a):0),{top:u-=Math.min(u,u+n>d&&d>n?Math.abs(n+o-0):0),bottom:h.bottom,left:c,right:h.right,width:h.width,height:h.height}},open:function(e,t){t.around;let s=i(e);s.show().removeAttr("aria-hidden").position(t.position),n.push({popup:s[0]})},close:function(e){var t=0;if(e){e=i(e)[0];for(var s=n.length-1;s>=0;s--)if(n[s].popup==e){t=n.length-s;break}}else t=n.length;for(var s=0;s<t;s++){var o=n.pop(),r=i(o.popup);r.hide().attr("aria-hidden","true")}}}}),e("skylark-domx-plugins-popups/calc-offset",["skylark-domx-geom","./popups"],function(e,t){return t.calcOffset=function(t,i){var s=e.size(t),n=s.width,o=s.height,r=e.height(i),l=t.ownerDocument,a=l.documentElement,d=a.clientWidth+e.scrollLeft(l),h=a.clientHeight+e.scrollTop(l),c=e.pagePosition(i),u=c.left,p=c.top;return p+=r,u-=Math.min(u,u+n>d&&d>n?Math.abs(u+n-d):0),{top:p-=Math.min(p,p+o>h&&h>o?Math.abs(o+r-0):0),bottom:c.bottom,left:u,right:c.right,width:c.width,height:c.height}}}),e("skylark-domx-plugins-popups/dropdown",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups"],function(e,t,i,s,n,o,r,l){"use strict";var a=".dropdown-backdrop",d='[data-toggle="dropdown"]',h=r.Plugin.inherit({klassName:"Dropdown",pluginName:"lark.popups.dropdown",options:{selectors:{toggler:'[data-toggle="dropdown"],.dropdown-menu'}},_construct:function(e,t){this.overrided(e,t);var i=this.$element=o(this._elm);i.on("click.dropdown",this.toggle),i.on("keydown.dropdown",this.options.selectors.toggler,this.keydown)},toggle:function(e){var t=o(this);if(!t.is(".disabled, :disabled")){var s=c(t),n=s.hasClass("open");if(u(),!n){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&o(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(o(this)).on("click",u);var r={relatedTarget:this};if(s.trigger(e=i.create("show.dropdown",r)),e.isDefaultPrevented())return;t.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(i.create("shown.dropdown",r))}return!1}},keydown:function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var t=o(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var i=c(t),s=i.hasClass("open");if(!s&&27!=e.which||s&&27==e.which)return 27==e.which&&i.find(d).trigger("focus"),t.trigger("click");var n=i.find(".dropdown-menu li:not(.disabled):visible a");if(n.length){var r=n.index(e.target);38==e.which&&r>0&&r--,40==e.which&&r<n.length-1&&r++,~r||(r=0),n.eq(r).trigger("focus")}}}}});function c(e){var t=e.attr("data-target");t||(t=(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""));var i=t&&o(t);return i&&i.length?i:e.parent()}function u(e){e&&3===e.which||(o(a).remove(),o(d).each(function(){var t=o(this),n=c(t),r={relatedTarget:this};n.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&s.contains(n[0],e.target)||(n.trigger(e=i.create("hide.dropdown",r)),e.isDefaultPrevented()||(t.attr("aria-expanded","false"),n.removeClass("open").trigger(i.create("hidden.dropdown",r)))))}))}return o(document).on("click.dropdown.data-api",u).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}),r.register(h),l.Dropdown=h}),e("skylark-domx-plugins-popups/comboBox",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups","./dropdown"],function(e,t,i,s,n,o,r,l,a){var d=r.Plugin.inherit({klassName:"ComboBox",pluginName:"lark.popups.combobox",options:{autoResizeMenu:!0,filterOnKeypress:!1,showOptionsOnKeypress:!1,filter:function(e,t,i){var s=0;i.$dropMenu.find(".empty-indicator").remove(),e.each(function(e){var i=o(this),n=o(this).text().trim();i.removeClass(),n===t?(i.addClass("text-success"),s++):n.substr(0,t.length)===t?(i.addClass("text-info"),s++):i.addClass("hidden")}),0===s&&i.$dropMenu.append('<li class="empty-indicator text-muted"><em>No Matches</em></li>')}},_construct:function(t,i){this.overrided(t,i),this.$element=this.$(),this.$dropMenu=this.$element.find(".dropdown-menu"),this.$input=this.$element.find("input"),this.$button=this.$element.find(".btn"),this.$button.plugin("lark.popups.dropdown"),this.$inputGroupBtn=this.$element.find(".input-group-btn"),this.$element.on("click.lark","a",e.proxy(this.itemclicked,this)),this.$element.on("change.lark","input",e.proxy(this.inputchanged,this)),this.$element.on("shown.bs.dropdown",e.proxy(this.menuShown,this)),this.$input.on("keyup.lark",e.proxy(this.keypress,this)),this.setDefaultSelection();var s=this.$dropMenu.children("li");0===s.length&&this.$button.addClass("disabled"),this.options.filterOnKeypress&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this)},_destroy:function(){return this.$element.remove(),this.$element.find("input").each(function(){o(this).attr("value",o(this).val())}),this.$element[0].outerHTML},doSelect:function(e){void 0!==e[0]?(this.$element.find("li.selected:first").removeClass("selected"),this.$selectedItem=e,this.$selectedItem.addClass("selected"),this.$input.val(this.$selectedItem.text().trim())):(this.$selectedItem=null,this.$element.find("li.selected:first").removeClass("selected"))},clearSelection:function(){this.$selectedItem=null,this.$input.val(""),this.$dropMenu.find("li").removeClass("selected")},menuShown:function(){this.options.autoResizeMenu&&this.resizeMenu()},resizeMenu:function(){var e=this.$element.outerWidth();this.$dropMenu.outerWidth(e)},selectedItem:function(){var t=this.$selectedItem,i={};if(t){var s=this.$selectedItem.text().trim();i=e.mixin({text:s},this.$selectedItem.data())}else i={text:this.$input.val().trim(),notFound:!0};return i},selectByText:function(e){var t=o([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||o(this).text()||"").trim().toLowerCase()===(e||"").trim().toLowerCase())return t=o(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e="li[data-selected=true]:first",t=this.$element.find(e);t.length>0&&(this.selectBySelector(e),t.removeData("selected"),t.removeAttr("data-selected"))},enable:function(){this.$element.removeClass("disabled"),this.$input.removeAttr("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$input.attr("disabled",!0),this.$button.addClass("disabled")},itemclicked:function(e){this.$selectedItem=o(e.target).parent(),this.$input.val(this.$selectedItem.text().trim()).trigger("change",{synthetic:!0});var t=this.selectedItem();this.$element.trigger("changed.lark",t),e.preventDefault(),this.$element.find(".dropdown-toggle").focus()},keypress:function(e){var t=38===e.which||40===e.which||37===e.which||39===e.which;if(this.options.showOptionsOnKeypress&&!this.$inputGroupBtn.hasClass("open")&&(this.$button.plugin("lark.popups.dropdown").toggle(),this.$input.focus()),13===e.which){e.preventDefault();var i=this.$dropMenu.find("li.selected").text().trim();i.length>0?this.selectByText(i):this.selectByText(this.$input.val()),this.$inputGroupBtn.removeClass("open")}else if(27===e.which)e.preventDefault(),this.clearSelection(),this.$inputGroupBtn.removeClass("open");else if(this.options.showOptionsOnKeypress&&(40===e.which||38===e.which)){e.preventDefault();var s=this.$dropMenu.find("li.selected");s.length>0&&(s=40===e.which?s.next(":not(.hidden)"):s.prev(":not(.hidden)")),0===s.length&&(s=40===e.which?this.$dropMenu.find("li:not(.hidden):first"):this.$dropMenu.find("li:not(.hidden):last")),this.doSelect(s)}this.options.filterOnKeypress&&!t&&this.options.filter(this.$dropMenu.find("li"),this.$input.val(),this),this.previousKeyPress=e.which},inputchanged:function(e,t){var i=o(e.target).val();if(t&&t.synthetic)this.selectByText(i);else{this.selectByText(i);var s=this.selectedItem();0===s.text.length&&(s={text:i}),this.$element.trigger("changed.lark",s)}}});return d.prototype.getValue=d.prototype.selectedItem,r.register(d),l.ComboBox=d}),e("skylark-domx-plugins-popups/select-list",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups","./dropdown"],function(e,t,i,s,n,o,r,l,a){var d=r.Plugin.inherit({klassName:"SelectList",pluginName:"lark.popups.selectlist",options:{emptyLabelHTML:'<li data-value=""><a href="#">No items</a></li>'},_construct:function(t,i){this.overrided(t,i),this.$element=this.$(),this.$button=this.$element.find(".btn.dropdown-toggle"),this.$hiddenField=this.$element.find(".hidden-field"),this.$label=this.$element.find(".selected-label"),this.$dropdownMenu=this.$element.find(".dropdown-menu"),this.$button.plugin("lark.popups.dropdown"),this.$element.on("click.selectlist",".dropdown-menu a",e.proxy(this.itemClicked,this)),this.setDefaultSelection(),"auto"!==this.options.resize&&"auto"!==this.$element.attr("data-resize")||this.resize();var s=this.$dropdownMenu.children("li");0===s.length&&(this.disable(),this.doSelect(o(this.options.emptyLabelHTML))),this.$element.on("shown.dropdown",function(){var e=o(this);o(document).on("keypress.selectlist",function(t){var i=String.fromCharCode(t.which);e.find("li").each(function(e,t){if(o(t).text().charAt(0).toLowerCase()===i)return o(t).children("a").focus(),!1})})}),this.$element.on("hide.dropdown",function(){o(document).off("keypress.selectlist")})},_destroy:function(){return this.$element.remove(),this.$element[0].outerHTML},doSelect:function(e){var t;this.$selectedItem=t=e,this.$hiddenField.val(this.$selectedItem.attr("data-value")),this.$label.html(o(this.$selectedItem.children()[0]).html()),this.$element.find("li").each(function(){t.is(o(this))?o(this).attr("data-selected",!0):o(this).removeData("selected").removeAttr("data-selected")})},itemClicked:function(e){this.$element.trigger("clicked.selectlist",this.$selectedItem),e.preventDefault(),o(e.currentTarget).parent("li").is(".disabled, :disabled")||(o(e.target).parent().is(this.$selectedItem)||this.itemChanged(e),this.$element.find(".dropdown-toggle").focus())},itemChanged:function(e){this.doSelect(o(e.target).closest("li"));var t=this.selectedItem();this.$element.trigger("changed.selectlist",t)},resize:function(){var e=0,t=0,i=o("<div/>").addClass("selectlist-sizer");Boolean(o(document).find("html").hasClass("fuelux"))?o(document.body).append(i):o(".fuelux:first").append(i),i.append(this.$element.clone()),this.$element.find("a").each(function(){i.find(".selected-label").text(o(this).text()),t=i.find(".selectlist").outerWidth(),(t+=i.find(".sr-only").outerWidth())>e&&(e=t)}),e<=1||(this.$button.css("width",e),this.$dropdownMenu.css("width",e),i.remove())},selectedItem:function(){var t=this.$selectedItem.text();return e.mixin({text:t},this.$selectedItem.data())},selectByText:function(e){var t=o([]);this.$element.find("li").each(function(){if((this.textContent||this.innerText||o(this).text()||"").toLowerCase()===(e||"").toLowerCase())return t=o(this),!1}),this.doSelect(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.doSelect(t)},setDefaultSelection:function(){var e=this.$element.find("li[data-selected=true]").eq(0);0===e.length&&(e=this.$element.find("li").has("a").eq(0)),this.doSelect(e)},enable:function(){this.$element.removeClass("disabled"),this.$button.removeClass("disabled")},disable:function(){this.$element.addClass("disabled"),this.$button.addClass("disabled")}});return d.prototype.getValue=d.prototype.selectedItem,r.register(d),l.SelectList=d}),e("skylark-domx-plugins-popups/main",["./popups","./calc-offset","./dropdown","./comboBox","./select-list"],function(e){return e}),e("skylark-domx-plugins-popups",["skylark-domx-plugins-popups/main"],function(e){return e})}(i),!s){var r=require("skylark-langx-ns");n?module.exports=r:t.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-popups.js.map
