/**
 * skylark-domx-plugins-popups - The skylark popup utility library for dom api extension.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./popups"],function(e,t,r,o,a,n,i,d){"use strict";var s=".dropdown-backdrop",l='[data-toggle="dropdown"]',g=i.Plugin.inherit({klassName:"Dropdown",pluginName:"lark.popups.dropdown",options:{selectors:{toggler:'[data-toggle="dropdown"],.dropdown-menu'}},_construct:function(e,t){this.overrided(e,t);var r=this.$element=n(this._elm);r.on("click.dropdown",this.toggle),r.on("keydown.dropdown",this.options.selectors.toggler,this.keydown)},toggle:function(e){var t=n(this);if(!t.is(".disabled, :disabled")){var o=c(t),a=o.hasClass("open");if(p(),!a){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&n(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(n(this)).on("click",p);var i={relatedTarget:this};if(o.trigger(e=r.create("show.dropdown",i)),e.isDefaultPrevented())return;t.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger(r.create("shown.dropdown",i))}return!1}},keydown:function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var t=n(this);if(e.preventDefault(),e.stopPropagation(),!t.is(".disabled, :disabled")){var r=c(t),o=r.hasClass("open");if(!o&&27!=e.which||o&&27==e.which)return 27==e.which&&r.find(l).trigger("focus"),t.trigger("click");var a=r.find(".dropdown-menu li:not(.disabled):visible a");if(a.length){var i=a.index(e.target);38==e.which&&i>0&&i--,40==e.which&&i<a.length-1&&i++,~i||(i=0),a.eq(i).trigger("focus")}}}}});function c(e){var t=e.attr("data-target");t||(t=(t=e.attr("href"))&&/#[A-Za-z]/.test(t)&&t.replace(/.*(?=#[^\s]*$)/,""));var r=t&&n(t);return r&&r.length?r:e.parent()}function p(e){e&&3===e.which||(n(s).remove(),n(l).each(function(){var t=n(this),a=c(t),i={relatedTarget:this};a.hasClass("open")&&(e&&"click"==e.type&&/input|textarea/i.test(e.target.tagName)&&o.contains(a[0],e.target)||(a.trigger(e=r.create("hide.dropdown",i)),e.isDefaultPrevented()||(t.attr("aria-expanded","false"),a.removeClass("open").trigger(r.create("hidden.dropdown",i)))))}))}return n(document).on("click.dropdown.data-api",p).on("click.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}),i.register(g),d.Dropdown=g});
//# sourceMappingURL=sourcemaps/dropdown.js.map
