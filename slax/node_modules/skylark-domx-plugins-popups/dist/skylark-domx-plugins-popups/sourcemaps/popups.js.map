{"version":3,"sources":["popups.js"],"names":["define","skylark","geom","$","plugins","stack","popups","around","ref","dpSize","size","popup","dpWidth","width","dpHeight","height","refHeight","doc","ownerDocument","docElem","documentElement","viewWidth","clientWidth","scrollLeft","viewHeight","clientHeight","scrollTop","offset","pagePosition","offsetLeft","left","offsetTop","top","Math","min","abs","bottom","right","open","options","$popup","show","removeAttr","position","push","close","count","i","length","pop","hide","attr"],"mappings":";;;;;;;AAAAA,QACC,mBACA,oBACA,qBACG,qCACF,SAASC,EAAQC,EAAKC,EAAEC,GAEzB,IAAIC,KA8FJ,OAAOD,EAAQE,QACdC,OAvFE,SAAgBC,GACZ,IACIC,EAASP,EAAKQ,KAAKC,OACnBC,EAAUH,EAAOI,MACjBC,EAAWL,EAAOM,OAClBC,EAAYd,EAAKa,OAAOP,GACxBS,EAAMT,EAAIU,cACVC,EAAUF,EAAIG,gBACdC,EAAYF,EAAQG,YAAcpB,EAAKqB,WAAWN,GAClDO,EAAaL,EAAQM,aAAevB,EAAKwB,UAAUT,GACnDU,EAASzB,EAAK0B,aAAapB,GAC3BqB,EAAaF,EAAOG,KACpBC,EAAYJ,EAAOK,IAYvB,OAVAD,GAAaf,EAEba,GACII,KAAKC,IAAIL,EAAaA,EAAajB,EAAUS,GAAaA,EAAYT,EACtEqB,KAAKE,IAAIN,EAAajB,EAAUS,GAAa,IAO7CW,IALJD,GACIE,KAAKC,IAAIH,EAAaA,EAAYjB,EAAWU,GAAcA,EAAaV,EACxEmB,KAAKE,IAAIrB,EAAWE,EArBX,GAAA,GAyBToB,OAAQT,EAAOS,OACfN,KAAMD,EACNQ,MAAOV,EAAOU,MACdxB,MAAOc,EAAOd,MACdE,OAAQY,EAAOZ,SA0DzBuB,KA5CD,SAAc3B,EAAM4B,GACfA,EAAQhC,OAIZ,IAAIiC,EAASrC,EAAEQ,GAEf6B,EAAOC,OACHC,WAAY,eACTC,SAAUJ,EAAQI,UAEtBtC,EAAMuC,MACLjC,MAAQ6B,EAAO,MAiCnBK,MAxBD,SAAelC,GACd,IAAImC,EAAQ,EAEZ,GAAInC,EAAO,CACVA,EAAQR,EAAEQ,GAAO,GACjB,IAAK,IAAIoC,EAAG1C,EAAM2C,OAAO,EAAGD,GAAG,EAAGA,IACjC,GAAI1C,EAAM0C,GAAGpC,OAASA,EAAO,CAC5BmC,EAAQzC,EAAM2C,OAASD,EACvB,YAIFD,EAAQzC,EAAM2C,OAEf,IAASD,EAAE,EAAGA,EAAED,EAAQC,IAAM,CAC7B,IAAIf,EAAM3B,EAAM4C,MACN9C,EAAE6B,EAAIrB,OACTuC,OACLC,KAAM,cAAe","file":"../popups.js","sourcesContent":["define([\r\n\t\"skylark-langx-ns\",\r\n\t\"skylark-domx-geom\",\r\n\t\"skylark-domx-query\",\r\n    \"skylark-domx-plugins-base/plugins\"\r\n],function(skylark,geom,$,plugins){\r\n\r\n\tvar stack = [];\r\n\r\n\r\n\r\n    /**\r\n    * get the offset below/above and left/right element depending on screen position\r\n    * Thanks https://github.com/jquery/jquery-ui/blob/master/ui/jquery.ui.datepicker.js\r\n    */\r\n    function around(ref) {\r\n        var extraY = 0;\r\n        var dpSize = geom.size(popup);\r\n        var dpWidth = dpSize.width;\r\n        var dpHeight = dpSize.height;\r\n        var refHeight = geom.height(ref);\r\n        var doc = ref.ownerDocument;\r\n        var docElem = doc.documentElement;\r\n        var viewWidth = docElem.clientWidth + geom.scrollLeft(doc);\r\n        var viewHeight = docElem.clientHeight + geom.scrollTop(doc);\r\n        var offset = geom.pagePosition(ref);\r\n        var offsetLeft = offset.left;\r\n        var offsetTop = offset.top;\r\n\r\n        offsetTop += refHeight;\r\n\r\n        offsetLeft -=\r\n            Math.min(offsetLeft, (offsetLeft + dpWidth > viewWidth && viewWidth > dpWidth) ?\r\n            Math.abs(offsetLeft + dpWidth - viewWidth) : 0);\r\n\r\n        offsetTop -=\r\n            Math.min(offsetTop, ((offsetTop + dpHeight > viewHeight && viewHeight > dpHeight) ?\r\n            Math.abs(dpHeight + refHeight - extraY) : extraY));\r\n\r\n        return {\r\n            top: offsetTop,\r\n            bottom: offset.bottom,\r\n            left: offsetLeft,\r\n            right: offset.right,\r\n            width: offset.width,\r\n            height: offset.height\r\n        };\r\n    }\r\n\r\n\r\n\t/*\r\n\t * Popup the ui elment at the specified position\r\n\t * @param popup  element to display\r\n\t * @param options\r\n\t *  - around {HtmlEleent}\r\n\t *  - at {x,y}\r\n\t *  - parent {}\r\n\t */\r\n\r\n\tfunction open(popup,options) {\r\n\t\tif (options.around) {\r\n\t\t\t//A DOM node that should be used as a reference point for placing the pop-up. \r\n\t\t}\r\n\r\n\t\tlet $popup = $(popup);\r\n\r\n\t\t$popup.show()\r\n\t\t\t  .removeAttr( \"aria-hidden\" )\r\n   \t\t\t  .position( options.position );\r\n\r\n   \t\tstack.push({\r\n   \t\t\tpopup : $popup[0]\r\n   \t\t})\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Close specified popup and any popups that it parented.\r\n\t * If no popup is specified, closes all popups.\r\n     */\r\n\tfunction close(popup) {\r\n\t\tvar count = 0;\r\n\r\n\t\tif (popup) {\r\n\t\t\tpopup = $(popup)[0];\r\n\t\t\tfor (var i= stack.length-1; i>=0; i--) {\r\n\t\t\t\tif (stack[i].popup == popup) {\r\n\t\t\t\t\tcount = stack.length - i; \r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcount = stack.length;\r\n\t\t}\r\n\t\tfor (var i=0; i<count ; i++ ) {\r\n\t\t\tvar top = stack.pop(),\r\n\t\t\t\t$popup = $(top.popup);\r\n\t\t\t$popup.hide()\r\n\t\t\t\t.attr( \"aria-hidden\", \"true\" );\r\n\t\t} \r\n\t}\r\n\treturn plugins.popups = {\r\n\t\taround,\r\n\t\topen,\r\n\t\tclose\r\n\t};\r\n});"]}