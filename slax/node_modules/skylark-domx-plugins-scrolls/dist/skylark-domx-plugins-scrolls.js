/**
 * skylark-domx-plugins-scrolls - The skylark scrolls plugins library for dom api extension
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx-plugins/skylark-domx-plugins-scrolls/
 * @license MIT
 */
!function(t,e){var s=e.define,require=e.require,i="function"==typeof s&&s.amd,o=!i&&"undefined"!=typeof exports;if(!i&&!s){var n={};s=e.define=function(t,e,s){"function"==typeof s?(n[t]={factory:s,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var s=e.split("/"),i=t.split("/");s.pop();for(var o=0;o<i.length;o++)"."!=i[o]&&(".."==i[o]?s.pop():s.push(i[o]));return s.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):n[t]={factory:null,resolved:!0,exports:s}},require=e.require=function(t){if(!n.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=n[t];if(!module.resolved){var s=[];module.deps.forEach(function(t){s.push(require(t))}),module.exports=module.factory.apply(e,s)||null,module.resolved=!0}return module.exports}}if(!s)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-domx-plugins-scrolls/scrolls",["skylark-domx-plugins-base/plugins"],function(t){"use strict";return t.scrolls={}}),t("skylark-domx-plugins-scrolls/affix",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(t,e,s,i,o,n,r,l){"use strict";var a=r.Plugin.inherit({klassName:"Affix",pluginName:"lark.scrolls.affix",options:{offset:0,target:window},_construct:function(e,s){this.overrided(e,s),this.$target=n(this.options.target).on("scroll.affix.data-api",t.proxy(this.checkPosition,this)).on("click.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=this.$(),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()},getState:function(t,e,s,i){var o=this.$target.scrollTop(),n=this.$element.offset(),r=this.$target.height();if(null!=s&&"top"==this.affixed)return o<s&&"top";if("bottom"==this.affixed)return null!=s?!(o+this.unpin<=n.top)&&"bottom":!(o+r<=t-i)&&"bottom";var l=null==this.affixed,a=l?o:n.top,c=l?r:e;return null!=s&&o<=s?"top":null!=i&&a+c>=t-i&&"bottom"},getPinnedOffset:function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(a.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},checkPositionWithEventLoop:function(){setTimeout(t.proxy(this.checkPosition,this),1)},checkPosition:function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,o=e.bottom,r=Math.max(n(document).height(),n(document.body).height());"object"!=typeof e&&(o=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof o&&(o=e.bottom(this.$element));var l=this.getState(r,t,i,o);if(this.affixed!=l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),h=s.create(c+".affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(a.RESET).addClass(c).trigger(c.replace("affix","affixed")+".affix")}"bottom"==l&&this.$element.offset({top:r-t-o})}}});return a.RESET="affix affix-top affix-bottom",r.register(a),l.Affix=a}),t("skylark-domx-plugins-scrolls/infinite-scroll",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(t,e,s,i,o,n,r,l){"use strict";var a=r.Plugin.inherit({klassName:"InfiniteScroll",pluginName:"lark.scrolls.infinitescroll",options:{dataSource:null,hybrid:!1,percentage:95},_construct:function(e,s){this.overrided(e,s),this.$element=this.$(),this.$element.addClass("infinitescroll"),this.curScrollTop=this.$element.scrollTop(),this.curPercentage=this.getPercentage(),this.fetchingData=!1,this.$element.on("scroll.domx.infinitescroll",t.proxy(this.onScroll,this)),this.onScroll()},destroy:function(){return this.$element.remove(),this.$element.empty(),this.$element[0].outerHTML},disable:function(){this.$element.off("scroll.domx.infinitescroll")},enable:function(){this.$element.on("scroll.domx.infinitescroll",t.proxy(this.onScroll,this))},end:function(t){var e=n('<div class="infinitescroll-end"></div>');t?e.append(t):e.append("---------"),this.$element.append(e),this.disable()},getPercentage:function(){var t="border-box"===this.$element.css("box-sizing")?this.$element.outerHeight():this.$element.height(),e=this.$element.get(0).scrollHeight;return e>t?t/(e-this.curScrollTop)*100:0},fetchData:function(t){var e,s=n('<div class="infinitescroll-load"></div>'),i=this,o=function(){var t={percentage:i.curPercentage,scrollTop:i.curScrollTop},e=n('<div class="loader"></div>');s.append(e),e.loader(),i.options.dataSource&&i.options.dataSource(t,function(t){var e;s.remove(),t.content&&i.$element.append(t.content),t.end&&(e=!0!==t.end?t.end:void 0,i.end(e)),i.fetchingData=!1})};this.fetchingData=!0,this.$element.append(s),this.options.hybrid&&!0!==t?(e=n('<button type="button" class="btn btn-primary"></button>'),"object"==typeof this.options.hybrid?e.append(this.options.hybrid.label):e.append('<span class="glyphicon glyphicon-repeat"></span>'),e.on("click.domx.infinitescroll",function(){e.remove(),o()}),s.append(e)):o()},onScroll:function(t){this.curScrollTop=this.$element.scrollTop(),this.curPercentage=this.getPercentage(),!this.fetchingData&&this.curPercentage>=this.options.percentage&&this.fetchData()}});return r.register(a),l.InfiniteScroll=a}),t("skylark-domx-plugins-scrolls/scrolling-element",["./scrolls"],function(t){return t.scrollingElement=function(){return document.scrollingElement||document.documentElement}}),t("skylark-domx-plugins-scrolls/scroll-spy",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(t,e,s,i,o,n,r,l){"use strict";var a=r.Plugin.inherit({klassName:"ScrollSpy",pluginName:"lark.scrolls.scrollspy",options:{offset:10},_construct:function(e,s){this.overrided(e,s),this.$body=n(document.body),this.$scrollElement=this.$().is(document.body)?n(window):this.$(),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()},getScrollHeight:function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},refresh:function(){var e=this,s="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(s="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=n(this),e=t.data("target")||t.attr("href"),o=/^#./.test(e)&&n(e);return o&&o.length&&o.is(":visible")&&[[o[s]().top+i,e]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},process:function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,s=this.getScrollHeight(),i=this.options.offset+s-this.$scrollElement.height(),o=this.offsets,n=this.targets,r=this.activeTarget;if(this.scrollHeight!=s&&this.refresh(),e>=i)return r!=(t=n[n.length-1])&&this.activate(t);if(r&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)r!=n[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(n[t])},activate:function(t){this.activeTarget=t,this.clear();var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',s=n(e).parents("li").addClass("active");s.parent(".dropdown-menu").length&&(s=s.closest("li.dropdown").addClass("active")),s.trigger("activate.scrollspy")},clear:function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active")}});return r.register(a),l.ScrollSpy=a}),t("skylark-domx-plugins-scrolls/main",["./scrolls","./affix","./infinite-scroll","./scrolling-element","./scroll-spy"],function(t){return t}),t("skylark-domx-plugins-scrolls",["skylark-domx-plugins-scrolls/main"],function(t){return t})}(s),!i){var r=require("skylark-langx-ns");o?module.exports=r:e.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-scrolls.js.map
