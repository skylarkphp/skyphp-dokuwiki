{"version":3,"sources":["EasyEditor.js"],"names":["define","skylark","langx","browser","noder","eventer","finder","datax","$","plugins","EasyEditor","Plugin","inherit","klassName","_construct","element","options","this","elem","className","buttons","buttonsHtml","overwriteButtonSettings","css","onLoaded","randomString","Math","random","toString","substring","theme","dropdown","characterLimit","characterLimitText","characterLimitPreventKeypress","attachEvents","bootstrap","addToolbar","handleKeypress","handleResizeImage","utils","call","enableCharacterLimit","detachEvents","closest","find","remove","removeClass","removeAttr","unwrap","tag","prop","toLowerCase","placeholderText","attr","marginTop","marginBottom","style","length","after","val","hide","addClass","document","getElementById","wrap","$wrapperElem","parent","containerClass","get","_this","keydown","e","keyCode","isSelectionInsideElement","preventDefault","shiftKey","execCommand","addEventListener","text","clipboardData","getData","replace","tagName","sel","containerNode","toUpperCase","window","getSelection","rangeCount","getRangeAt","commonAncestorContainer","selection","type","createRange","parentElement","nodeType","parentNode","before","$toolbarContainer","populateButtons","injectButton","settings","buttonTitle","undefined","buttonIdentifier","newSettings","extend","buttonHtml","childOf","$parentContainer","append","children","clickHandler","on","event","hasChild","stopPropagation","trigger","openDropdownOf","identifier","show","each","index","button","width","click","removeFormatting","arg","inFullArea","isSelectionOutsideOfEditor","selectedText","range","$parent","node","createElement","html","deleteContents","insertNode","contents","topMostParent","hasParentNode","parentsUntil","el","removeEmptyTags","removeBlockElementFromSelection","removeBr","removeBrNode","selectedHtml","cloneContents","temp","replaceWith","childNodes","wrapSelectionWithNodeName","name","blockElement","class","attribute","keepHtml","nodeName","isWrapped","isAlreadyWrapped","cloneRange","addAttribute","selectionContainsHtml","clonedSelection","div","appendChild","innerHTML","textContent","localName","surroundContents","removeAllRanges","addRange","removeWrappedDuplicateTag","wrapSelectionWithList","tagname","listArray","split","filter","v","wrappedListHtml","map","item","trim","startContainer","result","hasClass","inArray","isArray","pair","insertAtCaret","appendTo","elementContainsSelection","isActive","readonly","isOrContains","container","i","insertHtml","bindData","closeModal","clearTimeout","setTimeout","getValue","plainText","characterCount","wordCount","currentCharacterCount","remainingCount","$dom","getYoutubeVideoIdFromUrl","url","openModal","selector","$temp","focus","bold","italic","h2","h3","h4","x","alignleft","aligncenter","alignright","quote","code","link","prompt","list","source","thisButton","$tempTextarea","$elem","top","offset","left","outerWidth","height","outerHeight","fn","easyEditor","data"],"mappings":"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","file":"../EasyEditor.js","sourcesContent":["define([\r\n  \"skylark-langx/skylark\",\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-finder\",\r\n  \"skylark-domx-data\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins-base\"\r\n],function(skylark, langx, browser, noder, eventer,finder, datax,$,   plugins) {\r\n\r\n\r\n    'use strict';\r\n\r\n\r\n  \tvar EasyEditor =  plugins.Plugin.inherit({\r\n\t    klassName : \"EasyEditor\",\r\n\t   \r\n\t    _construct : function( element, options ){\r\n\t        this.elem = element;\r\n\t        options = options || {};\r\n\t        this.className = options.className || 'easyeditor';\r\n\r\n\t        // 'bold', 'italic', 'link', 'h2', 'h3', 'h4', 'alignleft', 'aligncenter', 'alignright', 'quote', 'code', 'list', 'x', 'source'\r\n\t        var defaultButtons = ['bold', 'italic', 'link', 'h2', 'h3', 'h4', 'alignleft', 'aligncenter', 'alignright'];\r\n\t        this.buttons = options.buttons || defaultButtons;\r\n\t        this.buttonsHtml = options.buttonsHtml || null;\r\n\t        this.overwriteButtonSettings = options.overwriteButtonSettings || null;\r\n\t        this.css = options.css || null;\r\n\t        this.onLoaded = typeof options.onLoaded === 'function' ? options.onLoaded : null;\r\n\t        this.randomString = \"cls\"+Math.random().toString(36).substring(7);\r\n\t        this.theme = options.theme || null;\r\n\t        this.dropdown = options.dropdown || {};\r\n\t        this.characterLimit = options.characterLimit || null;\r\n\t        this.characterLimitText = options.characterLimitText || null;\r\n\t        this.characterLimitPreventKeypress = options.characterLimitPreventKeypress || false;\r\n\r\n\t        this.attachEvents();\r\n\t    },\r\n\r\n\t    // initialize\r\n\t    attachEvents: function() {\r\n\t        this.bootstrap();\r\n\t        this.addToolbar();\r\n\t        this.handleKeypress();\r\n\t        this.handleResizeImage();\r\n\t        this.utils();\r\n\r\n\t        if(this.onLoaded !== null) {\r\n\t            this.onLoaded.call(this, this);\r\n\t        }\r\n\t        \r\n\t        if (this.characterLimit) {\r\n\t            this.enableCharacterLimit();\r\n\t        }\r\n\t    },\r\n\r\n\t    // destory editor\r\n\t    detachEvents : function() {\r\n\t        var _this = this;\r\n\t        var $container = $(_this.elem).closest('.' + _this.className +'-wrapper');\r\n\t        var $toolbar = $container.find('.' + _this.className +'-toolbar');\r\n\r\n\t        $toolbar.remove();\r\n\t        $(_this.elem).removeClass(_this.className).removeAttr('contenteditable').unwrap();\r\n\t    },\r\n\r\n\t    // Adding necessary classes and attributes in editor\r\n\t    bootstrap : function() {\r\n\t        var _this = this;\r\n\t        var tag = $(_this.elem).prop('tagName').toLowerCase();\r\n\r\n\t        if(tag === 'textarea' || tag === 'input') {\r\n\t            var placeholderText = $(_this.elem).attr('placeholder') || '';\r\n\r\n\t            var marginTop = $(_this.elem).css('marginTop') || 0;\r\n\t            var marginBottom = $(_this.elem).css('marginBottom') || 0;\r\n\t            var style = '';\r\n\t            if(marginTop.length > 0 || marginBottom.length > 0) {\r\n\t                style = ' style=\"margin-top: ' + marginTop + '; margin-bottom: ' + marginBottom + '\" ';\r\n\t            }\r\n\r\n\t            $(_this.elem).after('<div id=\"' + _this.randomString + '-editor\" placeholder=\"' + placeholderText + '\">' + $(_this.elem).val() + '</div>');\r\n\t            $(_this.elem).hide().addClass(_this.randomString + '-bind');\r\n\r\n\t            _this.elem = document.getElementById(_this.randomString + '-editor');\r\n\t            $(_this.elem).attr('contentEditable', true).addClass(_this.className).wrap('<div class=\"'+ _this.className +'-wrapper\"' + style + '></div>');\r\n\t        }\r\n\t        else {\r\n\t            $(_this.elem).attr('contentEditable', true).addClass(_this.className).wrap('<div class=\"'+ _this.className +'-wrapper\"></div>');\r\n\t        }\r\n\r\n\t        this.$wrapperElem = $(_this.elem).parent();\r\n\r\n\t        if(_this.css !== null) {\r\n\t            $(_this.elem).css(_this.css);\r\n\t        }\r\n\r\n\t        this.containerClass = '.' + _this.className +'-wrapper';\r\n\r\n\t        if(typeof _this.elem === 'string') {\r\n\t            _this.elem = $(_this.elem).get(0);\r\n\t        }\r\n\r\n\t        if(_this.theme !== null) {\r\n\t            $(_this.elem).closest(_this.containerClass).addClass(_this.theme);\r\n\t        }\r\n\t    },\r\n\r\n\t    // enter and paste key handler\r\n\t    handleKeypress : function(){\r\n\t        var _this = this;\r\n\r\n\t        $(_this.elem).keydown(function(e) {\r\n\t            if(e.keyCode === 13 && _this.isSelectionInsideElement('li') === false) {\r\n\t                e.preventDefault();\r\n\r\n\t                if(e.shiftKey === true) {\r\n\t                    document.execCommand('insertHTML', false, '<br>');\r\n\t                }\r\n\t                else {\r\n\t                    document.execCommand('insertHTML', false, '<br><br>');\r\n\t                }\r\n\r\n\t                return false;\r\n\t            }\r\n\t        });\r\n\r\n\t        _this.elem.addEventListener('paste', function(e) {\r\n\t            e.preventDefault();\r\n\t            var text = e.clipboardData.getData('text/plain').replace(/\\n/ig, '<br>');\r\n\t            document.execCommand('insertHTML', false, text);\r\n\t        });\r\n\r\n\t    },\r\n\r\n\t    isSelectionInsideElement : function(tagName) {\r\n\t        var sel, containerNode;\r\n\t        tagName = tagName.toUpperCase();\r\n\t        if (window.getSelection) {\r\n\t            sel = window.getSelection();\r\n\t            if (sel.rangeCount > 0) {\r\n\t                containerNode = sel.getRangeAt(0).commonAncestorContainer;\r\n\t            }\r\n\t        } else if ( (sel = document.selection) && sel.type != \"Control\" ) {\r\n\t            containerNode = sel.createRange().parentElement();\r\n\t        }\r\n\t        while (containerNode) {\r\n\t            if (containerNode.nodeType == 1 && containerNode.tagName == tagName) {\r\n\t                return true;\r\n\t            }\r\n\t            containerNode = containerNode.parentNode;\r\n\t        }\r\n\t        return false;\r\n\t    },\r\n\r\n\t    // adding toolbar\r\n\t    addToolbar : function(){\r\n\t        var _this = this;\r\n\r\n\t        $(_this.elem).before('<div class=\"'+ _this.className +'-toolbar\"><ul></ul></div>');\r\n\t        this.$toolbarContainer = this.$wrapperElem.find('.' + _this.className +'-toolbar');\r\n\r\n\t        this.populateButtons();\r\n\t    },\r\n\r\n\t    // inejct button events\r\n\t    injectButton : function(settings){\r\n\t        var _this = this;\r\n\r\n\t        // overwritting default button settings\r\n\t        if(_this.overwriteButtonSettings !== null && _this.overwriteButtonSettings[settings.buttonIdentifier] !== undefined) {\r\n\t            var newSettings = langx.extend({}, settings, _this.overwriteButtonSettings[settings.buttonIdentifier]);\r\n\t            settings = newSettings;\r\n\t        }\r\n\r\n\t        // if button html exists overwrite default button html\r\n\t        if(_this.buttonsHtml !== null && _this.buttonsHtml[settings.buttonIdentifier] !== undefined) {\r\n\t            settings.buttonHtml = _this.buttonsHtml[settings.buttonIdentifier];\r\n\t        }\r\n\r\n\t        // if buttonTitle parameter exists\r\n\t        var buttonTitle;\r\n\t        if(settings.buttonTitle) {\r\n\t            buttonTitle = settings.buttonTitle;\r\n\t        }\r\n\t        else {\r\n\t            buttonTitle = settings.buttonIdentifier.replace(/\\W/g, ' ');\r\n\t        }\r\n\r\n\t        // adding button html\r\n\t        if(settings.buttonHtml) {\r\n\t            if(settings.childOf !== undefined) {\r\n\t                var $parentContainer = _this.$toolbarContainer.find('.toolbar-' + settings.childOf).parent('li');\r\n\r\n\t                if($parentContainer.find('ul').length === 0) {\r\n\t                    $parentContainer.append('<ul></ul>');\r\n\t                }\r\n\r\n\t                $parentContainer = $parentContainer.find('ul');\r\n\t                $parentContainer.append('<li><button type=\"button\" class=\"toolbar-'+ settings.buttonIdentifier +'\" title=\"'+ buttonTitle +'\">'+ settings.buttonHtml +'</button></li>');\r\n\t            }\r\n\t            else {\r\n\t                _this.$toolbarContainer.children('ul').append('<li><button type=\"button\" class=\"toolbar-'+ settings.buttonIdentifier +'\" title=\"'+ buttonTitle +'\">'+ settings.buttonHtml +'</button></li>');\r\n\t            }\r\n\t        }\r\n\r\n\t        // bind click event\r\n\t        if(typeof settings.clickHandler === 'function') {\r\n\t            $(_this.elem).closest(_this.containerClass).on('click', '.toolbar-'+ settings.buttonIdentifier, function(event){\r\n\t                if(typeof settings.hasChild !== undefined && settings.hasChild === true) {\r\n\t                    event.stopPropagation();\r\n\t                }\r\n\t                else {\r\n\t                    event.preventDefault();\r\n\t                }\r\n\r\n\t                settings.clickHandler.call(this, this);\r\n\t                $(_this.elem).trigger('keyup');\r\n\t            });\r\n\t        }\r\n\t    },\r\n\r\n\t    // open dropdown\r\n\t    openDropdownOf : function(identifier){\r\n\t        var _this = this;\r\n\t        $(_this.elem).closest(_this.containerClass).find('.toolbar-' + identifier).parent().children('ul').show();\r\n\t    },\r\n\r\n\t    // bidning all buttons\r\n\t    populateButtons : function(){\r\n\t        var _this = this;\r\n\r\n\t        langx.each(_this.buttons, function(index, button) {\r\n\t            if(typeof _this[button] === 'function'){\r\n\t                _this[button]();\r\n\t            }\r\n\t        });\r\n\r\n\t    },\r\n\r\n\t    // allowing resizing image\r\n\t    handleResizeImage : function(){\r\n\t        var _this = this;\r\n\r\n\t        $('html').on('click', _this.containerClass + ' figure', function(event) {\r\n\t            event.stopPropagation();\r\n\t            $(this).addClass('is-resizable');\r\n\t        });\r\n\r\n\t        $('html').on('mousemove', _this.containerClass + ' figure.is-resizable', function(event) {\r\n\t            $(this).find('img').css({ 'width' : $(this).width() + 'px' });\r\n\t        });\r\n\r\n\t        $(document).click(function() {\r\n\t            $(_this.elem).find('figure').removeClass('is-resizable');\r\n\t        });\r\n\t    },\r\n\r\n\t    // get selection\r\n\t    getSelection : function(){\r\n\t        if (window.getSelection) {\r\n\t            var selection = window.getSelection();\r\n\r\n\t            if (selection.rangeCount) {\r\n\t                return selection;\r\n\t            }\r\n\t        }\r\n\r\n\t        return false;\r\n\t    },\r\n\r\n\t    // remove formatting\r\n\t    removeFormatting : function(arg){\r\n\t        var _this = this;\r\n\t        var inFullArea = arg.inFullArea;\r\n\r\n\t        if(_this.isSelectionOutsideOfEditor() === true) {\r\n\t            return false;\r\n\t        }\r\n\r\n\t        if(inFullArea === false) {\r\n\t            var selection = _this.getSelection();\r\n\t            var selectedText = selection.toString();\r\n\r\n\t            if(selection && selectedText.length > 0) {\r\n\r\n\t                var range = selection.getRangeAt(0);\r\n\t                var $parent = $(range.commonAncestorContainer.parentNode);\r\n\r\n\t                if($parent.attr('class') === _this.className || $parent.attr('class') === _this.className + '-wrapper') {\r\n\t                    var node = document.createElement('span');\r\n\t                    $(node).attr('data-value', 'temp').html(selectedText.replace(/\\n/ig, '<br>'));\r\n\t                    range.deleteContents();\r\n\t                    range.insertNode(node);\r\n\r\n\t                    $('[data-value=\"temp\"]').contents().unwrap();\r\n\t                }\r\n\t                else {\r\n\r\n\t                    var topMostParent;\r\n\t                    var hasParentNode = false;\r\n\t                    langx.each($parent.parentsUntil(_this.elem), function(index, el) {\r\n\t                        topMostParent = el;\r\n\t                        hasParentNode = true;\r\n\t                    });\r\n\r\n\t                    if(hasParentNode === true) {\r\n\t                        $(topMostParent).html($(topMostParent).text().replace(/\\n/ig, '<br>')).contents().unwrap();\r\n\t                    }\r\n\t                    else {\r\n\t                        $parent.contents().unwrap();\r\n\t                    }\r\n\r\n\t                }\r\n\r\n\t            }\r\n\t        }\r\n\t        else {\r\n\t            $(_this.elem).html($(_this.elem).text().replace(/\\n/ig, '<br>'));\r\n\t        }\r\n\r\n\t        // _this.removeEmptyTags();\r\n\t    },\r\n\r\n\t    // removing empty tags\r\n\t    removeEmptyTags : function(){\r\n\t        var _this = this;\r\n\t        $(_this.elem).html( $(_this.elem).html().replace(/(<(?!\\/)[^>]+>)+(<\\/[^>]+>)+/, '') );\r\n\t    },\r\n\r\n\t    // remove block elemenet from selection\r\n\t    removeBlockElementFromSelection : function(selection, removeBr){\r\n\t        var _this = this;\r\n\t        var result;\r\n\r\n\t        removeBr = removeBr === undefined ? false : removeBr;\r\n\t        var removeBrNode = '';\r\n\t        if(removeBr === true) {\r\n\t            removeBrNode = ', br';\r\n\t        }\r\n\r\n\t        var range = selection.getRangeAt(0);\r\n\t        var selectedHtml = range.cloneContents();\r\n\t        var temp = document.createElement('temp');\r\n\t        $(temp).html(selectedHtml);\r\n\t        $(temp).find('h1, h2, h3, h4, h5, h6, p, div' + removeBrNode).each(function() { $(this).replaceWith(this.childNodes); });\r\n\t        result = $(temp).html();\r\n\r\n\t        return result;\r\n\t    },\r\n\r\n\t    // wrap selction with a tag\r\n\t    wrapSelectionWithNodeName : function(arg){\r\n\t        var _this = this;\r\n\t        if(_this.isSelectionOutsideOfEditor() === true) {\r\n\t            return false;\r\n\t        }\r\n\r\n\t        var node = {\r\n\t            name: 'span',\r\n\t            blockElement: false,\r\n\t            style: null,\r\n\t            class: null,\r\n\t            attribute: null,\r\n\t            keepHtml: false\r\n\t        };\r\n\r\n\t        if(typeof arg === 'string') {\r\n\t            node.name = arg;\r\n\t        }\r\n\t        else {\r\n\t            node.name = arg.nodeName || node.name;\r\n\t            node.blockElement = arg.blockElement || node.blockElement;\r\n\t            node.style = arg.style || node.style;\r\n\t            node.class = arg.class || node.class;\r\n\t            node.attribute = arg.attribute || node.attribute;\r\n\t            node.keepHtml = arg.keepHtml || node.keepHtml;\r\n\t        }\r\n\r\n\t        var selection = _this.getSelection();\r\n\r\n\t        if(selection && selection.toString().length > 0 && selection.rangeCount) {\r\n\t            // checking if already wrapped\r\n\t            var isWrapped = _this.isAlreadyWrapped(selection, node);\r\n\r\n\t            // wrap node\r\n\t            var range = selection.getRangeAt(0).cloneRange();\r\n\t            var tag = document.createElement(node.name);\r\n\r\n\t                // adding necessary attribute to tag\r\n\t                if(node.style !== null || node.class !== null || node.attribute !== null) {\r\n\t                    tag = _this.addAttribute(tag, node);\r\n\t                }\r\n\r\n\t            // if selection contains html, surround contents has some problem with pre html tag and raw text selection\r\n\t            if(_this.selectionContainsHtml(range)) {\r\n\t                range = selection.getRangeAt(0);\r\n\r\n\t                if(node.keepHtml === true) {\r\n\t                    var clonedSelection = range.cloneContents();\r\n\t                    var div = document.createElement('div');\r\n\t                    div.appendChild(clonedSelection);\r\n\t                    $(tag).html(div.innerHTML);\r\n\t                }\r\n\t                else {\r\n\t                    tag.textContent = selection.toString();\r\n\t                }\r\n\r\n\t                range.deleteContents();\r\n\t                range.insertNode(tag);\r\n\r\n\t                if(range.commonAncestorContainer.localName === node.name) {\r\n\t                    $(range.commonAncestorContainer).contents().unwrap();\r\n\t                    _this.removeEmptyTags();\r\n\t                }\r\n\t            }\r\n\t            else {\r\n\t                range.surroundContents(tag);\r\n\t                selection.removeAllRanges();\r\n\t                selection.addRange(range);\r\n\t            }\r\n\r\n\t            if(isWrapped === true) {\r\n\t                _this.removeWrappedDuplicateTag(tag);\r\n\t            }\r\n\r\n\t            _this.removeEmptyTags();\r\n\t            selection.removeAllRanges();\r\n\t        }\r\n\t    },\r\n\r\n\t    // wrap selection with unordered list\r\n\t    wrapSelectionWithList : function(tagname){\r\n\t        var _this = this;\r\n\t        tagname = tagname || 'ul';\r\n\r\n\t        // preventing outside selection\r\n\t        if(_this.isSelectionOutsideOfEditor() === true) {\r\n\t            return false;\r\n\t        }\r\n\r\n\t        // if text selected\r\n\t        var selection = _this.getSelection();\r\n\t        if(selection && selection.toString().length > 0 && selection.rangeCount) {\r\n\t            var selectedHtml = _this.removeBlockElementFromSelection(selection, true);\r\n\t            var listArray = selectedHtml.split('\\n').filter(function(v){return v!=='';});\r\n\t            var wrappedListHtml = langx.map(listArray, function(item) {\r\n\t                return '<li>' + langx.trim(item) + '</li>';\r\n\t            });\r\n\r\n\t            var node = document.createElement(tagname);\r\n\t            $(node).html(wrappedListHtml);\r\n\r\n\t            var range = selection.getRangeAt(0);\r\n\t            range.deleteContents();\r\n\t            range.insertNode(node);\r\n\r\n\t            selection.removeAllRanges();\r\n\t        }\r\n\r\n\t    },\r\n\r\n\t    // if selection contains html tag, surround content fails if selection contains html\r\n\t    selectionContainsHtml : function(range){\r\n\t        var _this = this;\r\n\t        if(range.startContainer.parentNode.className === _this.className + '-wrapper') return false;\r\n\t        else return true;\r\n\t    },\r\n\r\n\t    // if already wrapped with same tag\r\n\t    isAlreadyWrapped : function(selection, node){\r\n\t        var _this = this;\r\n\t        var range = selection.getRangeAt(0);\r\n\t        var el = $(range.commonAncestorContainer);\r\n\t        var result = false;\r\n\r\n\t        if( el.parent().prop('tagName').toLowerCase() === node.name && el.parent().hasClass(_this.className) === false ) {\r\n\t            result = true;\r\n\t        }\r\n\t        else if(node.blockElement === true) {\r\n\t            langx.each(el.parentsUntil(_this.elem), function(index, el) {\r\n\t                var tag = el.tagName.toLowerCase();\r\n\t                if( langx.inArray(tag, ['h1', 'h2', 'h3', 'h4', 'h5', 'h6']) !== -1 ) {\r\n\t                    result = true;\r\n\t                }\r\n\t            });\r\n\t        }\r\n\t        else {\r\n\t            langx.each(el.parentsUntil(_this.elem), function(index, el) {\r\n\t                var tag = el.tagName.toLowerCase();\r\n\t                if( tag === node.name ) {\r\n\t                    result = true;\r\n\t                }\r\n\t            });\r\n\t        }\r\n\r\n\t        return result;\r\n\t    },\r\n\r\n\t    // remove wrap if already wrapped with same tag\r\n\t    removeWrappedDuplicateTag : function(tag){\r\n\t        var _this = this;\r\n\t        var tagName = tag.tagName;\r\n\r\n\t        $(tag).unwrap();\r\n\r\n\t        if($(tag).prop('tagName') === tagName && $(tag).parent().hasClass(_this.className) === false && $(tag).parent().hasClass(_this.className + '-wrapper')) {\r\n\t            $(tag).unwrap();\r\n\t        }\r\n\t    },\r\n\r\n\t    // adding attribute in tag\r\n\t    addAttribute : function(tag, node){\r\n\t        if(node.style !== null) {\r\n\t            $(tag).attr('style', node.style);\r\n\t        }\r\n\r\n\t        if(node.class !== null) {\r\n\t            $(tag).addClass(node.class);\r\n\t        }\r\n\r\n\t        if(node.attribute !== null) {\r\n\t            if(langx.isArray(node.attribute) === true) {\r\n\t                if(langx.isArray(node.attribute[0]) !== true){\r\n\t                    node.attribute[0] = [node.attribute[0], node.attribute[1]];\r\n\t                }\r\n\t                langx.each(node.attribute,function(index,pair){\r\n\t                    $(tag).attr(pair[0], pair[1]);\r\n\t                });\r\n\t            }\r\n\t            else {\r\n\t                $(tag).attr(node.attribute);\r\n\t            }\r\n\t        }\r\n\r\n\t        return tag;\r\n\t    },\r\n\r\n\t    // insert a node into cursor point in editor\r\n\t    insertAtCaret : function(node){\r\n\t        var _this = this;\r\n\t        if(_this.isSelectionOutsideOfEditor() === true) {\r\n\t            return false;\r\n\t        }\r\n\r\n\t        if(_this.getSelection()) {\r\n\t            var range = _this.getSelection().getRangeAt(0);\r\n\t            range.insertNode(node);\r\n\t        }\r\n\t        else {\r\n\t            $(node).appendTo(_this.elem);\r\n\t        }\r\n\t    },\r\n\r\n\t    // checking if selection outside of editor or not\r\n\t    isSelectionOutsideOfEditor : function(){\r\n\t        return !this.elementContainsSelection(this.elem);\r\n\t    },\r\n\r\n        isActive : function(){\r\n            //return false;\r\n            return this.elementContainsSelection(this.elem);\r\n        },\r\n\r\n        readonly : function(readonly) {\r\n            if (readonly === undefined) {\r\n                return $(this.elem).attr('contentEditable');\r\n            } else {\r\n                $(this.elem).attr('contentEditable', readonly && true);\r\n                return this;\r\n            }\r\n        },\r\n    \r\n\r\n\t    // node contains in containers or not\r\n\t    isOrContains : function(node, container) {\r\n\t        while (node) {\r\n\t            if (node === container) {\r\n\t                return true;\r\n\t            }\r\n\t            node = node.parentNode;\r\n\t        }\r\n\t        return false;\r\n\t    },\r\n\r\n\t    // selected text is inside container\r\n\t    elementContainsSelection : function(el) {\r\n\t        var _this = this;\r\n\t        var sel;\r\n\t        if (window.getSelection) {\r\n\t            sel = window.getSelection();\r\n\t            if (sel.rangeCount > 0) {\r\n\t                for (var i = 0; i < sel.rangeCount; ++i) {\r\n\t                    if (!_this.isOrContains(sel.getRangeAt(i).commonAncestorContainer, el)) {\r\n\t                        return false;\r\n\t                    }\r\n\t                }\r\n\t                return true;\r\n\t            }\r\n\t        } else if ( (sel = document.selection) && sel.type !== \"Control\") {\r\n\t            return _this.isOrContains(sel.createRange().parentElement(), el);\r\n\t        }\r\n\t        return false;\r\n\t    },\r\n\r\n\t    // insert html chunk into editor's temp tag\r\n\t    insertHtml : function(html){\r\n\t        var _this = this;\r\n\t        $(_this.elem).find('temp').html(html);\r\n\t    },\r\n\r\n\t    // utility of editor\r\n\t    utils : function(){\r\n\t        var _this = this;\r\n\r\n\t        $('html').on('click', '.'+ _this.className +'-modal-close', function(event) {\r\n\t            event.preventDefault();\r\n\t            _this.closeModal('#' + $(this).closest('.'+ _this.className + '-modal').attr('id'));\r\n\t        });\r\n\t        \r\n\t        // binding value in textarea if present\r\n\t        if( $('.' + _this.randomString + '-bind').length > 0 ) {\r\n\t            var bindData;\r\n\t            $('html').on('click keyup', _this.elem, function() {\r\n\t                var el = _this.elem;\r\n\t                clearTimeout(bindData);\r\n\t                bindData = setTimeout(function(){ $('.' + _this.randomString + '-bind').html( $(el).html() ); }, 250);\r\n\t            });\r\n\t        }\r\n\r\n\t        $(document).click(function(event) {\r\n\t            $('.' + _this.className).closest('.' + _this.className + '-wrapper').find('.' + _this.className + '-toolbar > ul > li > ul').hide();\r\n\t        });\r\n\t    },\r\n\t    \r\n\t    // Get value of current easy editor\r\n\t    getValue : function() {\r\n\t        var _this = this;\r\n\t        \r\n\t        var html = $(_this.elem).html();\r\n\t        var plainText = $(_this.elem).text();\r\n\t        var characterCount = plainText.length;\r\n\t        var wordCount = plainText.trim().split(/\\s+/).length;\r\n\t        \r\n\t        return {\r\n\t            html: html,\r\n\t            plainText: plainText,\r\n\t            characterCount: characterCount,\r\n\t            wordCount: wordCount\r\n\t        };\r\n\t    },\r\n\t    \r\n\t    \r\n\t    // Enable character limit\r\n\t    enableCharacterLimit : function() {\r\n\t        var _this = this;\r\n\t        \r\n\t        var currentCharacterCount = _this.characterLimit - _this.getValue().characterCount;\r\n\t        $(_this.elem).after('<div class=\"'+ _this.className +'-character-remaining '+ ((currentCharacterCount <= 0) ? 'is-invalid' : 'is-valid') +'\">'+ (_this.characterLimitText ? _this.characterLimitText + ' ' + currentCharacterCount : currentCharacterCount) +'</div>');\r\n\t        \r\n\t        $('html').on('keyup', _this.elem, function(){\r\n\t            var val = _this.getValue();\r\n\t            var remainingCount = _this.characterLimit - val.characterCount;\r\n\t            var $dom = $(_this.containerClass).find('[class*=\"-character-remaining\"]');\r\n\t            \r\n\t            if (_this.characterLimitText) {\r\n\t                $dom.text(_this.characterLimitText + ' ' + remainingCount);\r\n\t            } else {\r\n\t                $dom.text(remainingCount);\r\n\t            }\r\n\t            \r\n\t            if (remainingCount <= 0) {\r\n\t                $dom.removeClass('is-valid').addClass('is-invalid');\r\n\t            } else {\r\n\t                $dom.removeClass('is-invalid').addClass('is-valid');\r\n\t            }\r\n\t        });\r\n\t        \r\n\t        $('html').on('keypress', _this.elem, function(){\r\n\t            var val = _this.getValue();\r\n\t            \r\n\t            if (_this.characterLimitPreventKeypress && _this.characterLimit <= val.characterCount) {\r\n\t                return false;\r\n\t            }\r\n\t        });\r\n\t    },\r\n\t    \r\n\r\n\t    // youtube video id from url\r\n\t    getYoutubeVideoIdFromUrl : function(url){\r\n\t        if(url.length === 0) return false;\r\n\t        var videoId = '';\r\n\t        url = url.replace(/(>|<)/gi,'').split(/(vi\\/|v=|\\/v\\/|youtu\\.be\\/|\\/embed\\/)/);\r\n\t        if(url[2] !== undefined) {\r\n\t            videoId = url[2].split(/[^0-9a-z_\\-]/i);\r\n\t            videoId = videoId[0];\r\n\t        }\r\n\t        else {\r\n\t            videoId = url;\r\n\t        }\r\n\t        return videoId;\r\n\t    },\r\n\r\n\t    // opening modal window\r\n\t    openModal : function(selector){\r\n\t        var temp = document.createElement('temp');\r\n\t        temp.textContent = '.';\r\n\t        this.insertAtCaret(temp);\r\n\r\n\t        $(selector).removeClass('is-hidden');\r\n\t    },\r\n\r\n\t    // closing modal window\r\n\t    closeModal : function(selector){\r\n\t        var _this = this;\r\n\r\n\t        $(selector).addClass('is-hidden').find('input').val('');\r\n\t        $(selector).find('.' + _this.className + '-modal-content-body-loader').css('width', '0');\r\n\t        var $temp = $(this.elem).find('temp');\r\n\r\n\t        if($temp.html() === '.') {\r\n\t            $temp.remove();\r\n\t        }\r\n\t        else {\r\n\t            $temp.contents().unwrap();\r\n\t        }\r\n\r\n\t        $(this.elem).focus();\r\n\t    },\r\n\r\n\t    bold : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'bold',\r\n\t            buttonHtml: 'B',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'strong', keepHtml: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    italic : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'italic',\r\n\t            buttonHtml: 'I',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'em', keepHtml: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    h2 : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'header-2',\r\n\t            buttonHtml: 'H2',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'h2', blockElement: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    h3 : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'header-3',\r\n\t            buttonHtml: 'H3',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'h3', blockElement: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    h4 : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'header-4',\r\n\t            buttonHtml: 'H4',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'h4', blockElement: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    x : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'remove-formatting',\r\n\t            buttonHtml: 'x',\r\n\t            clickHandler: function(){\r\n\t                _this.removeFormatting({ inFullArea: false });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    alignleft : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'align-left',\r\n\t            buttonHtml: 'Align left',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'p', style: 'text-align: left', class: 'text-left', keepHtml: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    aligncenter : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'align-center',\r\n\t            buttonHtml: 'Align center',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'p', style: 'text-align: center', class: 'text-center', keepHtml: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    alignright : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'align-right',\r\n\t            buttonHtml: 'Align right',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'p', style: 'text-align: right', class: 'text-right', keepHtml: true });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    quote : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'quote',\r\n\t            buttonHtml: 'Quote',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'blockquote' });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    code : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'code',\r\n\t            buttonHtml: 'Code',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'pre' });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    link : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'link',\r\n\t            buttonHtml: 'Link',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithNodeName({ nodeName: 'a', attribute: ['href', prompt('Insert link', '')] });\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    list : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'list',\r\n\t            buttonHtml: 'List',\r\n\t            clickHandler: function(){\r\n\t                _this.wrapSelectionWithList();\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    },\r\n\r\n\t    source : function(){\r\n\t        var _this = this;\r\n\t        var settings = {\r\n\t            buttonIdentifier: 'source',\r\n\t            buttonHtml: 'Source',\r\n\t            clickHandler: function(thisButton){\r\n\t                var $elemContainer = $(thisButton).closest('.' + _this.className + '-wrapper');\r\n\t                var $elem = $elemContainer.find('.' + _this.className);\r\n\t                var $tempTextarea;\r\n\r\n\t                if($(thisButton).hasClass('is-view-source-mode')) {\r\n\t                    $tempTextarea = $('body > textarea.' + _this.className + '-temp');\r\n\t                    $elem.css('visibility', 'visible');\r\n\t                    $tempTextarea.remove();\r\n\t                    $(thisButton).removeClass('is-view-source-mode');\r\n\t                }\r\n\t                else {\r\n\t                    $('body').append('<textarea class=\"' + _this.className + '-temp\" style=\"position: absolute; margin: 0;\"></textarea>');\r\n\t                    $tempTextarea = $('body > textarea.' + _this.className + '-temp');\r\n\r\n\t                    $tempTextarea.css({\r\n\t                        'top' : $elem.offset().top,\r\n\t                        'left' : $elem.offset().left,\r\n\t                        'width' : $elem.outerWidth(),\r\n\t                        'height' : $elem.outerHeight()\r\n\t                    }).html( $elem.html() );\r\n\r\n\t                    if( $elem.css('border') !== undefined ) {\r\n\t                        $tempTextarea.css('border', $elem.css('border'));\r\n\t                    }\r\n\r\n\t                    $elem.css('visibility', 'hidden');\r\n\t                    $(thisButton).addClass('is-view-source-mode');\r\n\r\n\t                    $tempTextarea.on('keyup click change keypress', function() {\r\n\t                        $elem.html( $(this).val() );\r\n\t                    });\r\n\t                }\r\n\t            }\r\n\t        };\r\n\r\n\t        _this.injectButton(settings);\r\n\t    }\r\n\t});\r\n\r\n    $.fn.easyEditor = function ( options ) {\r\n        return this.each(function () {\r\n            if (!datax.data(this, 'plugin_easyEditor')) {\r\n                datax.data(this, 'plugin_easyEditor',\r\n                new EasyEditor( this, options ));\r\n            }\r\n        });\r\n    };\r\n\r\n\treturn  EasyEditor;\t\r\n});\r\n"]}