{"version":3,"sources":["plugin.js"],"names":["define","skylark","types","objects","funcs","Emitter","noder","datax","eventer","finder","geom","styler","fx","$","elmx","plugins","Array","prototype","slice","concat","parentClass","ctor","hasOwnProperty","superclass","Object","getPrototypeOf","Plugin","inherit","klassName","_construct","elm","options","this","_elm","_initOptions","constructor","cache","defaults","ctors","unshift","i","length","mixin","defineProperty","value","destroy","_destroy","unlistenTo","removeData","pluginName","noop","_delay","handler","delay","instance","setTimeout","apply","arguments","_velm","_$elm","option","key","parts","curOption","split","shift","pop","undefined","_setOptions","_setOption","getUID","prefix","Math","random","document","getElementById"],"mappings":"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","file":"../plugin.js","sourcesContent":["define([\r\n    \"skylark-langx-ns\",\r\n    \"skylark-langx-types\",\r\n    \"skylark-langx-objects\",\r\n    \"skylark-langx-funcs\",\r\n    \"skylark-langx-events/Emitter\",\r\n    \"skylark-domx-noder\",\r\n    \"skylark-domx-data\",\r\n    \"skylark-domx-eventer\",\r\n    \"skylark-domx-finder\",\r\n    \"skylark-domx-geom\",\r\n    \"skylark-domx-styler\",\r\n    \"skylark-domx-fx\",\r\n    \"skylark-domx-query\",\r\n    \"skylark-domx-velm\",\r\n    \"./plugins\"\r\n], function(\r\n    skylark,\r\n    types,\r\n    objects,\r\n    funcs,\r\n    Emitter, \r\n    noder, \r\n    datax, \r\n    eventer, \r\n    finder, \r\n    geom, \r\n    styler, \r\n    fx, \r\n    $, \r\n    elmx,\r\n    plugins\r\n) {\r\n    \"use strict\";\r\n\r\n    var slice = Array.prototype.slice,\r\n        concat = Array.prototype.concat;\r\n\r\n    function parentClass(ctor){\r\n        if (ctor.hasOwnProperty(\"superclass\")) {\r\n            return ctor.superclass;\r\n        }\r\n\r\n        return Object.getPrototypeOf(ctor);\r\n    }\r\n\r\n \r\n    var Plugin =   Emitter.inherit({\r\n        klassName: \"Plugin\",\r\n\r\n        _construct : function(elm,options) {\r\n           this._elm = elm;\r\n           this._initOptions(options);\r\n        },\r\n\r\n        _initOptions : function(options) {\r\n          var ctor = this.constructor,\r\n              cache = ctor.cache = (ctor.hasOwnProperty(\"cache\") ? ctor.cache : {}),\r\n              defaults = cache.defaults;\r\n          if (!defaults) {\r\n            var  ctors = [];\r\n            do {\r\n              ctors.unshift(ctor);\r\n              if (ctor === Plugin) {\r\n                break;\r\n              }\r\n              ctor = parentClass(ctor);\r\n            } while (ctor);\r\n\r\n            defaults = cache.defaults = {};\r\n            for (var i=0;i<ctors.length;i++) {\r\n              ctor = ctors[i];\r\n              if (ctor.prototype.hasOwnProperty(\"options\")) {\r\n                objects.mixin(defaults,ctor.prototype.options,true);\r\n              }\r\n              if (ctor.hasOwnProperty(\"options\")) {\r\n                objects.mixin(defaults,ctor.options,true);\r\n              }\r\n            }\r\n          }\r\n          Object.defineProperty(this,\"options\",{\r\n            value :objects.mixin({},defaults,options,true)\r\n          });\r\n\r\n          //return this.options = langx.mixin({},defaults,options);\r\n          return this.options;\r\n        },\r\n\r\n\r\n        destroy: function() {\r\n\r\n            this._destroy();\r\n\r\n            // remove all event lisener\r\n            this.unlistenTo();\r\n            // remove data \r\n            datax.removeData(this._elm,this.pluginName );\r\n        },\r\n\r\n        _destroy: funcs.noop,\r\n\r\n        _delay: function( handler, delay ) {\r\n            function handlerProxy() {\r\n                return ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n                    .apply( instance, arguments );\r\n            }\r\n            var instance = this;\r\n            return setTimeout( handlerProxy, delay || 0 );\r\n        },\r\n\r\n        elmx : function(elm) {\r\n            if (elm) {\r\n                return elmx(elm);\r\n            }\r\n            if (!this._velm) {\r\n                this._velm = elmx(this._elm);\r\n            }\r\n            return this._velm;\r\n        },\r\n\r\n        $ : function(elm) {\r\n            if (elm) {\r\n                return $(elm,this._elm);\r\n            }\r\n            if (!this._$elm) {\r\n                this._$elm = $(this._elm);\r\n            }            \r\n            return this._$elm;\r\n        },\r\n\r\n        option: function( key, value ) {\r\n            var options = key;\r\n            var parts;\r\n            var curOption;\r\n            var i;\r\n\r\n            if ( arguments.length === 0 ) {\r\n\r\n                // Don't return a reference to the internal hash\r\n                return objects.mixin( {}, this.options );\r\n            }\r\n\r\n            if ( typeof key === \"string\" ) {\r\n\r\n                // Handle nested keys, e.g., \"foo.bar\" => { foo: { bar: ___ } }\r\n                options = {};\r\n                parts = key.split( \".\" );\r\n                key = parts.shift();\r\n                if ( parts.length ) {\r\n                    curOption = options[ key ] = objects.mixin( {}, this.options[ key ] );\r\n                    for ( i = 0; i < parts.length - 1; i++ ) {\r\n                        curOption[ parts[ i ] ] = curOption[ parts[ i ] ] || {};\r\n                        curOption = curOption[ parts[ i ] ];\r\n                    }\r\n                    key = parts.pop();\r\n                    if ( arguments.length === 1 ) {\r\n                        return curOption[ key ] === undefined ? null : curOption[ key ];\r\n                    }\r\n                    curOption[ key ] = value;\r\n                } else {\r\n                    if ( arguments.length === 1 ) {\r\n                        return this.options[ key ] === undefined ? null : this.options[ key ];\r\n                    }\r\n                    options[ key ] = value;\r\n                }\r\n            }\r\n\r\n            this._setOptions( options );\r\n\r\n            return this;\r\n        },\r\n\r\n        _setOptions: function( options ) {\r\n            var key;\r\n\r\n            for ( key in options ) {\r\n                this._setOption( key, options[ key ] );\r\n            }\r\n\r\n            return this;\r\n        },\r\n\r\n        _setOption: function( key, value ) {\r\n\r\n            this.options[ key ] = value;\r\n\r\n            return this;\r\n        },\r\n\r\n        getUID : function (prefix) {\r\n            prefix = prefix || \"plugin\";\r\n            do prefix += ~~(Math.random() * 1000000)\r\n            while (document.getElementById(prefix))\r\n            return prefix;\r\n        },\r\n\r\n        elm : function() {\r\n            return this._elm;\r\n        }\r\n\r\n    });\r\n\r\n\r\n    return  plugins.Plugin = Plugin;\r\n});"]}