/**
 * skylark-io-diskfs - The filer features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.1
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(e,r){var n=r.define,require=r.require,t="function"==typeof n&&n.amd,a=!t&&"undefined"!=typeof exports;if(!t&&!n){var o={};n=r.define=function(e,r,n){"function"==typeof n?(o[e]={factory:n,deps:r.map(function(r){return function(e,r){if("."!==e[0])return e;var n=r.split("/"),t=e.split("/");n.pop();for(var a=0;a<t.length;a++)"."!=t[a]&&(".."==t[a]?n.pop():n.push(t[a]));return n.join("/")}(r,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:n}},require=r.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var n=[];module.deps.forEach(function(e){n.push(require(e))}),module.exports=module.factory.apply(r,n)||null,module.resolved=!0}return module.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-io-diskfs/diskfs",["skylark-langx/skylark"],function(e){var r=function(){return r};return e.attach("storages.diskfs",r)}),e("skylark-io-diskfs/download",["skylark-langx/types","./diskfs"],function(e,r){return r.downlad=function(r,n){if(window.navigator.msSaveBlob)e.isString(r)&&(r=dataURItoBlob(r)),window.navigator.msSaveBlob(r,n);else{var t=document.createElement("a");r instanceof Blob&&(r=URL.createObjectURL(r)),t.href=r,t.setAttribute("download",n||"noname"),t.click()}}}),e("skylark-io-diskfs/read",["skylark-langx-async/Deferred","./diskfs"],function(e,r){return r.read=r.readFile=function(r,n){n=n||{};var t=new e,a=new FileReader;a.onload=function(e){t.resolve(e.target.result)},a.onerror=function(e){var r=e.target.error.code;2===r?alert("please don't open this page using protocol fill:///"):alert("error code: "+r)},n.asArrayBuffer?a.readAsArrayBuffer(r):n.asDataUrl?a.readAsDataURL(r):n.asText?a.readAsText(r):a.readAsArrayBuffer(r);return t.promise}}),e("skylark-io-diskfs/readImage",["skylark-langx/Deferred","./diskfs","./read"],function(e,r,n){return r.readImage=function(r){var t=new e,a=new Image;return a.onload=function(){t.resolve(a)},a.onerror=function(e){t.reject(e)},n(r,{asDataUrl:!0}).then(function(e){a.src=e}).catch(function(e){t.reject(e)}),t.promise}}),e("skylark-io-diskfs/select",["./diskfs"],function(e){var r,n=1/0;return e.select=function(e){var t=(e=e||{}).directory||!1,a=e.multiple||!1,o=e.accept||"",i=e.title||"",s=e.picked;if(!r){var l=r=document.createElement("input");l.type="file",l.style.position="fixed",l.style.left=0,l.style.top=0,l.style.opacity=.001,document.body.appendChild(l)}function f(e){for(var r=e.length;r--;)e[r].size>n&&e.splice(r,1);s(e)}r.onchange=function(e){var n=e.target.webkitEntries||e.target.entries;n&&n.length?webentry.all(n).then(function(e){f(e)}):f(Array.prototype.slice.call(e.target.files)),r.value="",r.onchange=null},r.multiple=a,r.accept=o,r.title=i,r.webkitdirectory=t,r.click()}}),e("skylark-io-diskfs/webentry",["skylark-langx/arrays","skylark-langx/Deferred","./diskfs"],function(e,r,n){var t=Array.prototype.concat,a=function(){function n(e,n){var t=new r,o=function(e){t.reject(e)};if(n=n||"",e.isFile)e.file(function(e){e.relativePath=n,t.resolve(e)},o);else if(e.isDirectory){var i=e.createReader();i.readEntries(function(r){a(r,n+e.name+"/").then(function(e){t.resolve(e)}).catch(o)},o)}else t.resolve([]);return t.promise}function a(a,o){return r.all(e.map(a,function(e){return n(e,o)})).then(function(){return t.apply([],arguments)})}return{one:n,all:a}}();return n.webentry=a}),e("skylark-io-diskfs/main",["./diskfs","./download","./read","./readImage","./select","./webentry"],function(e){return e}),e("skylark-io-diskfs",["skylark-io-diskfs/main"],function(e){return e})}(n),!t){var i=require("skylark-langx-ns");a?module.exports=i:r.skylarkjs=i}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-io-diskfs.js.map
