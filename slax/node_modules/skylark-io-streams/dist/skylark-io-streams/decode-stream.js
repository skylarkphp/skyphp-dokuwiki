/**
 * skylark-io-streams - The stream features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-events","skylark-langx-chars","./streams"],function(t,e,r){var s=new Uint8Array(0),n=t.Emitter.inherit({klassName:"DecodeStream",_construct:function(t){if(this._rawMinBufferLength=t||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=s,this.minBufferLength=512,t)for(;this.minBufferLength<t;)this.minBufferLength*=2},length:{get:function(){throw new Error("Should not access DecodeStream.length")}},isEmpty:{get:function(){for(;!this.eof&&0===this.bufferLength;)this.readBlock();return 0===this.bufferLength}},ensureBuffer:function(t){var e=this.buffer;if(t<=e.byteLength)return e;for(var r=this.minBufferLength;r<t;)r*=2;var s=new Uint8Array(r);return s.set(e),this.buffer=s},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]},getUint16:function(){var t=this.getByte(),e=this.getByte();return-1===t||-1===e?-1:(t<<8)+e},getInt32:function(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()},getBytes(t,e=!1){var r,s=this.pos;if(t){for(this.ensureBuffer(s+t),r=s+t;!this.eof&&this.bufferLength<r;)this.readBlock();var n=this.bufferLength;r>n&&(r=n)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}this.pos=r;const i=this.buffer.subarray(s,r);return!e||i instanceof Uint8ClampedArray?i:new Uint8ClampedArray(i)},peekByte:function(){var t=this.getByte();return-1!==t&&this.pos--,t},peekBytes(t,e=!1){var r=this.getBytes(t,e);return this.pos-=r.length,r},makeSubStream:function(t,e,r){for(var s=t+e;this.bufferLength<=s&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,r)},getByteRange(t,e){throw new Error("Should not call DecodeStream.getByteRange")},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0},getBaseStreams:function(){return this.str&&this.str.getBaseStreams?this.str.getBaseStreams():[]}});return r.DecodeStream=n});
//# sourceMappingURL=sourcemaps/decode-stream.js.map
