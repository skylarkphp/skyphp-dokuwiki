{"version":3,"sources":["plugins/fold.js"],"names":["define","langx","$","effects","options","done","element","this","mode","show","hide","size","percent","exec","ref","horizFirst","duration","placeholder","createPlaceholder","start","cssClip","animation1","clip","mixin","animation2","distance","parseInt","css","clipToBox","Deferred","funcs","doAnimate","properties","ease","d","animate","resolve","promise","push","easing","reduce","prev","curr","index","array","then"],"mappings":";;;;;;;AAAAA,QACC,sBACA,qBACA,cACE,SAASC,EAAMC,EAAEC,GACpB,OAAOA,EAAQH,OAAQ,OAAQ,OAAQ,SAAUI,EAASC,GAGzD,IAAIC,EAAUJ,EAAGK,MAChBC,EAAOJ,EAAQI,KACfC,EAAgB,SAATD,EACPE,EAAgB,SAATF,EACPG,EAAOP,EAAQO,MAAQ,GACvBC,EAAU,YAAYC,KAAMF,GAE5BG,IADeV,EAAQW,YACF,QAAS,WAAe,SAAU,SACvDC,EAAWZ,EAAQY,SAAW,EAE9BC,EAAcd,EAAQe,kBAAmBZ,GAEzCa,EAAQb,EAAQc,UAChBC,GAAeC,KAAMrB,EAAMsB,SAAWJ,IACtCK,GAAeF,KAAMrB,EAAMsB,SAAWJ,IAEtCM,GAAaN,EAAOL,EAAK,IAAOK,EAAOL,EAAK,KAGxCF,IACJD,EAAOe,SAAUd,EAAS,GAAK,IAAO,IAAMa,EAAUf,EAAO,EAAI,IAElEW,EAAWC,KAAMR,EAAK,IAAQH,EAC9Ba,EAAWF,KAAMR,EAAK,IAAQH,EAC9Ba,EAAWF,KAAMR,EAAK,IAAQ,EAEzBL,IACJH,EAAQc,QAASI,EAAWF,MACvBL,GACJA,EAAYU,IAAKxB,EAAQyB,UAAWJ,IAGrCA,EAAWF,KAAOH,GAInB,IAAIU,EAAW5B,EAAM4B,SACjBC,KAEJ,SAASC,EAAUzB,EAAQ0B,EAAYhB,EAAUiB,GAChD,OAAO,WACN,IAAIC,EAAI,IAAIL,EAKZ,OAHAvB,EAAQ6B,QAASH,EAAYhB,EAAUiB,EAAM,WAC5CC,EAAEE,YAEIF,EAAEG,SAKNpB,IACJa,EAAMQ,KAAKP,EAAUd,EAAYd,EAAQyB,UAAWP,GAAcL,EAAUZ,EAAQmC,SACpFT,EAAMQ,KAAKP,EAAUd,EAAYd,EAAQyB,UAAWJ,GAAcR,EAAUZ,EAAQmC,UAGrFT,EAAMQ,KAAKP,EAAUzB,EAAQe,EAAYL,EAAUZ,EAAQmC,SAC3DT,EAAMQ,KAAKP,EAAUzB,EAAQkB,EAAYR,EAAUZ,EAAQmC,SAE3DT,EAAMQ,KAAKjC,GACXyB,EAAMU,OAAO,SAASC,EAAMC,EAAMC,EAAOC,GACtC,OAAOH,EAAKI,KAAKH,IACjBb,EAASO","file":"../../plugins/fold.js","sourcesContent":["define( [\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-domx-query\",\r\n\t\"../effects\"\r\n], function(langx,$,effects) {\r\nreturn effects.define( \"fold\", \"hide\", function( options, done ) {\r\n\r\n\t// Create element\r\n\tvar element = $( this ),\r\n\t\tmode = options.mode,\r\n\t\tshow = mode === \"show\",\r\n\t\thide = mode === \"hide\",\r\n\t\tsize = options.size || 15,\r\n\t\tpercent = /([0-9]+)%/.exec( size ),\r\n\t\thorizFirst = !!options.horizFirst,\r\n\t\tref = horizFirst ? [ \"right\", \"bottom\" ] : [ \"bottom\", \"right\" ],\r\n\t\tduration = options.duration / 2,\r\n\r\n\t\tplaceholder = effects.createPlaceholder( element ),\r\n\r\n\t\tstart = element.cssClip(),\r\n\t\tanimation1 = { clip: langx.mixin( {}, start ) },\r\n\t\tanimation2 = { clip: langx.mixin( {}, start ) },\r\n\r\n\t\tdistance = [ start[ ref[ 0 ] ], start[ ref[ 1 ] ] ];\r\n\r\n\r\n\tif ( percent ) {\r\n\t\tsize = parseInt( percent[ 1 ], 10 ) / 100 * distance[ hide ? 0 : 1 ];\r\n\t}\r\n\tanimation1.clip[ ref[ 0 ] ] = size;\r\n\tanimation2.clip[ ref[ 0 ] ] = size;\r\n\tanimation2.clip[ ref[ 1 ] ] = 0;\r\n\r\n\tif ( show ) {\r\n\t\telement.cssClip( animation2.clip );\r\n\t\tif ( placeholder ) {\r\n\t\t\tplaceholder.css( effects.clipToBox( animation2 ) );\r\n\t\t}\r\n\r\n\t\tanimation2.clip = start;\r\n\t}\r\n\r\n\t// Animate\r\n\tvar Deferred = langx.Deferred;\r\n\tvar funcs = [];\r\n\r\n\tfunction doAnimate(element,properties, duration, ease) {\r\n\t\treturn function() {\r\n\t\t\tvar d = new Deferred();\r\n\r\n\t\t\telement.animate( properties, duration, ease ,function(){\r\n\t\t\t\td.resolve();\r\n\t\t\t});\r\n\t\t\treturn d.promise;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tif ( placeholder ) {\r\n\t\tfuncs.push(doAnimate(placeholder,effects.clipToBox( animation1 ), duration, options.easing ));\r\n\t\tfuncs.push(doAnimate(placeholder,effects.clipToBox( animation2 ), duration, options.easing ));\r\n\t}\r\n\r\n\tfuncs.push(doAnimate(element,animation1, duration, options.easing ));\r\n\tfuncs.push(doAnimate(element,animation2, duration, options.easing ));\r\n\r\n\tfuncs.push(done);\r\n\tfuncs.reduce(function(prev, curr, index, array) {\r\n  \t\treturn prev.then(curr);\r\n\t}, Deferred.resolve());\r\n\t\r\n} );\r\n\r\n});\r\n"]}