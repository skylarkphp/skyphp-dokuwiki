/**
 * skylark-langx-async - The skylark JavaScript language extension library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-langx-arrays","skylark-langx-funcs","skylark-langx-objects"],function(t,e,r){"use strict";var n=Array.prototype.slice,i=e.proxy,o=t.makeArray,s=r.result;(0,r.mixin)(Promise.prototype,{always:function(t){return this.then(t,t),this},done:function(){for(var t=0;t<arguments.length;t++)this.then(arguments[t]);return this},fail:function(t){return this.catch(t),this}});var u=function(){var t=this;this.promise=c(new Promise(function(e,r){t._resolve=e,t._reject=r}))};function c(t){if(t.isResolved)return t;var e=!0,r=!1,n=!1,i=t.then(function(t){return n=!0,e=!1,t},function(t){throw r=!0,e=!1,t});i.isResolved=function(){return n},i.isPending=function(){return e},i.isRejected=function(){return r},i.state=function(){return n?"resolved":r?"rejected":"pending"};var o=[],s=[];return i.then=function(t,e,r){return r&&this.progress(r),c(Promise.prototype.then.call(this,t&&function(e){return e&&void 0!==e.__ctx__?t.apply(e.__ctx__,e):t(e)},e&&function(t){return t&&void 0!==t.__ctx__?e.apply(t.__ctx__,t):e(t)}))},i.progress=function(t){return o.forEach(function(e){t(e)}),s.push(t),this},i.pipe=i.then,i.notify=function(t){try{return o.push(t),s.forEach(function(e){return e(t)})}catch(t){this.reject(t)}return this},i}return u.prototype.resolve=function(t){var e=n.call(arguments);return this.resolveWith(null,e)},u.prototype.resolveWith=function(t,e){return(e=e?o(e):[]).__ctx__=t,this._resolve(e),this._resolved=!0,this},u.prototype.notify=function(t){return s(this,"promise").notify(t),this},u.prototype.reject=function(t){var e=n.call(arguments);return this.rejectWith(null,e)},u.prototype.rejectWith=function(t,e){return(e=e?o(e):[]).__ctx__=t,this._reject(e),this._rejected=!0,this},u.prototype.isResolved=function(){return s(this,"promise").isResolved()},u.prototype.isRejected=function(){return s(this,"promise").isRejected()},u.prototype.state=function(){return s(this,"promise").state()},u.prototype.then=function(t,e,r){return s(this,"promise").then(t,e,r)},u.prototype.progress=function(t){return s(this,"promise").progress(t)},u.prototype.catch=function(t){return s(this,"promise").catch(t)},u.prototype.always=function(){var t=s(this,"promise");return t.always.apply(t,arguments),this},u.prototype.done=function(){var t=s(this,"promise");return t.done.apply(t,arguments),this},u.prototype.fail=function(t){return s(this,"promise").fail(t),this},u.all=function(t){var e=new u;return Promise.all(t).then(e.resolve.bind(e),e.reject.bind(e)),s(e,"promise")},u.first=function(t){return c(Promise.race(t))},u.when=function(t,e,r,n){var o=t&&"function"==typeof t.then,s=o&&t instanceof Promise;if(!o)return arguments.length>1?e?e(t):t:(new u).resolve(t);if(!s){var c=new u(t.cancel);t.then(i(c.resolve,c),i(c.reject,c),c.notify),t=c.promise}return e||r||n?t.then(e,r,n):t},u.reject=function(t){var e=new u;return e.reject(t),e.promise},u.immediate=u.resolve=function(t){var e=new u;return e.resolve.apply(e,arguments),e.promise},u.promise=function(t){var e=new u;return t(e.resolve.bind(e),e.reject.bind(e),e.progress.bind(e)),e.promise},u});
//# sourceMappingURL=sourcemaps/Deferred.js.map
