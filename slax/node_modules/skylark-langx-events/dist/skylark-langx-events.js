/**
 * skylark-langx-events - The skylark JavaScript language extension library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(t,n){var e=n.define,require=n.require,r="function"==typeof e&&e.amd,i=!r&&"undefined"!=typeof exports;if(!r&&!e){var s={};e=n.define=function(t,n,e){"function"==typeof e?(s[t]={factory:e,deps:n.map(function(n){return function(t,n){if("."!==t[0])return t;var e=n.split("/"),r=t.split("/");e.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?e.pop():e.push(r[i]));return e.join("/")}(n,t)}),resolved:!1,exports:null},require(t)):s[t]={factory:null,resolved:!0,exports:e}},require=n.require=function(t){if(!s.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=s[t];if(!module.resolved){var e=[];module.deps.forEach(function(t){e.push(require(t))}),module.exports=module.factory.apply(n,e)||null,module.resolved=!0}return module.exports}}if(!e)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-langx-events/events",["skylark-langx-ns"],function(t){return t.attach("langx.events",{})}),t("skylark-langx-events/event",["skylark-langx-objects","skylark-langx-funcs","skylark-langx-klass","skylark-langx-hoster","./events"],function(t,n,e,r){var i={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function s(e,r){return!r&&e.isDefaultPrevented||(r||(r=e),t.each(i,function(t,i){var s=r[t];e[t]=function(){return this[i]=n.returnTrue,s&&s.apply(r,arguments)},e[i]=n.returnFalse})),e}class a extends CustomEvent{constructor(n,e){super(n,e),t.safeMixin(this,e),s(this)}}return a.compatible=s,r.Event=a}),t("skylark-langx-events/listener",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./event"],function(t,n,e,r,i,s){Array.prototype.slice;var a=e.compact,o=(t.isDefined,t.isUndefined),l=(t.isPlainObject,t.isFunction,t.isBoolean),u=t.isString,f=t.isEmptyObject,h=(n.mixin,n.safeMixin,r({listenTo:function(n,e,r,i,s){if(!n)return this;if(t.isPlainObject(e)){t.isBoolean(r)?(s=r,r=null):t.isBoolean(i)&&(s=i);var a=e;for(var f in a){var h=f.match(/^([\w:-]*)\s*(.*)$/),c=h[1],p=h[2]||r;p?this.listenTo(n,c,p,a[f],s):this.listenTo(n,c,a[f],s)}return this}l(i)?(s=i,i=r,r=null):l(r)?(s=r,i=r=null):o(i)&&(s=!1,i=r,r=null),i||(i="handleEvent"),u(i)&&(i=this[i]),s?r?n.one(e,r,i,this):n.one(e,i,this):r?n.on(e,r,i,this):n.on(e,i,this);for(var v,g=this._listeningTo||(this._listeningTo=[]),k=0;k<g.length;k++)if(g[k].obj==n){v=g[k];break}v||g.push(v={obj:n,events:{}});var d=v.events,y=d[e]=d[e]||[];return-1==y.indexOf(i)&&y.push(i),this},listenToOnce:function(t,n,e,r){return this.listenTo(t,n,e,r,1)},unlistenTo:function(t,n,e){var r=this._listeningTo;if(!r)return this;u(e)&&(e=this[e]);for(var i=0;i<r.length;i++){var s=r[i];if(!t||t==s.obj){var o=s.events;for(var l in o)if(!n||n==l){var h=o[l];if(h){for(var c=0;c<h.length;c++)e&&e!=h[i]||(s.obj.off(l,h[i],this),h[i]=null);h=o[l]=a(h),f(h)&&(o[l]=null)}}f(o)&&(r[i]=null)}}return r=this._listeningTo=a(r),f(r)&&(this._listeningTo=null),this}}));return i.Listener=h}),t("skylark-langx-events/emitter",["skylark-langx-types","skylark-langx-objects","skylark-langx-arrays","skylark-langx-klass","./events","./event","./listener"],function(t,n,e,r,i,s,a){var o=Array.prototype.slice,l=e.compact,u=t.isDefined,f=t.isPlainObject,h=t.isFunction,c=t.isString,p=(t.isEmptyObject,n.mixin);n.safeMixin;function v(t){var n=(""+t).split(".");return{name:n[0],ns:n.slice(1).join(" ")}}var g=new Map,k=a.inherit({_prepareArgs:function(t,n){return n=u(n)?[t].concat(n):[t]},on:function(t,n,e,r,i,s){var a=this,o=this._hub||(this._hub={});if(f(t))return i=r,each(t,function(t,r){a.on(t,n,e,r,i,s)}),this;if(c(n)||h(r)||(i=r,r=e,e=n,n=void 0),h(e)&&(i=r,r=e,e=null),!r)throw new Error("No callback function");if(!h(r))throw new Error("The callback  is not afunction");return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var a=v(t),l=a.name,u=a.ns;(o[l]||(o[l]=[])).push({fn:r,selector:n,data:e,ctx:i,ns:u,one:s})}),this},one:function(t,n,e,r,i){return this.on(t,n,e,r,i,1)},emit:function(t){if(!this._hub)return this;var n=this;c(t)&&(t=new s(t)),Object.defineProperty(t,"target",{value:this});var e=o.call(arguments,1);return e=this._prepareArgs(t,e),[t.type||t.name,"all"].forEach(function(r){var i=v(r),s=i.name,a=i.ns,o=n._hub[s];if(o){for(var u=o.length,h=!1,c=0;c<u;c++){if(t.isImmediatePropagationStopped&&t.isImmediatePropagationStopped())return this;var g=o[c];(!a||g.ns&&g.ns.startsWith(a))&&(g.data&&(t.data=p({},g.data,t.data)),2==e.length&&f(e[1])&&(t.data=t.data||{},p(t.data,e[1])),g.fn.apply(g.ctx,e),g.one&&(o[c]=null,h=!0))}h&&(n._hub[r]=l(o))}}),this},queueEmit:function(t){const n=t.type||t;let e=g.get(this);e||(e=new Map,g.set(this,e));const r=e.get(n);e.delete(n),window.clearTimeout(r);const i=window.setTimeout(()=>{0===e.size&&(e=null,g.delete(this)),this.trigger(t)},0);e.set(n,i)},listened:function(t){var n=(this._hub||(this._events={}))[t]||[];return n.length>0},off:function(t,n){if(t){var e=this._hub||(this._hub={});return c(t)&&(t=t.split(/\s/)),t.forEach(function(t){var r=v(t),i=r.name,s=r.ns,a=e[i];if(a){var o=[];if(n||s)for(var l=0,u=a.length;l<u;l++)n&&a[l].fn!==n&&a[l].fn._!==n?o.push(a[l]):!s||a[l].ns&&0==a[l].ns.indexOf(s)||o.push(a[l]);o.length?e[i]=o:delete e[i]}}),this}this._hub=null},trigger:function(){return this.emit.apply(this,arguments)},queueTrigger:function(t){return this.queueEmit.apply(this,arguments)}});return i.Emitter=k}),t("skylark-langx-events/create-event",["./events","./event"],function(t,n){return t.createEvent=function(t,e){return new n(t,e)}}),t("skylark-langx-events/main",["./events","./event","./listener","./emitter","./create-event"],function(t){return t}),t("skylark-langx-events",["skylark-langx-events/main"],function(t){return t})}(e),!r){var a=require("skylark-langx-ns");i?module.exports=a:n.skylarkjs=a}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-langx-events.js.map
