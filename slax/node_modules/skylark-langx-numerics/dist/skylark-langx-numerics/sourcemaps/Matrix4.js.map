{"version":3,"sources":["Matrix4.js"],"names":["define","klass","numerics","Vector3","_v1","_zero","_one","_x","_y","_z","Matrix4","set","n11","n12","n13","n14","n21","n22","n23","n24","n31","n32","n33","n34","n41","n42","n43","n44","te","this","elements","identity","clone","fromArray","copy","m","me","copyPosition","extractBasis","xAxis","yAxis","zAxis","setFromMatrixColumn","makeBasis","x","y","z","extractRotation","scaleX","length","scaleY","scaleZ","makeRotationFromEuler","euler","isEuler","console","error","a","Math","cos","b","sin","c","d","e","f","order","ae","af","be","bf","ce","cf","de","df","ac","ad","bc","bd","makeRotationFromQuaternion","q","compose","lookAt","eye","target","up","subVectors","lengthSq","normalize","crossVectors","abs","multiply","n","undefined","warn","multiplyMatrices","premultiply","a11","a12","a13","a14","a21","a22","a23","a24","a31","a32","a33","a34","a41","a42","a43","a44","b11","b12","b13","b14","b21","b22","b23","b24","b31","b32","b33","b34","b41","b42","b43","b44","multiplyScalar","s","determinant","transpose","tmp","setPosition","isVector3","getInverse","throwOnDegenerate","t11","t12","t13","t14","det","detInv","scale","v","getMaxScaleOnAxis","scaleXSq","scaleYSq","scaleZSq","sqrt","max","makeTranslation","makeRotationX","theta","makeRotationY","makeRotationZ","makeRotationAxis","axis","angle","t","tx","ty","makeScale","makeShear","position","quaternion","w","_w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","sx","sy","sz","decompose","_m1","invSX","invSY","invSZ","setFromRotationMatrix","makePerspective","left","right","top","bottom","near","far","makeOrthographic","h","p","equals","matrix","i","array","offset","toArray","_construct","arguments"],"mappings":"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","file":"../Matrix4.js","sourcesContent":["define([\r\n\t\"skylark-langx-klass\",\r\n\t\"./numerics\",\r\n\t\"./Vector3\"\r\n] ,function(\r\n\tklass,\r\n\tnumerics,\r\n\tVector3\r\n) {\r\n\r\n\tvar _v1 = new Vector3();\r\n\tvar _zero = new Vector3( 0, 0, 0 );\r\n\tvar _one = new Vector3( 1, 1, 1 );\r\n\tvar _x = new Vector3();\r\n\tvar _y = new Vector3();\r\n\tvar _z = new Vector3();\r\n\r\n\tvar Matrix4 = klass({\r\n\t\tset: function ( n11, n12, n13, n14, n21, n22, n23, n24, n31, n32, n33, n34, n41, n42, n43, n44 ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] = n11; te[ 4 ] = n12; te[ 8 ] = n13; te[ 12 ] = n14;\r\n\t\t\tte[ 1 ] = n21; te[ 5 ] = n22; te[ 9 ] = n23; te[ 13 ] = n24;\r\n\t\t\tte[ 2 ] = n31; te[ 6 ] = n32; te[ 10 ] = n33; te[ 14 ] = n34;\r\n\t\t\tte[ 3 ] = n41; te[ 7 ] = n42; te[ 11 ] = n43; te[ 15 ] = n44;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tidentity: function () {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tclone: function () {\r\n\r\n\t\t\treturn new Matrix4().fromArray( this.elements );\r\n\r\n\t\t},\r\n\r\n\t\tcopy: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ]; te[ 1 ] = me[ 1 ]; te[ 2 ] = me[ 2 ]; te[ 3 ] = me[ 3 ];\r\n\t\t\tte[ 4 ] = me[ 4 ]; te[ 5 ] = me[ 5 ]; te[ 6 ] = me[ 6 ]; te[ 7 ] = me[ 7 ];\r\n\t\t\tte[ 8 ] = me[ 8 ]; te[ 9 ] = me[ 9 ]; te[ 10 ] = me[ 10 ]; te[ 11 ] = me[ 11 ];\r\n\t\t\tte[ 12 ] = me[ 12 ]; te[ 13 ] = me[ 13 ]; te[ 14 ] = me[ 14 ]; te[ 15 ] = me[ 15 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcopyPosition: function ( m ) {\r\n\r\n\t\t\tvar te = this.elements, me = m.elements;\r\n\r\n\t\t\tte[ 12 ] = me[ 12 ];\r\n\t\t\tte[ 13 ] = me[ 13 ];\r\n\t\t\tte[ 14 ] = me[ 14 ];\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\txAxis.setFromMatrixColumn( this, 0 );\r\n\t\t\tyAxis.setFromMatrixColumn( this, 1 );\r\n\t\t\tzAxis.setFromMatrixColumn( this, 2 );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeBasis: function ( xAxis, yAxis, zAxis ) {\r\n\r\n\t\t\tthis.set(\r\n\t\t\t\txAxis.x, yAxis.x, zAxis.x, 0,\r\n\t\t\t\txAxis.y, yAxis.y, zAxis.y, 0,\r\n\t\t\t\txAxis.z, yAxis.z, zAxis.z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\textractRotation: function ( m ) {\r\n\r\n\t\t\t// this method does not support reflection matrices\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = m.elements;\r\n\r\n\t\t\tvar scaleX = 1 / _v1.setFromMatrixColumn( m, 0 ).length();\r\n\t\t\tvar scaleY = 1 / _v1.setFromMatrixColumn( m, 1 ).length();\r\n\t\t\tvar scaleZ = 1 / _v1.setFromMatrixColumn( m, 2 ).length();\r\n\r\n\t\t\tte[ 0 ] = me[ 0 ] * scaleX;\r\n\t\t\tte[ 1 ] = me[ 1 ] * scaleX;\r\n\t\t\tte[ 2 ] = me[ 2 ] * scaleX;\r\n\t\t\tte[ 3 ] = 0;\r\n\r\n\t\t\tte[ 4 ] = me[ 4 ] * scaleY;\r\n\t\t\tte[ 5 ] = me[ 5 ] * scaleY;\r\n\t\t\tte[ 6 ] = me[ 6 ] * scaleY;\r\n\t\t\tte[ 7 ] = 0;\r\n\r\n\t\t\tte[ 8 ] = me[ 8 ] * scaleZ;\r\n\t\t\tte[ 9 ] = me[ 9 ] * scaleZ;\r\n\t\t\tte[ 10 ] = me[ 10 ] * scaleZ;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationFromEuler: function ( euler ) {\r\n\r\n\t\t\tif ( ! ( euler && euler.isEuler ) ) {\r\n\r\n\t\t\t\tconsole.error( 'mathsMatrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar x = euler.x, y = euler.y, z = euler.z;\r\n\t\t\tvar a = Math.cos( x ), b = Math.sin( x );\r\n\t\t\tvar c = Math.cos( y ), d = Math.sin( y );\r\n\t\t\tvar e = Math.cos( z ), f = Math.sin( z );\r\n\r\n\t\t\tif ( euler.order === 'XYZ' ) {\r\n\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - c * f;\r\n\t\t\t\tte[ 8 ] = d;\r\n\r\n\t\t\t\tte[ 1 ] = af + be * d;\r\n\t\t\t\tte[ 5 ] = ae - bf * d;\r\n\t\t\t\tte[ 9 ] = - b * c;\r\n\r\n\t\t\t\tte[ 2 ] = bf - ae * d;\r\n\t\t\t\tte[ 6 ] = be + af * d;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'YXZ' ) {\r\n\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\t\tte[ 0 ] = ce + df * b;\r\n\t\t\t\tte[ 4 ] = de * b - cf;\r\n\t\t\t\tte[ 8 ] = a * d;\r\n\r\n\t\t\t\tte[ 1 ] = a * f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b;\r\n\r\n\t\t\t\tte[ 2 ] = cf * b - de;\r\n\t\t\t\tte[ 6 ] = df + ce * b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'ZXY' ) {\r\n\r\n\t\t\t\tvar ce = c * e, cf = c * f, de = d * e, df = d * f;\r\n\r\n\t\t\t\tte[ 0 ] = ce - df * b;\r\n\t\t\t\tte[ 4 ] = - a * f;\r\n\t\t\t\tte[ 8 ] = de + cf * b;\r\n\r\n\t\t\t\tte[ 1 ] = cf + de * b;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = df - ce * b;\r\n\r\n\t\t\t\tte[ 2 ] = - a * d;\r\n\t\t\t\tte[ 6 ] = b;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'ZYX' ) {\r\n\r\n\t\t\t\tvar ae = a * e, af = a * f, be = b * e, bf = b * f;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = be * d - af;\r\n\t\t\t\tte[ 8 ] = ae * d + bf;\r\n\r\n\t\t\t\tte[ 1 ] = c * f;\r\n\t\t\t\tte[ 5 ] = bf * d + ae;\r\n\t\t\t\tte[ 9 ] = af * d - be;\r\n\r\n\t\t\t\tte[ 2 ] = - d;\r\n\t\t\t\tte[ 6 ] = b * c;\r\n\t\t\t\tte[ 10 ] = a * c;\r\n\r\n\t\t\t} else if ( euler.order === 'YZX' ) {\r\n\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = bd - ac * f;\r\n\t\t\t\tte[ 8 ] = bc * f + ad;\r\n\r\n\t\t\t\tte[ 1 ] = f;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = - b * e;\r\n\r\n\t\t\t\tte[ 2 ] = - d * e;\r\n\t\t\t\tte[ 6 ] = ad * f + bc;\r\n\t\t\t\tte[ 10 ] = ac - bd * f;\r\n\r\n\t\t\t} else if ( euler.order === 'XZY' ) {\r\n\r\n\t\t\t\tvar ac = a * c, ad = a * d, bc = b * c, bd = b * d;\r\n\r\n\t\t\t\tte[ 0 ] = c * e;\r\n\t\t\t\tte[ 4 ] = - f;\r\n\t\t\t\tte[ 8 ] = d * e;\r\n\r\n\t\t\t\tte[ 1 ] = ac * f + bd;\r\n\t\t\t\tte[ 5 ] = a * e;\r\n\t\t\t\tte[ 9 ] = ad * f - bc;\r\n\r\n\t\t\t\tte[ 2 ] = bc * f - ad;\r\n\t\t\t\tte[ 6 ] = b * e;\r\n\t\t\t\tte[ 10 ] = bd * f + ac;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// bottom row\r\n\t\t\tte[ 3 ] = 0;\r\n\t\t\tte[ 7 ] = 0;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\t// last column\r\n\t\t\tte[ 12 ] = 0;\r\n\t\t\tte[ 13 ] = 0;\r\n\t\t\tte[ 14 ] = 0;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationFromQuaternion: function ( q ) {\r\n\r\n\t\t\treturn this.compose( _zero, q, _one );\r\n\r\n\t\t},\r\n\r\n\t\tlookAt: function ( eye, target, up ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\t_z.subVectors( eye, target );\r\n\r\n\t\t\tif ( _z.lengthSq() === 0 ) {\r\n\r\n\t\t\t\t// eye and target are in the same position\r\n\r\n\t\t\t\t_z.z = 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_z.normalize();\r\n\t\t\t_x.crossVectors( up, _z );\r\n\r\n\t\t\tif ( _x.lengthSq() === 0 ) {\r\n\r\n\t\t\t\t// up and z are parallel\r\n\r\n\t\t\t\tif ( Math.abs( up.z ) === 1 ) {\r\n\r\n\t\t\t\t\t_z.x += 0.0001;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t_z.z += 0.0001;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_z.normalize();\r\n\t\t\t\t_x.crossVectors( up, _z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_x.normalize();\r\n\t\t\t_y.crossVectors( _z, _x );\r\n\r\n\t\t\tte[ 0 ] = _x.x; te[ 4 ] = _y.x; te[ 8 ] = _z.x;\r\n\t\t\tte[ 1 ] = _x.y; te[ 5 ] = _y.y; te[ 9 ] = _z.y;\r\n\t\t\tte[ 2 ] = _x.z; te[ 6 ] = _y.z; te[ 10 ] = _z.z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiply: function ( m, n ) {\r\n\r\n\t\t\tif ( n !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'mathsMatrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.' );\r\n\t\t\t\treturn this.multiplyMatrices( m, n );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this.multiplyMatrices( this, m );\r\n\r\n\t\t},\r\n\r\n\t\tpremultiply: function ( m ) {\r\n\r\n\t\t\treturn this.multiplyMatrices( m, this );\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyMatrices: function ( a, b ) {\r\n\r\n\t\t\tvar ae = a.elements;\r\n\t\t\tvar be = b.elements;\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar a11 = ae[ 0 ], a12 = ae[ 4 ], a13 = ae[ 8 ], a14 = ae[ 12 ];\r\n\t\t\tvar a21 = ae[ 1 ], a22 = ae[ 5 ], a23 = ae[ 9 ], a24 = ae[ 13 ];\r\n\t\t\tvar a31 = ae[ 2 ], a32 = ae[ 6 ], a33 = ae[ 10 ], a34 = ae[ 14 ];\r\n\t\t\tvar a41 = ae[ 3 ], a42 = ae[ 7 ], a43 = ae[ 11 ], a44 = ae[ 15 ];\r\n\r\n\t\t\tvar b11 = be[ 0 ], b12 = be[ 4 ], b13 = be[ 8 ], b14 = be[ 12 ];\r\n\t\t\tvar b21 = be[ 1 ], b22 = be[ 5 ], b23 = be[ 9 ], b24 = be[ 13 ];\r\n\t\t\tvar b31 = be[ 2 ], b32 = be[ 6 ], b33 = be[ 10 ], b34 = be[ 14 ];\r\n\t\t\tvar b41 = be[ 3 ], b42 = be[ 7 ], b43 = be[ 11 ], b44 = be[ 15 ];\r\n\r\n\t\t\tte[ 0 ] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n\t\t\tte[ 4 ] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n\t\t\tte[ 8 ] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n\t\t\tte[ 12 ] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n\r\n\t\t\tte[ 1 ] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n\t\t\tte[ 5 ] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n\t\t\tte[ 9 ] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n\t\t\tte[ 13 ] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n\r\n\t\t\tte[ 2 ] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n\t\t\tte[ 6 ] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n\t\t\tte[ 10 ] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n\t\t\tte[ 14 ] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n\r\n\t\t\tte[ 3 ] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n\t\t\tte[ 7 ] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n\t\t\tte[ 11 ] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n\t\t\tte[ 15 ] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmultiplyScalar: function ( s ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tte[ 0 ] *= s; te[ 4 ] *= s; te[ 8 ] *= s; te[ 12 ] *= s;\r\n\t\t\tte[ 1 ] *= s; te[ 5 ] *= s; te[ 9 ] *= s; te[ 13 ] *= s;\r\n\t\t\tte[ 2 ] *= s; te[ 6 ] *= s; te[ 10 ] *= s; te[ 14 ] *= s;\r\n\t\t\tte[ 3 ] *= s; te[ 7 ] *= s; te[ 11 ] *= s; te[ 15 ] *= s;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdeterminant: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar n11 = te[ 0 ], n12 = te[ 4 ], n13 = te[ 8 ], n14 = te[ 12 ];\r\n\t\t\tvar n21 = te[ 1 ], n22 = te[ 5 ], n23 = te[ 9 ], n24 = te[ 13 ];\r\n\t\t\tvar n31 = te[ 2 ], n32 = te[ 6 ], n33 = te[ 10 ], n34 = te[ 14 ];\r\n\t\t\tvar n41 = te[ 3 ], n42 = te[ 7 ], n43 = te[ 11 ], n44 = te[ 15 ];\r\n\r\n\t\t\t//TODO: make this more efficient\r\n\t\t\t//( based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm )\r\n\r\n\t\t\treturn (\r\n\t\t\t\tn41 * (\r\n\t\t\t\t\t+ n14 * n23 * n32\r\n\t\t\t\t\t - n13 * n24 * n32\r\n\t\t\t\t\t - n14 * n22 * n33\r\n\t\t\t\t\t + n12 * n24 * n33\r\n\t\t\t\t\t + n13 * n22 * n34\r\n\t\t\t\t\t - n12 * n23 * n34\r\n\t\t\t\t) +\r\n\t\t\t\tn42 * (\r\n\t\t\t\t\t+ n11 * n23 * n34\r\n\t\t\t\t\t - n11 * n24 * n33\r\n\t\t\t\t\t + n14 * n21 * n33\r\n\t\t\t\t\t - n13 * n21 * n34\r\n\t\t\t\t\t + n13 * n24 * n31\r\n\t\t\t\t\t - n14 * n23 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn43 * (\r\n\t\t\t\t\t+ n11 * n24 * n32\r\n\t\t\t\t\t - n11 * n22 * n34\r\n\t\t\t\t\t - n14 * n21 * n32\r\n\t\t\t\t\t + n12 * n21 * n34\r\n\t\t\t\t\t + n14 * n22 * n31\r\n\t\t\t\t\t - n12 * n24 * n31\r\n\t\t\t\t) +\r\n\t\t\t\tn44 * (\r\n\t\t\t\t\t- n13 * n22 * n31\r\n\t\t\t\t\t - n11 * n23 * n32\r\n\t\t\t\t\t + n11 * n22 * n33\r\n\t\t\t\t\t + n13 * n21 * n32\r\n\t\t\t\t\t - n12 * n21 * n33\r\n\t\t\t\t\t + n12 * n23 * n31\r\n\t\t\t\t)\r\n\r\n\t\t\t);\r\n\r\n\t\t},\r\n\r\n\t\ttranspose: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar tmp;\r\n\r\n\t\t\ttmp = te[ 1 ]; te[ 1 ] = te[ 4 ]; te[ 4 ] = tmp;\r\n\t\t\ttmp = te[ 2 ]; te[ 2 ] = te[ 8 ]; te[ 8 ] = tmp;\r\n\t\t\ttmp = te[ 6 ]; te[ 6 ] = te[ 9 ]; te[ 9 ] = tmp;\r\n\r\n\t\t\ttmp = te[ 3 ]; te[ 3 ] = te[ 12 ]; te[ 12 ] = tmp;\r\n\t\t\ttmp = te[ 7 ]; te[ 7 ] = te[ 13 ]; te[ 13 ] = tmp;\r\n\t\t\ttmp = te[ 11 ]; te[ 11 ] = te[ 14 ]; te[ 14 ] = tmp;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tsetPosition: function ( x, y, z ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tif ( x.isVector3 ) {\r\n\r\n\t\t\t\tte[ 12 ] = x.x;\r\n\t\t\t\tte[ 13 ] = x.y;\r\n\t\t\t\tte[ 14 ] = x.z;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tte[ 12 ] = x;\r\n\t\t\t\tte[ 13 ] = y;\r\n\t\t\t\tte[ 14 ] = z;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetInverse: function ( m, throwOnDegenerate ) {\r\n\r\n\t\t\tif ( throwOnDegenerate !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( \"mathsMatrix4: .getInverse() can no longer be configured to throw on degenerate.\" );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// based on http://www.euclideanspace.com/maths/algebra/matrix/functions/inverse/fourD/index.htm\r\n\t\t\tvar te = this.elements,\r\n\t\t\t\tme = m.elements,\r\n\r\n\t\t\t\tn11 = me[ 0 ], n21 = me[ 1 ], n31 = me[ 2 ], n41 = me[ 3 ],\r\n\t\t\t\tn12 = me[ 4 ], n22 = me[ 5 ], n32 = me[ 6 ], n42 = me[ 7 ],\r\n\t\t\t\tn13 = me[ 8 ], n23 = me[ 9 ], n33 = me[ 10 ], n43 = me[ 11 ],\r\n\t\t\t\tn14 = me[ 12 ], n24 = me[ 13 ], n34 = me[ 14 ], n44 = me[ 15 ],\r\n\r\n\t\t\t\tt11 = n23 * n34 * n42 - n24 * n33 * n42 + n24 * n32 * n43 - n22 * n34 * n43 - n23 * n32 * n44 + n22 * n33 * n44,\r\n\t\t\t\tt12 = n14 * n33 * n42 - n13 * n34 * n42 - n14 * n32 * n43 + n12 * n34 * n43 + n13 * n32 * n44 - n12 * n33 * n44,\r\n\t\t\t\tt13 = n13 * n24 * n42 - n14 * n23 * n42 + n14 * n22 * n43 - n12 * n24 * n43 - n13 * n22 * n44 + n12 * n23 * n44,\r\n\t\t\t\tt14 = n14 * n23 * n32 - n13 * n24 * n32 - n14 * n22 * n33 + n12 * n24 * n33 + n13 * n22 * n34 - n12 * n23 * n34;\r\n\r\n\t\t\tvar det = n11 * t11 + n21 * t12 + n31 * t13 + n41 * t14;\r\n\r\n\t\t\tif ( det === 0 ) return this.set( 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 );\r\n\r\n\t\t\tvar detInv = 1 / det;\r\n\r\n\t\t\tte[ 0 ] = t11 * detInv;\r\n\t\t\tte[ 1 ] = ( n24 * n33 * n41 - n23 * n34 * n41 - n24 * n31 * n43 + n21 * n34 * n43 + n23 * n31 * n44 - n21 * n33 * n44 ) * detInv;\r\n\t\t\tte[ 2 ] = ( n22 * n34 * n41 - n24 * n32 * n41 + n24 * n31 * n42 - n21 * n34 * n42 - n22 * n31 * n44 + n21 * n32 * n44 ) * detInv;\r\n\t\t\tte[ 3 ] = ( n23 * n32 * n41 - n22 * n33 * n41 - n23 * n31 * n42 + n21 * n33 * n42 + n22 * n31 * n43 - n21 * n32 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 4 ] = t12 * detInv;\r\n\t\t\tte[ 5 ] = ( n13 * n34 * n41 - n14 * n33 * n41 + n14 * n31 * n43 - n11 * n34 * n43 - n13 * n31 * n44 + n11 * n33 * n44 ) * detInv;\r\n\t\t\tte[ 6 ] = ( n14 * n32 * n41 - n12 * n34 * n41 - n14 * n31 * n42 + n11 * n34 * n42 + n12 * n31 * n44 - n11 * n32 * n44 ) * detInv;\r\n\t\t\tte[ 7 ] = ( n12 * n33 * n41 - n13 * n32 * n41 + n13 * n31 * n42 - n11 * n33 * n42 - n12 * n31 * n43 + n11 * n32 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 8 ] = t13 * detInv;\r\n\t\t\tte[ 9 ] = ( n14 * n23 * n41 - n13 * n24 * n41 - n14 * n21 * n43 + n11 * n24 * n43 + n13 * n21 * n44 - n11 * n23 * n44 ) * detInv;\r\n\t\t\tte[ 10 ] = ( n12 * n24 * n41 - n14 * n22 * n41 + n14 * n21 * n42 - n11 * n24 * n42 - n12 * n21 * n44 + n11 * n22 * n44 ) * detInv;\r\n\t\t\tte[ 11 ] = ( n13 * n22 * n41 - n12 * n23 * n41 - n13 * n21 * n42 + n11 * n23 * n42 + n12 * n21 * n43 - n11 * n22 * n43 ) * detInv;\r\n\r\n\t\t\tte[ 12 ] = t14 * detInv;\r\n\t\t\tte[ 13 ] = ( n13 * n24 * n31 - n14 * n23 * n31 + n14 * n21 * n33 - n11 * n24 * n33 - n13 * n21 * n34 + n11 * n23 * n34 ) * detInv;\r\n\t\t\tte[ 14 ] = ( n14 * n22 * n31 - n12 * n24 * n31 - n14 * n21 * n32 + n11 * n24 * n32 + n12 * n21 * n34 - n11 * n22 * n34 ) * detInv;\r\n\t\t\tte[ 15 ] = ( n12 * n23 * n31 - n13 * n22 * n31 + n13 * n21 * n32 - n11 * n23 * n32 - n12 * n21 * n33 + n11 * n22 * n33 ) * detInv;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tscale: function ( v ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = v.x, y = v.y, z = v.z;\r\n\r\n\t\t\tte[ 0 ] *= x; te[ 4 ] *= y; te[ 8 ] *= z;\r\n\t\t\tte[ 1 ] *= x; te[ 5 ] *= y; te[ 9 ] *= z;\r\n\t\t\tte[ 2 ] *= x; te[ 6 ] *= y; te[ 10 ] *= z;\r\n\t\t\tte[ 3 ] *= x; te[ 7 ] *= y; te[ 11 ] *= z;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tgetMaxScaleOnAxis: function () {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar scaleXSq = te[ 0 ] * te[ 0 ] + te[ 1 ] * te[ 1 ] + te[ 2 ] * te[ 2 ];\r\n\t\t\tvar scaleYSq = te[ 4 ] * te[ 4 ] + te[ 5 ] * te[ 5 ] + te[ 6 ] * te[ 6 ];\r\n\t\t\tvar scaleZSq = te[ 8 ] * te[ 8 ] + te[ 9 ] * te[ 9 ] + te[ 10 ] * te[ 10 ];\r\n\r\n\t\t\treturn Math.sqrt( Math.max( scaleXSq, scaleYSq, scaleZSq ) );\r\n\r\n\t\t},\r\n\r\n\t\tmakeTranslation: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, x,\r\n\t\t\t\t0, 1, 0, y,\r\n\t\t\t\t0, 0, 1, z,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationX: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, c, - s, 0,\r\n\t\t\t\t0, s, c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationY: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t c, 0, s, 0,\r\n\t\t\t\t 0, 1, 0, 0,\r\n\t\t\t\t- s, 0, c, 0,\r\n\t\t\t\t 0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationZ: function ( theta ) {\r\n\r\n\t\t\tvar c = Math.cos( theta ), s = Math.sin( theta );\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tc, - s, 0, 0,\r\n\t\t\t\ts, c, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeRotationAxis: function ( axis, angle ) {\r\n\r\n\t\t\t// Based on http://www.gamedev.net/reference/articles/article1199.asp\r\n\r\n\t\t\tvar c = Math.cos( angle );\r\n\t\t\tvar s = Math.sin( angle );\r\n\t\t\tvar t = 1 - c;\r\n\t\t\tvar x = axis.x, y = axis.y, z = axis.z;\r\n\t\t\tvar tx = t * x, ty = t * y;\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\ttx * x + c, tx * y - s * z, tx * z + s * y, 0,\r\n\t\t\t\ttx * y + s * z, ty * y + c, ty * z - s * x, 0,\r\n\t\t\t\ttx * z - s * y, ty * z + s * x, t * z * z + c, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\t return this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeScale: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\tx, 0, 0, 0,\r\n\t\t\t\t0, y, 0, 0,\r\n\t\t\t\t0, 0, z, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeShear: function ( x, y, z ) {\r\n\r\n\t\t\tthis.set(\r\n\r\n\t\t\t\t1, y, z, 0,\r\n\t\t\t\tx, 1, z, 0,\r\n\t\t\t\tx, y, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t);\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tcompose: function ( position, quaternion, scale ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar x = quaternion._x, y = quaternion._y, z = quaternion._z, w = quaternion._w;\r\n\t\t\tvar x2 = x + x,\ty2 = y + y, z2 = z + z;\r\n\t\t\tvar xx = x * x2, xy = x * y2, xz = x * z2;\r\n\t\t\tvar yy = y * y2, yz = y * z2, zz = z * z2;\r\n\t\t\tvar wx = w * x2, wy = w * y2, wz = w * z2;\r\n\r\n\t\t\tvar sx = scale.x, sy = scale.y, sz = scale.z;\r\n\r\n\t\t\tte[ 0 ] = ( 1 - ( yy + zz ) ) * sx;\r\n\t\t\tte[ 1 ] = ( xy + wz ) * sx;\r\n\t\t\tte[ 2 ] = ( xz - wy ) * sx;\r\n\t\t\tte[ 3 ] = 0;\r\n\r\n\t\t\tte[ 4 ] = ( xy - wz ) * sy;\r\n\t\t\tte[ 5 ] = ( 1 - ( xx + zz ) ) * sy;\r\n\t\t\tte[ 6 ] = ( yz + wx ) * sy;\r\n\t\t\tte[ 7 ] = 0;\r\n\r\n\t\t\tte[ 8 ] = ( xz + wy ) * sz;\r\n\t\t\tte[ 9 ] = ( yz - wx ) * sz;\r\n\t\t\tte[ 10 ] = ( 1 - ( xx + yy ) ) * sz;\r\n\t\t\tte[ 11 ] = 0;\r\n\r\n\t\t\tte[ 12 ] = position.x;\r\n\t\t\tte[ 13 ] = position.y;\r\n\t\t\tte[ 14 ] = position.z;\r\n\t\t\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tdecompose: function ( position, quaternion, scale ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tvar sx = _v1.set( te[ 0 ], te[ 1 ], te[ 2 ] ).length();\r\n\t\t\tvar sy = _v1.set( te[ 4 ], te[ 5 ], te[ 6 ] ).length();\r\n\t\t\tvar sz = _v1.set( te[ 8 ], te[ 9 ], te[ 10 ] ).length();\r\n\r\n\t\t\t// if determine is negative, we need to invert one scale\r\n\t\t\tvar det = this.determinant();\r\n\t\t\tif ( det < 0 ) sx = - sx;\r\n\r\n\t\t\tposition.x = te[ 12 ];\r\n\t\t\tposition.y = te[ 13 ];\r\n\t\t\tposition.z = te[ 14 ];\r\n\r\n\t\t\t// scale the rotation part\r\n\t\t\t_m1.copy( this );\r\n\r\n\t\t\tvar invSX = 1 / sx;\r\n\t\t\tvar invSY = 1 / sy;\r\n\t\t\tvar invSZ = 1 / sz;\r\n\r\n\t\t\t_m1.elements[ 0 ] *= invSX;\r\n\t\t\t_m1.elements[ 1 ] *= invSX;\r\n\t\t\t_m1.elements[ 2 ] *= invSX;\r\n\r\n\t\t\t_m1.elements[ 4 ] *= invSY;\r\n\t\t\t_m1.elements[ 5 ] *= invSY;\r\n\t\t\t_m1.elements[ 6 ] *= invSY;\r\n\r\n\t\t\t_m1.elements[ 8 ] *= invSZ;\r\n\t\t\t_m1.elements[ 9 ] *= invSZ;\r\n\t\t\t_m1.elements[ 10 ] *= invSZ;\r\n\r\n\t\t\tquaternion.setFromRotationMatrix( _m1 );\r\n\r\n\t\t\tscale.x = sx;\r\n\t\t\tscale.y = sy;\r\n\t\t\tscale.z = sz;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakePerspective: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\t\tif ( far === undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'mathsMatrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar x = 2 * near / ( right - left );\r\n\t\t\tvar y = 2 * near / ( top - bottom );\r\n\r\n\t\t\tvar a = ( right + left ) / ( right - left );\r\n\t\t\tvar b = ( top + bottom ) / ( top - bottom );\r\n\t\t\tvar c = - ( far + near ) / ( far - near );\r\n\t\t\tvar d = - 2 * far * near / ( far - near );\r\n\r\n\t\t\tte[ 0 ] = x;\tte[ 4 ] = 0;\tte[ 8 ] = a;\tte[ 12 ] = 0;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = y;\tte[ 9 ] = b;\tte[ 13 ] = 0;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = c;\tte[ 14 ] = d;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = - 1;\tte[ 15 ] = 0;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tmakeOrthographic: function ( left, right, top, bottom, near, far ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar w = 1.0 / ( right - left );\r\n\t\t\tvar h = 1.0 / ( top - bottom );\r\n\t\t\tvar p = 1.0 / ( far - near );\r\n\r\n\t\t\tvar x = ( right + left ) * w;\r\n\t\t\tvar y = ( top + bottom ) * h;\r\n\t\t\tvar z = ( far + near ) * p;\r\n\r\n\t\t\tte[ 0 ] = 2 * w;\tte[ 4 ] = 0;\tte[ 8 ] = 0;\tte[ 12 ] = - x;\r\n\t\t\tte[ 1 ] = 0;\tte[ 5 ] = 2 * h;\tte[ 9 ] = 0;\tte[ 13 ] = - y;\r\n\t\t\tte[ 2 ] = 0;\tte[ 6 ] = 0;\tte[ 10 ] = - 2 * p;\tte[ 14 ] = - z;\r\n\t\t\tte[ 3 ] = 0;\tte[ 7 ] = 0;\tte[ 11 ] = 0;\tte[ 15 ] = 1;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\tequals: function ( matrix ) {\r\n\r\n\t\t\tvar te = this.elements;\r\n\t\t\tvar me = matrix.elements;\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\tif ( te[ i ] !== me[ i ] ) return false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t},\r\n\r\n\t\tfromArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tfor ( var i = 0; i < 16; i ++ ) {\r\n\r\n\t\t\t\tthis.elements[ i ] = array[ i + offset ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t\ttoArray: function ( array, offset ) {\r\n\r\n\t\t\tif ( array === undefined ) array = [];\r\n\t\t\tif ( offset === undefined ) offset = 0;\r\n\r\n\t\t\tvar te = this.elements;\r\n\r\n\t\t\tarray[ offset ] = te[ 0 ];\r\n\t\t\tarray[ offset + 1 ] = te[ 1 ];\r\n\t\t\tarray[ offset + 2 ] = te[ 2 ];\r\n\t\t\tarray[ offset + 3 ] = te[ 3 ];\r\n\r\n\t\t\tarray[ offset + 4 ] = te[ 4 ];\r\n\t\t\tarray[ offset + 5 ] = te[ 5 ];\r\n\t\t\tarray[ offset + 6 ] = te[ 6 ];\r\n\t\t\tarray[ offset + 7 ] = te[ 7 ];\r\n\r\n\t\t\tarray[ offset + 8 ] = te[ 8 ];\r\n\t\t\tarray[ offset + 9 ] = te[ 9 ];\r\n\t\t\tarray[ offset + 10 ] = te[ 10 ];\r\n\t\t\tarray[ offset + 11 ] = te[ 11 ];\r\n\r\n\t\t\tarray[ offset + 12 ] = te[ 12 ];\r\n\t\t\tarray[ offset + 13 ] = te[ 13 ];\r\n\t\t\tarray[ offset + 14 ] = te[ 14 ];\r\n\t\t\tarray[ offset + 15 ] = te[ 15 ];\r\n\r\n\t\t\treturn array;\r\n\r\n\t\t},\r\n\r\n\t\t\"_construct\" : function() {\r\n\r\n\t\t\tthis.elements = [\r\n\r\n\t\t\t\t1, 0, 0, 0,\r\n\t\t\t\t0, 1, 0, 0,\r\n\t\t\t\t0, 0, 1, 0,\r\n\t\t\t\t0, 0, 0, 1\r\n\r\n\t\t\t];\r\n\r\n\t\t\tif ( arguments.length > 0 ) {\r\n\r\n\t\t\t\tconsole.error( 'mathsMatrix4: the constructor no longer reads arguments. use .set() instead.' );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tvar _m1 = new Matrix4();\r\n\r\n\treturn numerics.Matrix4 =  Matrix4 ;\r\n\r\n});"]}