/**
 * skylark-codemirror - A version of codemirror 5.45  that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-codemirror/
 * @license MIT
 */
define(["../../CodeMirror","./matchesonscrollbar"],function(t){"use strict";var e={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};function o(t){var e=t.state.matchHighlighter;(e.active||t.hasFocus())&&i(t,e)}function n(t){var e=t.state.matchHighlighter;e.active||(e.active=!0,i(t,e))}function i(t,e){clearTimeout(e.timeout),e.timeout=setTimeout(function(){s(t)},e.options.delay)}function r(t,e,o,n){var i=t.state.matchHighlighter;if(t.addOverlay(i.overlay=function(t,e,o){return{token:function(n){if(n.match(t)&&(!e||function(t,e){return!(t.start&&e.test(t.string.charAt(t.start-1))||t.pos!=t.string.length&&e.test(t.string.charAt(t.pos)))}(n,e)))return o;n.next(),n.skipTo(t.charAt(0))||n.skipToEnd()}}}(e,o,n)),i.options.annotateScrollbar&&t.showMatchesOnScrollbar){var r=o?new RegExp("\\b"+e.replace(/[\\\[.+*?(){|^$]/g,"\\$&")+"\\b"):e;i.matchesonscroll=t.showMatchesOnScrollbar(r,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}}function a(t){var e=t.state.matchHighlighter;e.overlay&&(t.removeOverlay(e.overlay),e.overlay=null,e.matchesonscroll&&(e.matchesonscroll.clear(),e.matchesonscroll=null))}function s(t){t.operation(function(){var e=t.state.matchHighlighter;if(a(t),t.somethingSelected()||!e.options.showToken){var o=t.getCursor("from"),n=t.getCursor("to");if(o.line==n.line&&(!e.options.wordsOnly||function(t,e,o){if(null!==t.getRange(e,o).match(/^\w+$/)){if(e.ch>0){var n={line:e.line,ch:e.ch-1},i=t.getRange(n,e);if(null===i.match(/\W/))return!1}if(o.ch<t.getLine(e.line).length){var n={line:o.line,ch:o.ch+1},i=t.getRange(o,n);if(null===i.match(/\W/))return!1}return!0}return!1}(t,o,n))){var i=t.getRange(o,n);e.options.trim&&(i=i.replace(/^\s+|\s+$/g,"")),i.length>=e.options.minChars&&r(t,i,!1,e.options.style)}}else{for(var s=!0===e.options.showToken?/[\w$]/:e.options.showToken,l=t.getCursor(),c=t.getLine(l.line),h=l.ch,u=h;h&&s.test(c.charAt(h-1));)--h;for(;u<c.length&&s.test(c.charAt(u));)++u;h<u&&r(t,c.slice(h,u),s,e.options.style)}})}t.defineOption("highlightSelectionMatches",!1,function(i,r,l){if(l&&l!=t.Init&&(a(i),clearTimeout(i.state.matchHighlighter.timeout),i.state.matchHighlighter=null,i.off("cursorActivity",o),i.off("focus",n)),r){var c=i.state.matchHighlighter=new function(t){for(var o in this.options={},e)this.options[o]=(t&&t.hasOwnProperty(o)?t:e)[o];this.overlay=this.timeout=null,this.matchesonscroll=null,this.active=!1}(r);i.hasFocus()?(c.active=!0,s(i)):i.on("focus",n),i.on("cursorActivity",o)}})});
//# sourceMappingURL=../../sourcemaps/addon/search/match-highlighter.js.map
