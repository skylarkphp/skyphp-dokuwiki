/**
 * skylark-codemirror - A version of codemirror 5.45  that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-codemirror/
 * @license MIT
 */
define(["../../CodeMirror","../xml/xml","../javascript/javascript"],function(t){"use strict";function e(t,e,n,r){this.state=t,this.mode=e,this.depth=n,this.prev=r}t.defineMode("jsx",function(n,r){var a=t.getMode(n,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1,allowMissingTagName:!0}),i=t.getMode(n,r&&r.base||"javascript");function s(t){var e=t.tagName;t.tagName=null;var n=a.indent(t,"","");return t.tagName=e,n}function o(r,c){return c.context.mode==a?function(r,c,p){if(2==p.depth)return r.match(/^.*?\*\//)?p.depth=1:r.skipToEnd(),"comment";if("{"==r.peek()){a.skipAttribute(p.state);var d=s(p.state),u=p.state.context;if(u&&r.match(/^[^>]*>\s*$/,!1)){for(;u.prev&&!u.startOfLine;)u=u.prev;u.startOfLine?d-=n.indentUnit:p.prev.state.lexical&&(d=p.prev.state.lexical.indented)}else 1==p.depth&&(d+=n.indentUnit);return c.context=new e(t.startState(i,d),i,0,c.context),null}if(1==p.depth){if("<"==r.peek())return a.skipAttribute(p.state),c.context=new e(t.startState(a,s(p.state)),a,0,c.context),null;if(r.match("//"))return r.skipToEnd(),"comment";if(r.match("/*"))return p.depth=2,o(r,c)}var x,f=a.token(r,p.state),l=r.current();/\btag\b/.test(f)?/>$/.test(l)?p.state.context?p.depth=0:c.context=c.context.prev:/^</.test(l)&&(p.depth=1):!f&&(x=l.indexOf("{"))>-1&&r.backUp(l.length-x);return f}(r,c,c.context):function(n,r,s){if("<"==n.peek()&&i.expressionAllowed(n,s.state))return i.skipExpression(s.state),r.context=new e(t.startState(a,i.indent(s.state,"","")),a,0,r.context),null;var o=i.token(n,s.state);if(!o&&null!=s.depth){var c=n.current();"{"==c?s.depth++:"}"==c&&0==--s.depth&&(r.context=r.context.prev)}return o}(r,c,c.context)}return{startState:function(){return{context:new e(t.startState(i),i)}},copyState:function(n){return{context:function n(r){return new e(t.copyState(r.mode,r.state),r.mode,r.depth,r.prev&&n(r.prev))}(n.context)}},token:o,indent:function(t,e,n){return t.context.mode.indent(t.context.state,e,n)},innerMode:function(t){return t.context}}},"xml","javascript"),t.defineMIME("text/jsx","jsx"),t.defineMIME("text/typescript-jsx",{name:"jsx",base:{name:"javascript",typescript:!0}})});
//# sourceMappingURL=../../sourcemaps/mode/jsx/jsx.js.map
