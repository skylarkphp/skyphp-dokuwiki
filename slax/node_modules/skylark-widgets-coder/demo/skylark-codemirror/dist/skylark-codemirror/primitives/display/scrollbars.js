/**
 * skylark-codemirror - A version of codemirror 5.45  that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-codemirror/
 * @license MIT
 */
define(["../util/dom","../util/event","../measurement/position_measurement","../util/browser","./update_lines","../util/misc","./scrolling"],function(t,e,i,l,r,s,o){"use strict";function h(t){let e=t.display,l=e.gutters.offsetWidth,r=Math.round(t.doc.height+i.paddingVert(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?l:0,docHeight:r,scrollHeight:r+i.scrollGap(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:l}}function a(t,e){let i=t.display,l=i.scrollbars.update(e);i.sizer.style.paddingRight=(i.barWidth=l.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=l.bottom)+"px",i.heightForcer.style.borderBottom=l.bottom+"px solid transparent",l.right&&l.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=l.bottom+"px",i.scrollbarFiller.style.width=l.right+"px"):i.scrollbarFiller.style.display="",l.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=l.bottom+"px",i.gutterFiller.style.width=e.gutterWidth+"px"):i.gutterFiller.style.display=""}let d={native:class{constructor(i,r,s){this.cm=s;let o=this.vert=t.elt("div",[t.elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),h=this.horiz=t.elt("div",[t.elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");o.tabIndex=h.tabIndex=-1,i(o),i(h),e.on(o,"scroll",()=>{o.clientHeight&&r(o.scrollTop,"vertical")}),e.on(h,"scroll",()=>{h.clientWidth&&r(h.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,l.ie&&l.ie_version<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}update(t){let e=t.scrollWidth>t.clientWidth+1,i=t.scrollHeight>t.clientHeight+1,l=t.nativeBarWidth;if(i){this.vert.style.display="block",this.vert.style.bottom=e?l+"px":"0";let i=t.viewHeight-(e?l:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+i)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(e){this.horiz.style.display="block",this.horiz.style.right=i?l+"px":"0",this.horiz.style.left=t.barLeft+"px";let e=t.viewWidth-t.barLeft-(i?l:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+e)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==l&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?l:0,bottom:e?l:0}}setScrollLeft(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")}setScrollTop(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")}zeroWidthHack(){let t=l.mac&&!l.mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new s.Delayed,this.disableVert=new s.Delayed}enableZeroWidthBar(t,e,i){t.style.pointerEvents="auto",e.set(1e3,function l(){let r=t.getBoundingClientRect();("vert"==i?document.elementFromPoint(r.right-1,(r.top+r.bottom)/2):document.elementFromPoint((r.right+r.left)/2,r.bottom-1))!=t?t.style.pointerEvents="none":e.set(1e3,l)})}clear(){let t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)}},null:class{update(){return{bottom:0,right:0}}setScrollLeft(){}setScrollTop(){}clear(){}}};return{measureForScrollbars:h,updateScrollbars:function(t,e){e||(e=h(t));let i=t.display.barWidth,l=t.display.barHeight;a(t,e);for(let e=0;e<4&&i!=t.display.barWidth||l!=t.display.barHeight;e++)i!=t.display.barWidth&&t.options.lineWrapping&&r.updateHeightsInViewport(t),a(t,h(t)),i=t.display.barWidth,l=t.display.barHeight},scrollbarModel:d,initScrollbars:function(i){i.display.scrollbars&&(i.display.scrollbars.clear(),i.display.scrollbars.undefined&&t.rmClass(i.display.wrapper,i.display.scrollbars.undefined)),i.display.scrollbars=new d[i.options.scrollbarStyle](t=>{i.display.wrapper.insertBefore(t,i.display.scrollbarFiller),e.on(t,"mousedown",()=>{i.state.focused&&setTimeout(()=>i.display.input.focus(),0)}),t.setAttribute("cm-not-content","true")},(t,e)=>{"horizontal"==e?o.setScrollLeft(i,t):o.updateScrollTop(i,t)},i),i.display.scrollbars.undefined&&t.addClass(i.display.wrapper,i.display.scrollbars.undefined)}}});
//# sourceMappingURL=../../sourcemaps/primitives/display/scrollbars.js.map
