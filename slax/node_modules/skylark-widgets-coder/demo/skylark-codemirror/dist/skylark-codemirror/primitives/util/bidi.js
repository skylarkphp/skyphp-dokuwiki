/**
 * skylark-codemirror - A version of codemirror 5.45  that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-codemirror/
 * @license MIT
 */
define(["./misc"],function(r){"use strict";let t=null;let L=function(){let t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",L="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";let e=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,l=/[stwN]/,n=/[LRr]/,m=/[Lb1n]/,b=/[1n]/;function N(r,t,L){this.level=r,this.from=t,this.to=L}return function(f,o){let s="ltr"==o?"L":"R";if(0==f.length||"ltr"==o&&!e.test(f))return!1;let i=f.length,u=[];for(let r=0;r<i;++r)u.push((h=f.charCodeAt(r))<=247?t.charAt(h):1424<=h&&h<=1524?"R":1536<=h&&h<=1785?L.charAt(h-1536):1774<=h&&h<=2220?"r":8192<=h&&h<=8203?"w":8204==h?"b":"L");var h;for(let r=0,t=s;r<i;++r){let L=u[r];"m"==L?u[r]=t:t=L}for(let r=0,t=s;r<i;++r){let L=u[r];"1"==L&&"r"==t?u[r]="n":n.test(L)&&(t=L,"r"==L&&(u[r]="R"))}for(let r=1,t=u[0];r<i-1;++r){let L=u[r];"+"==L&&"1"==t&&"1"==u[r+1]?u[r]="1":","!=L||t!=u[r+1]||"1"!=t&&"n"!=t||(u[r]=t),t=L}for(let r=0;r<i;++r){let t=u[r];if(","==t)u[r]="N";else if("%"==t){let t;for(t=r+1;t<i&&"%"==u[t];++t);let L=r&&"!"==u[r-1]||t<i&&"1"==u[t]?"1":"N";for(let e=r;e<t;++e)u[e]=L;r=t-1}}for(let r=0,t=s;r<i;++r){let L=u[r];"L"==t&&"1"==L?u[r]="L":n.test(L)&&(t=L)}for(let r=0;r<i;++r)if(l.test(u[r])){let t;for(t=r+1;t<i&&l.test(u[t]);++t);let L="L"==(r?u[r-1]:s),e=L==("L"==(t<i?u[t]:s))?L?"L":"R":s;for(let L=r;L<t;++L)u[L]=e;r=t-1}let c,a=[];for(let r=0;r<i;)if(m.test(u[r])){let t=r;for(++r;r<i&&m.test(u[r]);++r);a.push(new N(0,t,r))}else{let t=r,L=a.length;for(++r;r<i&&"L"!=u[r];++r);for(let e=t;e<r;)if(b.test(u[e])){t<e&&a.splice(L,0,new N(1,t,e));let l=e;for(++e;e<r&&b.test(u[e]);++e);a.splice(L,0,new N(2,l,e)),t=e}else++e;t<r&&a.splice(L,0,new N(1,t,r))}return"ltr"==o&&(1==a[0].level&&(c=f.match(/^\s+/))&&(a[0].from=c[0].length,a.unshift(new N(0,0,c[0].length))),1==r.lst(a).level&&(c=f.match(/\s+$/))&&(r.lst(a).to-=c[0].length,a.push(new N(0,i-c[0].length,i)))),"rtl"==o?a.reverse():a}}();return{iterateBidiSections:function(r,t,L,e){if(!r)return e(t,L,"ltr",0);let l=!1;for(let n=0;n<r.length;++n){let m=r[n];(m.from<L&&m.to>t||t==L&&m.to==t)&&(e(Math.max(m.from,t),Math.min(m.to,L),1==m.level?"rtl":"ltr",n),l=!0)}l||e(t,L,"ltr")},bidiOther:t,getBidiPartAt:function(r,L,e){let l;t=null;for(let n=0;n<r.length;++n){let m=r[n];if(m.from<L&&m.to>L)return n;m.to==L&&(m.from!=m.to&&"before"==e?l=n:t=n),m.from==L&&(m.from!=m.to&&"before"!=e?l=n:t=n)}return null!=l?l:t},getOrder:function(r,t){let e=r.order;return null==e&&(e=r.order=L(r.text,t)),e}}});
//# sourceMappingURL=../../sourcemaps/primitives/util/bidi.js.map
