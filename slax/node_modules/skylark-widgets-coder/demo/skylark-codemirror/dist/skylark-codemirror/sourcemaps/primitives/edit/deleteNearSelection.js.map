{"version":3,"sources":["primitives/edit/deleteNearSelection.js"],"names":["define","operations","scrolling","line_pos","changes","misc","deleteNearSelection","cm","compute","ranges","doc","sel","kill","i","length","toKill","cmp","from","lst","to","replaced","pop","push","runInOp","replaceRange","ensureCursorVisible"],"mappings":";;;;;;;AAAAA,QACI,wBACA,uBACA,cACA,mBACA,gBACD,SAAUC,EAAYC,EAAWC,EAAUC,EAASC,GACnD,aAoBA,OAASC,oBAnBT,SAA6BC,EAAIC,GAC7B,IAAIC,EAASF,EAAGG,IAAIC,IAAIF,OAAQG,KAChC,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAOK,OAAQD,IAAK,CACpC,IAAIE,EAASP,EAAQC,EAAOI,IAC5B,KAAOD,EAAKE,QAAUX,EAASa,IAAID,EAAOE,KAAMZ,EAAKa,IAAIN,GAAMO,KAAO,GAAG,CACrE,IAAIC,EAAWR,EAAKS,MACpB,GAAIlB,EAASa,IAAII,EAASH,KAAMF,EAAOE,MAAQ,EAAG,CAC9CF,EAAOE,KAAOG,EAASH,KACvB,OAGRL,EAAKU,KAAKP,GAEdd,EAAWsB,QAAQhB,EAAI,KACnB,IAAK,IAAIM,EAAID,EAAKE,OAAS,EAAGD,GAAK,EAAGA,IAClCT,EAAQoB,aAAajB,EAAGG,IAAK,GAAIE,EAAKC,GAAGI,KAAML,EAAKC,GAAGM,GAAI,WAC/DjB,EAAUuB,oBAAoBlB","file":"../../../primitives/edit/deleteNearSelection.js","sourcesContent":["define([\n    '../display/operations',\n    '../display/scrolling',\n    '../line/pos',\n    '../model/changes',\n    '../util/misc'\n], function (operations, scrolling, line_pos, changes, misc) {\n    'use strict';\n    function deleteNearSelection(cm, compute) {\n        let ranges = cm.doc.sel.ranges, kill = [];\n        for (let i = 0; i < ranges.length; i++) {\n            let toKill = compute(ranges[i]);\n            while (kill.length && line_pos.cmp(toKill.from, misc.lst(kill).to) <= 0) {\n                let replaced = kill.pop();\n                if (line_pos.cmp(replaced.from, toKill.from) < 0) {\n                    toKill.from = replaced.from;\n                    break;\n                }\n            }\n            kill.push(toKill);\n        }\n        operations.runInOp(cm, () => {\n            for (let i = kill.length - 1; i >= 0; i--)\n                changes.replaceRange(cm.doc, '', kill[i].from, kill[i].to, '+delete');\n            scrolling.ensureCursorVisible(cm);\n        });\n    }\n    return { deleteNearSelection: deleteNearSelection };\n});"]}