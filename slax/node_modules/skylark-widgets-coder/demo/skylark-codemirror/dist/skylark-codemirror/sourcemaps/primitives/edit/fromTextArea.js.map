{"version":3,"sources":["primitives/edit/fromTextArea.js"],"names":["define","CodeMirror","dom","events","misc","fromTextArea","textarea","options","copyObj","value","tabindex","tabIndex","placeholder","autofocus","hasFocus","activeElt","getAttribute","document","body","save","cm","getValue","realSubmit","form","on","leaveSubmitMethodAlone","submit","wrappedSubmit","e","finishInit","getTextArea","toTextArea","isNaN","parentNode","removeChild","getWrapperElement","style","display","off","node","insertBefore","nextSibling"],"mappings":";;;;;;;AAAAA,QACI,eACA,cACA,gBACA,gBACD,SAAUC,EAAYC,EAAKC,EAAQC,GAClC,aAmDA,OAASC,aAlDT,SAAsBC,EAAUC,GAO5B,IANAA,EAAUA,EAAUH,EAAKI,QAAQD,OACzBE,MAAQH,EAASG,OACpBF,EAAQG,UAAYJ,EAASK,WAC9BJ,EAAQG,SAAWJ,EAASK,WAC3BJ,EAAQK,aAAeN,EAASM,cACjCL,EAAQK,YAAcN,EAASM,aACV,MAArBL,EAAQM,UAAmB,CAC3B,IAAIC,EAAWZ,EAAIa,YACnBR,EAAQM,UAAYC,GAAYR,GAAkD,MAAtCA,EAASU,aAAa,cAAwBF,GAAYG,SAASC,KAEnH,SAASC,IACLb,EAASG,MAAQW,EAAGC,WAExB,IAAIC,EACJ,GAAIhB,EAASiB,OACTpB,EAAOqB,GAAGlB,EAASiB,KAAM,SAAUJ,IAC9BZ,EAAQkB,wBAAwB,CACjC,IAAIF,EAAOjB,EAASiB,KACpBD,EAAaC,EAAKG,OAClB,IACI,IAAIC,EAAgBJ,EAAKG,OAAS,MAC9BP,IACAI,EAAKG,OAASJ,EACdC,EAAKG,SACLH,EAAKG,OAASC,IAEpB,MAAOC,KAIjBrB,EAAQsB,WAAaT,CAAAA,IACjBA,EAAGD,KAAOA,EACVC,EAAGU,YAAc,KAAMxB,GACvBc,EAAGW,WAAa,MACZX,EAAGW,WAAaC,MAChBb,IACAb,EAAS2B,WAAWC,YAAYd,EAAGe,qBACnC7B,EAAS8B,MAAMC,QAAU,GACrB/B,EAASiB,OACTpB,EAAOmC,IAAIhC,EAASiB,KAAM,SAAUJ,GACD,mBAAxBb,EAASiB,KAAKG,SACrBpB,EAASiB,KAAKG,OAASJ,QAIvChB,EAAS8B,MAAMC,QAAU,OACzB,IAAIjB,EAAKnB,EAAWsC,GAAQjC,EAAS2B,WAAWO,aAAaD,EAAMjC,EAASmC,aAAclC,GAC1F,OAAOa","file":"../../../primitives/edit/fromTextArea.js","sourcesContent":["define([\n    './CodeMirror',\n    '../util/dom',\n    '../util/event',\n    '../util/misc'\n], function (CodeMirror, dom, events, misc) {\n    'use strict';\n    function fromTextArea(textarea, options) {\n        options = options ? misc.copyObj(options) : {};\n        options.value = textarea.value;\n        if (!options.tabindex && textarea.tabIndex)\n            options.tabindex = textarea.tabIndex;\n        if (!options.placeholder && textarea.placeholder)\n            options.placeholder = textarea.placeholder;\n        if (options.autofocus == null) {\n            let hasFocus = dom.activeElt();\n            options.autofocus = hasFocus == textarea || textarea.getAttribute('autofocus') != null && hasFocus == document.body;\n        }\n        function save() {\n            textarea.value = cm.getValue();\n        }\n        let realSubmit;\n        if (textarea.form) {\n            events.on(textarea.form, 'submit', save);\n            if (!options.leaveSubmitMethodAlone) {\n                let form = textarea.form;\n                realSubmit = form.submit;\n                try {\n                    let wrappedSubmit = form.submit = () => {\n                        save();\n                        form.submit = realSubmit;\n                        form.submit();\n                        form.submit = wrappedSubmit;\n                    };\n                } catch (e) {\n                }\n            }\n        }\n        options.finishInit = cm => {\n            cm.save = save;\n            cm.getTextArea = () => textarea;\n            cm.toTextArea = () => {\n                cm.toTextArea = isNaN;\n                save();\n                textarea.parentNode.removeChild(cm.getWrapperElement());\n                textarea.style.display = '';\n                if (textarea.form) {\n                    events.off(textarea.form, 'submit', save);\n                    if (typeof textarea.form.submit == 'function')\n                        textarea.form.submit = realSubmit;\n                }\n            };\n        };\n        textarea.style.display = 'none';\n        let cm = CodeMirror(node => textarea.parentNode.insertBefore(node, textarea.nextSibling), options);\n        return cm;\n    }\n    return { fromTextArea: fromTextArea };\n});"]}