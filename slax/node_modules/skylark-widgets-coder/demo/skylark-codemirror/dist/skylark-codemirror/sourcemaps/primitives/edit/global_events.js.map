{"version":3,"sources":["primitives/edit/global_events.js"],"names":["define","focuses","events","forEachCodeMirror","f","document","getElementsByClassName","byClass","editors","i","length","cm","CodeMirror","push","operation","globalsRegistered","onResize","d","display","cachedCharWidth","cachedTextHeight","cachedPaddingH","scrollbarsClipped","setSize","ensureGlobalHandlers","resizeTimer","on","window","setTimeout","onBlur","registerGlobalHandlers"],"mappings":";;;;;;;AAAAA,QACI,mBACA,iBACD,SAAUC,EAASC,GAClB,aACA,SAASC,EAAkBC,GACvB,IAAKC,SAASC,uBACV,OACJ,IAAIC,EAAUF,SAASC,uBAAuB,cAAeE,KAC7D,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAQG,OAAQD,IAAK,CACrC,IAAIE,EAAKJ,EAAQE,GAAGG,WAChBD,GACAH,EAAQK,KAAKF,GAEjBH,EAAQE,QACRF,EAAQ,GAAGM,UAAU,KACjB,IAAK,IAAIL,EAAI,EAAGA,EAAID,EAAQE,OAAQD,IAChCL,EAAEI,EAAQC,MAG1B,IAAIM,GAAoB,EAkBxB,SAASC,EAASL,GACd,IAAIM,EAAIN,EAAGO,QACXD,EAAEE,gBAAkBF,EAAEG,iBAAmBH,EAAEI,eAAiB,KAC5DJ,EAAEK,mBAAoB,EACtBX,EAAGY,UAEP,OAASC,qBAvBT,WACQT,IAKR,WACI,IAAIU,EACJvB,EAAOwB,GAAGC,OAAQ,SAAU,KACL,MAAfF,IACAA,EAAcG,WAAW,KACrBH,EAAc,KACdtB,EAAkBa,IACnB,QAEXd,EAAOwB,GAAGC,OAAQ,OAAQ,IAAMxB,EAAkBF,EAAQ4B,SAZ1DC,GACAf,GAAoB","file":"../../../primitives/edit/global_events.js","sourcesContent":["define([\n    '../display/focus',\n    '../util/event'\n], function (focuses, events) {\n    'use strict';\n    function forEachCodeMirror(f) {\n        if (!document.getElementsByClassName)\n            return;\n        let byClass = document.getElementsByClassName('CodeMirror'), editors = [];\n        for (let i = 0; i < byClass.length; i++) {\n            let cm = byClass[i].CodeMirror;\n            if (cm)\n                editors.push(cm);\n        }\n        if (editors.length)\n            editors[0].operation(() => {\n                for (let i = 0; i < editors.length; i++)\n                    f(editors[i]);\n            });\n    }\n    let globalsRegistered = false;\n    function ensureGlobalHandlers() {\n        if (globalsRegistered)\n            return;\n        registerGlobalHandlers();\n        globalsRegistered = true;\n    }\n    function registerGlobalHandlers() {\n        let resizeTimer;\n        events.on(window, 'resize', () => {\n            if (resizeTimer == null)\n                resizeTimer = setTimeout(() => {\n                    resizeTimer = null;\n                    forEachCodeMirror(onResize);\n                }, 100);\n        });\n        events.on(window, 'blur', () => forEachCodeMirror(focuses.onBlur));\n    }\n    function onResize(cm) {\n        let d = cm.display;\n        d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n        d.scrollbarsClipped = false;\n        cm.setSize();\n    }\n    return { ensureGlobalHandlers: ensureGlobalHandlers };\n});"]}