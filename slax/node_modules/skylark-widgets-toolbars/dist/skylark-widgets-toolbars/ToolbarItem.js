/**
 * skylark-widgets-toolbars - The skylark toolbar widgets library
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-widgets/skylark-widgets-toolbars/
 * @license MIT
 */
define(["skylark-langx/langx","skylark-domx-query","skylark-widgets-base/Widget","./toolbars"],function(t,e,n,i){var a=n.inherit({options:{template:'<li><a tabindex="-1" unselectable="on" class="toolbar-item" href="javascript:;"><span></span></a></li>',menu:{menuWrapper:'<div class="toolbar-menu"></div>',menuItem:'<li><a tabindex="-1" unselectable="on" class="menu-item" href="javascript:;"><span></span></a></li>',separator:'<li><span class="separator"></span></li>'}},_construct:function(t){this.action=t.action,this.toolbar=t.toolbar,n.prototype._construct.call(this,t)},_init:function(){this.toolbar.addToolItem(this),this.wrapper=e(this._elm),this.el=this.wrapper.find("a.toolbar-item"),this.el.attr("title",this.title).addClass("toolbar-item-"+this.name).data("button",this),this.setIcon(this.icon),this.menu&&(this.menuWrapper=e(this.options.menu.menuWrapper).appendTo(this.wrapper),this.menuWrapper.addClass("toolbar-menu-"+this.name),this.renderMenu());var t=this;this.el.on("mousedown",function(e){var n;return e.preventDefault(),!t.el.hasClass("disabled")&&(t.menu?(t.wrapper.toggleClass("menu-on").siblings("li").removeClass("menu-on"),t.wrapper.is(".menu-on")&&(t.menuWrapper.offset().left+t.menuWrapper.outerWidth()+5-t.toolbar.offset().left-t.toolbar.outerWidth()>0&&t.menuWrapper.css({left:"auto",right:0}),t.trigger("menuexpand")),!1):(n=t.el.data("param"),t.command(n),!1))}),this.wrapper.on("click","a.menu-item",function(n){var i,a;return n.preventDefault(),i=e(n.currentTarget),t.wrapper.removeClass("menu-on"),!i.hasClass("disabled")&&(t.toolbar.removeClass("menu-on"),a=i.data("param"),t.command(a),!1)}),this.wrapper.on("mousedown","a.menu-item",function(t){return!1}),this.action.state.on("changed",function(e,n){var i=n.data;void 0!==i.active&&t._doActive(i.active.value),void 0!==i.disabled&&t._doDisabled(i.disabled.value)})},_doActive:function(t){return this.el.toggleClass("active",t)},_doDisabled:function(t){return this.el.toggleClass("disabled",t)},iconClassOf:function(t){return t?this.toolbar.options.classes&&this.toolbar.options.classes.icons&&this.toolbar.options.classes.icons[t]?this.toolbar.options.classes.icons[t]:"wordpad-icon wordpad-icon-"+t:""},setIcon:function(t){return this.el.find("span").removeClass().addClass(this.iconClassOf(t)).text(this.text)},render:function(){if(this.toolbar.addToolItem(this),this.wrapper=e(this._elm),this.el=this.wrapper.find("a.toolbar-item"),this.el.attr("title",this.title).addClass("toolbar-item-"+this.name).data("button",this),this.setIcon(this.icon),this.menu)return this.menuWrapper=e(this.options.menu.menuWrapper).appendTo(this.wrapper),this.menuWrapper.addClass("toolbar-menu-"+this.name),this.renderMenu()},renderMenu:function(){var n,i,a,s,o,r,l;if(t.isArray(this.menu)){for(this.menuEl=e("<ul/>").appendTo(this.menuWrapper),l=[],i=0,a=(o=this.menu).length;i<a;i++)"|"!==(s=o[i])?(n=e(this.options.menu.menuItem).appendTo(this.menuEl).find("a.menu-item").attr({title:null!=(r=s.title)?r:s.text,"data-param":s.param}).addClass("menu-item-"+s.name),s.icon?l.push(n.find("span").addClass(this.iconClassOf(s.icon))):l.push(n.find("span").text(s.text))):e(this.options.menu.separator).appendTo(this.menuEl);return l}},command:function(t){this.action.execute(t)},name:{get:function(){return this.action.name}},icon:{get:function(){return this.action.icon}},title:{get:function(){return this.action.tooltip}},text:{get:function(){return this.action.text}},htmlTag:{get:function(){return this.action.htmlTag}},disableTag:{get:function(){return this.action.disableTag}},menu:{get:function(){return this.action.menu}},editable:{get:function(){return this._options.editable}},active:{get:function(){return this.action.active}},disabled:{get:function(){return this.action.disabled}},needFocus:{get:function(){return this.action.needFocus}},shortcut:{get:function(){return this.action.shortcut}}});return i.ToolbarItem=a});
//# sourceMappingURL=sourcemaps/ToolbarItem.js.map
