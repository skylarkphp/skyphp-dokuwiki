{"version":3,"sources":["skylark-widgets-toolbars.js"],"names":["define","skylark","attach","langx","$","plugins","panels","Panel","Toolbar","inherit","klassName","pluginName","options","toolbarFloat","toolbarHidden","toolbarFloatOffset","template","separator","_construct","elm","toolbarHeight","_this","prototype","call","this","opts","wrapper","_elm","list","find","on","e","removeClass","document","css","width","editor","editable","util","reflow","outerWidth","os","mobile","position","left","offset","outerHeight","placeholderEl","addToolItem","itemWidget","appendTo","addSeparator","register","Widget","toolbars","ToolbarItem","menu","menuWrapper","menuItem","action","toolbar","_init","el","attr","title","addClass","name","data","setIcon","icon","renderMenu","param","preventDefault","hasClass","toggleClass","siblings","is","right","trigger","command","btn","currentTarget","state","args","updates","undefined","_doActive","value","_doDisabled","iconClassOf","classes","icons","text","render","$menuBtnEl","$menuItemEl","k","len","ref","ref1","results","isArray","menuEl","length","data-param","push","params","execute","get","tooltip","htmlTag","disableTag","_options","active","disabled","needFocus","shortcut","_Toolbar","parent","_xtoolbar","instantiate","buttons","actions","i","toolItemCtor","item","findButton","button","addButton","main"],"mappings":";;;;;;;g4BAAAA,EAAA,qCACA,yBACA,SAAAC,GACA,OAAAA,EAAAC,OAAA,yBAEAF,EAAA,uCACA,sBACA,qBACA,4BACA,WACA,WACA,SAAAG,EAAAC,EAAAC,EAAAC,EAAAC,GAGA,IAAAC,EAAAD,EAAAE,SACAC,UAAA,UAEAC,WAAA,sBAEAC,SACAC,cAAA,EACAC,eAAA,EACAC,mBAAA,EACAC,SAAA,4CACAC,WACAD,SAAA,6CAIAE,WAAA,SAAAC,EAAAP,GAGA,IAAAQ,EAgBAC,EAlBAd,EAAAe,UAAAJ,WAAAK,KAAAC,KAAAL,EAAAP,GAMAY,KAAAC,KAAAD,KAAAZ,QAOAY,KAAAE,QAAAtB,EAAAoB,KAAAG,MACAH,KAAAI,KAAAJ,KAAAE,QAAAG,KAAA,MACAL,KAAAI,KAAAE,GAAA,QAAA,SAAAC,GACA,OAAA,IAEAP,KAAAE,QAAAI,GAAA,aAAAT,EAIAG,KAHA,SAAAO,GACA,OAAAV,EAAAO,KAAAC,KAAA,YAAAG,YAAA,eAGA5B,EAAA6B,UAAAH,GAAA,oBAAA,SAAAT,GACA,OAAA,SAAAU,GACA,OAAAV,EAAAO,KAAAC,KAAA,YAAAG,YAAA,YAFA,CAIAR,QACAA,KAAAC,KAAAX,eAAAU,KAAAC,KAAAZ,eACAW,KAAAE,QAAAQ,IAAA,MAAAV,KAAAC,KAAAV,oBACAK,EAAA,EACA,SAAAC,GACA,OAAA,WASA,OARAA,EAAAK,QAAAQ,IAAA,WAAA,UACAb,EAAAK,QAAAS,MAAA,QACAd,EAAAe,OAAAC,SAAAC,KAAAC,OAAAlB,EAAAK,SACAL,EAAAK,QAAAS,MAAAd,EAAAK,QAAAc,cACAnB,EAAAK,QAAAQ,IAAA,OAAAb,EAAAe,OAAAC,SAAAC,KAAAG,GAAAC,OAAArB,EAAAK,QAAAiB,WAAAC,KAAAvB,EAAAK,QAAAmB,SAAAD,MACAvB,EAAAK,QAAAQ,IAAA,WAAA,IACAd,EAAAC,EAAAK,QAAAoB,cACAzB,EAAAe,OAAAW,cAAAb,IAAA,MAAAd,IACA,GAVA,CAYAI,QArCAwB,YAAA,SAAAC,GAEA,OADA7C,EAAA6C,EAAAtB,MAAAuB,SAAA1B,KAAAI,MACAJ,MAGA2B,aAAA,WAEA,OADA/C,EAAAoB,KAAAZ,QAAAK,UAAAD,UAAAkC,SAAA1B,KAAAI,MACAJ,QAOA,OAFAnB,EAAA+C,SAAA5C,GAEAF,EAAAE,QAAAA,IAGAR,EAAA,wCACA,sBACA,qBACA,8BACA,cACA,SAAAG,EAAAC,EAAAiD,EAAAC,GACA,IAEAC,EAAAF,EAAA5C,SAEAG,SACAI,SAAA,yGAEAwC,MACAC,YAAA,mCACAC,SAAA,sGACAzC,UAAA,6CAKAC,WAAA,SAAAO,GACAD,KAAAmC,OAAAlC,EAAAkC,OACAnC,KAAAoC,QAAAnC,EAAAmC,QAEAP,EAAA/B,UAAAJ,WAAAK,KAAAC,KAAAC,IAGAoC,MAAA,WAKArC,KAAAoC,QAAAZ,YAAAxB,MACAA,KAAAE,QAAAtB,EAAAoB,KAAAG,MAEAH,KAAAsC,GAAAtC,KAAAE,QAAAG,KAAA,kBACAL,KAAAsC,GAAAC,KAAA,QAAAvC,KAAAwC,OAAAC,SAAA,gBAAAzC,KAAA0C,MAAAC,KAAA,SAAA3C,MACAA,KAAA4C,QAAA5C,KAAA6C,MACA7C,KAAAgC,OACAhC,KAAAiC,YAAArD,EAAAoB,KAAAZ,QAAA4C,KAAAC,aAAAP,SAAA1B,KAAAE,SACAF,KAAAiC,YAAAQ,SAAA,gBAAAzC,KAAA0C,MAEA1C,KAAA8C,cAGA,IAAAjD,EAAAG,KACAA,KAAAsC,GAAAhC,GAAA,YAAA,SAAAC,GACA,IAAAwC,EAGA,OAFAxC,EAAAyC,kBAEAnD,EAAAyC,GAAAW,SAAA,cAMApD,EAAAmC,MACAnC,EAAAK,QAAAgD,YAAA,WAAAC,SAAA,MAAA3C,YAAA,WACAX,EAAAK,QAAAkD,GAAA,cAEAvD,EAAAoC,YAAAZ,SAAAD,KAAAvB,EAAAoC,YAAAjB,aAAA,EAAAnB,EAAAuC,QAAAf,SAAAD,KAAAvB,EAAAuC,QAAApB,aACA,GACAnB,EAAAoC,YAAAvB,KACAU,KAAA,OACAiC,MAAA,IAGAxD,EAAAyD,QAAA,gBAEA,IAEAP,EAAAlD,EAAAyC,GAAAK,KAAA,SACA9C,EAAA0D,QAAAR,IACA,MAEA/C,KAAAE,QAAAI,GAAA,QAAA,cAAA,SAAAC,GACA,IAAAiD,EAAAT,EAKA,OAJAxC,EAAAyC,iBACAQ,EAAA5E,EAAA2B,EAAAkD,eACA5D,EAAAK,QAAAM,YAAA,YAEAgD,EAAAP,SAAA,cAGApD,EAAAuC,QAAA5B,YAAA,WACAuC,EAAAS,EAAAb,KAAA,SACA9C,EAAA0D,QAAAR,IACA,KAEA/C,KAAAE,QAAAI,GAAA,YAAA,cAAA,SAAAC,GACA,OAAA,IAGAP,KAAAmC,OAAAuB,MAAApD,GAAA,UAAA,SAAAC,EAAAoD,GACA,IAAAC,EAAAD,EAAAhB,UACAkB,IAAAD,EAAA,QACA/D,EAAAiE,UAAAF,EAAA,OAAAG,YAGAF,IAAAD,EAAA,UACA/D,EAAAmE,YAAAJ,EAAA,SAAAG,UAMAD,UAAA,SAAAC,GACA,OAAA/D,KAAAsC,GAAAY,YAAA,SAAAa,IAGAC,YAAA,SAAAD,GACA,OAAA/D,KAAAsC,GAAAY,YAAA,WAAAa,IAGAE,YAAA,SAAApB,GACA,OAAAA,EAGA7C,KAAAoC,QAAAhD,QAAA8E,SAAAlE,KAAAoC,QAAAhD,QAAA8E,QAAAC,OAAAnE,KAAAoC,QAAAhD,QAAA8E,QAAAC,MAAAtB,GACA7C,KAAAoC,QAAAhD,QAAA8E,QAAAC,MAAAtB,GAEA,6BAAAA,EAGA,IAIAD,QAAA,SAAAC,GACA,OAAA7C,KAAAsC,GAAAjC,KAAA,QAAAG,cAAAiC,SAAAzC,KAAAiE,YAAApB,IAAAuB,KAAApE,KAAAoE,OAGAC,OAAA,WASA,GANArE,KAAAoC,QAAAZ,YAAAxB,MACAA,KAAAE,QAAAtB,EAAAoB,KAAAG,MAEAH,KAAAsC,GAAAtC,KAAAE,QAAAG,KAAA,kBACAL,KAAAsC,GAAAC,KAAA,QAAAvC,KAAAwC,OAAAC,SAAA,gBAAAzC,KAAA0C,MAAAC,KAAA,SAAA3C,MACAA,KAAA4C,QAAA5C,KAAA6C,MACA7C,KAAAgC,KAKA,OAFAhC,KAAAiC,YAAArD,EAAAoB,KAAAZ,QAAA4C,KAAAC,aAAAP,SAAA1B,KAAAE,SACAF,KAAAiC,YAAAQ,SAAA,gBAAAzC,KAAA0C,MACA1C,KAAA8C,cAGAA,WAAA,WACA,IAAAwB,EAAAC,EAAAC,EAAAC,EAAAvC,EAAAwC,EAAAC,EAAAC,EACA,GAAAjG,EAAAkG,QAAA7E,KAAAgC,MAAA,CAMA,IAHAhC,KAAA8E,OAAAlG,EAAA,SAAA8C,SAAA1B,KAAAiC,aACAyC,EAAA1E,KAAAgC,KACA4C,KACAJ,EAAA,EAAAC,EAAAC,EAAAK,OAAAP,EAAAC,EAAAD,IAEA,OADAtC,EAAAwC,EAAAF,KAKAD,EAAA3F,EAAAoB,KAAAZ,QAAA4C,KAAAE,UAAAR,SAAA1B,KAAA8E,QACAR,EAAAC,EAAAlE,KAAA,eAAAkC,MACAC,MAAA,OAAAmC,EAAAzC,EAAAM,OAAAmC,EAAAzC,EAAAkC,KACAY,aAAA9C,EAAAa,QACAN,SAAA,aAAAP,EAAAQ,MACAR,EAAAW,KACA+B,EAAAK,KAAAX,EAAAjE,KAAA,QAAAoC,SAAAzC,KAAAiE,YAAA/B,EAAAW,QAEA+B,EAAAK,KAAAX,EAAAjE,KAAA,QAAA+D,KAAAlC,EAAAkC,QAXAxF,EAAAoB,KAAAZ,QAAA4C,KAAAvC,WAAAiC,SAAA1B,KAAA8E,QAcA,OAAAF,IAGArB,QAAA,SAAA2B,GACAlF,KAAAmC,OAAAgD,QAAAD,IAGAxC,MACA0C,IAAA,WACA,OAAApF,KAAAmC,OAAAO,OAIAG,MACAuC,IAAA,WACA,OAAApF,KAAAmC,OAAAU,OAIAL,OACA4C,IAAA,WAEA,OAAApF,KAAAmC,OAAAkD,UAIAjB,MACAgB,IAAA,WACA,OAAApF,KAAAmC,OAAAiC,OAIAkB,SACAF,IAAA,WACA,OAAApF,KAAAmC,OAAAmD,UAIAC,YACAH,IAAA,WACA,OAAApF,KAAAmC,OAAAoD,aAIAvD,MACAoD,IAAA,WACA,OAAApF,KAAAmC,OAAAH,OAIAnB,UACAuE,IAAA,WACA,OAAApF,KAAAwF,SAAA3E,WAIA4E,QACAL,IAAA,WACA,OAAApF,KAAAmC,OAAAsD,SAIAC,UACAN,IAAA,WACA,OAAApF,KAAAmC,OAAAuD,WAIAC,WACAP,IAAA,WACA,OAAApF,KAAAmC,OAAAwD,YAKAC,UACAR,IAAA,WACA,OAAApF,KAAAmC,OAAAyD,aAQA,OAAA9D,EAAAC,YAAAA,IAGAvD,EAAA,oCACA,sBACA,qBACA,sCACA,8BACA,aACA,iBACA,SAAAG,EAAAC,EAAAiH,EAAAhE,EAAAC,EAAAC,GACA,IAAA/C,EAAA6C,EAAA5C,SACAC,UAAA,UACAC,WAAA,uBAEAC,SACAI,SAAA,6CAGAE,WAAA,SAAAoG,EAAA7F,GAEA4B,EAAA/B,UAAAJ,WAAAK,KAAAC,KAAA8F,EAAA7F,IAIAoC,MAAA,WACArC,KAAA+F,UAAAF,EAAAG,YAAAhG,KAAAG,KAAAH,KAAAZ,SACAY,KAAAiG,WAKA,IADA,IAAAC,EAAAlG,KAAAZ,QAAA8G,QACAC,EAAA,EAAAA,EAAAD,EAAAnB,OAAAoB,IAAA,CACA,IAAAhE,EAAA+D,EAAAC,GAEA,GAAA,MAAAhE,EAAAO,KAAA,CAKA,IAAA0D,EAAAjE,EAAAiE,aAEAA,IACAA,EAAArE,GAGA/B,KAAAiG,QAAAhB,KAAA,IAAAmB,GACAjE,OAAAA,EACAC,QAAApC,aAZAA,KAAA+F,UAAApE,iBAoBAH,YAAA,SAAA6E,GACArG,KAAA+F,UAAAvE,YAAA6E,IAGAC,WAAA,SAAA5D,GACA,IAAA6D,EAEA,OAAA,OADAA,EAAAvG,KAAA+F,UAAA3F,KAAAC,KAAA,iBAAAqC,GAAAC,KAAA,WACA4D,EAAA,QAWA,OANAvH,EAAAwH,UAAA,SAAAhD,GACA,OAAAxD,KAAAiG,QAAAzC,EAAA1D,UAAA4C,MAAAc,GAGAxE,EAAAiH,WAEAnE,EAAA9C,QAAAA,IAGAR,EAAA,iCACA,aACA,YACA,iBACA,SAAAsD,GACA,OAAAA,IAEAtD,EAAA,4BAAA,iCAAA,SAAAiI,GAAA,OAAAA","file":"../skylark-widgets-toolbars.js","sourcesContent":["define('skylark-widgets-toolbars/toolbars',[\r\n\t\"skylark-langx/skylark\"\r\n],function(skylark){\r\n\treturn skylark.attach(\"widgets.toolbars\",{});\r\n});\ndefine('skylark-domx-plugins-panels/Toolbar',[\n  \"skylark-langx/langx\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins-base\",\n  \"./panels\",\n  \"./panel\"\n],function(langx,$,plugins,panels,Panel){ \n\n\n  var Toolbar = Panel.inherit({\n    klassName : \"Toolbar\",\n\n    pluginName : \"lark.panels.toolbar\",\n\n    options : {\n      toolbarFloat: true,\n      toolbarHidden: false,\n      toolbarFloatOffset: 0,\n      template : '<div class=\"domx-toolbar\"><ul></ul></div>',\n      separator : {\n        template :  '<li><span class=\"separator\"></span></li>'\n      }\n    },\n\n    _construct : function(elm,options) {\n      Panel.prototype._construct.call(this,elm,options);\n\n      var floatInitialized, initToolbarFloat, toolbarHeight;\n      //this.editor = editor;\n\n      //this.opts = langx.extend({}, this.opts, opts);\n      this.opts = this.options;\n\n\n      //if (!langx.isArray(this.opts.toolbar)) {\n      //  this.opts.toolbar = ['bold', 'italic', 'underline', 'strikethrough', '|', 'ol', 'ul', 'blockquote', 'code', '|', 'link', 'image', '|', 'indent', 'outdent'];\n      //}\n\n      this.wrapper = $(this._elm);\n      this.list = this.wrapper.find('ul');\n      this.list.on('click', function(e) {\n        return false;\n      });\n      this.wrapper.on('mousedown', (function(_this) {\n        return function(e) {\n          return _this.list.find('.menu-on').removeClass('.menu-on');\n        };\n      })(this));\n      $(document).on('mousedown.toolbar', (function(_this) {\n        return function(e) {\n          return _this.list.find('.menu-on').removeClass('menu-on');\n        };\n      })(this));\n      if (!this.opts.toolbarHidden && this.opts.toolbarFloat) {\n        this.wrapper.css('top', this.opts.toolbarFloatOffset);\n        toolbarHeight = 0;\n        initToolbarFloat = (function(_this) {\n          return function() {\n            _this.wrapper.css('position', 'static');\n            _this.wrapper.width('auto');\n            _this.editor.editable.util.reflow(_this.wrapper);\n            _this.wrapper.width(_this.wrapper.outerWidth());\n            _this.wrapper.css('left', _this.editor.editable.util.os.mobile ? _this.wrapper.position().left : _this.wrapper.offset().left);\n            _this.wrapper.css('position', '');\n            toolbarHeight = _this.wrapper.outerHeight();\n            _this.editor.placeholderEl.css('top', toolbarHeight);\n            return true;\n          };\n        })(this);\n        floatInitialized = null;\n\n        /*\n        $(window).on('resize.richeditor-' + this.editor.id, function(e) {\n          return floatInitialized = initToolbarFloat();\n        });\n        $(window).on('scroll.richeditor-' + this.editor.id, (function(_this) {\n          return function(e) {\n            var bottomEdge, scrollTop, topEdge;\n            if (!_this.wrapper.is(':visible')) {\n              return;\n            }\n            topEdge = _this.editor.wrapper.offset().top;\n            bottomEdge = topEdge + _this.editor.wrapper.outerHeight() - 80;\n            scrollTop = $(document).scrollTop() + _this.opts.toolbarFloatOffset;\n            if (scrollTop <= topEdge || scrollTop >= bottomEdge) {\n              _this.editor.wrapper.removeClass('toolbar-floating').css('padding-top', '');\n              if (_this.editor.editable.util.os.mobile) {\n                return _this.wrapper.css('top', _this.opts.toolbarFloatOffset);\n              }\n            } else {\n              floatInitialized || (floatInitialized = initToolbarFloat());\n              _this.editor.wrapper.addClass('toolbar-floating').css('padding-top', toolbarHeight);\n              if (_this.editor.editable.util.os.mobile) {\n                return _this.wrapper.css('top', scrollTop - topEdge + _this.opts.toolbarFloatOffset);\n              }\n            }\n          };\n        })(this));\n        */\n      }\n\n      /*\n      this.editor.on('destroy', (function(_this) {\n        return function() {\n          return _this.buttons.length = 0;\n        };\n      })(this));\n      */\n\n      \n    },\n\n    addToolItem : function(itemWidget) {\n      $(itemWidget._elm).appendTo(this.list);\n      return this;\n    },\n\n    addSeparator : function() {\n      $(this.options.separator.template).appendTo(this.list);\n      return this;\n    }\n\n  });\n\n  plugins.register(Toolbar);\n\n  return panels.Toolbar = Toolbar;\n\n});\ndefine('skylark-widgets-toolbars/ToolbarItem',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-widgets-base/Widget\",\r\n  \"./toolbars\"  \r\n],function(langx, $, Widget,toolbars){ \r\n  var slice = [].slice;\r\n\r\n  var ToolbarItem = Widget.inherit( {\r\n\r\n    options : {\r\n      template: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"toolbar-item\" href=\"javascript:;\"><span></span></a></li>',\r\n\r\n      menu : {\r\n        menuWrapper: '<div class=\"toolbar-menu\"></div>',\r\n        menuItem: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"menu-item\" href=\"javascript:;\"><span></span></a></li>',\r\n        separator: '<li><span class=\"separator\"></span></li>'      \r\n      }\r\n\r\n    },\r\n\r\n    _construct : function(opts) {\r\n      this.action = opts.action;\r\n      this.toolbar = opts.toolbar;\r\n      //this.editor = opts.toolbar.editor;\r\n      Widget.prototype._construct.call(this,opts);\r\n    },\r\n\r\n    _init : function() {\r\n      var k, len, ref, tag;\r\n      //this.render();\r\n\r\n      //this.wrapper = $(this._tpl.item).appendTo(this.toolbar.list);\r\n      this.toolbar.addToolItem(this);\r\n      this.wrapper = $(this._elm);\r\n\r\n      this.el = this.wrapper.find('a.toolbar-item');\r\n      this.el.attr('title', this.title).addClass(\"toolbar-item-\" + this.name).data('button', this);\r\n      this.setIcon(this.icon);\r\n      if (this.menu) {\r\n          this.menuWrapper = $(this.options.menu.menuWrapper).appendTo(this.wrapper);\r\n          this.menuWrapper.addClass(\"toolbar-menu-\" + this.name);\r\n      \r\n          this.renderMenu();\r\n      }\r\n\r\n      var _this = this;\r\n      this.el.on('mousedown', function(e) {\r\n          var exceed, noFocus, param;\r\n          e.preventDefault();\r\n          //noFocus = _this.needFocus && !_this.editor.editable.inputManager.focused;\r\n          if (_this.el.hasClass('disabled')) {\r\n            return false;\r\n          }\r\n          //if (noFocus) {\r\n          //  _this.editor.focus();\r\n          //}\r\n          if (_this.menu) {\r\n            _this.wrapper.toggleClass('menu-on').siblings('li').removeClass('menu-on');\r\n            if (_this.wrapper.is('.menu-on')) {\r\n              //exceed = _this.menuWrapper.offset().left + _this.menuWrapper.outerWidth() + 5 - _this.editor.wrapper.offset().left - _this.editor.wrapper.outerWidth();\r\n              exceed = _this.menuWrapper.offset().left + _this.menuWrapper.outerWidth() + 5 - _this.toolbar.offset().left - _this.toolbar.outerWidth();\r\n              if (exceed > 0) {\r\n                _this.menuWrapper.css({\r\n                  'left': 'auto',\r\n                  'right': 0\r\n                });\r\n              }\r\n              _this.trigger('menuexpand');\r\n            }\r\n            return false;\r\n          }\r\n          param = _this.el.data('param');\r\n          _this.command(param);\r\n          return false;\r\n      });\r\n      this.wrapper.on('click', 'a.menu-item', function(e) {\r\n          var btn, noFocus, param;\r\n          e.preventDefault();\r\n          btn = $(e.currentTarget);\r\n          _this.wrapper.removeClass('menu-on');\r\n          ///noFocus = _this.needFocus && !_this.editor.editable.inputManager.focused;\r\n          if (btn.hasClass('disabled') || noFocus) {\r\n            return false;\r\n          }\r\n          _this.toolbar.removeClass('menu-on');\r\n          param = btn.data('param');\r\n          _this.command(param);\r\n          return false;\r\n      });\r\n      this.wrapper.on('mousedown', 'a.menu-item', function(e) {\r\n        return false;\r\n      });\r\n\r\n      this.action.state.on(\"changed\", function(e,args) {\r\n        var updates = args.data;\r\n        if (updates[\"active\"] !== undefined) {\r\n          _this._doActive(updates[\"active\"].value);\r\n        }\r\n\r\n        if (updates[\"disabled\"] !== undefined) {\r\n          _this._doDisabled(updates[\"disabled\"].value);\r\n        }\r\n\r\n      });\r\n    },\r\n\r\n    _doActive : function(value) {\r\n      return this.el.toggleClass('active', value);\r\n    },\r\n\r\n    _doDisabled : function(value) {\r\n      return this.el.toggleClass('disabled', value);\r\n    },\r\n\r\n    iconClassOf : function(icon) {\r\n      if (icon) {\r\n        //if (this.editor.options.classes.icons[icon]) {\r\n        //  return this.editor.options.classes.icons[icon];\r\n        if (this.toolbar.options.classes && this.toolbar.options.classes.icons && this.toolbar.options.classes.icons[icon]) {\r\n          return  this.toolbar.options.classes.icons[icon];\r\n        } else {\r\n          return \"wordpad-icon wordpad-icon-\" + icon;\r\n        }\r\n      } else {\r\n        return '';\r\n      }\r\n    },\r\n\r\n    setIcon : function(icon) {\r\n      return this.el.find('span').removeClass().addClass(this.iconClassOf(icon)).text(this.text);\r\n    },\r\n\r\n    render : function() {\r\n\r\n      //this.wrapper = $(this._tpl.item).appendTo(this.toolbar.list);\r\n      this.toolbar.addToolItem(this);\r\n      this.wrapper = $(this._elm);\r\n\r\n      this.el = this.wrapper.find('a.toolbar-item');\r\n      this.el.attr('title', this.title).addClass(\"toolbar-item-\" + this.name).data('button', this);\r\n      this.setIcon(this.icon);\r\n      if (!this.menu) {\r\n        return;\r\n      }\r\n      this.menuWrapper = $(this.options.menu.menuWrapper).appendTo(this.wrapper);\r\n      this.menuWrapper.addClass(\"toolbar-menu-\" + this.name);\r\n      return this.renderMenu();\r\n    },\r\n\r\n    renderMenu : function() {\r\n      var $menuBtnEl, $menuItemEl, k, len, menuItem, ref, ref1, results;\r\n      if (!langx.isArray(this.menu)) {\r\n        return;\r\n      }\r\n      this.menuEl = $('<ul/>').appendTo(this.menuWrapper);\r\n      ref = this.menu;\r\n      results = [];\r\n      for (k = 0, len = ref.length; k < len; k++) {\r\n        menuItem = ref[k];\r\n        if (menuItem === '|') {\r\n          $(this.options.menu.separator).appendTo(this.menuEl);\r\n          continue;\r\n        }\r\n        $menuItemEl = $(this.options.menu.menuItem).appendTo(this.menuEl);\r\n        $menuBtnEl = $menuItemEl.find('a.menu-item').attr({\r\n          'title': (ref1 = menuItem.title) != null ? ref1 : menuItem.text,\r\n          'data-param': menuItem.param\r\n        }).addClass('menu-item-' + menuItem.name);\r\n        if (menuItem.icon) {\r\n          results.push($menuBtnEl.find('span').addClass(this.iconClassOf(menuItem.icon)));\r\n        } else {\r\n          results.push($menuBtnEl.find('span').text(menuItem.text));\r\n        }\r\n      }\r\n      return results;\r\n    },\r\n\r\n    command : function(params) {\r\n      this.action.execute(params);\r\n    },\r\n\r\n    \"name\" : {\r\n      get : function() {\r\n        return this.action.name;\r\n      }\r\n    },\r\n\r\n    \"icon\" : {\r\n      get : function() {\r\n        return this.action.icon;\r\n      }\r\n    },\r\n\r\n    \"title\" : {\r\n      get : function() {\r\n        //return this.action.tooltip || i18n.translate(this.action.name);\r\n        return this.action.tooltip ;\r\n      }\r\n    },\r\n\r\n    \"text\" : {\r\n      get : function() {\r\n        return this.action.text;\r\n      }\r\n    },\r\n\r\n    \"htmlTag\" : {\r\n      get : function() {\r\n        return this.action.htmlTag;\r\n      }\r\n    },\r\n\r\n    \"disableTag\" : {\r\n      get : function() {\r\n        return this.action.disableTag;\r\n      }\r\n    },\r\n\r\n    \"menu\" : {\r\n      get : function() {\r\n        return this.action.menu;\r\n      }\r\n    },\r\n\r\n    \"editable\" : {\r\n      get : function() {\r\n        return this._options.editable;\r\n      }\r\n    },\r\n\r\n    \"active\" : {\r\n      get : function() {\r\n        return this.action.active;\r\n      }\r\n    },\r\n\r\n    \"disabled\" : {\r\n      get : function() {\r\n        return this.action.disabled;\r\n      }\r\n    },\r\n\r\n    \"needFocus\" : {\r\n      get : function() {\r\n        return this.action.needFocus;\r\n      }\r\n    },\r\n\r\n\r\n    \"shortcut\" : {\r\n      get : function() {\r\n        return this.action.shortcut;\r\n      }\r\n    }\r\n\r\n\r\n  }); \r\n\r\n\r\n  return toolbars.ToolbarItem = ToolbarItem;\r\n});\r\n\ndefine('skylark-widgets-toolbars/Toolbar',[\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins-panels/Toolbar\",\r\n  \"skylark-widgets-base/Widget\",\r\n  \"./toolbars\",\r\n  \"./ToolbarItem\"\r\n],function(langx,$,_Toolbar, Widget,toolbars,ToolbarItem){ \r\n  var Toolbar = Widget.inherit({\r\n    klassName : \"Toolbar\",\r\n    pluginName : \"lark.wordpad.toolbar\",\r\n\r\n    options : {\r\n      template : \"<div class=\\\"domx-toolbar\\\"><ul></ul></div>\"\r\n    },\r\n\r\n    _construct : function(parent,opts) {\r\n      //this.editor =editor;\r\n      Widget.prototype._construct.call(this,parent,opts);\r\n\r\n    },\r\n\r\n    _init : function() {\r\n      this._xtoolbar = _Toolbar.instantiate(this._elm,this.options);\r\n      this.buttons = [];\r\n      //this.wrapper = $(this._tpl.wrapper).prependTo(this.editor.wrapper);\r\n      //this.wrapper = $(this._elm).prependTo(this.editor.wrapper);\r\n      \r\n      var actions = this.options.actions;\r\n      for (var i = 0; i < actions.length; i++) {\r\n        var action = actions[i];\r\n\r\n        if (action.name === '|') {\r\n          this._xtoolbar.addSeparator();\r\n          continue;\r\n        }\r\n\r\n        var toolItemCtor = action.toolItemCtor;\r\n\r\n        if (!toolItemCtor) {\r\n          toolItemCtor = ToolbarItem;\r\n        }\r\n\r\n        this.buttons.push(new toolItemCtor({\r\n          \"action\" : action,\r\n          \"toolbar\" : this\r\n        }));\r\n      }\r\n      //if (this.options.toolbarHidden) {\r\n       // return this.wrapper.hide();\r\n      //}\r\n    },\r\n\r\n    addToolItem : function(item) {\r\n      this._xtoolbar.addToolItem(item);\r\n    },\r\n\r\n    findButton : function(name) {\r\n      var button;\r\n      button = this._xtoolbar.list.find('.toolbar-item-' + name).data('button');\r\n      return button != null ? button : null;\r\n    }\r\n  });\r\n\r\n\r\n  Toolbar.addButton = function(btn) {\r\n    return this.buttons[btn.prototype.name] = btn;\r\n  };\r\n\r\n  Toolbar.buttons = {};\r\n\r\n  return toolbars.Toolbar = Toolbar;\r\n\r\n});\ndefine('skylark-widgets-toolbars/main',[\r\n\t\"./toolbars\",\r\n\t\"./Toolbar\",\r\n\t\"./ToolbarItem\"\r\n],function(toolbars){\r\n\treturn toolbars;\r\n});\ndefine('skylark-widgets-toolbars', ['skylark-widgets-toolbars/main'], function (main) { return main; });\n\n"]}