/**
 * skylark-widgets-wordpad - The skylark richeditor widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-widgets/skylark-widgets-wordpad/
 * @license MIT
 */
define(["skylark-domx-query","skylark-widgets-base/Addon","../Wordpad","../i18n"],function(t,e,a,o){var s=e.inherit({needFocus:!1,_init:function(){var e,a,o,s;if((this.editor=this._module,this.opts.autosave)&&(this.name="string"==typeof this.opts.autosave?this.opts.autosave:"simditor",this.opts.autosavePath?this.path=this.opts.autosavePath:(e=t("<a/>",{href:location.href}),a=this.editor.textarea.data("autosave")||this.name,this.path="/"+e[0].pathname.replace(/\/$/g,"").replace(/^\//g,"")+"/autosave/"+a+"/"),this.path&&(this.editor.on("valuechanged",(s=this,function(){return s.storage.set(s.path,s.editor.getValue())})),this.editor.el.closest("form").on("ajax:success.simditor-"+this.editor.id,function(t){return function(e){return t.storage.remove(t.path)}}(this)),(o=this.storage.get(this.path))&&o!==this.editor.textarea.val())))return this.editor.textarea.is("[data-autosave-confirm]")?confirm(this.editor.textarea.data("autosave-confirm")||"Are you sure to restore unsaved changes?")?this.editor.setValue(o):this.storage.remove(this.path):this.editor.setValue(o)}});return s.categoryName="general",s.addonName="autosave",s.prototype.opts={autosave:!0,autosavePath:null},s.prototype.storage={supported:function(){try{return localStorage.setItem("_storageSupported","yes"),localStorage.removeItem("_storageSupported"),!0}catch(t){return t,!1}},set:function(t,e,a){if(null==a&&(a=!1),this.supported())return(a?sessionStorage:localStorage).setItem(t,e)},get:function(t,e){if(null==e&&(e=!1),this.supported())return(e?sessionStorage:localStorage)[t]},remove:function(t,e){if(null==e&&(e=!1),this.supported())return(e?sessionStorage:localStorage).removeItem(t)}},a.addons.general.autoSave=s});
//# sourceMappingURL=../sourcemaps/addons/AutoSave.js.map
